(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,94670,(e,t,n)=>{var r={675:function(e,t){"use strict";t.byteLength=function(e){var t=a(e),n=t[0],r=t[1];return(n+r)*3/4-r},t.toByteArray=function(e){var t,n,i=a(e),s=i[0],l=i[1],c=new o((s+l)*3/4-l),d=0,u=l>0?s-4:s;for(n=0;n<u;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],c[d++]=t>>16&255,c[d++]=t>>8&255,c[d++]=255&t;return 2===l&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,c[d++]=255&t),1===l&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,c[d++]=t>>8&255,c[d++]=255&t),c},t.fromByteArray=function(e){for(var t,r=e.length,o=r%3,i=[],s=0,l=r-o;s<l;s+=16383)i.push(function(e,t,r){for(var o,i=[],s=t;s<r;s+=3)o=(e[s]<<16&0xff0000)+(e[s+1]<<8&65280)+(255&e[s+2]),i.push(n[o>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return i.join("")}(e,s,s+16383>l?l:s+16383));return 1===o?i.push(n[(t=e[r-1])>>2]+n[t<<4&63]+"=="):2===o&&i.push(n[(t=(e[r-2]<<8)+e[r-1])>>10]+n[t>>4&63]+n[t<<2&63]+"="),i.join("")};for(var n=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=i.length;s<l;++s)n[s]=i[s],r[i.charCodeAt(s)]=s;function a(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");-1===n&&(n=t);var r=n===t?0:4-n%4;return[n,r]}r[45]=62,r[95]=63},72:function(e,t,n){"use strict";var r=n(675),o=n(783),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function s(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,n){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return d(e)}return a(e,t,n)}function a(e,t,n){if("string"==typeof e){var r=e,o=t;if(("string"!=typeof o||""===o)&&(o="utf8"),!l.isEncoding(o))throw TypeError("Unknown encoding: "+o);var i=0|p(r,o),a=s(i),c=a.write(r,o);return c!==i&&(a=a.slice(0,c)),a}if(ArrayBuffer.isView(e))return u(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(N(e,ArrayBuffer)||e&&N(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(N(e,SharedArrayBuffer)||e&&N(e.buffer,SharedArrayBuffer)))return function(e,t,n){var r;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),l.prototype),r}(e,t,n);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var d=e.valueOf&&e.valueOf();if(null!=d&&d!==e)return l.from(d,t,n);var f=function(e){if(l.isBuffer(e)){var t=0|h(e.length),n=s(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||function(e){return e!=e}(e.length)?s(0):u(e):"Buffer"===e.type&&Array.isArray(e.data)?u(e.data):void 0}(e);if(f)return f;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return c(e),s(e<0?0:0|h(e))}function u(e){for(var t=e.length<0?0:0|h(e.length),n=s(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50,t.kMaxLength=0x7fffffff,l.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,n){return a(e,t,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,n){return(c(e),e<=0)?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e)},l.allocUnsafe=function(e){return d(e)},l.allocUnsafeSlow=function(e){return d(e)};function h(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function p(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||N(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var o=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return x(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return A(e).length;default:if(o)return r?-1:x(e).length;t=(""+t).toLowerCase(),o=!0}}function f(e,t,n){var o,i,s,l=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===n||n>this.length)&&(n=this.length),n<=0||(n>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=M[e[i]];return o}(this,t,n);case"utf8":case"utf-8":return y(this,t,n);case"ascii":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}(this,t,n);case"latin1":case"binary":return function(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}(this,t,n);case"base64":return o=this,i=t,s=n,0===i&&s===o.length?r.fromByteArray(o):r.fromByteArray(o.slice(i,s));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}(this,t,n);default:if(l)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),l=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,o){var i;if(0===e.length)return -1;if("string"==typeof n?(r=n,n=0):n>0x7fffffff?n=0x7fffffff:n<-0x80000000&&(n=-0x80000000),(i=n*=1)!=i&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length)if(o)return -1;else n=e.length-1;else if(n<0)if(!o)return -1;else n=0;if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,o);if("number"==typeof t){if(t&=255,"function"==typeof Uint8Array.prototype.indexOf)if(o)return Uint8Array.prototype.indexOf.call(e,t,n);else return Uint8Array.prototype.lastIndexOf.call(e,t,n);return b(e,[t],n,r,o)}throw TypeError("val must be string, number or Buffer")}function b(e,t,n,r,o){var i,s=1,l=e.length,a=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return -1;s=2,l/=2,a/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o){var d=-1;for(i=n;i<l;i++)if(c(e,i)===c(t,-1===d?0:i-d)){if(-1===d&&(d=i),i-d+1===a)return d*s}else -1!==d&&(i-=i-d),d=-1}else for(n+a>l&&(n=l-a),i=n;i>=0;i--){for(var u=!0,h=0;h<a;h++)if(c(e,i+h)!==c(t,h)){u=!1;break}if(u)return i}return -1}l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(N(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),N(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:+(r<n)},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);if(void 0===t)for(n=0,t=0;n<e.length;++n)t+=e[n].length;var n,r=l.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var i=e[n];if(N(i,Uint8Array)&&(i=l.from(i)),!l.isBuffer(i))throw TypeError('"list" argument must be an Array of Buffers');i.copy(r,o),o+=i.length}return r},l.byteLength=p,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},l.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?y(this,0,e):f.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},i&&(l.prototype[i]=l.prototype.inspect),l.prototype.compare=function(e,t,n,r,o){if(N(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return -1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,o>>>=0,this===e)return 0;for(var i=o-r,s=n-t,a=Math.min(i,s),c=this.slice(r,o),d=e.slice(t,n),u=0;u<a;++u)if(c[u]!==d[u]){i=c[u],s=d[u];break}return i<s?-1:+(s<i)},l.prototype.includes=function(e,t,n){return -1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)};function y(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,s,l,a,c=e[o],d=null,u=c>239?4:c>223?3:c>191?2:1;if(o+u<=n)switch(u){case 1:c<128&&(d=c);break;case 2:(192&(i=e[o+1]))==128&&(a=(31&c)<<6|63&i)>127&&(d=a);break;case 3:i=e[o+1],s=e[o+2],(192&i)==128&&(192&s)==128&&(a=(15&c)<<12|(63&i)<<6|63&s)>2047&&(a<55296||a>57343)&&(d=a);break;case 4:i=e[o+1],s=e[o+2],l=e[o+3],(192&i)==128&&(192&s)==128&&(192&l)==128&&(a=(15&c)<<18|(63&i)<<12|(63&s)<<6|63&l)>65535&&a<1114112&&(d=a)}null===d?(d=65533,u=1):d>65535&&(d-=65536,r.push(d>>>10&1023|55296),d=56320|1023&d),r.push(d),o+=u}var h=r,p=h.length;if(p<=4096)return String.fromCharCode.apply(String,h);for(var f="",m=0;m<p;)f+=String.fromCharCode.apply(String,h.slice(m,m+=4096));return f}function v(e,t,n){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>n)throw RangeError("Trying to access beyond buffer length")}function E(e,t,n,r,o,i){if(!l.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw RangeError('"value" argument is out of bounds');if(n+r>e.length)throw RangeError("Index out of range")}function k(e,t,n,r,o,i){if(n+r>e.length||n<0)throw RangeError("Index out of range")}function C(e,t,n,r,i){return t*=1,n>>>=0,i||k(e,t,n,4,34028234663852886e22,-34028234663852886e22),o.write(e,t,n,r,23,4),n+4}function T(e,t,n,r,i){return t*=1,n>>>=0,i||k(e,t,n,8,17976931348623157e292,-17976931348623157e292),o.write(e,t,n,r,52,8),n+8}l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var o,i,s,l,a,c,d,u,h=this.length-t;if((void 0===n||n>h)&&(n=h),e.length>0&&(n<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var p=!1;;)switch(r){case"hex":return function(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;r>i/2&&(r=i/2);for(var s=0;s<r;++s){var l,a=parseInt(t.substr(2*s,2),16);if((l=a)!=l)break;e[n+s]=a}return s}(this,e,t,n);case"utf8":case"utf-8":return o=t,i=n,_(x(e,this.length-o),this,o,i);case"ascii":return s=t,l=n,_(S(e),this,s,l);case"latin1":case"binary":return function(e,t,n,r){return _(S(t),e,n,r)}(this,e,t,n);case"base64":return a=t,c=n,_(A(e),this,a,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return d=t,u=n,_(function(e,t){for(var n,r,o=[],i=0;i<e.length&&!((t-=2)<0);++i)r=(n=e.charCodeAt(i))>>8,o.push(n%256),o.push(r);return o}(e,this.length-d),this,d,u);default:if(p)throw TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),p=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},l.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,l.prototype),r},l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||v(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||v(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},l.prototype.readUInt8=function(e,t){return e>>>=0,t||v(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||v(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||v(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||v(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||v(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||v(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||v(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readInt8=function(e,t){return(e>>>=0,t||v(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||v(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?0xffff0000|n:n},l.prototype.readInt16BE=function(e,t){e>>>=0,t||v(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?0xffff0000|n:n},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||v(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||v(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return e>>>=0,t||v(e,4,this.length),o.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||v(e,4,this.length),o.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||v(e,8,this.length),o.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||v(e,8,this.length),o.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,r){if(e*=1,t>>>=0,n>>>=0,!r){var o=Math.pow(2,8*n)-1;E(this,e,t,n,o,0)}var i=1,s=0;for(this[t]=255&e;++s<n&&(i*=256);)this[t+s]=e/i&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,r){if(e*=1,t>>>=0,n>>>=0,!r){var o=Math.pow(2,8*n)-1;E(this,e,t,n,o,0)}var i=n-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e*=1,t>>>=0,n||E(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e*=1,t>>>=0,n||E(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUInt16BE=function(e,t,n){return e*=1,t>>>=0,n||E(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUInt32LE=function(e,t,n){return e*=1,t>>>=0,n||E(this,e,t,4,0xffffffff,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUInt32BE=function(e,t,n){return e*=1,t>>>=0,n||E(this,e,t,4,0xffffffff,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeIntLE=function(e,t,n,r){if(e*=1,t>>>=0,!r){var o=Math.pow(2,8*n-1);E(this,e,t,n,o-1,-o)}var i=0,s=1,l=0;for(this[t]=255&e;++i<n&&(s*=256);)e<0&&0===l&&0!==this[t+i-1]&&(l=1),this[t+i]=(e/s|0)-l&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e*=1,t>>>=0,!r){var o=Math.pow(2,8*n-1);E(this,e,t,n,o-1,-o)}var i=n-1,s=1,l=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===l&&0!==this[t+i+1]&&(l=1),this[t+i]=(e/s|0)-l&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e*=1,t>>>=0,n||E(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e*=1,t>>>=0,n||E(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e*=1,t>>>=0,n||E(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e*=1,t>>>=0,n||E(this,e,t,4,0x7fffffff,-0x80000000),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e*=1,t>>>=0,n||E(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeFloatLE=function(e,t,n){return C(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return C(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return T(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return T(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(!l.isBuffer(e))throw TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw RangeError("Index out of range");if(r<0)throw RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o=r-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,n,r);else if(this===e&&n<t&&t<r)for(var i=o-1;i>=0;--i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,r),t);return o},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw TypeError("Unknown encoding: "+r);if(1===e.length){var o,i=e.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw RangeError("Out of range index");if(n<=t)return this;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=l.isBuffer(e)?e:l.from(e,r),a=s.length;if(0===a)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var w=/[^+/0-9A-Za-z-_]/g;function x(e,t){t=t||1/0;for(var n,r=e.length,o=null,i=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319||s+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=(o-55296<<10|n-56320)+65536}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else if(n<1114112){if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}else throw Error("Invalid code point")}return i}function S(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function A(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(w,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function _(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length)&&!(o>=e.length);++o)t[o+n]=e[o];return o}function N(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}var M=function(){for(var e="0123456789abcdef",t=Array(256),n=0;n<16;++n)for(var r=16*n,o=0;o<16;++o)t[r+o]=e[n]+e[o];return t}()},783:function(e,t){t.read=function(e,t,n,r,o){var i,s,l=8*o-r-1,a=(1<<l)-1,c=a>>1,d=-7,u=n?o-1:0,h=n?-1:1,p=e[t+u];for(u+=h,i=p&(1<<-d)-1,p>>=-d,d+=l;d>0;i=256*i+e[t+u],u+=h,d-=8);for(s=i&(1<<-d)-1,i>>=-d,d+=r;d>0;s=256*s+e[t+u],u+=h,d-=8);if(0===i)i=1-c;else{if(i===a)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),i-=c}return(p?-1:1)*s*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var s,l,a,c=8*i-o-1,d=(1<<c)-1,u=d>>1,h=5960464477539062e-23*(23===o),p=r?0:i-1,f=r?1:-1,m=+(t<0||0===t&&1/t<0);for(isNaN(t=Math.abs(t))||t===1/0?(l=+!!isNaN(t),s=d):(s=Math.floor(Math.log(t)/Math.LN2),t*(a=Math.pow(2,-s))<1&&(s--,a*=2),s+u>=1?t+=h/a:t+=h*Math.pow(2,1-u),t*a>=2&&(s++,a/=2),s+u>=d?(l=0,s=d):s+u>=1?(l=(t*a-1)*Math.pow(2,o),s+=u):(l=t*Math.pow(2,u-1)*Math.pow(2,o),s=0));o>=8;e[n+p]=255&l,p+=f,l/=256,o-=8);for(s=s<<o|l,c+=o;c>0;e[n+p]=255&s,p+=f,s/=256,c-=8);e[n+p-f]|=128*m}}},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}},s=!0;try{r[e](n,n.exports,i),s=!1}finally{s&&delete o[e]}return n.exports}i.ab="/ROOT/node_modules/.pnpm/next@16.1.1_@babel+core@7.2_39b5f7bf9254f45631682e0d132e5fc2/node_modules/next/dist/compiled/buffer/",t.exports=i(72)},65932,(e,t,n)=>{"use strict";t.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(o=r;0!=o--;)if(!e(t[o],n[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(i=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(o=r;0!=o--;)if(!Object.prototype.hasOwnProperty.call(n,i[o]))return!1;for(o=r;0!=o--;){var r,o,i,s=i[o];if(!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}},75609,(e,t,n)=>{"use strict";var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,i=Object.defineProperty,s=Object.getOwnPropertyDescriptor,l=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===o.call(e)},a=function(e){if(!e||"[object Object]"!==o.call(e))return!1;var t,n=r.call(e,"constructor"),i=e.constructor&&e.constructor.prototype&&r.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!i)return!1;for(t in e);return void 0===t||r.call(e,t)},c=function(e,t){i&&"__proto__"===t.name?i(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},d=function(e,t){if("__proto__"===t){if(!r.call(e,t))return;else if(s)return s(e,t).value}return e[t]};t.exports=function e(){var t,n,r,o,i,s,u=arguments[0],h=1,p=arguments.length,f=!1;for("boolean"==typeof u&&(f=u,u=arguments[1]||{},h=2),(null==u||"object"!=typeof u&&"function"!=typeof u)&&(u={});h<p;++h)if(t=arguments[h],null!=t)for(n in t)r=d(u,n),u!==(o=d(t,n))&&(f&&o&&(a(o)||(i=l(o)))?(i?(i=!1,s=r&&l(r)?r:[]):s=r&&a(r)?r:{},c(u,{name:n,newValue:e(f,s,o)})):void 0!==o&&c(u,{name:n,newValue:o}));return u}},7983,(e,t,n)=>{"use strict";var r=e.r(80744),o="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=r.useState,s=r.useEffect,l=r.useLayoutEffect,a=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!o(e,n)}catch(e){return!0}}var d="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=i({inst:{value:n,getSnapshot:t}}),o=r[0].inst,d=r[1];return l(function(){o.value=n,o.getSnapshot=t,c(o)&&d({inst:o})},[e,n,t]),s(function(){return c(o)&&d({inst:o}),e(function(){c(o)&&d({inst:o})})},[e]),a(n),n};n.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:d},33347,(e,t,n)=>{"use strict";t.exports=e.r(7983)},83842,(e,t,n)=>{"use strict";var r=e.r(80744),o=e.r(33347),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=o.useSyncExternalStore,l=r.useRef,a=r.useEffect,c=r.useMemo,d=r.useDebugValue;n.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var u=l(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;var p=s(e,(u=c(function(){function e(e){if(!a){if(a=!0,s=e,e=r(e),void 0!==o&&h.hasValue){var t=h.value;if(o(t,e))return l=t}return l=e}if(t=l,i(s,e))return t;var n=r(e);return void 0!==o&&o(t,n)?(s=e,t):(s=e,l=n)}var s,l,a=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,r,o]))[0],u[1]);return a(function(){h.hasValue=!0,h.value=p},[p]),d(p),p}},91926,(e,t,n)=>{"use strict";t.exports=e.r(83842)},28615,e=>{"use strict";let t,n,r,o,i,s,l,a,c,d,u;var h,p,f,m,g,b,y,v,E,k,C,T,w,x,S,A,_,N,M,I,O,D,R,L,P,B,H,j,F,U,z,V,$,G,q,W,Y,K,Z=e.i(71866),X=e.i(80744),Q=e.i(23276),J=e.i(71611),ee=e.i(98631);let et=(0,ee.default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),en=(0,ee.default)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var er=e.i(43293);let eo=(0,ee.default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var ei=e.i(86914);let es=(0,ee.default)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);var el=e.i(98227),ea=e.i(98281),ec=e.i(43731),ed=e.i(5300),eu=e.i(70856);let eh=(0,ee.default)("flag",[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]]);var ep=e.i(87516);function ef(e){this.content=e}ef.prototype={constructor:ef,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return -1},get:function(e){var t=this.find(e);return -1==t?void 0:this.content[t+1]},update:function(e,t,n){var r=n&&n!=e?this.remove(n):this,o=r.find(e),i=r.content.slice();return -1==o?i.push(n||e,t):(i[o+1]=t,n&&(i[o]=n)),new ef(i)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new ef(n)},addToStart:function(e,t){return new ef([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new ef(n)},addBefore:function(e,t,n){var r=this.remove(t),o=r.content.slice(),i=r.find(e);return o.splice(-1==i?o.length:i,0,t,n),new ef(o)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=ef.from(e)).size?new ef(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=ef.from(e)).size?new ef(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=ef.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},toObject:function(){var e={};return this.forEach(function(t,n){e[t]=n}),e},get size(){return this.content.length>>1}},ef.from=function(e){if(e instanceof ef)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new ef(t)};class em{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let t=0;t<e.length;t++)this.size+=e[t].nodeSize}nodesBetween(e,t,n,r=0,o){for(let i=0,s=0;s<t;i++){let l=this.content[i],a=s+l.nodeSize;if(a>e&&!1!==n(l,r+s,o||null,i)&&l.content.size){let o=s+1;l.nodesBetween(Math.max(0,e-o),Math.min(l.content.size,t-o),n,r+o)}s=a}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,r){let o="",i=!0;return this.nodesBetween(e,t,(s,l)=>{let a=s.isText?s.text.slice(Math.max(e,l)-l,t-l):s.isLeaf?r?"function"==typeof r?r(s):r:s.type.spec.leafText?s.type.spec.leafText(s):"":"";s.isBlock&&(s.isLeaf&&a||s.isTextblock)&&n&&(i?i=!1:o+=n),o+=a},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,r=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),o=1);o<e.content.length;o++)r.push(e.content[o]);return new em(r,this.size+e.size)}cut(e,t=this.size){if(0==e&&t==this.size)return this;let n=[],r=0;if(t>e)for(let o=0,i=0;i<t;o++){let s=this.content[o],l=i+s.nodeSize;l>e&&((i<e||l>t)&&(s=s.isText?s.cut(Math.max(0,e-i),Math.min(s.text.length,t-i)):s.cut(Math.max(0,e-i-1),Math.min(s.content.size,t-i-1))),n.push(s),r+=s.nodeSize),i=l}return new em(n,r)}cutByIndex(e,t){return e==t?em.empty:0==e&&t==this.content.length?this:new em(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let r=this.content.slice(),o=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new em(r,o)}addToStart(e){return new em([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new em(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let r=this.content[t];e(r,n,t),n+=r.nodeSize}}findDiffStart(e,t=0){return function e(t,n,r){for(let o=0;;o++){if(o==t.childCount||o==n.childCount)return t.childCount==n.childCount?null:r;let i=t.child(o),s=n.child(o);if(i==s){r+=i.nodeSize;continue}if(!i.sameMarkup(s))return r;if(i.isText&&i.text!=s.text){for(let e=0;i.text[e]==s.text[e];e++)r++;return r}if(i.content.size||s.content.size){let t=e(i.content,s.content,r+1);if(null!=t)return t}r+=i.nodeSize}}(this,e,t)}findDiffEnd(e,t=this.size,n=e.size){return function e(t,n,r,o){for(let i=t.childCount,s=n.childCount;;){if(0==i||0==s)return i==s?null:{a:r,b:o};let l=t.child(--i),a=n.child(--s),c=l.nodeSize;if(l==a){r-=c,o-=c;continue}if(!l.sameMarkup(a))return{a:r,b:o};if(l.isText&&l.text!=a.text){let e=0,t=Math.min(l.text.length,a.text.length);for(;e<t&&l.text[l.text.length-e-1]==a.text[a.text.length-e-1];)e++,r--,o--;return{a:r,b:o}}if(l.content.size||a.content.size){let t=e(l.content,a.content,r-1,o-1);if(t)return t}r-=c,o-=c}}(this,e,t,n)}findIndex(e){if(0==e)return eb(0,e);if(e==this.size)return eb(this.content.length,e);if(e>this.size||e<0)throw RangeError(`Position ${e} outside of fragment (${this})`);for(let t=0,n=0;;t++){let r=n+this.child(t).nodeSize;if(r>=e){if(r==e)return eb(t+1,r);return eb(t,n)}n=r}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return em.empty;if(!Array.isArray(t))throw RangeError("Invalid input for Fragment.fromJSON");return new em(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return em.empty;let t,n=0;for(let r=0;r<e.length;r++){let o=e[r];n+=o.nodeSize,r&&o.isText&&e[r-1].sameMarkup(o)?(t||(t=e.slice(0,r)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new em(t||e,n)}static from(e){if(!e)return em.empty;if(e instanceof em)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new em([e],e.nodeSize);throw RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}em.empty=new em([],0);let eg={index:0,offset:0};function eb(e,t){return eg.index=e,eg.offset=t,eg}function ey(e,t){if(e===t)return!0;if(!(e&&"object"==typeof e)||!(t&&"object"==typeof t))return!1;let n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!ey(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!ey(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}class ev{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let r=0;r<e.length;r++){let o=e[r];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,r));else{if(o.type.excludes(this.type))return e;!n&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),n=!0),t&&t.push(o)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&ey(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw RangeError(`There is no mark type ${t.type} in this schema`);let r=n.create(t.attrs);return n.checkAttrs(r.attrs),r}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&0==e.length)return ev.none;if(e instanceof ev)return[e];let t=e.slice();return t.sort((e,t)=>e.type.rank-t.type.rank),t}}ev.none=[];class eE extends Error{}class ek{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=function e(t,n,r,o){let{index:i,offset:s}=t.findIndex(n),l=t.maybeChild(i);if(s==n||l.isText)return o&&!o.canReplace(i,i,r)?null:t.cut(0,n).append(r).append(t.cut(n));let a=e(l.content,n-s-1,r,l);return a&&t.replaceChild(i,l.copy(a))}(this.content,e+this.openStart,t);return n&&new ek(n,this.openStart,this.openEnd)}removeBetween(e,t){return new ek(function e(t,n,r){let{index:o,offset:i}=t.findIndex(n),s=t.maybeChild(o),{index:l,offset:a}=t.findIndex(r);if(i==n||s.isText){if(a!=r&&!t.child(l).isText)throw RangeError("Removing non-flat range");return t.cut(0,n).append(t.cut(r))}if(o!=l)throw RangeError("Removing non-flat range");return t.replaceChild(o,s.copy(e(s.content,n-i-1,r-i-1)))}(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return ek.empty;let n=t.openStart||0,r=t.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw RangeError("Invalid input for Slice.fromJSON");return new ek(em.fromJSON(e,t.content),n,r)}static maxOpen(e,t=!0){let n=0,r=0;for(let r=e.firstChild;r&&!r.isLeaf&&(t||!r.type.spec.isolating);r=r.firstChild)n++;for(let n=e.lastChild;n&&!n.isLeaf&&(t||!n.type.spec.isolating);n=n.lastChild)r++;return new ek(e,n,r)}}function eC(e,t){if(!t.type.compatibleContent(e.type))throw new eE("Cannot join "+t.type.name+" onto "+e.type.name)}function eT(e,t,n){let r=e.node(n);return eC(r,t.node(n)),r}function ew(e,t){let n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function ex(e,t,n,r){let o=(t||e).node(n),i=0,s=t?t.index(n):o.childCount;e&&(i=e.index(n),e.depth>n?i++:e.textOffset&&(ew(e.nodeAfter,r),i++));for(let e=i;e<s;e++)ew(o.child(e),r);t&&t.depth==n&&t.textOffset&&ew(t.nodeBefore,r)}function eS(e,t){return e.type.checkContent(t),e.copy(t)}function eA(e,t,n){let r=[];return ex(null,e,n,r),e.depth>n&&ew(eS(eT(e,t,n+1),eA(e,t,n+1)),r),ex(t,null,n,r),new em(r)}ek.empty=new ek(em.empty,0,0);class e_{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[3*t],r=0==t?0:this.path[3*t-1]+1;for(let t=0;t<e;t++)r+=n.child(t).nodeSize;return r}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return ev.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),r=e.maybeChild(t);if(!n){let e=n;n=r,r=e}let o=n.marks;for(var i=0;i<o.length;i++)!1!==o[i].type.spec.inclusive||r&&o[i].isInSet(r.marks)||(o=o[i--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,r=e.parent.maybeChild(e.index());for(var o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new eO(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw RangeError("Position "+t+" out of range");let n=[],r=0,o=t;for(let t=e;;){let{index:e,offset:i}=t.content.findIndex(o),s=o-i;if(n.push(t,e,r+i),!s||(t=t.child(e)).isText)break;o=s-1,r+=i+1}return new e_(t,n,o)}static resolveCached(e,t){let n=eI.get(e);if(n)for(let e=0;e<n.elts.length;e++){let r=n.elts[e];if(r.pos==t)return r}else eI.set(e,n=new eN);let r=n.elts[n.i]=e_.resolve(e,t);return n.i=(n.i+1)%eM,r}}class eN{constructor(){this.elts=[],this.i=0}}let eM=12,eI=new WeakMap;class eO{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}let eD=Object.create(null);class eR{constructor(e,t,n,r=ev.none){this.type=e,this.attrs=t,this.marks=r,this.content=n||em.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n,r=0){this.content.nodesBetween(e,t,n,r,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,r){return this.content.textBetween(e,t,n,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&ey(this.attrs,t||e.defaultAttrs||eD)&&ev.sameSet(this.marks,n||ev.none)}copy(e=null){return e==this.content?this:new eR(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new eR(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,n=!1){if(e==t)return ek.empty;let r=this.resolve(e),o=this.resolve(t),i=n?0:r.sharedDepth(t),s=r.start(i);return new ek(r.node(i).content.cut(r.pos-s,o.pos-s),r.depth-i,o.depth-i)}replace(e,t,n){var r=this.resolve(e),o=this.resolve(t);if(n.openStart>r.depth)throw new eE("Inserted content deeper than insertion position");if(r.depth-n.openStart!=o.depth-n.openEnd)throw new eE("Inconsistent open depths");return function e(t,n,r,o){let i=t.index(o),s=t.node(o);if(i==n.index(o)&&o<t.depth-r.openStart){let l=e(t,n,r,o+1);return s.copy(s.content.replaceChild(i,l))}if(!r.content.size)return eS(s,eA(t,n,o));if(r.openStart||r.openEnd||t.depth!=o||n.depth!=o){let{start:e,end:i}=function(e,t){let n=t.depth-e.openStart,r=t.node(n).copy(e.content);for(let e=n-1;e>=0;e--)r=t.node(e).copy(em.from(r));return{start:r.resolveNoCache(e.openStart+n),end:r.resolveNoCache(r.content.size-e.openEnd-n)}}(r,t);return eS(s,function e(t,n,r,o,i){let s=t.depth>i&&eT(t,n,i+1),l=o.depth>i&&eT(r,o,i+1),a=[];return ex(null,t,i,a),s&&l&&n.index(i)==r.index(i)?(eC(s,l),ew(eS(s,e(t,n,r,o,i+1)),a)):(s&&ew(eS(s,eA(t,n,i+1)),a),ex(n,r,i,a),l&&ew(eS(l,eA(r,o,i+1)),a)),ex(o,null,i,a),new em(a)}(t,e,i,n,o))}{let e=t.parent,o=e.content;return eS(e,o.cut(0,t.parentOffset).append(r.content).append(o.cut(n.parentOffset)))}}(r,o,n,0)}nodeAt(e){for(let t=this;;){let{index:n,offset:r}=t.content.findIndex(e);if(!(t=t.maybeChild(n)))return null;if(r==e||t.isText)return t;e-=r+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let r=this.content.child(t-1);return{node:r,index:t-1,offset:n-r.nodeSize}}resolve(e){return e_.resolveCached(this,e)}resolveNoCache(e){return e_.resolve(this,e)}rangeHasMark(e,t,n){let r=!1;return t>e&&this.nodesBetween(e,t,e=>(n.isInSet(e.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),eP(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,n=em.empty,r=0,o=n.childCount){let i=this.contentMatchAt(e).matchFragment(n,r,o),s=i&&i.matchFragment(this.content,t);if(!s||!s.validEnd)return!1;for(let e=r;e<o;e++)if(!this.type.allowsMarks(n.child(e).marks))return!1;return!0}canReplaceWith(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;let o=this.contentMatchAt(e).matchType(n),i=o&&o.matchFragment(this.content,t);return!!i&&i.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=ev.none;for(let t=0;t<this.marks.length;t++){let n=this.marks[t];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!ev.sameSet(e,this.marks))throw RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(e=>e.toJSON())),e}static fromJSON(e,t){let n;if(!t)throw RangeError("Invalid input for Node.fromJSON");if(t.marks){if(!Array.isArray(t.marks))throw RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw RangeError("Invalid text node in JSON");return e.text(t.text,n)}let r=em.fromJSON(e,t.content),o=e.nodeType(t.type).create(t.attrs,r,n);return o.type.checkAttrs(o.attrs),o}}eR.prototype.text=void 0;class eL extends eR{constructor(e,t,n,r){if(super(e,t,null,r),!n)throw RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):eP(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new eL(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new eL(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function eP(e,t){for(let n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}class eB{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){var n;let r,o=new eH(e,t);if(null==o.next)return eB.empty;let i=function e(t){let n=[];do n.push(function(t){let n=[];do n.push(function(t){let n=function(t){if(t.eat("(")){let n=e(t);return t.eat(")")||t.err("Missing closing paren"),n}if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=(function(e,t){let n=e.nodeTypes,r=n[t];if(r)return[r];let o=[];for(let e in n){let r=n[e];r.isInGroup(t)&&o.push(r)}return 0==o.length&&e.err("No node type or group '"+t+"' found"),o})(t,t.next).map(e=>(null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}));return t.pos++,1==e.length?e[0]:{type:"choice",exprs:e}}}(t);for(;;)if(t.eat("+"))n={type:"plus",expr:n};else if(t.eat("*"))n={type:"star",expr:n};else if(t.eat("?"))n={type:"opt",expr:n};else if(t.eat("{"))n=function(e,t){let n=ej(e),r=n;return e.eat(",")&&(r="}"!=e.next?ej(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}(t,n);else break;return n}(t));while(t.next&&")"!=t.next&&"|"!=t.next)return 1==n.length?n[0]:{type:"seq",exprs:n}}(t));while(t.eat("|"))return 1==n.length?n[0]:{type:"choice",exprs:n}}(o);o.next&&o.err("Unexpected trailing text");let s=(n=function(e){let t=[[]];return o(function e(t,i){if("choice"==t.type)return t.exprs.reduce((t,n)=>t.concat(e(n,i)),[]);if("seq"==t.type)for(let r=0;;r++){let s=e(t.exprs[r],i);if(r==t.exprs.length-1)return s;o(s,i=n())}else if("star"==t.type){let s=n();return r(i,s),o(e(t.expr,s),s),[r(s)]}else if("plus"==t.type){let s=n();return o(e(t.expr,i),s),o(e(t.expr,s),s),[r(s)]}else if("opt"==t.type)return[r(i)].concat(e(t.expr,i));else if("range"==t.type){let s=i;for(let r=0;r<t.min;r++){let r=n();o(e(t.expr,s),r),s=r}if(-1==t.max)o(e(t.expr,s),s);else for(let i=t.min;i<t.max;i++){let i=n();r(s,i),o(e(t.expr,s),i),s=i}return[r(s)]}else if("name"==t.type)return[r(i,void 0,t.value)];else throw Error("Unknown expr type")}(e,0),n()),t;function n(){return t.push([])-1}function r(e,n,r){let o={term:r,to:n};return t[e].push(o),o}function o(e,t){e.forEach(e=>e.to=t)}}(i),r=Object.create(null),function e(t){let o=[];t.forEach(e=>{n[e].forEach(({term:e,to:t})=>{let r;if(e){for(let t=0;t<o.length;t++)o[t][0]==e&&(r=o[t][1]);eU(n,t).forEach(t=>{r||o.push([e,r=[]]),-1==r.indexOf(t)&&r.push(t)})}})});let i=r[t.join(",")]=new eB(t.indexOf(n.length-1)>-1);for(let t=0;t<o.length;t++){let n=o[t][1].sort(eF);i.next.push({type:o[t][0],next:r[n.join(",")]||e(n)})}return i}(eU(n,0)));return function(e,t){for(let n=0,r=[e];n<r.length;n++){let e=r[n],o=!e.validEnd,i=[];for(let t=0;t<e.next.length;t++){let{type:n,next:s}=e.next[t];i.push(n.name),o&&!(n.isText||n.hasRequiredAttrs())&&(o=!1),-1==r.indexOf(s)&&r.push(s)}o&&t.err("Only non-generatable nodes ("+i.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(s,o),s}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,n=e.childCount){let r=this;for(let o=t;r&&o<n;o++)r=r.matchType(e.child(o).type);return r}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e,t=!1,n=0){let r=[this];return function o(i,s){let l=i.matchFragment(e,n);if(l&&(!t||l.validEnd))return em.from(s.map(e=>e.createAndFill()));for(let e=0;e<i.next.length;e++){let{type:t,next:n}=i.next[e];if(!(t.isText||t.hasRequiredAttrs())&&-1==r.indexOf(n)){r.push(n);let e=o(n,s.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let t=0;t<this.wrapCache.length;t+=2)if(this.wrapCache[t]==e)return this.wrapCache[t+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let r=n.shift(),o=r.match;if(o.matchType(e)){let e=[];for(let t=r;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<o.next.length;e++){let{type:i,next:s}=o.next[e];i.isLeaf||i.hasRequiredAttrs()||i.name in t||r.type&&!s.validEnd||(n.push({match:i.contentMatch,type:i,via:r}),t[i.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];return!function t(n){e.push(n);for(let r=0;r<n.next.length;r++)-1==e.indexOf(n.next[r].next)&&t(n.next[r].next)}(this),e.map((t,n)=>{let r=n+(t.validEnd?"*":" ")+" ";for(let n=0;n<t.next.length;n++)r+=(n?", ":"")+t.next[n].type.name+"->"+e.indexOf(t.next[n].next);return r}).join("\n")}}eB.empty=new eB(!0);class eH{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw SyntaxError(e+" (in content expression '"+this.string+"')")}}function ej(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function eF(e,t){return t-e}function eU(e,t){let n=[];return function t(r){let o=e[r];if(1==o.length&&!o[0].term)return t(o[0].to);n.push(r);for(let e=0;e<o.length;e++){let{term:r,to:i}=o[e];r||-1!=n.indexOf(i)||t(i)}}(t),n.sort(eF)}function ez(e){let t=Object.create(null);for(let n in e){let r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function eV(e,t){let n=Object.create(null);for(let r in e){let o=t&&t[r];if(void 0===o){let t=e[r];if(t.hasDefault)o=t.default;else throw RangeError("No value supplied for attribute "+r)}n[r]=o}return n}function e$(e,t,n,r){for(let r in t)if(!(r in e))throw RangeError(`Unsupported attribute ${r} for ${n} of type ${r}`);for(let n in e){let r=e[n];r.validate&&r.validate(t[n])}}function eG(e,t){let n=Object.create(null);if(t)for(let r in t)n[r]=new eW(e,r,t[r]);return n}class eq{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=eG(e,n.attrs),this.defaultAttrs=ez(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==eB.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:eV(this.attrs,e)}create(e=null,t,n){if(this.isText)throw Error("NodeType.create can't construct text nodes");return new eR(this,this.computeAttrs(e),em.from(t),ev.setFrom(n))}createChecked(e=null,t,n){return t=em.from(t),this.checkContent(t),new eR(this,this.computeAttrs(e),t,ev.setFrom(n))}createAndFill(e=null,t,n){if(e=this.computeAttrs(e),(t=em.from(t)).size){let e=this.contentMatch.fillBefore(t);if(!e)return null;t=e.append(t)}let r=this.contentMatch.matchFragment(t),o=r&&r.fillBefore(em.empty,!0);return o?new eR(this,e,t.append(o),ev.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let t=0;t<e.childCount;t++)if(!this.allowsMarks(e.child(t).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){e$(this.attrs,e,"node",this.name)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){let t;if(null==this.markSet)return e;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:ev.none:e}static compile(e,t){let n=Object.create(null);e.forEach((e,r)=>n[e]=new eq(e,t,r));let r=t.spec.topNode||"doc";if(!n[r])throw RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw RangeError("Every schema needs a 'text' type");for(let e in n.text.attrs)throw RangeError("The text node type should not have attributes");return n}}class eW{constructor(e,t,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate="string"==typeof n.validate?function(e,t,n){let r=n.split("|");return n=>{let o=null===n?"null":typeof n;if(0>r.indexOf(o))throw RangeError(`Expected value of type ${r} for attribute ${t} on type ${e}, got ${o}`)}}(e,t,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class eY{constructor(e,t,n,r){this.name=e,this.rank=t,this.schema=n,this.spec=r,this.attrs=eG(e,r.attrs),this.excluded=null;let o=ez(this.attrs);this.instance=o?new ev(this,o):null}create(e=null){return!e&&this.instance?this.instance:new ev(this,eV(this.attrs,e))}static compile(e,t){let n=Object.create(null),r=0;return e.forEach((e,o)=>n[e]=new eY(e,r++,t,o)),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){e$(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class eK{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let n in e)t[n]=e[n];t.nodes=ef.from(e.nodes),t.marks=ef.from(e.marks||{}),this.nodes=eq.compile(this.spec.nodes,this),this.marks=eY.compile(this.spec.marks,this);let n=Object.create(null);for(let e in this.nodes){if(e in this.marks)throw RangeError(e+" can not be both a node and a mark");let t=this.nodes[e],r=t.spec.content||"",o=t.spec.marks;if(t.contentMatch=n[r]||(n[r]=eB.parse(r,this.nodes)),t.inlineContent=t.contentMatch.inlineContent,t.spec.linebreakReplacement){if(this.linebreakReplacement)throw RangeError("Multiple linebreak nodes defined");if(!t.isInline||!t.isLeaf)throw RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=t}t.markSet="_"==o?null:o?eZ(this,o.split(" ")):""!=o&&t.inlineContent?null:[]}for(let e in this.marks){let t=this.marks[e],n=t.spec.excludes;t.excluded=null==n?[t]:""==n?[]:eZ(this,n.split(" "))}this.nodeFromJSON=e=>eR.fromJSON(this,e),this.markFromJSON=e=>ev.fromJSON(this,e),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,n,r){if("string"==typeof e)e=this.nodeType(e);else if(e instanceof eq){if(e.schema!=this)throw RangeError("Node type from different schema used ("+e.name+")")}else throw RangeError("Invalid node type: "+e);return e.createChecked(t,n,r)}text(e,t){let n=this.nodes.text;return new eL(n,n.defaultAttrs,e,ev.setFrom(t))}mark(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}nodeType(e){let t=this.nodes[e];if(!t)throw RangeError("Unknown node type: "+e);return t}}function eZ(e,t){let n=[];for(let r=0;r<t.length;r++){let o=t[r],i=e.marks[o],s=i;if(i)n.push(i);else for(let t in e.marks){let r=e.marks[t];("_"==o||r.spec.group&&r.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=r)}if(!s)throw SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}class eX{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let n=this.matchedStyles=[];t.forEach(e=>{if(null!=e.tag)this.tags.push(e);else if(null!=e.style){let t=/[^=]*/.exec(e.style)[0];0>n.indexOf(t)&&n.push(t),this.styles.push(e)}}),this.normalizeLists=!this.tags.some(t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let n=e.nodes[t.node];return n.contentMatch.matchType(n)})}parse(e,t={}){let n=new e4(this,t,!1);return n.addAll(e,ev.none,t.from,t.to),n.finish()}parseSlice(e,t={}){let n=new e4(this,t,!0);return n.addAll(e,ev.none,t.from,t.to),ek.maxOpen(n.finish())}matchTag(e,t,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){var r,o;let n=this.tags[i];if(r=e,o=n.tag,(r.matches||r.msMatchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector).call(r,o)&&(void 0===n.namespace||e.namespaceURI==n.namespace)&&(!n.context||t.matchesContext(n.context))){if(n.getAttrs){let t=n.getAttrs(e);if(!1===t)continue;n.attrs=t||void 0}return n}}}matchStyle(e,t,n,r){for(let o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){let r=this.styles[o],i=r.style;if(0==i.indexOf(e)&&(!r.context||n.matchesContext(r.context))&&(!(i.length>e.length)||61==i.charCodeAt(e.length)&&i.slice(e.length+1)==t)){if(r.getAttrs){let e=r.getAttrs(t);if(!1===e)continue;r.attrs=e||void 0}return r}}}static schemaRules(e){let t=[];function n(e){let n=null==e.priority?50:e.priority,r=0;for(;r<t.length;r++){let e=t[r];if((null==e.priority?50:e.priority)<n)break}t.splice(r,0,e)}for(let t in e.marks){let r=e.marks[t].spec.parseDOM;r&&r.forEach(e=>{n(e=e5(e)),e.mark||e.ignore||e.clearMark||(e.mark=t)})}for(let t in e.nodes){let r=e.nodes[t].spec.parseDOM;r&&r.forEach(e=>{n(e=e5(e)),e.node||e.ignore||e.mark||(e.node=t)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new eX(e,eX.schemaRules(e)))}}let eQ={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},eJ={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},e0={ol:!0,ul:!0};function e1(e,t,n){return null!=t?!!t|2*("full"===t):e&&"pre"==e.whitespace?3:-5&n}class e2{constructor(e,t,n,r,o,i){this.type=e,this.attrs=t,this.marks=n,this.solid=r,this.options=i,this.content=[],this.activeMarks=ev.none,this.match=o||(4&i?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(em.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let t=this.type.contentMatch,n;return(n=t.findWrapping(e.type))?(this.match=t,n):null}}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let e=this.content[this.content.length-1],t;e&&e.isText&&(t=/[ \t\r\n\u000c]+$/.exec(e.text))&&(e.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=e.withText(e.text.slice(0,e.text.length-t[0].length)))}let t=em.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(em.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!eQ.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class e4{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let r=t.topNode,o,i=e1(null,t.preserveWhitespace,0)|4*!!n;o=r?new e2(r.type,r.attrs,ev.none,!0,t.topMatch||r.type.contentMatch,i):n?new e2(null,null,ev.none,!0,null,i):new e2(e.schema.topNodeType,null,ev.none,!0,null,i),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){3==e.nodeType?this.addTextNode(e,t):1==e.nodeType&&this.addElement(e,t)}addTextNode(e,t){let n=e.nodeValue,r=this.top,o=2&r.options?"full":this.localPreserveWS||(1&r.options)>0,{schema:i}=this.parser;if("full"===o||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(o)if("full"===o)n=n.replace(/\r\n?/g,"\n");else if(i.linebreakReplacement&&/[\r\n]/.test(n)&&this.top.findWrapping(i.linebreakReplacement.create())){let e=n.split(/\r?\n|\r/);for(let n=0;n<e.length;n++)n&&this.insertNode(i.linebreakReplacement.create(),t,!0),e[n]&&this.insertNode(i.text(e[n]),t,!/\S/.test(e[n]));n=""}else n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let t=r.content[r.content.length-1],o=e.previousSibling;(!t||o&&"BR"==o.nodeName||t.isText&&/[ \t\r\n\u000c]$/.test(t.text))&&(n=n.slice(1))}n&&this.insertNode(i.text(n),t,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,t,n){let r=this.localPreserveWS,o=this.top;("PRE"==e.tagName||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let i=e.nodeName.toLowerCase(),s;e0.hasOwnProperty(i)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,n=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&e0.hasOwnProperty(e)&&n?(n.appendChild(t),t=n):"li"==e?n=t:e&&(n=null)}}(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(s=this.parser.matchTag(e,this,n));e:if(l?l.ignore:eJ.hasOwnProperty(i))this.findInside(e),this.ignoreFallback(e,t);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let n,r=this.needsBlock;if(eQ.hasOwnProperty(i))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),n=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let s=l&&l.skip?t:this.readStyles(e,t);s&&this.addAll(e,s),n&&this.sync(o),this.needsBlock=r}else{let n=this.readStyles(e,t);n&&this.addElementByRule(e,l,n,!1===l.consuming?s:void 0)}this.localPreserveWS=r}leafFallback(e,t){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"),t)}ignoreFallback(e,t){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let n=e.style;if(n&&n.length)for(let e=0;e<this.parser.matchedStyles.length;e++){let r=this.parser.matchedStyles[e],o=n.getPropertyValue(r);if(o)for(let e;;){let n=this.parser.matchStyle(r,o,this,e);if(!n)break;if(n.ignore)return null;if(t=n.clearMark?t.filter(e=>!n.clearMark(e)):t.concat(this.parser.schema.marks[n.mark].create(n.attrs)),!1===n.consuming)e=n;else break}}return t}addElementByRule(e,t,n,r){let o,i;if(t.node)if((i=this.parser.schema.nodes[t.node]).isLeaf)this.insertNode(i.create(t.attrs),n,"BR"==e.nodeName)||this.leafFallback(e,n);else{let e=this.enter(i,t.attrs||null,n,t.preserveWhitespace);e&&(o=!0,n=e)}else{let e=this.parser.schema.marks[t.mark];n=n.concat(e.create(t.attrs))}let s=this.top;if(i&&i.isLeaf)this.findInside(e);else if(r)this.addElement(e,n,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(e=>this.insertNode(e,n,!1));else{let r=e;"string"==typeof t.contentElement?r=e.querySelector(t.contentElement):"function"==typeof t.contentElement?r=t.contentElement(e):t.contentElement&&(r=t.contentElement),this.findAround(e,r,!0),this.addAll(r,n),this.findAround(e,r,!1)}o&&this.sync(s)&&this.open--}addAll(e,t,n,r){let o=n||0;for(let i=n?e.childNodes[n]:e.firstChild,s=null==r?null:e.childNodes[r];i!=s;i=i.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(i,t);this.findAtPoint(e,o)}findPlace(e,t,n){let r,o;for(let t=this.open,i=0;t>=0;t--){let s=this.nodes[t],l=s.findWrapping(e);if(l&&(!r||r.length>l.length+i)&&(r=l,o=s,!l.length))break;if(s.solid){if(n)break;i+=2}}if(!r)return null;this.sync(o);for(let e=0;e<r.length;e++)t=this.enterInner(r[e],null,t,!1);return t}insertNode(e,t,n){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&(t=this.enterInner(e,null,t))}let r=this.findPlace(e,t,n);if(r){this.closeExtra();let t=this.top;t.match&&(t.match=t.match.matchType(e.type));let n=ev.none;for(let o of r.concat(e.marks))(t.type?t.type.allowsMarkType(o.type):e3(o.type,e.type))&&(n=o.addToSet(n));return t.content.push(e.mark(n)),!0}return!1}enter(e,t,n,r){let o=this.findPlace(e.create(t),n,!1);return o&&(o=this.enterInner(e,t,n,!0,r)),o}enterInner(e,t,n,r=!1,o){this.closeExtra();let i=this.top;i.match=i.match&&i.match.matchType(e);let s=e1(e,o,i.options);4&i.options&&0==i.content.length&&(s|=4);let l=ev.none;return n=n.filter(t=>(i.type?!i.type.allowsMarkType(t.type):!e3(t.type,e))||(l=t.addToSet(l),!1)),this.nodes.push(new e2(e,t,l,r,null,s)),this.open++,n}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;else this.localPreserveWS&&(this.nodes[t].options|=1);return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let t=n.length-1;t>=0;t--)e+=n[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let r=0;r<this.find.length;r++)null==this.find[r].pos&&1==e.nodeType&&e.contains(this.find[r].node)&&t.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,r=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),o=-(n?n.depth+1:0)+ +!r,i=(e,s)=>{for(;e>=0;e--){let l=t[e];if(""==l){if(e==t.length-1||0==e)continue;for(;s>=o;s--)if(i(e-1,s))return!0;return!1}{let e=s>0||0==s&&r?this.nodes[s].type:n&&s>=o?n.node(s-o).type:null;if(!e||e.name!=l&&!e.isInGroup(l))return!1;s--}}return!0};return i(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let e in this.parser.schema.nodes){let t=this.parser.schema.nodes[e];if(t.isTextblock&&t.defaultAttrs)return t}}}function e5(e){let t={};for(let n in e)t[n]=e[n];return t}function e3(e,t){let n=t.schema.nodes;for(let r in n){let o=n[r];if(!o.allowsMarkType(e))continue;let i=[],s=e=>{i.push(e);for(let n=0;n<e.edgeCount;n++){let{type:r,next:o}=e.edge(n);if(r==t||0>i.indexOf(o)&&s(o))return!0}};if(s(o.contentMatch))return!0}}class e8{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},n){n||(n=e9(t).createDocumentFragment());let r=n,o=[];return e.forEach(e=>{if(o.length||e.marks.length){let n=0,i=0;for(;n<o.length&&i<e.marks.length;){let t=e.marks[i];if(!this.marks[t.type.name]){i++;continue}if(!t.eq(o[n][0])||!1===t.type.spec.spanning)break;n++,i++}for(;n<o.length;)r=o.pop()[1];for(;i<e.marks.length;){let n=e.marks[i++],s=this.serializeMark(n,e.isInline,t);s&&(o.push([n,r]),r.appendChild(s.dom),r=s.contentDOM||s.dom)}}r.appendChild(this.serializeNodeInner(e,t))}),n}serializeNodeInner(e,t){let{dom:n,contentDOM:r}=te(e9(t),this.nodes[e.type.name](e),null,e.attrs);if(r){if(e.isLeaf)throw RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,r)}return n}serializeNode(e,t={}){let n=this.serializeNodeInner(e,t);for(let r=e.marks.length-1;r>=0;r--){let o=this.serializeMark(e.marks[r],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n}serializeMark(e,t,n={}){let r=this.marks[e.type.name];return r&&te(e9(n),r(e,t),null,e.attrs)}static renderSpec(e,t,n=null,r){return te(e,t,n,r)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new e8(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=e6(e.nodes);return t.text||(t.text=e=>e.text),t}static marksFromSchema(e){return e6(e.marks)}}function e6(e){let t={};for(let n in e){let r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function e9(e){return e.document||window.document}let e7=new WeakMap;function te(e,t,n,r){let o,i,s;if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;let l=t[0],a;if("string"!=typeof l)throw RangeError("Invalid array passed to renderSpec");if(r&&(void 0===(i=e7.get(r))&&e7.set(r,(s=null,!function e(t){if(t&&"object"==typeof t)if(Array.isArray(t))if("string"==typeof t[0])s||(s=[]),s.push(t);else for(let n=0;n<t.length;n++)e(t[n]);else for(let n in t)e(t[n])}(r),i=s)),a=i)&&a.indexOf(t)>-1)throw RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let c=l.indexOf(" ");c>0&&(n=l.slice(0,c),l=l.slice(c+1));let d=n?e.createElementNS(n,l):e.createElement(l),u=t[1],h=1;if(u&&"object"==typeof u&&null==u.nodeType&&!Array.isArray(u)){for(let e in h=2,u)if(null!=u[e]){let t=e.indexOf(" ");t>0?d.setAttributeNS(e.slice(0,t),e.slice(t+1),u[e]):"style"==e&&d.style?d.style.cssText=u[e]:d.setAttribute(e,u[e])}}for(let i=h;i<t.length;i++){let s=t[i];if(0===s){if(i<t.length-1||i>h)throw RangeError("Content hole must be the only child of its parent node");return{dom:d,contentDOM:d}}{let{dom:t,contentDOM:i}=te(e,s,n,r);if(d.appendChild(t),i){if(o)throw RangeError("Multiple content holes");o=i}}}return{dom:d,contentDOM:o}}class tt{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class tn{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&tn.empty)return tn.empty}recover(e){let t=0,n=65535&e;if(!this.inverted)for(let e=0;e<n;e++)t+=this.ranges[3*e+2]-this.ranges[3*e+1];return this.ranges[3*n]+t+(e-(65535&e))/65536}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,n){let r=0,o=this.inverted?2:1,i=this.inverted?1:2;for(let s=0;s<this.ranges.length;s+=3){let l=this.ranges[s]-(this.inverted?r:0);if(l>e)break;let a=this.ranges[s+o],c=this.ranges[s+i],d=l+a;if(e<=d){let o=a?e==l?-1:e==d?1:t:t,i=l+r+(o<0?0:c);if(n)return i;let u=e==(t<0?l:d)?null:s/3+(e-l)*65536,h=e==l?2:e==d?1:4;return(t<0?e!=l:e!=d)&&(h|=8),new tt(i,h,u)}r+=c-a}return n?e+r:new tt(e+r,0,null)}touches(e,t){let n=0,r=65535&t,o=this.inverted?2:1,i=this.inverted?1:2;for(let t=0;t<this.ranges.length;t+=3){let s=this.ranges[t]-(this.inverted?n:0);if(s>e)break;let l=this.ranges[t+o];if(e<=s+l&&t==3*r)return!0;n+=this.ranges[t+i]-l}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let r=0,o=0;r<this.ranges.length;r+=3){let i=this.ranges[r],s=i-(this.inverted?o:0),l=i+(this.inverted?0:o),a=this.ranges[r+t],c=this.ranges[r+n];e(s,s+a,l,l+c),o+=c-a}}invert(){return new tn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?tn.empty:new tn(e<0?[0,-e,0]:[0,0,e])}}tn.empty=new tn([]);class tr{constructor(e,t,n=0,r=e?e.length:0){this.mirror=t,this.from=n,this.to=r,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new tr(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),null!=t&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,n=this._maps.length;t<e._maps.length;t++){let r=e.getMirror(t);this.appendMap(e._maps[t],null!=r&&r<t?n+r:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this._maps.length+e._maps.length;t>=0;t--){let r=e.getMirror(t);this.appendMap(e._maps[t].invert(),null!=r&&r>t?n-r-1:void 0)}}invert(){let e=new tr;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,n){let r=0;for(let n=this.from;n<this.to;n++){let o=this._maps[n].mapResult(e,t);if(null!=o.recover){let t=this.getMirror(n);if(null!=t&&t>n&&t<this.to){n=t,e=this._maps[t].recover(o.recover);continue}}r|=o.delInfo,e=o.pos}return n?e:new tt(e,r,null)}}let to=Object.create(null);class ti{getMap(){return tn.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw RangeError("Invalid input for Step.fromJSON");let n=to[t.stepType];if(!n)throw RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in to)throw RangeError("Duplicate use of step JSON ID "+e);return to[e]=t,t.prototype.jsonID=e,t}}class ts{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new ts(e,null)}static fail(e){return new ts(null,e)}static fromReplace(e,t,n,r){try{return ts.ok(e.replace(t,n,r))}catch(e){if(e instanceof eE)return ts.fail(e.message);throw e}}}function tl(e,t,n){let r=[];for(let o=0;o<e.childCount;o++){let i=e.child(o);i.content.size&&(i=i.copy(tl(i.content,t,i))),i.isInline&&(i=t(i,n,o)),r.push(i)}return em.fromArray(r)}class ta extends ti{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),r=n.node(n.sharedDepth(this.to)),o=new ek(tl(t.content,(e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e,r),t.openStart,t.openEnd);return ts.fromReplace(e,this.from,this.to,o)}invert(){return new tc(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new ta(t.pos,n.pos,this.mark)}merge(e){return e instanceof ta&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ta(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for AddMarkStep.fromJSON");return new ta(t.from,t.to,e.markFromJSON(t.mark))}}ti.jsonID("addMark",ta);class tc extends ti{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new ek(tl(t.content,e=>e.mark(this.mark.removeFromSet(e.marks)),e),t.openStart,t.openEnd);return ts.fromReplace(e,this.from,this.to,n)}invert(){return new ta(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new tc(t.pos,n.pos,this.mark)}merge(e){return e instanceof tc&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new tc(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for RemoveMarkStep.fromJSON");return new tc(t.from,t.to,e.markFromJSON(t.mark))}}ti.jsonID("removeMark",tc);class td extends ti{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ts.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return ts.fromReplace(e,this.pos,this.pos+1,new ek(em.from(n),0,+!t.isLeaf))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let n=0;n<t.marks.length;n++)if(!t.marks[n].isInSet(e))return new td(this.pos,t.marks[n]);return new td(this.pos,this.mark)}}return new tu(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new td(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new td(t.pos,e.markFromJSON(t.mark))}}ti.jsonID("addNodeMark",td);class tu extends ti{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ts.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return ts.fromReplace(e,this.pos,this.pos+1,new ek(em.from(n),0,+!t.isLeaf))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new td(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new tu(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new tu(t.pos,e.markFromJSON(t.mark))}}ti.jsonID("removeNodeMark",tu);class th extends ti{constructor(e,t,n,r=!1){super(),this.from=e,this.to=t,this.slice=n,this.structure=r}apply(e){return this.structure&&tf(e,this.from,this.to)?ts.fail("Structure replace would overwrite content"):ts.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new tn([this.from,this.to-this.from,this.slice.size])}invert(e){return new th(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new th(t.pos,Math.max(t.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof th)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart)if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;else{let t=this.slice.size+e.slice.size==0?ek.empty:new ek(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new th(e.from,this.to,t,this.structure)}{let t=this.slice.size+e.slice.size==0?ek.empty:new ek(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new th(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for ReplaceStep.fromJSON");return new th(t.from,t.to,ek.fromJSON(e,t.slice),!!t.structure)}}ti.jsonID("replace",th);class tp extends ti{constructor(e,t,n,r,o,i,s=!1){super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=r,this.slice=o,this.insert=i,this.structure=s}apply(e){if(this.structure&&(tf(e,this.from,this.gapFrom)||tf(e,this.gapTo,this.to)))return ts.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return ts.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?ts.fromReplace(e,this.from,this.to,n):ts.fail("Content does not fit in gap")}getMap(){return new tn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new tp(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),r=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||r<t.pos||o>n.pos?null:new tp(t.pos,n.pos,r,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new tp(t.from,t.to,t.gapFrom,t.gapTo,ek.fromJSON(e,t.slice),t.insert,!!t.structure)}}function tf(e,t,n){let r=e.resolve(t),o=n-t,i=r.depth;for(;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0){let e=r.node(i).maybeChild(r.indexAfter(i));for(;o>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,o--}}return!1}function tm(e,t,n,r=n.contentMatch,o=!0){let i=e.doc.nodeAt(t),s=[],l=t+1;for(let t=0;t<i.childCount;t++){let a=i.child(t),c=l+a.nodeSize,d=r.matchType(a.type);if(d){r=d;for(let t=0;t<a.marks.length;t++)n.allowsMarkType(a.marks[t].type)||e.step(new tc(l,c,a.marks[t]));if(o&&a.isText&&"pre"!=n.whitespace){let e,t=/\r?\n|\r/g,r;for(;e=t.exec(a.text);)r||(r=new ek(em.from(n.schema.text(" ",n.allowedMarks(a.marks))),0,0)),s.push(new th(l+e.index,l+e.index+e[0].length,r))}}else s.push(new th(l,c,ek.empty));l=c}if(!r.validEnd){let t=r.fillBefore(em.empty,!0);e.replace(l,l,new ek(t,0,0))}for(let t=s.length-1;t>=0;t--)e.step(s[t])}function tg(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth,r=0,o=0;;--n){let i=e.$from.node(n),s=e.$from.index(n)+r,l=e.$to.indexAfter(n)-o;if(n<e.depth&&i.canReplace(s,l,t))return n;if(0==n||i.type.spec.isolating||!((0==s||i.canReplace(s,i.childCount))&&(l==i.childCount||i.canReplace(0,l))))break;s&&(r=1),l<i.childCount&&(o=1)}return null}function tb(e,t,n=null,r=e){let o=function(e,t){let{parent:n,startIndex:r,endIndex:o}=e,i=n.contentMatchAt(r).findWrapping(t);if(!i)return null;let s=i.length?i[0]:t;return n.canReplaceWith(r,o,s)?i:null}(e,t),i=o&&function(e,t){let{parent:n,startIndex:r,endIndex:o}=e,i=n.child(r),s=t.contentMatch.findWrapping(i.type);if(!s)return null;let l=(s.length?s[s.length-1]:t).contentMatch;for(let e=r;l&&e<o;e++)l=l.matchType(n.child(e).type);return l&&l.validEnd?s:null}(r,t);return i?o.map(ty).concat({type:t,attrs:n}).concat(i.map(ty)):null}function ty(e){return{type:e,attrs:null}}function tv(e,t,n,r){t.forEach((o,i)=>{if(o.isText){let s,l=/\r?\n|\r/g;for(;s=l.exec(o.text);){let o=e.mapping.slice(r).map(n+1+i+s.index);e.replaceWith(o,o+1,t.type.schema.linebreakReplacement.create())}}})}function tE(e,t,n,r){t.forEach((o,i)=>{if(o.type==o.type.schema.linebreakReplacement){let o=e.mapping.slice(r).map(n+1+i);e.replaceWith(o,o+1,t.type.schema.text("\n"))}})}function tk(e,t,n=1,r){let o=e.resolve(t),i=o.depth-n,s=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(let e=o.depth-1,t=n-2;e>i;e--,t--){let n=o.node(e),i=o.index(e);if(n.type.spec.isolating)return!1;let s=n.content.cutByIndex(i,n.childCount),l=r&&r[t+1];l&&(s=s.replaceChild(0,l.type.create(l.attrs)));let a=r&&r[t]||n;if(!n.canReplace(i+1,n.childCount)||!a.type.validContent(s))return!1}let l=o.indexAfter(i),a=r&&r[0];return o.node(i).canReplaceWith(l,l,a?a.type:o.node(i+1).type)}function tC(e,t){let n=e.resolve(t),r=n.index();return tT(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function tT(e,t){return!!(e&&t&&!e.isLeaf&&function(e,t){t.content.size||e.type.compatibleContent(t.type);let n=e.contentMatchAt(e.childCount),{linebreakReplacement:r}=e.type.schema;for(let o=0;o<t.childCount;o++){let i=t.child(o),s=i.type==r?e.type.schema.nodes.text:i.type;if(!(n=n.matchType(s))||!e.type.allowsMarks(i.marks))return!1}return n.validEnd}(e,t))}function tw(e,t,n=-1){let r=e.resolve(t);for(let e=r.depth;;e--){let o,i,s=r.index(e);if(e==r.depth?(o=r.nodeBefore,i=r.nodeAfter):n>0?(o=r.node(e+1),s++,i=r.node(e).maybeChild(s)):(o=r.node(e).maybeChild(s-1),i=r.node(e+1)),o&&!o.isTextblock&&tT(o,i)&&r.node(e).canReplace(s,s+1))return t;if(0==e)break;t=n<0?r.before(e):r.after(e)}}function tx(e,t,n){let r=e.resolve(t);if(!n.content.size)return t;let o=n.content;for(let e=0;e<n.openStart;e++)o=o.firstChild.content;for(let e=1;e<=(0==n.openStart&&n.size?2:1);e++)for(let t=r.depth;t>=0;t--){let n=t==r.depth?0:r.pos<=(r.start(t+1)+r.end(t+1))/2?-1:1,i=r.index(t)+ +(n>0),s=r.node(t),l=!1;if(1==e)l=s.canReplace(i,i,o);else{let e=s.contentMatchAt(i).findWrapping(o.firstChild.type);l=e&&s.canReplaceWith(i,i,e[0])}if(l)return 0==n?r.pos:n<0?r.before(t+1):r.after(t+1)}return null}function tS(e,t,n=t,r=ek.empty){if(t==n&&!r.size)return null;let o=e.resolve(t),i=e.resolve(n);return tA(o,i,r)?new th(t,n,r):new t_(o,i,r).fit()}function tA(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}ti.jsonID("replaceAround",tp);class t_{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=em.empty;for(let t=0;t<=e.depth;t++){let n=e.node(t);this.frontier.push({type:n.type,match:n.contentMatchAt(e.indexAfter(t))})}for(let t=e.depth;t>0;t--)this.placed=em.from(e.node(t).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,r=this.close(e<0?this.$to:n.doc.resolve(e));if(!r)return null;let o=this.placed,i=n.depth,s=r.depth;for(;i&&s&&1==o.childCount;)o=o.firstChild.content,i--,s--;let l=new ek(o,i,s);return e>-1?new tp(n.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||n.pos!=this.$to.pos?new th(n.pos,r.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,r=this.unplaced.openEnd;n<e;n++){let o=t.firstChild;if(t.childCount>1&&(r=0),o.type.spec.isolating&&r<=n){e=n;break}t=o.content}for(let t=1;t<=2;t++)for(let n=1==t?e:this.unplaced.openStart;n>=0;n--){let e=null,r=(n?(e=tI(this.unplaced.content,n-1).firstChild).content:this.unplaced.content).firstChild;for(let o=this.depth;o>=0;o--){let{type:i,match:s}=this.frontier[o],l,a=null;if(1==t&&(r?s.matchType(r.type)||(a=s.fillBefore(em.from(r),!1)):e&&i.compatibleContent(e.type)))return{sliceDepth:n,frontierDepth:o,parent:e,inject:a};if(2==t&&r&&(l=s.findWrapping(r.type)))return{sliceDepth:n,frontierDepth:o,parent:e,wrap:l};if(e&&s.matchType(e.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=tI(e,t);return!!r.childCount&&!r.firstChild.isLeaf&&(this.unplaced=new ek(e,t+1,Math.max(n,r.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=tI(e,t);if(r.childCount<=1&&t>0){let o=e.size-t<=t+r.size;this.unplaced=new ek(tN(e,t-1,1),t-1,o?t-1:n)}else this.unplaced=new ek(tN(e,t,1),t,n)}placeNodes({sliceDepth:e,frontierDepth:t,parent:n,inject:r,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let e=0;e<o.length;e++)this.openFrontierNode(o[e]);let i=this.unplaced,s=n?n.content:i.content,l=i.openStart-e,a=0,c=[],{match:d,type:u}=this.frontier[t];if(r){for(let e=0;e<r.childCount;e++)c.push(r.child(e));d=d.matchFragment(r)}let h=s.size+e-(i.content.size-i.openEnd);for(;a<s.childCount;){let e=s.child(a),t=d.matchType(e.type);if(!t)break;(++a>1||0==l||e.content.size)&&(d=t,c.push(function e(t,n,r){if(n<=0)return t;let o=t.content;return n>1&&(o=o.replaceChild(0,e(o.firstChild,n-1,1==o.childCount?r-1:0))),n>0&&(o=t.type.contentMatch.fillBefore(o).append(o),r<=0&&(o=o.append(t.type.contentMatch.matchFragment(o).fillBefore(em.empty,!0)))),t.copy(o)}(e.mark(u.allowedMarks(e.marks)),1==a?l:0,a==s.childCount?h:-1)))}let p=a==s.childCount;p||(h=-1),this.placed=tM(this.placed,t,em.from(c)),this.frontier[t].match=d,p&&h<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let e=0,t=s;e<h;e++){let e=t.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),t=e.content}this.unplaced=p?0==e?ek.empty:new ek(tN(i.content,e-1,1),e-1,h<0?i.openEnd:e-1):new ek(tN(i.content,e,a),i.openStart,i.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return -1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!tO(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return -1;let{depth:n}=this.$to,r=this.$to.after(n);for(;n>1&&r==this.$to.end(--n);)++r;return r}findCloseLevel(e){t:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:r}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),i=tO(e,t,r,n,o);if(i){for(let n=t-1;n>=0;n--){let{match:t,type:r}=this.frontier[n],o=tO(e,n,r,t,!0);if(!o||o.childCount)continue t}return{depth:t,fit:i,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=tM(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let t=e.node(n),r=t.type.contentMatch.fillBefore(t.content,!0,e.index(n));this.openFrontierNode(t.type,t.attrs,r)}return e}openFrontierNode(e,t=null,n){let r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=tM(this.placed,this.depth,em.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(em.empty,!0);e.childCount&&(this.placed=tM(this.placed,this.frontier.length,e))}}function tN(e,t,n){return 0==t?e.cutByIndex(n,e.childCount):e.replaceChild(0,e.firstChild.copy(tN(e.firstChild.content,t-1,n)))}function tM(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(tM(e.lastChild.content,t-1,n)))}function tI(e,t){for(let n=0;n<t;n++)e=e.firstChild.content;return e}function tO(e,t,n,r,o){let i=e.node(t),s=o?e.indexAfter(t):e.index(t);if(s==i.childCount&&!n.compatibleContent(i.type))return null;let l=r.fillBefore(i.content,!0,s);return l&&!function(e,t,n){for(let r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(n,i.content,s)?l:null}function tD(e,t){let n=[],r=Math.min(e.depth,t.depth);for(let o=r;o>=0;o--){let r=e.start(o);if(r<e.pos-(e.depth-o)||t.end(o)>t.pos+(t.depth-o)||e.node(o).type.spec.isolating||t.node(o).type.spec.isolating)break;(r==t.start(o)||o==e.depth&&o==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&o&&t.start(o-1)==r-1)&&n.push(o)}return n}class tR extends ti{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return ts.fail("No node at attribute step's position");let n=Object.create(null);for(let e in t.attrs)n[e]=t.attrs[e];n[this.attr]=this.value;let r=t.type.create(n,null,t.marks);return ts.fromReplace(e,this.pos,this.pos+1,new ek(em.from(r),0,+!t.isLeaf))}getMap(){return tn.empty}invert(e){return new tR(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new tR(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw RangeError("Invalid input for AttrStep.fromJSON");return new tR(t.pos,t.attr,t.value)}}ti.jsonID("attr",tR);class tL extends ti{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let n in e.attrs)t[n]=e.attrs[n];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return ts.ok(n)}getMap(){return tn.empty}invert(e){return new tL(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw RangeError("Invalid input for DocAttrStep.fromJSON");return new tL(t.attr,t.value)}}ti.jsonID("docAttr",tL);let tP=class extends Error{};(tP=function e(t){let n=Error.call(this,t);return n.__proto__=e.prototype,n}).prototype=Object.create(Error.prototype),tP.prototype.constructor=tP,tP.prototype.name="TransformError";class tB{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new tr}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new tP(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,n=ek.empty){let r=tS(this.doc,e,t,n);return r&&this.step(r),this}replaceWith(e,t,n){return this.replace(e,t,new ek(em.from(n),0,0))}delete(e,t){return this.replace(e,t,ek.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,n){return!function(e,t,n,r){if(!r.size)return e.deleteRange(t,n);let o=e.doc.resolve(t),i=e.doc.resolve(n);if(tA(o,i,r))return e.step(new th(t,n,r));let s=tD(o,i);0==s[s.length-1]&&s.pop();let l=-(o.depth+1);s.unshift(l);for(let e=o.depth,t=o.pos-1;e>0;e--,t--){let n=o.node(e).type.spec;if(n.defining||n.definingAsContext||n.isolating)break;s.indexOf(e)>-1?l=e:o.before(e)==t&&s.splice(1,0,-e)}let a=s.indexOf(l),c=[],d=r.openStart;for(let e=r.content,t=0;;t++){let n=e.firstChild;if(c.push(n),t==r.openStart)break;e=n.content}for(let e=d-1;e>=0;e--){var u;let t=c[e],n=(u=t.type).spec.defining||u.spec.definingForContent;if(n&&!t.sameMarkup(o.node(Math.abs(l)-1)))d=e;else if(n||!t.type.isTextblock)break}for(let t=r.openStart;t>=0;t--){let l=(t+d+1)%(r.openStart+1),u=c[l];if(u)for(let t=0;t<s.length;t++){let c=s[(t+a)%s.length],d=!0;c<0&&(d=!1,c=-c);let h=o.node(c-1),p=o.index(c-1);if(h.canReplaceWith(p,p,u.type,u.marks))return e.replace(o.before(c),d?i.after(c):n,new ek(function e(t,n,r,o,i){if(n<r){let i=t.firstChild;t=t.replaceChild(0,i.copy(e(i.content,n+1,r,o,i)))}if(n>o){let e=i.contentMatchAt(0),n=e.fillBefore(t).append(t);t=n.append(e.matchFragment(n).fillBefore(em.empty,!0))}return t}(r.content,0,r.openStart,l),l,r.openEnd))}}let h=e.steps.length;for(let l=s.length-1;l>=0&&(e.replace(t,n,r),!(e.steps.length>h));l--){let e=s[l];e<0||(t=o.before(e),n=i.after(e))}}(this,e,t,n),this}replaceRangeWith(e,t,n){var r=e,o=t;if(!n.isInline&&r==o&&this.doc.resolve(r).parent.content.size){let e=function(e,t,n){let r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(let e=r.depth-1;e>=0;e--){let t=r.index(e);if(r.node(e).canReplaceWith(t,t,n))return r.before(e+1);if(t>0)return null}if(r.parentOffset==r.parent.content.size)for(let e=r.depth-1;e>=0;e--){let t=r.indexAfter(e);if(r.node(e).canReplaceWith(t,t,n))return r.after(e+1);if(t<r.node(e).childCount)break}return null}(this.doc,r,n.type);null!=e&&(r=o=e)}return this.replaceRange(r,o,new ek(em.from(n),0,0)),this}deleteRange(e,t){return!function(e,t,n){let r=e.doc.resolve(t),o=e.doc.resolve(n),i=tD(r,o);for(let t=0;t<i.length;t++){let n=i[t],s=t==i.length-1;if(s&&0==n||r.node(n).type.contentMatch.validEnd)return e.delete(r.start(n),o.end(n));if(n>0&&(s||r.node(n-1).canReplace(r.index(n-1),o.indexAfter(n-1))))return e.delete(r.before(n),o.after(n))}for(let i=1;i<=r.depth&&i<=o.depth;i++)if(t-r.start(i)==r.depth-i&&n>r.end(i)&&o.end(i)-n!=o.depth-i&&r.start(i-1)==o.start(i-1)&&r.node(i-1).canReplace(r.index(i-1),o.index(i-1)))return e.delete(r.before(i),n);e.delete(t,n)}(this,e,t),this}lift(e,t){return!function(e,t,n){let{$from:r,$to:o,depth:i}=t,s=r.before(i+1),l=o.after(i+1),a=s,c=l,d=em.empty,u=0;for(let e=i,t=!1;e>n;e--)t||r.index(e)>0?(t=!0,d=em.from(r.node(e).copy(d)),u++):a--;let h=em.empty,p=0;for(let e=i,t=!1;e>n;e--)t||o.after(e+1)<o.end(e)?(t=!0,h=em.from(o.node(e).copy(h)),p++):c++;e.step(new tp(a,c,s,l,new ek(d.append(h),u,p),d.size-u,!0))}(this,e,t),this}join(e,t=1){return!function(e,t,n){let r=null,{linebreakReplacement:o}=e.doc.type.schema,i=e.doc.resolve(t-n),s=i.node().type;if(o&&s.inlineContent){let e="pre"==s.whitespace,t=!!s.contentMatch.matchType(o);e&&!t?r=!1:!e&&t&&(r=!0)}let l=e.steps.length;if(!1===r){let r=e.doc.resolve(t+n);tE(e,r.node(),r.before(),l)}s.inlineContent&&tm(e,t+n-1,s,i.node().contentMatchAt(i.index()),null==r);let a=e.mapping.slice(l),c=a.map(t-n);if(e.step(new th(c,a.map(t+n,-1),ek.empty,!0)),!0===r){let t=e.doc.resolve(c);tv(e,t.node(),t.before(),e.steps.length)}}(this,e,t),this}wrap(e,t){return!function(e,t,n){let r=em.empty;for(let e=n.length-1;e>=0;e--){if(r.size){let t=n[e].type.contentMatch.matchFragment(r);if(!t||!t.validEnd)throw RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=em.from(n[e].type.create(n[e].attrs,r))}let o=t.start,i=t.end;e.step(new tp(o,i,o,i,new ek(r,0,0),n.length,!0))}(this,e,t),this}setBlockType(e,t=e,n,r=null){var o=this;if(!n.isTextblock)throw RangeError("Type given to setBlockType should be a textblock");let i=o.steps.length;return o.doc.nodesBetween(e,t,(e,t)=>{var s,l,a;let c,d,u="function"==typeof r?r(e):r;if(e.isTextblock&&!e.hasMarkup(n,u)&&(s=o.doc,l=o.mapping.slice(i).map(t),a=n,d=(c=s.resolve(l)).index(),c.parent.canReplaceWith(d,d+1,a))){let r=null;if(n.schema.linebreakReplacement){let e="pre"==n.whitespace,t=!!n.contentMatch.matchType(n.schema.linebreakReplacement);e&&!t?r=!1:!e&&t&&(r=!0)}!1===r&&tE(o,e,t,i),tm(o,o.mapping.slice(i).map(t,1),n,void 0,null===r);let s=o.mapping.slice(i),l=s.map(t,1),a=s.map(t+e.nodeSize,1);return o.step(new tp(l,a,l+1,a-1,new ek(em.from(n.create(u,null,e.marks)),0,0),1,!0)),!0===r&&tv(o,e,t,i),!1}}),this}setNodeMarkup(e,t,n=null,r){return!function(e,t,n,r,o){let i=e.doc.nodeAt(t);if(!i)throw RangeError("No node at given position");n||(n=i.type);let s=n.create(r,null,o||i.marks);if(i.isLeaf)return e.replaceWith(t,t+i.nodeSize,s);if(!n.validContent(i.content))throw RangeError("Invalid content for node type "+n.name);e.step(new tp(t,t+i.nodeSize,t+1,t+i.nodeSize-1,new ek(em.from(s),0,0),1,!0))}(this,e,t,n,r),this}setNodeAttribute(e,t,n){return this.step(new tR(e,t,n)),this}setDocAttribute(e,t){return this.step(new tL(e,t)),this}addNodeMark(e,t){return this.step(new td(e,t)),this}removeNodeMark(e,t){let n=this.doc.nodeAt(e);if(!n)throw RangeError("No node at position "+e);if(t instanceof ev)t.isInSet(n.marks)&&this.step(new tu(e,t));else{let r=n.marks,o,i=[];for(;o=t.isInSet(r);)i.push(new tu(e,o)),r=o.removeFromSet(r);for(let e=i.length-1;e>=0;e--)this.step(i[e])}return this}split(e,t=1,n){return!function(e,t,n=1,r){let o=e.doc.resolve(t),i=em.empty,s=em.empty;for(let e=o.depth,t=o.depth-n,l=n-1;e>t;e--,l--){i=em.from(o.node(e).copy(i));let t=r&&r[l];s=em.from(t?t.type.create(t.attrs,s):o.node(e).copy(s))}e.step(new th(t,t,new ek(i.append(s),n,n),!0))}(this,e,t,n),this}addMark(e,t,n){var r;let o,i,s,l;return r=this,s=[],l=[],r.doc.nodesBetween(e,t,(r,a,c)=>{if(!r.isInline)return;let d=r.marks;if(!n.isInSet(d)&&c.type.allowsMarkType(n.type)){let c=Math.max(a,e),u=Math.min(a+r.nodeSize,t),h=n.addToSet(d);for(let e=0;e<d.length;e++)d[e].isInSet(h)||(o&&o.to==c&&o.mark.eq(d[e])?o.to=u:s.push(o=new tc(c,u,d[e])));i&&i.to==c?i.to=u:l.push(i=new ta(c,u,n))}}),s.forEach(e=>r.step(e)),l.forEach(e=>r.step(e)),this}removeMark(e,t,n){var r;let o,i;return r=this,o=[],i=0,r.doc.nodesBetween(e,t,(r,s)=>{if(!r.isInline)return;i++;let l=null;if(n instanceof eY){let e=r.marks,t;for(;t=n.isInSet(e);)(l||(l=[])).push(t),e=t.removeFromSet(e)}else n?n.isInSet(r.marks)&&(l=[n]):l=r.marks;if(l&&l.length){let n=Math.min(s+r.nodeSize,t);for(let t=0;t<l.length;t++){let r=l[t],a;for(let e=0;e<o.length;e++){let t=o[e];t.step==i-1&&r.eq(o[e].style)&&(a=t)}a?(a.to=n,a.step=i):o.push({style:r,from:Math.max(s,e),to:n,step:i})}}}),o.forEach(e=>r.step(new tc(e.from,e.to,e.style))),this}clearIncompatible(e,t,n){return tm(this,e,t,n),this}}let tH=Object.create(null);class tj{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new tF(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=ek.empty){let n=t.content.lastChild,r=null;for(let e=0;e<t.openEnd;e++)r=n,n=n.lastChild;let o=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:l,$to:a}=i[s],c=e.mapping.slice(o);e.replaceRange(c.map(l.pos),c.map(a.pos),s?ek.empty:t),0==s&&tZ(e,o,(n?n.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,r=this.ranges;for(let o=0;o<r.length;o++){let{$from:i,$to:s}=r[o],l=e.mapping.slice(n),a=l.map(i.pos),c=l.map(s.pos);o?e.deleteRange(a,c):(e.replaceRangeWith(a,c,t),tZ(e,n,t.isInline?-1:1))}}static findFrom(e,t,n=!1){let r=e.parent.inlineContent?new tV(e):tK(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(let r=e.depth-1;r>=0;r--){let o=t<0?tK(e.node(0),e.node(r),e.before(r+1),e.index(r),t,n):tK(e.node(0),e.node(r),e.after(r+1),e.index(r)+1,t,n);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new tW(e.node(0))}static atStart(e){return tK(e,e,0,0,1)||new tW(e)}static atEnd(e){return tK(e,e,e.content.size,e.childCount,-1)||new tW(e)}static fromJSON(e,t){if(!t||!t.type)throw RangeError("Invalid input for Selection.fromJSON");let n=tH[t.type];if(!n)throw RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in tH)throw RangeError("Duplicate use of selection JSON ID "+e);return tH[e]=t,t.prototype.jsonID=e,t}getBookmark(){return tV.between(this.$anchor,this.$head).getBookmark()}}tj.prototype.visible=!0;class tF{constructor(e,t){this.$from=e,this.$to=t}}let tU=!1;function tz(e){tU||e.parent.inlineContent||(tU=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class tV extends tj{constructor(e,t=e){tz(e),tz(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return tj.near(n);let r=e.resolve(t.map(this.anchor));return new tV(r.parent.inlineContent?r:n,n)}replace(e,t=ek.empty){if(super.replace(e,t),t==ek.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(e){return e instanceof tV&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new t$(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw RangeError("Invalid input for TextSelection.fromJSON");return new tV(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){let r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))}static between(e,t,n){let r=e.pos-t.pos;if((!n||r)&&(n=r>=0?1:-1),!t.parent.inlineContent){let e=tj.findFrom(t,n,!0)||tj.findFrom(t,-n,!0);if(!e)return tj.near(t,n);t=e.$head}return e.parent.inlineContent||(0==r?e=t:(e=(tj.findFrom(e,-n,!0)||tj.findFrom(e,n,!0)).$anchor).pos<t.pos!=r<0&&(e=t)),new tV(e,t)}}tj.jsonID("text",tV);class t${constructor(e,t){this.anchor=e,this.head=t}map(e){return new t$(e.map(this.anchor),e.map(this.head))}resolve(e){return tV.between(e.resolve(this.anchor),e.resolve(this.head))}}class tG extends tj{constructor(e){let t=e.nodeAfter;super(e,e.node(0).resolve(e.pos+t.nodeSize)),this.node=t}map(e,t){let{deleted:n,pos:r}=t.mapResult(this.anchor),o=e.resolve(r);return n?tj.near(o):new tG(o)}content(){return new ek(em.from(this.node),0,0)}eq(e){return e instanceof tG&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new tq(this.anchor)}static fromJSON(e,t){if("number"!=typeof t.anchor)throw RangeError("Invalid input for NodeSelection.fromJSON");return new tG(e.resolve(t.anchor))}static create(e,t){return new tG(e.resolve(t))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}tG.prototype.visible=!1,tj.jsonID("node",tG);class tq{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new t$(n,n):new tq(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&tG.isSelectable(n)?new tG(t):tj.near(t)}}class tW extends tj{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=ek.empty){if(t==ek.empty){e.delete(0,e.doc.content.size);let t=tj.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new tW(e)}map(e){return new tW(e)}eq(e){return e instanceof tW}getBookmark(){return tY}}tj.jsonID("all",tW);let tY={map(){return this},resolve:e=>new tW(e)};function tK(e,t,n,r,o,i=!1){if(t.inlineContent)return tV.create(e,n);for(let s=r-(o>0?0:1);o>0?s<t.childCount:s>=0;s+=o){let r=t.child(s);if(r.isAtom){if(!i&&tG.isSelectable(r))return tG.create(e,n-(o<0?r.nodeSize:0))}else{let t=tK(e,r,n+o,o<0?r.childCount:0,o,i);if(t)return t}n+=r.nodeSize*o}return null}function tZ(e,t,n){let r,o=e.steps.length-1;if(o<t)return;let i=e.steps[o];(i instanceof th||i instanceof tp)&&(e.mapping.maps[o].forEach((e,t,n,o)=>{null==r&&(r=o)}),e.setSelection(tj.near(e.doc.resolve(r),n)))}class tX extends tB{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(1|this.updated)&-3,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return ev.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,t){super.addStep(e,t),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||ev.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,n){let r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();{if(null==n&&(n=t),!e)return this.deleteRange(t,n);let o=this.storedMarks;if(!o){let e=this.doc.resolve(t);o=n==t?e.marks():e.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,o)),this.selection.empty||this.selection.to!=t+e.length||this.setSelection(tj.near(this.selection.$to)),this}}setMeta(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function tQ(e,t){return t&&e?e.bind(t):e}class tJ{constructor(e,t,n){this.name=e,this.init=tQ(t.init,n),this.apply=tQ(t.apply,n)}}let t0=[new tJ("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new tJ("selection",{init:(e,t)=>e.selection||tj.atStart(t.doc),apply:e=>e.selection}),new tJ("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,n,r)=>r.selection.$cursor?e.storedMarks:null}),new tJ("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t})];class t1{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=t0.slice(),t&&t.forEach(e=>{if(this.pluginsByKey[e.key])throw RangeError("Adding different instances of a keyed plugin ("+e.key+")");this.plugins.push(e),this.pluginsByKey[e.key]=e,e.spec.state&&this.fields.push(new tJ(e.key,e.spec.state,e))})}}class t2{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let n=0;n<this.config.plugins.length;n++)if(n!=t){let t=this.config.plugins[n];if(t.spec.filterTransaction&&!t.spec.filterTransaction.call(t,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],n=this.applyInner(e),r=null;for(;;){let o=!1;for(let i=0;i<this.config.plugins.length;i++){let s=this.config.plugins[i];if(s.spec.appendTransaction){let l=r?r[i].n:0,a=r?r[i].state:this,c=l<t.length&&s.spec.appendTransaction.call(s,l?t.slice(l):t,a,n);if(c&&n.filterTransaction(c,i)){if(c.setMeta("appendedTransaction",e),!r){r=[];for(let e=0;e<this.config.plugins.length;e++)r.push(e<i?{state:n,n:t.length}:{state:this,n:0})}t.push(c),n=n.applyInner(c),o=!0}r&&(r[i]={state:n,n:t.length})}}if(!o)return{state:n,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw RangeError("Applying a mismatched transaction");let t=new t2(this.config),n=this.config.fields;for(let r=0;r<n.length;r++){let o=n[r];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new tX(this)}static create(e){let t=new t1(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new t2(t);for(let r=0;r<t.fields.length;r++)n[t.fields[r].name]=t.fields[r].init(e,n);return n}reconfigure(e){let t=new t1(this.schema,e.plugins),n=t.fields,r=new t2(t);for(let t=0;t<n.length;t++){let o=n[t].name;r[o]=this.hasOwnProperty(o)?this[o]:n[t].init(e,r)}return r}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(e=>e.toJSON())),e&&"object"==typeof e)for(let n in e){if("doc"==n||"selection"==n)throw RangeError("The JSON fields `doc` and `selection` are reserved");let r=e[n],o=r.spec.state;o&&o.toJSON&&(t[n]=o.toJSON.call(r,this[r.key]))}return t}static fromJSON(e,t,n){if(!t)throw RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw RangeError("Required config field 'schema' missing");let r=new t1(e.schema,e.plugins),o=new t2(r);return r.fields.forEach(r=>{if("doc"==r.name)o.doc=eR.fromJSON(e.schema,t.doc);else if("selection"==r.name)o.selection=tj.fromJSON(o.doc,t.selection);else if("storedMarks"==r.name)t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let i in n){let s=n[i],l=s.spec.state;if(s.key==r.name&&l&&l.fromJSON&&Object.prototype.hasOwnProperty.call(t,i)){o[r.name]=l.fromJSON.call(s,e,t[i],o);return}}o[r.name]=r.init(e,o)}}),o}}class t4{constructor(e){this.spec=e,this.props={},e.props&&function e(t,n,r){for(let o in t){let i=t[o];i instanceof Function?i=i.bind(n):"handleDOMEvents"==o&&(i=e(i,n,{})),r[o]=i}return r}(e.props,this,this.props),this.key=e.key?e.key.key:t3("plugin")}getState(e){return e[this.key]}}let t5=Object.create(null);function t3(e){return e in t5?e+"$"+ ++t5[e]:(t5[e]=0,e+"$")}class t8{constructor(e="key"){this.key=t3(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}let t6=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function t9(e,t){let{$cursor:n}=e.selection;return n&&(t?t.endOfTextblock("backward",e):!(n.parentOffset>0))?n:null}let t7=(e,t,n)=>{let r=t9(e,n);if(!r)return!1;let o=nr(r);if(!o){let n=r.blockRange(),o=n&&tg(n);return null!=o&&(t&&t(e.tr.lift(n,o).scrollIntoView()),!0)}let i=o.nodeBefore;if(np(e,o,t,-1))return!0;if(0==r.parent.content.size&&(nt(i,"end")||tG.isSelectable(i)))for(let n=r.depth;;n--){let s=tS(e.doc,r.before(n),r.after(n),ek.empty);if(s&&s.slice.size<s.to-s.from){if(t){let n=e.tr.step(s);n.setSelection(nt(i,"end")?tj.findFrom(n.doc.resolve(n.mapping.map(o.pos,-1)),-1):tG.create(n.doc,o.pos-i.nodeSize)),t(n.scrollIntoView())}return!0}if(1==n||r.node(n-1).childCount>1)break}return!!i.isAtom&&o.depth==r.depth-1&&(t&&t(e.tr.delete(o.pos-i.nodeSize,o.pos).scrollIntoView()),!0)};function ne(e,t,n){let r=t.nodeBefore,o=t.pos-1;for(;!r.isTextblock;o--){if(r.type.spec.isolating)return!1;let e=r.lastChild;if(!e)return!1;r=e}let i=t.nodeAfter,s=t.pos+1;for(;!i.isTextblock;s++){if(i.type.spec.isolating)return!1;let e=i.firstChild;if(!e)return!1;i=e}let l=tS(e.doc,o,s,ek.empty);if(!l||l.from!=o||l instanceof th&&l.slice.size>=s-o)return!1;if(n){let t=e.tr.step(l);t.setSelection(tV.create(t.doc,o)),n(t.scrollIntoView())}return!0}function nt(e,t,n=!1){for(let r=e;r;r="start"==t?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&1!=r.childCount)break}return!1}let nn=(e,t,n)=>{let{$head:r,empty:o}=e.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):r.parentOffset>0)return!1;i=nr(r)}let s=i&&i.nodeBefore;return!!s&&!!tG.isSelectable(s)&&(t&&t(e.tr.setSelection(tG.create(e.doc,i.pos-s.nodeSize)).scrollIntoView()),!0)};function nr(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function no(e,t){let{$cursor:n}=e.selection;return n&&(t?t.endOfTextblock("forward",e):!(n.parentOffset<n.parent.content.size))?n:null}let ni=(e,t,n)=>{let r=no(e,n);if(!r)return!1;let o=nl(r);if(!o)return!1;let i=o.nodeAfter;if(np(e,o,t,1))return!0;if(0==r.parent.content.size&&(nt(i,"start")||tG.isSelectable(i))){let n=tS(e.doc,r.before(),r.after(),ek.empty);if(n&&n.slice.size<n.to-n.from){if(t){let r=e.tr.step(n);r.setSelection(nt(i,"start")?tj.findFrom(r.doc.resolve(r.mapping.map(o.pos)),1):tG.create(r.doc,r.mapping.map(o.pos))),t(r.scrollIntoView())}return!0}}return!!i.isAtom&&o.depth==r.depth-1&&(t&&t(e.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),!0)},ns=(e,t,n)=>{let{$head:r,empty:o}=e.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)return!1;i=nl(r)}let s=i&&i.nodeAfter;return!!s&&!!tG.isSelectable(s)&&(t&&t(e.tr.setSelection(tG.create(e.doc,i.pos)).scrollIntoView()),!0)};function nl(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}let na=(e,t)=>{let{$head:n,$anchor:r}=e.selection;return!!n.parent.type.spec.code&&!!n.sameParent(r)&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)};function nc(e){for(let t=0;t<e.edgeCount;t++){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}let nd=(e,t)=>{let{$head:n,$anchor:r}=e.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let o=n.node(-1),i=n.indexAfter(-1),s=nc(o.contentMatchAt(i));if(!s||!o.canReplaceWith(i,i,s))return!1;if(t){let r=n.after(),o=e.tr.replaceWith(r,r,s.createAndFill());o.setSelection(tj.near(o.doc.resolve(r),1)),t(o.scrollIntoView())}return!0},nu=(e,t)=>{let n=e.selection,{$from:r,$to:o}=n;if(n instanceof tW||r.parent.inlineContent||o.parent.inlineContent)return!1;let i=nc(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){let n=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,s=e.tr.insert(n,i.createAndFill());s.setSelection(tV.create(s.doc,n+1)),t(s.scrollIntoView())}return!0},nh=(e,t)=>{let{$cursor:n}=e.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let r=n.before();if(tk(e.doc,r))return t&&t(e.tr.split(r).scrollIntoView()),!0}let r=n.blockRange(),o=r&&tg(r);return null!=o&&(t&&t(e.tr.lift(r,o).scrollIntoView()),!0)};function np(e,t,n,r){let o,i,s,l=t.nodeBefore,a=t.nodeAfter,c,d,u=l.type.spec.isolating||a.type.spec.isolating;if(!u&&(o=t.nodeBefore,i=t.nodeAfter,s=t.index(),o&&i&&o.type.compatibleContent(i.type)&&(!o.content.size&&t.parent.canReplace(s-1,s)?(n&&n(e.tr.delete(t.pos-o.nodeSize,t.pos).scrollIntoView()),!0):!!t.parent.canReplace(s,s+1)&&!!(i.isTextblock||tC(e.doc,t.pos))&&(n&&n(e.tr.join(t.pos).scrollIntoView()),!0))))return!0;let h=!u&&t.parent.canReplace(t.index(),t.index()+1);if(h&&(c=(d=l.contentMatchAt(l.childCount)).findWrapping(a.type))&&d.matchType(c[0]||a.type).validEnd){if(n){let r=t.pos+a.nodeSize,o=em.empty;for(let e=c.length-1;e>=0;e--)o=em.from(c[e].create(null,o));o=em.from(l.copy(o));let i=e.tr.step(new tp(t.pos-1,r,t.pos,r,new ek(o,1,0),c.length,!0)),s=i.doc.resolve(r+2*c.length);s.nodeAfter&&s.nodeAfter.type==l.type&&tC(i.doc,s.pos)&&i.join(s.pos),n(i.scrollIntoView())}return!0}let p=a.type.spec.isolating||r>0&&u?null:tj.findFrom(t,1),f=p&&p.$from.blockRange(p.$to),m=f&&tg(f);if(null!=m&&m>=t.depth)return n&&n(e.tr.lift(f,m).scrollIntoView()),!0;if(h&&nt(a,"start",!0)&&nt(l,"end")){let r=l,o=[];for(;o.push(r),!r.isTextblock;)r=r.lastChild;let i=a,s=1;for(;!i.isTextblock;i=i.firstChild)s++;if(r.canReplace(r.childCount,r.childCount,i.content)){if(n){let r=em.empty;for(let e=o.length-1;e>=0;e--)r=em.from(o[e].copy(r));n(e.tr.step(new tp(t.pos-o.length,t.pos+a.nodeSize,t.pos+s,t.pos+a.nodeSize-s,new ek(r,o.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function nf(e){return function(t,n){let r=t.selection,o=e<0?r.$from:r.$to,i=o.depth;for(;o.node(i).isInline;){if(!i)return!1;i--}return!!o.node(i).isTextblock&&(n&&n(t.tr.setSelection(tV.create(t.doc,e<0?o.start(i):o.end(i)))),!0)}}let nm=nf(-1),ng=nf(1);function nb(e,t=null){return function(n,r){let o=!1;for(let r=0;r<n.selection.ranges.length&&!o;r++){let{$from:{pos:i},$to:{pos:s}}=n.selection.ranges[r];n.doc.nodesBetween(i,s,(r,i)=>{if(o)return!1;if(!(!r.isTextblock||r.hasMarkup(e,t)))if(r.type==e)o=!0;else{let t=n.doc.resolve(i),r=t.index();o=t.parent.canReplaceWith(r,r+1,e)}})}if(!o)return!1;if(r){let o=n.tr;for(let r=0;r<n.selection.ranges.length;r++){let{$from:{pos:i},$to:{pos:s}}=n.selection.ranges[r];o.setBlockType(i,s,e,t)}r(o.scrollIntoView())}return!0}}function ny(...e){return function(t,n,r){for(let o=0;o<e.length;o++)if(e[o](t,n,r))return!0;return!1}}let nv=ny(t6,t7,nn),nE=ny(t6,ni,ns),nk={Enter:ny(na,nu,nh,(e,t)=>{let{$from:n,$to:r}=e.selection;if(e.selection instanceof tG&&e.selection.node.isBlock)return!!n.parentOffset&&!!tk(e.doc,n.pos)&&(t&&t(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let o=[],i,s,l=!1,a=!1;for(let e=n.depth;;e--){if(n.node(e).isBlock){let t;l=n.end(e)==n.pos+(n.depth-e),a=n.start(e)==n.pos-(n.depth-e),s=nc(n.node(e-1).contentMatchAt(n.indexAfter(e-1)));o.unshift(t||(l&&s?{type:s}:null)),i=e;break}if(1==e)return!1;o.unshift(null)}let c=e.tr;(e.selection instanceof tV||e.selection instanceof tW)&&c.deleteSelection();let d=c.mapping.map(n.pos),u=tk(c.doc,d,o.length,o);if(u||(o[0]=s?{type:s}:null,u=tk(c.doc,d,o.length,o)),!u)return!1;if(c.split(d,o.length,o),!l&&a&&n.node(i).type!=s){let e=c.mapping.map(n.before(i)),t=c.doc.resolve(e);s&&n.node(i-1).canReplaceWith(t.index(),t.index()+1,s)&&c.setNodeMarkup(c.mapping.map(n.before(i)),s)}return t&&t(c.scrollIntoView()),!0}),"Mod-Enter":nd,Backspace:nv,"Mod-Backspace":nv,"Shift-Backspace":nv,Delete:nE,"Mod-Delete":nE,"Mod-a":(e,t)=>(t&&t(e.tr.setSelection(new tW(e.doc))),!0)},nC={"Ctrl-h":nk.Backspace,"Alt-Backspace":nk["Mod-Backspace"],"Ctrl-d":nk.Delete,"Ctrl-Alt-Backspace":nk["Mod-Delete"],"Alt-Delete":nk["Mod-Delete"],"Alt-d":nk["Mod-Delete"],"Ctrl-a":nm,"Ctrl-e":ng};for(let e in nk)nC[e]=nk[e];"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();let nT=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},nw=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t},nx=null,nS=function(e,t,n){let r=nx||(nx=document.createRange());return r.setEnd(e,null==n?e.nodeValue.length:n),r.setStart(e,t||0),r},nA=function(){nx=null},n_=function(e,t,n,r){return n&&(nM(e,t,n,r,-1)||nM(e,t,n,r,1))},nN=/^(img|br|input|textarea|hr)$/i;function nM(e,t,n,r,o){for(var i;;){if(e==n&&t==r)return!0;if(t==(o<0?0:nI(e))){let n=e.parentNode;if(!n||1!=n.nodeType||nO(e)||nN.test(e.nodeName)||"false"==e.contentEditable)return!1;t=nT(e)+(o<0?0:1),e=n}else{if(1!=e.nodeType)return!1;let n=e.childNodes[t+(o<0?-1:0)];if(1==n.nodeType&&"false"==n.contentEditable)if(null==(i=n.pmViewDesc)||!i.ignoreForSelection)return!1;else t+=o;else e=n,t=o<0?nI(e):0}}}function nI(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function nO(e){let t;for(let n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}let nD=function(e){return e.focusNode&&n_(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function nR(e,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}let nL="undefined"!=typeof navigator?navigator:null,nP="undefined"!=typeof document?document:null,nB=nL&&nL.userAgent||"",nH=/Edge\/(\d+)/.exec(nB),nj=/MSIE \d/.exec(nB),nF=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(nB),nU=!!(nj||nF||nH),nz=nj?document.documentMode:nF?+nF[1]:nH?+nH[1]:0,nV=!nU&&/gecko\/(\d+)/i.test(nB);nV&&(/Firefox\/(\d+)/.exec(nB)||[0,0])[1];let n$=!nU&&/Chrome\/(\d+)/.exec(nB),nG=!!n$,nq=n$?+n$[1]:0,nW=!nU&&!!nL&&/Apple Computer/.test(nL.vendor),nY=nW&&(/Mobile\/\w+/.test(nB)||!!nL&&nL.maxTouchPoints>2),nK=nY||!!nL&&/Mac/.test(nL.platform),nZ=!!nL&&/Win/.test(nL.platform),nX=/Android \d/.test(nB),nQ=!!nP&&"webkitFontSmoothing"in nP.documentElement.style,nJ=nQ?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function n0(e,t){return"number"==typeof e?e:e[t]}function n1(e,t,n){let r=e.someProp("scrollThreshold")||0,o=e.someProp("scrollMargin")||5,i=e.dom.ownerDocument;for(let s=n||e.dom;s;){if(1!=s.nodeType){s=nw(s);continue}let e=s,n=e==i.body,l=n?function(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}(i):function(e){let t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*r}}(e),a=0,c=0;if(t.top<l.top+n0(r,"top")?c=-(l.top-t.top+n0(o,"top")):t.bottom>l.bottom-n0(r,"bottom")&&(c=t.bottom-t.top>l.bottom-l.top?t.top+n0(o,"top")-l.top:t.bottom-l.bottom+n0(o,"bottom")),t.left<l.left+n0(r,"left")?a=-(l.left-t.left+n0(o,"left")):t.right>l.right-n0(r,"right")&&(a=t.right-l.right+n0(o,"right")),a||c)if(n)i.defaultView.scrollBy(a,c);else{let n=e.scrollLeft,r=e.scrollTop;c&&(e.scrollTop+=c),a&&(e.scrollLeft+=a);let o=e.scrollLeft-n,i=e.scrollTop-r;t={left:t.left-o,top:t.top-i,right:t.right-o,bottom:t.bottom-i}}let d=n?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(d))break;s="absolute"==d?s.offsetParent:nw(s)}}function n2(e){let t=[],n=e.ownerDocument;for(let r=e;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),e!=n);r=nw(r));return t}function n4(e,t){for(let n=0;n<e.length;n++){let{dom:r,top:o,left:i}=e[n];r.scrollTop!=o+t&&(r.scrollTop=o+t),r.scrollLeft!=i&&(r.scrollLeft=i)}}let n5=null;function n3(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function n8(e){return e.top<e.bottom||e.left<e.right}function n6(e,t){let n=e.getClientRects();if(n.length){let e=n[t<0?0:n.length-1];if(n8(e))return e}return Array.prototype.find.call(n,n8)||e.getBoundingClientRect()}let n9=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function n7(e,t,n){let{node:r,offset:o,atom:i}=e.docView.domFromPos(t,n<0?-1:1),s=nQ||nV;if(3==r.nodeType)if(s&&(n9.test(r.nodeValue)||(n<0?!o:o==r.nodeValue.length))){let e=n6(nS(r,o,o),n);if(nV&&o&&/\s/.test(r.nodeValue[o-1])&&o<r.nodeValue.length){let t=n6(nS(r,o-1,o-1),-1);if(t.top==e.top){let n=n6(nS(r,o,o+1),-1);if(n.top!=e.top)return re(n,n.left<t.left)}}return e}else{let e=o,t=o,i=n<0?1:-1;return n<0&&!o?(t++,i=-1):n>=0&&o==r.nodeValue.length?(e--,i=1):n<0?e--:t++,re(n6(nS(r,e,t),i),i<0)}if(!e.state.doc.resolve(t-(i||0)).parent.inlineContent){if(null==i&&o&&(n<0||o==nI(r))){let e=r.childNodes[o-1];if(1==e.nodeType)return rt(e.getBoundingClientRect(),!1)}if(null==i&&o<nI(r)){let e=r.childNodes[o];if(1==e.nodeType)return rt(e.getBoundingClientRect(),!0)}return rt(r.getBoundingClientRect(),n>=0)}if(null==i&&o&&(n<0||o==nI(r))){let e=r.childNodes[o-1],t=3==e.nodeType?nS(e,nI(e)-!s):1!=e.nodeType||"BR"==e.nodeName&&e.nextSibling?null:e;if(t)return re(n6(t,1),!1)}if(null==i&&o<nI(r)){let e=r.childNodes[o];for(;e.pmViewDesc&&e.pmViewDesc.ignoreForCoords;)e=e.nextSibling;let t=e?3==e.nodeType?nS(e,0,+!s):1==e.nodeType?e:null:null;if(t)return re(n6(t,-1),!0)}return re(n6(3==r.nodeType?nS(r):r,-n),n>=0)}function re(e,t){if(0==e.width)return e;let n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function rt(e,t){if(0==e.height)return e;let n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function rn(e,t,n){let r=e.state,o=e.root.activeElement;r!=t&&e.updateState(t),o!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),o!=e.dom&&o&&o.focus()}}let rr=/[\u0590-\u08ac]/,ro=null,ri=null,rs=!1;class rl{constructor(e,t,n,r){this.parent=e,this.children=t,this.dom=n,this.contentDOM=r,this.dirty=0,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,n=this.posAtStart;;t++){let r=this.children[t];if(r==e)return n;n+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,n){let r;if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode))if(n<0){let n,r;if(e==this.contentDOM)n=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.previousSibling}for(;n&&!((r=n.pmViewDesc)&&r.parent==this);)n=n.previousSibling;return n?this.posBeforeChild(r)+r.size:this.posAtStart}else{let n,r;if(e==this.contentDOM)n=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.nextSibling}for(;n&&!((r=n.pmViewDesc)&&r.parent==this);)n=n.nextSibling;return n?this.posBeforeChild(r):this.posAtEnd}if(e==this.dom&&this.contentDOM)r=t>nT(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!1;break}if(t.previousSibling)break}if(null==r&&t==e.childNodes.length)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!0;break}if(t.nextSibling)break}}return(null==r?n>0:r)?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let n=!0,r=e;r;r=r.parentNode){let o=this.getDesc(r),i;if(o&&(!t||o.node))if(!n||!(i=o.nodeDOM)||(1==i.nodeType?i.contains(1==e.nodeType?e:e.parentNode):i==e))return o;else n=!1}}getDesc(e){let t=e.pmViewDesc;for(let e=t;e;e=e.parent)if(e==this)return t}posFromDOM(e,t,n){for(let r=e;r;r=r.parentNode){let o=this.getDesc(r);if(o)return o.localPosFromDOM(e,t,n)}return -1}descAt(e){for(let t=0,n=0;t<this.children.length;t++){let r=this.children[t],o=n+r.size;if(n==e&&o!=n){for(;!r.border&&r.children.length;)for(let e=0;e<r.children.length;e++){let t=r.children[e];if(t.size){r=t;break}}return r}if(e<o)return r.descAt(e-n-r.border);n=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,r=0;for(let t=0;n<this.children.length;n++){let o=this.children[n],i=t+o.size;if(i>e||o instanceof rf){r=e-t;break}t=i}if(r)return this.children[n].domFromPos(r-this.children[n].border,t);for(let e;n&&!(e=this.children[n-1]).size&&e instanceof ra&&e.side>=0;n--);if(t<=0){let e,r=!0;for(;(e=n?this.children[n-1]:null)&&e.dom.parentNode!=this.contentDOM;n--,r=!1);return e&&t&&r&&!e.border&&!e.domAtom?e.domFromPos(e.size,t):{node:this.contentDOM,offset:e?nT(e.dom)+1:0}}{let e,r=!0;for(;(e=n<this.children.length?this.children[n]:null)&&e.dom.parentNode!=this.contentDOM;n++,r=!1);return e&&r&&!e.border&&!e.domAtom?e.domFromPos(0,t):{node:this.contentDOM,offset:e?nT(e.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,n=0){if(0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,o=-1;for(let i=n,s=0;;s++){let n=this.children[s],l=i+n.size;if(-1==r&&e<=l){let o=i+n.border;if(e>=o&&t<=l-n.border&&n.node&&n.contentDOM&&this.contentDOM.contains(n.contentDOM))return n.parseRange(e,t,o);e=i;for(let t=s;t>0;t--){let n=this.children[t-1];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(1)){r=nT(n.dom)+1;break}e-=n.size}-1==r&&(r=0)}if(r>-1&&(l>t||s==this.children.length-1)){t=l;for(let e=s+1;e<this.children.length;e++){let n=this.children[e];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){o=nT(n.dom);break}t+=n.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=l}return{node:this.contentDOM,from:e,to:t,fromOffset:r,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:n}=this.domFromPos(e,0);if(1!=t.nodeType||n==t.childNodes.length)throw RangeError("No node after pos "+e);return t.childNodes[n]}setSelection(e,t,n,r=!1){let o=Math.min(e,t),i=Math.max(e,t);for(let s=0,l=0;s<this.children.length;s++){let a=this.children[s],c=l+a.size;if(o>l&&i<c)return a.setSelection(e-l-a.border,t-l-a.border,n,r);l=c}let s=this.domFromPos(e,e?-1:1),l=t==e?s:this.domFromPos(t,t?-1:1),a=n.root.getSelection(),c=n.domSelectionRange(),d=!1;if((nV||nW)&&e==t){let{node:e,offset:t}=s;if(3==e.nodeType){if((d=!!(t&&"\n"==e.nodeValue[t-1]))&&t==e.nodeValue.length)for(let t=e,n;t;t=t.parentNode){if(n=t.nextSibling){"BR"==n.nodeName&&(s=l={node:n.parentNode,offset:nT(n)+1});break}let e=t.pmViewDesc;if(e&&e.node&&e.node.isBlock)break}}else{let n=e.childNodes[t-1];d=n&&("BR"==n.nodeName||"false"==n.contentEditable)}}if(nV&&c.focusNode&&c.focusNode!=l.node&&1==c.focusNode.nodeType){let e=c.focusNode.childNodes[c.focusOffset];e&&"false"==e.contentEditable&&(r=!0)}if(!(r||d&&nW)&&n_(s.node,s.offset,c.anchorNode,c.anchorOffset)&&n_(l.node,l.offset,c.focusNode,c.focusOffset))return;let u=!1;if((a.extend||e==t)&&!(d&&nV)){a.collapse(s.node,s.offset);try{e!=t&&a.extend(l.node,l.offset),u=!0}catch(e){}}if(!u){if(e>t){let e=s;s=l,l=e}let n=document.createRange();n.setEnd(l.node,l.offset),n.setStart(s.node,s.offset),a.removeAllRanges(),a.addRange(n)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let n=0,r=0;r<this.children.length;r++){let o=this.children[r],i=n+o.size;if(n==i?e<=i&&t>=n:e<i&&t>n){let r=n+o.border,s=i-o.border;if(e>=r&&t<=s){this.dirty=e==n||t==i?2:1,e==r&&t==s&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=3:o.markDirty(e-r,t-r);return}o.dirty=o.dom!=o.contentDOM||o.dom.parentNode!=this.contentDOM||o.children.length?3:2}n=i}this.dirty=2}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let n=1==e?2:1;t.dirty<n&&(t.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class ra extends rl{constructor(e,t,n,r){let o,i=t.type.toDOM;if("function"==typeof i&&(i=i(n,()=>o?o.parent?o.parent.posBeforeChild(o):void 0:r)),!t.type.spec.raw){if(1!=i.nodeType){let e=document.createElement("span");e.appendChild(i),i=e}i.contentEditable="false",i.classList.add("ProseMirror-widget")}super(e,[],i,null),this.widget=t,this.widget=t,o=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return!!t&&t(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class rc extends rl{constructor(e,t,n,r){super(e,[],t,null),this.textDOM=n,this.text=r}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class rd extends rl{constructor(e,t,n,r,o){super(e,[],n,r),this.mark=t,this.spec=o}static create(e,t,n,r){let o=r.nodeViews[t.type.name],i=o&&o(t,r,n);return i&&i.dom||(i=e8.renderSpec(document,t.type.spec.toDOM(t,n),null,t.attrs)),new rd(e,t,i.dom,i.contentDOM||i.dom,i)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),0!=this.dirty){let e=this.parent;for(;!e.node;)e=e.parent;e.dirty<this.dirty&&(e.dirty=this.dirty),this.dirty=0}}slice(e,t,n){let r=rd.create(this.parent,this.mark,!0,n),o=this.children,i=this.size;t<i&&(o=rx(o,t,i,n)),e>0&&(o=rx(o,0,e,n));for(let e=0;e<o.length;e++)o[e].parent=r;return r.children=o,r}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class ru extends rl{constructor(e,t,n,r,o,i,s,l,a){super(e,[],o,i),this.node=t,this.outerDeco=n,this.innerDeco=r,this.nodeDOM=s}static create(e,t,n,r,o,i){let s=o.nodeViews[t.type.name],l,a=s&&s(t,o,()=>l?l.parent?l.parent.posBeforeChild(l):void 0:i,n,r),c=a&&a.dom,d=a&&a.contentDOM;if(t.isText)if(c){if(3!=c.nodeType)throw RangeError("Text must be rendered as a DOM text node")}else c=document.createTextNode(t.text);else if(!c){let e=e8.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs);({dom:c,contentDOM:d}=e)}d||t.isText||"BR"==c.nodeName||(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let u=c;return(c=rE(c,n,t),a)?l=new rm(e,t,n,r,c,d||null,u,a,o,i+1):t.isText?new rp(e,t,n,r,c,u,o):new ru(e,t,n,r,c,d||null,u,o,i+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let t=this.children.length-1;t>=0;t--){let n=this.children[t];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>em.empty)}else e.contentElement=this.contentDOM;else e.getContent=()=>this.node.content;return e}matchesNode(e,t,n){return 0==this.dirty&&e.eq(this.node)&&rk(t,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return+!this.node.isLeaf}updateChildren(e,t){let n=this.node.inlineContent,r=t,o=e.composing?this.localCompositionInfo(e,t):null,i=o&&o.pos>-1?o:null,s=o&&o.pos<0,l=new rT(this,i&&i.node,e);(function(e,t,n,r){let o=t.locals(e),i=0;if(0==o.length){for(let n=0;n<e.childCount;n++){let s=e.child(n);r(s,o,t.forChild(i,s),n),i+=s.nodeSize}return}let s=0,l=[],a=null;for(let c=0;;){let d,u,h,p;for(;s<o.length&&o[s].to==i;){let e=o[s++];e.widget&&(d?(u||(u=[d])).push(e):d=e)}if(d)if(u){u.sort(rw);for(let e=0;e<u.length;e++)n(u[e],c,!!a)}else n(d,c,!!a);if(a)p=-1,h=a,a=null;else if(c<e.childCount)p=c,h=e.child(c++);else break;for(let e=0;e<l.length;e++)l[e].to<=i&&l.splice(e--,1);for(;s<o.length&&o[s].from<=i&&o[s].to>i;)l.push(o[s++]);let f=i+h.nodeSize;if(h.isText){let e=f;s<o.length&&o[s].from<e&&(e=o[s].from);for(let t=0;t<l.length;t++)l[t].to<e&&(e=l[t].to);e<f&&(a=h.cut(e-i),h=h.cut(0,e-i),f=e,p=-1)}else for(;s<o.length&&o[s].to<f;)s++;let m=h.isInline&&!h.isLeaf?l.filter(e=>!e.inline):l.slice();r(h,m,t.forChild(i,h),p),i=f}})(this.node,this.innerDeco,(t,o,i)=>{t.spec.marks?l.syncToMarks(t.spec.marks,n,e):t.type.side>=0&&!i&&l.syncToMarks(o==this.node.childCount?ev.none:this.node.child(o).marks,n,e),l.placeWidget(t,e,r)},(t,i,a,c)=>{let d;l.syncToMarks(t.marks,n,e),l.findNodeMatch(t,i,a,c)||s&&e.state.selection.from>r&&e.state.selection.to<r+t.nodeSize&&(d=l.findIndexWithChild(o.node))>-1&&l.updateNodeAt(t,i,a,d,e)||l.updateNextNode(t,i,a,e,c,r)||l.addNode(t,i,a,e,r),r+=t.nodeSize}),l.syncToMarks([],n,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||2==this.dirty)&&(i&&this.protectLocalComposition(e,i),function e(t,n,r){let o=t.firstChild,i=!1;for(let s=0;s<n.length;s++){let l=n[s],a=l.dom;if(a.parentNode==t){for(;a!=o;)o=rC(o),i=!0;o=o.nextSibling}else i=!0,t.insertBefore(a,o);if(l instanceof rd){let n=o?o.previousSibling:t.lastChild;e(l.contentDOM,l.children,r),o=n?n.nextSibling:t.firstChild}}for(;o;)o=rC(o),i=!0;i&&r.trackWrites==t&&(r.trackWrites=null)}(this.contentDOM,this.children,e),nY&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))}localCompositionInfo(e,t){let{from:n,to:r}=e.state.selection;if(!(e.state.selection instanceof tV)||n<t||r>t+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(!this.node.inlineContent)return{node:o,pos:-1,text:""};{let e=o.nodeValue,i=function(e,t,n,r){for(let o=0,i=0;o<e.childCount&&i<=r;){let s=e.child(o++),l=i;if(i+=s.nodeSize,!s.isText)continue;let a=s.text;for(;o<e.childCount;){let t=e.child(o++);if(i+=t.nodeSize,!t.isText)break;a+=t.text}if(i>=n){if(i>=r&&a.slice(r-t.length-l,r-l)==t)return r-t.length;let e=l<r?a.lastIndexOf(t,r-l-1):-1;if(e>=0&&e+t.length+l>=n)return l+e;if(n==r&&a.length>=r+t.length-l&&a.slice(r-l,r-l+t.length)==t)return r}}return -1}(this.node.content,e,n-t,r-t);return i<0?null:{node:o,pos:i,text:e}}}protectLocalComposition(e,{node:t,pos:n,text:r}){if(this.getDesc(t))return;let o=t;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let i=new rc(this,o,t,r);e.input.compositionNodes.push(i),this.children=rx(this.children,n,n+r.length,e,i)}update(e,t,n,r){return 3!=this.dirty&&!!e.sameMarkup(this.node)&&(this.updateInner(e,t,n,r),!0)}updateInner(e,t,n,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(rk(e,this.outerDeco))return;let t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=rv(this.dom,this.nodeDOM,ry(this.outerDeco,this.node,t),ry(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function rh(e,t,n,r,o){rE(r,t,e);let i=new ru(void 0,e,t,n,r,r,r,o,0);return i.contentDOM&&i.updateChildren(o,0),i}class rp extends ru{constructor(e,t,n,r,o,i,s){super(e,t,n,r,o,null,i,s,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,n,r){return 3!=this.dirty&&(0==this.dirty||!!this.inParent())&&!!e.sameMarkup(this.node)&&(this.updateOuterDeco(t),(0!=this.dirty||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=0,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,n){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,n)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,t,n){let r=this.node.cut(e,t),o=document.createTextNode(r.text);return new rp(this.parent,r,this.outerDeco,this.innerDeco,o,o,n)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(0==e||t==this.nodeDOM.nodeValue.length)&&(this.dirty=3)}get domAtom(){return!1}isText(e){return this.node.text==e}}class rf extends rl{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class rm extends ru{constructor(e,t,n,r,o,i,s,l,a,c){super(e,t,n,r,o,i,s,a,c),this.spec=l}update(e,t,n,r){if(3==this.dirty)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,t,n);return o&&this.updateInner(e,t,n,r),o}return(!!this.contentDOM||!!e.isLeaf)&&super.update(e,t,n,r)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,n,r){this.spec.setSelection?this.spec.setSelection(e,t,n.root):super.setSelection(e,t,n,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}let rg=function(e){e&&(this.nodeName=e)};rg.prototype=Object.create(null);let rb=[new rg];function ry(e,t,n){if(0==e.length)return rb;let r=n?rb[0]:new rg,o=[r];for(let i=0;i<e.length;i++){let s=e[i].type.attrs;if(s)for(let e in s.nodeName&&o.push(r=new rg(s.nodeName)),s){let i=s[e];null!=i&&(n&&1==o.length&&o.push(r=new rg(t.isInline?"span":"div")),"class"==e?r.class=(r.class?r.class+" ":"")+i:"style"==e?r.style=(r.style?r.style+";":"")+i:"nodeName"!=e&&(r[e]=i))}}return o}function rv(e,t,n,r){if(n==rb&&r==rb)return t;let o=t;for(let t=0;t<r.length;t++){let i=r[t],s=n[t];if(t){let t;s&&s.nodeName==i.nodeName&&o!=e&&(t=o.parentNode)&&t.nodeName.toLowerCase()==i.nodeName||((t=document.createElement(i.nodeName)).pmIsDeco=!0,t.appendChild(o),s=rb[0]),o=t}!function(e,t,n){for(let r in t)"class"==r||"style"==r||"nodeName"==r||r in n||e.removeAttribute(r);for(let r in n)"class"!=r&&"style"!=r&&"nodeName"!=r&&n[r]!=t[r]&&e.setAttribute(r,n[r]);if(t.class!=n.class){let r=t.class?t.class.split(" ").filter(Boolean):[],o=n.class?n.class.split(" ").filter(Boolean):[];for(let t=0;t<r.length;t++)-1==o.indexOf(r[t])&&e.classList.remove(r[t]);for(let t=0;t<o.length;t++)-1==r.indexOf(o[t])&&e.classList.add(o[t]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style){let n=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,r;for(;r=n.exec(t.style);)e.style.removeProperty(r[1])}n.style&&(e.style.cssText+=n.style)}}(o,s||rb[0],i)}return o}function rE(e,t,n){return rv(e,e,rb,ry(t,n,1!=e.nodeType))}function rk(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function rC(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class rT{constructor(e,t,n){this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function(e,t){let n=t,r=n.children.length,o=e.childCount,i=new Map,s=[];n:for(;o>0;){let l;for(;;)if(r){let e=n.children[r-1];if(e instanceof rd)n=e,r=e.children.length;else{l=e,r--;break}}else if(n==t)break n;else r=n.parent.children.indexOf(n),n=n.parent;let a=l.node;if(a){if(a!=e.child(o-1))break;--o,i.set(l,o),s.push(l)}}return{index:o,matched:i,matches:s.reverse()}}(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,n){let r=0,o=this.stack.length>>1,i=Math.min(o,e.length);for(;r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&!1!==e[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let r=-1;for(let t=this.index;t<Math.min(this.index+3,this.top.children.length);t++){let n=this.top.children[t];if(n.matchesMark(e[o])&&!this.isLocked(n.dom)){r=t;break}}if(r>-1)r>this.index&&(this.changed=!0,this.destroyBetween(this.index,r)),this.top=this.top.children[this.index];else{let r=rd.create(this.top,e[o],t,n);this.top.children.splice(this.index,0,r),this.top=r,this.changed=!0}this.index=0,o++}}findNodeMatch(e,t,n,r){let o=-1,i;if(r>=this.preMatch.index&&(i=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&i.matchesNode(e,t,n))o=this.top.children.indexOf(i,this.index);else for(let r=this.index,i=Math.min(this.top.children.length,r+5);r<i;r++){let i=this.top.children[r];if(i.matchesNode(e,t,n)&&!this.preMatch.matched.has(i)){o=r;break}}return!(o<0)&&(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,t,n,r,o){let i=this.top.children[r];return 3==i.dirty&&i.dom==i.contentDOM&&(i.dirty=2),!!i.update(e,t,n,o)&&(this.destroyBetween(this.index,r),this.index++,!0)}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return -1;if(t==this.top.contentDOM){let t=e.pmViewDesc;if(t){for(let e=this.index;e<this.top.children.length;e++)if(this.top.children[e]==t)return e}return -1}e=t}}updateNextNode(e,t,n,r,o,i){for(let s=this.index;s<this.top.children.length;s++){let l=this.top.children[s];if(l instanceof ru){let a=this.preMatch.matched.get(l);if(null!=a&&a!=o)return!1;let c=l.dom,d,u=this.isLocked(c)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&3!=l.dirty&&rk(t,l.outerDeco));if(!u&&l.update(e,t,n,r))return this.destroyBetween(this.index,s),l.dom!=c&&(this.changed=!0),this.index++,!0;if(!u&&(d=this.recreateWrapper(l,e,t,n,r,i)))return this.destroyBetween(this.index,s),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=2,d.updateChildren(r,i+1),d.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,n,r,o,i){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!rk(n,e.outerDeco)||!r.eq(e.innerDeco))return null;let s=ru.create(this.top,t,n,r,o,i);if(s.contentDOM)for(let t of(s.children=e.children,e.children=[],s.children))t.parent=s;return e.destroy(),s}addNode(e,t,n,r,o){let i=ru.create(this.top,e,t,n,r,o);i.contentDOM&&i.updateChildren(r,o+1),this.top.children.splice(this.index++,0,i),this.changed=!0}placeWidget(e,t,n){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(r&&r.matchesWidget(e)&&(e==r.widget||!r.widget.type.toDOM.parentNode))this.index++;else{let r=new ra(this.top,e,t,n);this.top.children.splice(this.index++,0,r),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof rd;)e=(t=e).children[t.children.length-1];(!e||!(e instanceof rp)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((nW||nG)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);"IMG"==e&&(n.className="ProseMirror-separator",n.alt=""),"BR"==e&&(n.className="ProseMirror-trailingBreak");let r=new rf(this.top,[],n,null);t!=this.top?t.children.push(r):t.children.splice(this.index++,0,r),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||1==e.nodeType&&e.contains(this.lock.parentNode))}}function rw(e,t){return e.type.side-t.type.side}function rx(e,t,n,r,o){let i=[];for(let s=0,l=0;s<e.length;s++){let a=e[s],c=l,d=l+=a.size;c>=n||d<=t?i.push(a):(c<t&&i.push(a.slice(0,t-c,r)),o&&(i.push(o),o=void 0),d>n&&i.push(a.slice(n-c,a.size,r)))}return i}function rS(e,t=null){let n=e.domSelectionRange(),r=e.state.doc;if(!n.focusNode)return null;let o=e.docView.nearestDesc(n.focusNode),i=o&&0==o.size,s=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(s<0)return null;let l=r.resolve(s),a,c;if(nD(n)){for(a=s;o&&!o.node;)o=o.parent;let e=o.node;if(o&&e.isAtom&&tG.isSelectable(e)&&o.parent&&!(e.isInline&&function(e,t,n){for(let r=0==t,o=t==nI(e);r||o;){if(e==n)return!0;let t=nT(e);if(!(e=e.parentNode))return!1;r=r&&0==t,o=o&&t==nI(e)}}(n.focusNode,n.focusOffset,o.dom))){let e=o.posBefore;c=new tG(s==e?l:r.resolve(e))}}else{if(n instanceof e.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let t=s,o=s;for(let r=0;r<n.rangeCount;r++){let i=n.getRangeAt(r);t=Math.min(t,e.docView.posFromDOM(i.startContainer,i.startOffset,1)),o=Math.max(o,e.docView.posFromDOM(i.endContainer,i.endOffset,-1))}if(t<0)return null;[a,s]=o==e.state.selection.anchor?[o,t]:[t,o],l=r.resolve(s)}else a=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(a<0)return null}let d=r.resolve(a);if(!c){let n="pointer"==t||e.state.selection.head<l.pos&&!i?1:-1;c=rL(e,d,l,n)}return c}function rA(e){return e.editable?e.hasFocus():rB(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function r_(e,t=!1){let n=e.state.selection;if(rD(e,n),rA(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&nG){let t=e.domSelectionRange(),n=e.domObserver.currentSelection;if(t.anchorNode&&n.anchorNode&&n_(t.anchorNode,t.anchorOffset,n.anchorNode,n.anchorOffset)){e.input.mouseDown.delayedSelectionSync=!0,e.domObserver.setCurSelection();return}}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){let t=e.domSelection();if(!t)return;let n=e.cursorWrapper.dom,r="IMG"==n.nodeName;r?t.collapse(n.parentNode,nT(n)+1):t.collapse(n,0),!r&&!e.state.selection.visible&&nU&&nz<=11&&(n.disabled=!0,n.disabled=!1)}(e);else{var r;let o,i,s,l,{anchor:a,head:c}=n,d,u;rN&&!(n instanceof tV)&&(n.$from.parent.inlineContent||(d=rM(e,n.from)),n.empty||n.$from.parent.inlineContent||(u=rM(e,n.to))),e.docView.setSelection(a,c,e,t),rN&&(d&&rO(d),u&&rO(u)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&((o=(r=e).dom.ownerDocument).removeEventListener("selectionchange",r.input.hideSelectionGuard),s=(i=r.domSelectionRange()).anchorNode,l=i.anchorOffset,o.addEventListener("selectionchange",r.input.hideSelectionGuard=()=>{(i.anchorNode!=s||i.anchorOffset!=l)&&(o.removeEventListener("selectionchange",r.input.hideSelectionGuard),setTimeout(()=>{(!rA(r)||r.state.selection.visible)&&r.dom.classList.remove("ProseMirror-hideselection")},20))})))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}let rN=nW||nG&&nq<63;function rM(e,t){let{node:n,offset:r}=e.docView.domFromPos(t,0),o=r<n.childNodes.length?n.childNodes[r]:null,i=r?n.childNodes[r-1]:null;if(nW&&o&&"false"==o.contentEditable)return rI(o);if((!o||"false"==o.contentEditable)&&(!i||"false"==i.contentEditable)){if(o)return rI(o);else if(i)return rI(i)}}function rI(e){return e.contentEditable="true",nW&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function rO(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function rD(e,t){if(t instanceof tG){let n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(rR(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else rR(e)}function rR(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function rL(e,t,n,r){return e.someProp("createSelectionBetween",r=>r(e,t,n))||tV.between(t,n,r)}function rP(e){return(!e.editable||!!e.hasFocus())&&rB(e)}function rB(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(e){return!1}}function rH(e,t){let{$anchor:n,$head:r}=e.selection,o=t>0?n.max(r):n.min(r),i=o.parent.inlineContent?o.depth?e.doc.resolve(t>0?o.after():o.before()):null:o;return i&&tj.findFrom(i,t)}function rj(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function rF(e,t,n){let r=e.state.selection;if(r instanceof tV){if(n.indexOf("s")>-1){let{$head:n}=r,o=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let i=e.state.doc.resolve(n.pos+o.nodeSize*(t<0?-1:1));return rj(e,new tV(r.$anchor,i))}else if(!r.empty)return!1;else if(e.endOfTextblock(t>0?"forward":"backward")){let n=rH(e.state,t);return!!n&&n instanceof tG&&rj(e,n)}else if(!(nK&&n.indexOf("m")>-1)){let n=r.$head,o=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter,i;if(!o||o.isText)return!1;let s=t<0?n.pos-o.nodeSize:n.pos;return!!(o.isAtom||(i=e.docView.descAt(s))&&!i.contentDOM)&&(tG.isSelectable(o)?rj(e,new tG(t<0?e.state.doc.resolve(n.pos-o.nodeSize):n)):!!nQ&&rj(e,new tV(e.state.doc.resolve(t<0?s:s+o.nodeSize))))}}else{if(r instanceof tG&&r.node.isInline)return rj(e,new tV(t>0?r.$to:r.$from));let n=rH(e.state,t);return!!n&&rj(e,n)}}function rU(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function rz(e,t){let n=e.pmViewDesc;return n&&0==n.size&&(t<0||e.nextSibling||"BR"!=e.nodeName)}function rV(e,t){return t<0?function(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let o,i,s=!1;for(nV&&1==n.nodeType&&r<rU(n)&&rz(n.childNodes[r],-1)&&(s=!0);;)if(r>0)if(1!=n.nodeType)break;else{let e=n.childNodes[r-1];if(rz(e,-1))o=n,i=--r;else if(3==e.nodeType)r=(n=e).nodeValue.length;else break}else if(r$(n))break;else{let t=n.previousSibling;for(;t&&rz(t,-1);)o=n.parentNode,i=nT(t),t=t.previousSibling;if(t)r=rU(n=t);else{if((n=n.parentNode)==e.dom)break;r=0}}s?rG(e,n,r):o&&rG(e,o,i)}(e):function(e){let t,n,r=e.domSelectionRange(),o=r.focusNode,i=r.focusOffset;if(!o)return;let s=rU(o);for(;;)if(i<s){if(1!=o.nodeType)break;if(rz(o.childNodes[i],1))t=o,n=++i;else break}else if(r$(o))break;else{let r=o.nextSibling;for(;r&&rz(r,1);)t=r.parentNode,n=nT(r)+1,r=r.nextSibling;if(r)i=0,s=rU(o=r);else{if((o=o.parentNode)==e.dom)break;i=s=0}}t&&rG(e,t,n)}(e)}function r$(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function rG(e,t,n){if(3!=t.nodeType){let e,r;(r=function(e,t){for(;e&&t==e.childNodes.length&&!nO(e);)t=nT(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let n=e.childNodes[t];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;e=n,t=0}}(t,n))?(t=r,n=0):(e=function(e,t){for(;e&&!t&&!nO(e);)t=nT(e),e=e.parentNode;for(;e&&t;){let n=e.childNodes[t-1];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;t=(e=n).childNodes.length}}(t,n))&&(t=e,n=e.nodeValue.length)}let r=e.domSelection();if(!r)return;if(nD(r)){let e=document.createRange();e.setEnd(t,n),e.setStart(t,n),r.removeAllRanges(),r.addRange(e)}else r.extend&&r.extend(t,n);e.domObserver.setCurSelection();let{state:o}=e;setTimeout(()=>{e.state==o&&r_(e)},50)}function rq(e,t){let n=e.state.doc.resolve(t);if(!(nG||nZ)&&n.parent.inlineContent){let r=e.coordsAtPos(t);if(t>n.start()){let n=e.coordsAtPos(t-1),o=(n.top+n.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(n.left-r.left)>1)return n.left<r.left?"ltr":"rtl"}if(t<n.end()){let n=e.coordsAtPos(t+1),o=(n.top+n.bottom)/2;if(o>r.top&&o<r.bottom&&Math.abs(n.left-r.left)>1)return n.left>r.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(e.dom).direction?"rtl":"ltr"}function rW(e,t,n){let r=e.state.selection;if(r instanceof tV&&!r.empty||n.indexOf("s")>-1||nK&&n.indexOf("m")>-1)return!1;let{$from:o,$to:i}=r;if(!o.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let n=rH(e.state,t);if(n&&n instanceof tG)return rj(e,n)}if(!o.parent.inlineContent){let n=t<0?o:i,s=r instanceof tW?tj.near(n,t):tj.findFrom(n,t);return!!s&&rj(e,s)}return!1}function rY(e,t){if(!(e.state.selection instanceof tV))return!0;let{$head:n,$anchor:r,empty:o}=e.state.selection;if(!n.sameParent(r))return!0;if(!o)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let i=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(i&&!i.isText){let r=e.state.tr;return t<0?r.delete(n.pos-i.nodeSize,n.pos):r.delete(n.pos,n.pos+i.nodeSize),e.dispatch(r),!0}return!1}function rK(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function rZ(e,t){e.someProp("transformCopied",n=>{t=n(t,e)});let n=[],{content:r,openStart:o,openEnd:i}=t;for(;o>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;let e=r.firstChild;n.push(e.type.name,e.attrs!=e.type.defaultAttrs?e.attrs:null),r=e.content}let s=e.someProp("clipboardSerializer")||e8.fromSchema(e.state.schema),l=r5(),a=l.createElement("div");a.appendChild(s.serializeFragment(r,{document:l}));let c=a.firstChild,d,u=0;for(;c&&1==c.nodeType&&(d=r2[c.nodeName.toLowerCase()]);){for(let e=d.length-1;e>=0;e--){let t=l.createElement(d[e]);for(;a.firstChild;)t.appendChild(a.firstChild);a.appendChild(t),u++}c=a.firstChild}return c&&1==c.nodeType&&c.setAttribute("data-pm-slice",`${o} ${i}${u?` -${u}`:""} ${JSON.stringify(n)}`),{dom:a,text:e.someProp("clipboardTextSerializer",n=>n(t,e))||t.content.textBetween(0,t.content.size,"\n\n"),slice:t}}function rX(e,t,n,r,o){let i,s,l=o.parent.type.spec.code;if(!n&&!t)return null;let a=!!t&&(r||l||!n);if(a){if(e.someProp("transformPastedText",n=>{t=n(t,l||r,e)}),l)return s=new ek(em.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0),e.someProp("transformPasted",t=>{s=t(s,e,!0)}),s;let n=e.someProp("clipboardTextParser",n=>n(t,o,r,e));if(n)s=n;else{let n=o.marks(),{schema:r}=e.state,s=e8.fromSchema(r);i=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(e=>{let t=i.appendChild(document.createElement("p"));e&&t.appendChild(s.serializeNode(r.text(e,n)))})}}else e.someProp("transformPastedHTML",t=>{n=t(n,e)}),i=function(e){var t;let n,r=/^(\s*<meta [^>]*>)*/.exec(e);r&&(e=e.slice(r[0].length));let o=r5().createElement("div"),i=/<([a-z][^>\s]+)/i.exec(e),s;if((s=i&&r2[i[1].toLowerCase()])&&(e=s.map(e=>"<"+e+">").join("")+e+s.map(e=>"</"+e+">").reverse().join("")),o.innerHTML=(t=e,(n=window.trustedTypes)?(r3||(r3=n.defaultPolicy||n.createPolicy("ProseMirrorClipboard",{createHTML:e=>e})),r3.createHTML(t)):t),s)for(let e=0;e<s.length;e++)o=o.querySelector(s[e])||o;return o}(n),nQ&&function(e){let t=e.querySelectorAll(nG?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let r=t[n];1==r.childNodes.length&&""==r.textContent&&r.parentNode&&r.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),r)}}(i);let c=i&&i.querySelector("[data-pm-slice]"),d=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(d&&d[3])for(let e=+d[3];e>0;e--){let e=i.firstChild;for(;e&&1!=e.nodeType;)e=e.nextSibling;if(!e)break;i=e}if(s||(s=(e.someProp("clipboardParser")||e.someProp("domParser")||eX.fromSchema(e.state.schema)).parseSlice(i,{preserveWhitespace:!!(a||d),context:o,ruleFromNode:e=>"BR"!=e.nodeName||e.nextSibling||!e.parentNode||rQ.test(e.parentNode.nodeName)?null:{ignore:!0}})),d)s=function(e,t){if(!e.size)return e;let n=e.content.firstChild.type.schema,r;try{r=JSON.parse(t)}catch(t){return e}let{content:o,openStart:i,openEnd:s}=e;for(let e=r.length-2;e>=0;e-=2){let t=n.nodes[r[e]];if(!t||t.hasRequiredAttrs())break;o=em.from(t.create(r[e+1],o)),i++,s++}return new ek(o,i,s)}(r1(s,+d[1],+d[2]),d[4]);else if((s=ek.maxOpen(function(e,t){if(e.childCount<2)return e;for(let n=t.depth;n>=0;n--){let r=t.node(n).contentMatchAt(t.index(n)),o,i=[];if(e.forEach(e=>{if(!i)return;let t=r.findWrapping(e.type),n;if(!t)return i=null;if(n=i.length&&o.length&&function e(t,n,r,o,i){if(i<t.length&&i<n.length&&t[i]==n[i]){let s=e(t,n,r,o.lastChild,i+1);if(s)return o.copy(o.content.replaceChild(o.childCount-1,s));if(o.contentMatchAt(o.childCount).matchType(i==t.length-1?r.type:t[i+1]))return o.copy(o.content.append(em.from(rJ(r,t,i+1))))}}(t,o,e,i[i.length-1],0))i[i.length-1]=n;else{i.length&&(i[i.length-1]=function e(t,n){if(0==n)return t;let r=t.content.replaceChild(t.childCount-1,e(t.lastChild,n-1)),o=t.contentMatchAt(t.childCount).fillBefore(em.empty,!0);return t.copy(r.append(o))}(i[i.length-1],o.length));let n=rJ(e,t);i.push(n),r=r.matchType(n.type),o=t}}),i)return em.from(i)}return e}(s.content,o),!0)).openStart||s.openEnd){let e=0,t=0;for(let t=s.content.firstChild;e<s.openStart&&!t.type.spec.isolating;e++,t=t.firstChild);for(let e=s.content.lastChild;t<s.openEnd&&!e.type.spec.isolating;t++,e=e.lastChild);s=r1(s,e,t)}return e.someProp("transformPasted",t=>{s=t(s,e,a)}),s}let rQ=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function rJ(e,t,n=0){for(let r=t.length-1;r>=n;r--)e=t[r].create(null,em.from(e));return e}function r0(e,t,n,r,o,i){let s=t<0?e.firstChild:e.lastChild,l=s.content;return e.childCount>1&&(i=0),o<r-1&&(l=r0(l,t,n,r,o+1,i)),o>=n&&(l=t<0?s.contentMatchAt(0).fillBefore(l,i<=o).append(l):l.append(s.contentMatchAt(s.childCount).fillBefore(em.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,s.copy(l))}function r1(e,t,n){return t<e.openStart&&(e=new ek(r0(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new ek(r0(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}let r2={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},r4=null;function r5(){return r4||(r4=document.implementation.createHTMLDocument("title"))}let r3=null,r8={},r6={},r9={touchstart:!0,touchmove:!0};class r7{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function oe(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function ot(e){e.someProp("handleDOMEvents",t=>{for(let n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=t=>on(e,t))})}function on(e,t){return e.someProp("handleDOMEvents",n=>{let r=n[t.type];return!!r&&(r(e,t)||t.defaultPrevented)})}function or(e){return{left:e.clientX,top:e.clientY}}function oo(e,t,n,r,o){if(-1==r)return!1;let i=e.state.doc.resolve(r);for(let r=i.depth+1;r>0;r--)if(e.someProp(t,t=>r>i.depth?t(e,n,i.nodeAfter,i.before(r),o,!0):t(e,n,i.node(r),i.before(r),o,!1)))return!0;return!1}function oi(e,t,n){if(e.focused||e.focus(),e.state.selection.eq(t))return;let r=e.state.tr.setSelection(t);"pointer"==n&&r.setMeta("pointer",!0),e.dispatch(r)}r6.keydown=(e,t)=>{if((e.input.shiftKey=16==t.keyCode||t.shiftKey,!oc(e,t))&&(e.input.lastKeyCode=t.keyCode,e.input.lastKeyCodeTime=Date.now(),!nX||!nG||13!=t.keyCode))if(229!=t.keyCode&&e.domObserver.forceFlush(),!nY||13!=t.keyCode||t.ctrlKey||t.altKey||t.metaKey)e.someProp("handleKeyDown",n=>n(e,t))||function(e,t){let n,r=t.keyCode,o=(n="",t.ctrlKey&&(n+="c"),t.metaKey&&(n+="m"),t.altKey&&(n+="a"),t.shiftKey&&(n+="s"),n);if(8==r||nK&&72==r&&"c"==o)return rY(e,-1)||rV(e,-1);if(46==r&&!t.shiftKey||nK&&68==r&&"c"==o)return rY(e,1)||rV(e,1);if(13==r||27==r)return!0;if(37==r||nK&&66==r&&"c"==o){let t=37==r?"ltr"==rq(e,e.state.selection.from)?-1:1:-1;return rF(e,t,o)||rV(e,t)}if(39==r||nK&&70==r&&"c"==o){let t=39==r?"ltr"==rq(e,e.state.selection.from)?1:-1:1;return rF(e,t,o)||rV(e,t)}else if(38==r||nK&&80==r&&"c"==o)return rW(e,-1,o)||rV(e,-1);else if(40==r||nK&&78==r&&"c"==o)return function(e){if(!nW||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(t&&1==t.nodeType&&0==n&&t.firstChild&&"false"==t.firstChild.contentEditable){let n=t.firstChild;rK(e,n,"true"),setTimeout(()=>rK(e,n,"false"),20)}return!1}(e)||rW(e,1,o)||rV(e,1);else if(o==(nK?"m":"c")&&(66==r||73==r||89==r||90==r))return!0;return!1}(e,t)?t.preventDefault():oe(e,"key");else{let t=Date.now();e.input.lastIOSEnter=t,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==t&&(e.someProp("handleKeyDown",t=>t(e,nR(13,"Enter"))),e.input.lastIOSEnter=0)},200)}},r6.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},r6.keypress=(e,t)=>{if(oc(e,t)||!t.charCode||t.ctrlKey&&!t.altKey||nK&&t.metaKey)return;if(e.someProp("handleKeyPress",n=>n(e,t)))return void t.preventDefault();let n=e.state.selection;if(!(n instanceof tV)||!n.$from.sameParent(n.$to)){let r=String.fromCharCode(t.charCode),o=()=>e.state.tr.insertText(r).scrollIntoView();/[\r\n]/.test(r)||e.someProp("handleTextInput",t=>t(e,n.$from.pos,n.$to.pos,r,o))||e.dispatch(o()),t.preventDefault()}};let ol=nK?"metaKey":"ctrlKey";r8.mousedown=(e,t)=>{var n;let r,o;e.input.shiftKey=t.shiftKey;let i=op(e),s=Date.now(),l="singleClick";s-e.input.lastClick.time<500&&(r=(n=e.input.lastClick).x-t.clientX)*r+(o=n.y-t.clientY)*o<100&&!t[ol]&&e.input.lastClick.button==t.button&&("singleClick"==e.input.lastClick.type?l="doubleClick":"doubleClick"==e.input.lastClick.type&&(l="tripleClick")),e.input.lastClick={time:s,x:t.clientX,y:t.clientY,type:l,button:t.button};let a=e.posAtCoords(or(t));a&&("singleClick"==l?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new oa(e,a,t,!!i)):("doubleClick"==l?function(e,t,n,r){return oo(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",n=>n(e,t,r))}:function(e,t,n,r){return oo(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",n=>n(e,t,r))||function(e,t,n){if(0!=n.button)return!1;let r=e.state.doc;if(-1==t)return!!r.inlineContent&&(oi(e,tV.create(r,0,r.content.size),"pointer"),!0);let o=r.resolve(t);for(let t=o.depth+1;t>0;t--){let n=t>o.depth?o.nodeAfter:o.node(t),i=o.before(t);if(n.inlineContent)oi(e,tV.create(r,i+1,i+1+n.content.size),"pointer");else{if(!tG.isSelectable(n))continue;oi(e,tG.create(r,i),"pointer")}return!0}}(e,n,r)})(e,a.pos,a.inside,t)?t.preventDefault():oe(e,"pointer"))};class oa{constructor(e,t,n,r){let o,i;if(this.view=e,this.pos=t,this.event=n,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[ol],this.allowDefault=n.shiftKey,t.inside>-1)o=e.state.doc.nodeAt(t.inside),i=t.inside;else{let n=e.state.doc.resolve(t.pos);o=n.parent,i=n.depth?n.before():0}const s=r?null:n.target,l=s?e.docView.nearestDesc(s,!0):null;this.target=l&&1==l.nodeDOM.nodeType?l.nodeDOM:null;let{selection:a}=e.state;(0==n.button&&o.type.spec.draggable&&!1!==o.type.spec.selectable||a instanceof tG&&a.from<=i&&a.to>i)&&(this.mightDrag={node:o,pos:i,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&nV&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),oe(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>r_(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;if(this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(or(e))),this.updateAllowDefault(e),this.allowDefault||!t)oe(this.view,"pointer");else{var n,r,o,i;(n=this.view,r=t.pos,o=t.inside,i=this.selectNode,oo(n,"handleClickOn",r,o,e)||n.someProp("handleClick",t=>t(n,r,e))||(i?function(e,t){if(-1==t)return!1;let n=e.state.selection,r,o;n instanceof tG&&(r=n.node);let i=e.state.doc.resolve(t);for(let e=i.depth+1;e>0;e--){let t=e>i.depth?i.nodeAfter:i.node(e);if(tG.isSelectable(t)){o=r&&n.$from.depth>0&&e>=n.$from.depth&&i.before(n.$from.depth+1)==n.$from.pos?i.before(n.$from.depth):i.before(e);break}}return null!=o&&(oi(e,tG.create(e.state.doc,o),"pointer"),!0)}(n,o):function(e,t){if(-1==t)return!1;let n=e.state.doc.resolve(t),r=n.nodeAfter;return!!(r&&r.isAtom&&tG.isSelectable(r))&&(oi(e,new tG(n),"pointer"),!0)}(n,o)))?e.preventDefault():0==e.button&&(this.flushed||nW&&this.mightDrag&&!this.mightDrag.node.isAtom||nG&&!this.view.state.selection.visible&&2>=Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to)))?(oi(this.view,tj.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):oe(this.view,"pointer")}}move(e){this.updateAllowDefault(e),oe(this.view,"pointer"),0==e.buttons&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}function oc(e,t){return!!e.composing||!!(nW&&500>Math.abs(t.timeStamp-e.input.compositionEndedAt))&&(e.input.compositionEndedAt=-2e8,!0)}r8.touchstart=e=>{e.input.lastTouch=Date.now(),op(e),oe(e,"pointer")},r8.touchmove=e=>{e.input.lastTouch=Date.now(),oe(e,"pointer")},r8.contextmenu=e=>op(e);let od=nX?5e3:-1;function ou(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>op(e),t))}function oh(e){let t;for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=((t=document.createEvent("Event")).initEvent("event",!0,!0),t.timeStamp));e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function op(e,t=!1){if(!nX||!(e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),oh(e),t||e.docView&&e.docView.dirty){let n=rS(e),r=e.state.selection;return n&&!n.eq(r)?e.dispatch(e.state.tr.setSelection(n)):(e.markCursor||t)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?e.dispatch(e.state.tr.deleteSelection()):e.updateState(e.state),!0}return!1}}r6.compositionstart=r6.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,n=t.selection.$to;if(t.selection instanceof tV&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(e=>!1===e.type.spec.inclusive)||nG&&nZ&&function(e){let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(!t||1!=t.nodeType||n>=t.childNodes.length)return!1;let r=t.childNodes[n];return 1==r.nodeType&&"false"==r.contentEditable}(e)))e.markCursor=e.state.storedMarks||n.marks(),op(e,!0),e.markCursor=null;else if(op(e,!t.selection.empty),nV&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let t=e.domSelectionRange();for(let n=t.focusNode,r=t.focusOffset;n&&1==n.nodeType&&0!=r;){let t=r<0?n.lastChild:n.childNodes[r-1];if(!t)break;if(3==t.nodeType){let n=e.domSelection();n&&n.collapse(t,t.nodeValue.length);break}n=t,r=-1}}e.input.composing=!0}ou(e,od)},r6.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,ou(e,20))};let of=nU&&nz<15||nY&&nJ<604;function om(e,t,n,r,o){let i=rX(e,t,n,r,e.state.selection.$from);if(e.someProp("handlePaste",t=>t(e,o,i||ek.empty)))return!0;if(!i)return!1;let s=0==i.openStart&&0==i.openEnd&&1==i.content.childCount?i.content.firstChild:null,l=s?e.state.tr.replaceSelectionWith(s,r):e.state.tr.replaceSelection(i);return e.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function og(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let n=e.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}r8.copy=r6.cut=(e,t)=>{let n=e.state.selection,r="cut"==t.type;if(n.empty)return;let o=of?null:t.clipboardData,{dom:i,text:s}=rZ(e,n.content());o?(t.preventDefault(),o.clearData(),o.setData("text/html",i.innerHTML),o.setData("text/plain",s)):function(e,t){if(!e.dom.parentNode)return;let n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),o=document.createRange();o.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}(e,i),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},r6.paste=(e,t)=>{if(e.composing&&!nX)return;let n=of?null:t.clipboardData,r=e.input.shiftKey&&45!=e.input.lastKeyCode;n&&om(e,og(n),n.getData("text/html"),r,t)?t.preventDefault():function(e,t){if(!e.dom.parentNode)return;let n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let o=e.input.shiftKey&&45!=e.input.lastKeyCode;setTimeout(()=>{e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?om(e,r.value,null,o,t):om(e,r.textContent,r.innerHTML,o,t)},50)}(e,t)};class ob{constructor(e,t,n){this.slice=e,this.move=t,this.node=n}}let oy=nK?"altKey":"ctrlKey";function ov(e,t){let n=e.someProp("dragCopies",e=>!e(t));return null!=n?n:!t[oy]}for(let e in r8.dragstart=(e,t)=>{let n,r=e.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let o=e.state.selection,i=o.empty?null:e.posAtCoords(or(t));if(i&&i.pos>=o.from&&i.pos<=(o instanceof tG?o.to-1:o.to));else if(r&&r.mightDrag)n=tG.create(e.state.doc,r.mightDrag.pos);else if(t.target&&1==t.target.nodeType){let r=e.docView.nearestDesc(t.target,!0);r&&r.node.type.spec.draggable&&r!=e.docView&&(n=tG.create(e.state.doc,r.posBefore))}let s=(n||e.state.selection).content(),{dom:l,text:a,slice:c}=rZ(e,s);t.dataTransfer.files.length&&nG&&!(nq>120)||t.dataTransfer.clearData(),t.dataTransfer.setData(of?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",of||t.dataTransfer.setData("text/plain",a),e.dragging=new ob(c,ov(e,t),n)},r8.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)},r6.dragover=r6.dragenter=(e,t)=>t.preventDefault(),r6.drop=(e,t)=>{try{!function(e,t,n){if(!t.dataTransfer)return;let r=e.posAtCoords(or(t));if(!r)return;let o=e.state.doc.resolve(r.pos),i=n&&n.slice;i?e.someProp("transformPasted",t=>{i=t(i,e,!1)}):i=rX(e,og(t.dataTransfer),of?null:t.dataTransfer.getData("text/html"),!1,o);let s=!!(n&&ov(e,t));if(e.someProp("handleDrop",n=>n(e,t,i||ek.empty,s)))return t.preventDefault();if(!i)return;t.preventDefault();let l=i?tx(e.state.doc,o.pos,i):o.pos;null==l&&(l=o.pos);let a=e.state.tr;if(s){let{node:e}=n;e?e.replace(a):a.deleteSelection()}let c=a.mapping.map(l),d=0==i.openStart&&0==i.openEnd&&1==i.content.childCount,u=a.doc;if(d?a.replaceRangeWith(c,c,i.content.firstChild):a.replaceRange(c,c,i),a.doc.eq(u))return;let h=a.doc.resolve(c);if(d&&tG.isSelectable(i.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(i.content.firstChild))a.setSelection(new tG(h));else{let t=a.mapping.map(l);a.mapping.maps[a.mapping.maps.length-1].forEach((e,n,r,o)=>t=o),a.setSelection(rL(e,h,a.doc.resolve(t)))}e.focus(),e.dispatch(a.setMeta("uiEvent","drop"))}(e,t,e.dragging)}finally{e.dragging=null}},r8.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&r_(e)},20))},r8.blur=(e,t)=>{e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),t.relatedTarget&&e.dom.contains(t.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},r8.beforeinput=(e,t)=>{if(nG&&nX&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:t}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=t||(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",t=>t(e,nR(8,"Backspace")))))return;let{$cursor:n}=e.state.selection;n&&n.pos>0&&e.dispatch(e.state.tr.delete(n.pos-1,n.pos).scrollIntoView())},50)}},r6)r8[e]=r6[e];function oE(e,t){if(e==t)return!0;for(let n in e)if(e[n]!==t[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}class ok{constructor(e,t){this.toDOM=e,this.spec=t||oS,this.side=this.spec.side||0}map(e,t,n,r){let{pos:o,deleted:i}=e.mapResult(t.from+r,this.side<0?-1:1);return i?null:new ow(o-n,o-n,this)}valid(){return!0}eq(e){return this==e||e instanceof ok&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&oE(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class oC{constructor(e,t){this.attrs=e,this.spec=t||oS}map(e,t,n,r){let o=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-n,i=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new ow(o,i,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof oC&&oE(this.attrs,e.attrs)&&oE(this.spec,e.spec)}static is(e){return e.type instanceof oC}destroy(){}}class oT{constructor(e,t){this.attrs=e,this.spec=t||oS}map(e,t,n,r){let o=e.mapResult(t.from+r,1);if(o.deleted)return null;let i=e.mapResult(t.to+r,-1);return i.deleted||i.pos<=o.pos?null:new ow(o.pos-n,i.pos-n,this)}valid(e,t){let{index:n,offset:r}=e.content.findIndex(t.from),o;return r==t.from&&!(o=e.child(n)).isText&&r+o.nodeSize==t.to}eq(e){return this==e||e instanceof oT&&oE(this.attrs,e.attrs)&&oE(this.spec,e.spec)}destroy(){}}class ow{constructor(e,t,n){this.from=e,this.to=t,this.type=n}copy(e,t){return new ow(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,n){return this.type.map(e,this,t,n)}static widget(e,t,n){return new ow(e,e,new ok(t,n))}static inline(e,t,n,r){return new ow(e,t,new oC(n,r))}static node(e,t,n,r){return new ow(e,t,new oT(n,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof oC}get widget(){return this.type instanceof ok}}let ox=[],oS={};class oA{constructor(e,t){this.local=e.length?e:ox,this.children=t.length?t:ox}static create(e,t){return t.length?oD(t,e,0,oS):o_}find(e,t,n){let r=[];return this.findInner(null==e?0:e,null==t?1e9:t,r,0,n),r}findInner(e,t,n,r,o){for(let i=0;i<this.local.length;i++){let s=this.local[i];s.from<=t&&s.to>=e&&(!o||o(s.spec))&&n.push(s.copy(s.from+r,s.to+r))}for(let i=0;i<this.children.length;i+=3)if(this.children[i]<t&&this.children[i+1]>e){let s=this.children[i]+1;this.children[i+2].findInner(e-s,t-s,n,r+s,o)}}map(e,t,n){return this==o_||0==e.maps.length?this:this.mapInner(e,t,0,0,n||oS)}mapInner(e,t,n,r,o){let i;for(let s=0;s<this.local.length;s++){let l=this.local[s].map(e,n,r);l&&l.type.valid(t,l)?(i||(i=[])).push(l):o.onRemove&&o.onRemove(this.local[s].spec)}return this.children.length?function(e,t,n,r,o,i,s){let l=e.slice();for(let e=0,t=i;e<n.maps.length;e++){let r=0;n.maps[e].forEach((e,n,o,i)=>{let s=i-o-(n-e);for(let o=0;o<l.length;o+=3){let i=l[o+1];if(i<0||e>i+t-r)continue;let a=l[o]+t-r;n>=a?l[o+1]=e<=a?-2:-1:e>=t&&s&&(l[o]+=s,l[o+1]+=s)}r+=s}),t=n.maps[e].map(t,-1)}let a=!1;for(let t=0;t<l.length;t+=3)if(l[t+1]<0){if(-2==l[t+1]){a=!0,l[t+1]=-1;continue}let c=n.map(e[t]+i),d=c-o;if(d<0||d>=r.content.size){a=!0;continue}let u=n.map(e[t+1]+i,-1)-o,{index:h,offset:p}=r.content.findIndex(d),f=r.maybeChild(h);if(f&&p==d&&p+f.nodeSize==u){let r=l[t+2].mapInner(n,f,c+1,e[t]+i+1,s);r!=o_?(l[t]=d,l[t+1]=u,l[t+2]=r):(l[t+1]=-2,a=!0)}else a=!0}if(a){let a=oD(function(e,t,n,r,o,i,s){for(let l=0;l<e.length;l+=3)-1==e[l+1]&&function e(t,i){for(let e=0;e<t.local.length;e++){let l=t.local[e].map(r,o,i);l?n.push(l):s.onRemove&&s.onRemove(t.local[e].spec)}for(let n=0;n<t.children.length;n+=3)e(t.children[n+2],t.children[n]+i+1)}(e[l+2],t[l]+i+1);return n}(l,e,t,n,o,i,s),r,0,s);t=a.local;for(let e=0;e<l.length;e+=3)l[e+1]<0&&(l.splice(e,3),e-=3);for(let e=0,t=0;e<a.children.length;e+=3){let n=a.children[e];for(;t<l.length&&l[t]<n;)t+=3;l.splice(t,0,a.children[e],a.children[e+1],a.children[e+2])}}return new oA(t.sort(oR),l)}(this.children,i||[],e,t,n,r,o):i?new oA(i.sort(oR),ox):o_}add(e,t){return t.length?this==o_?oA.create(e,t):this.addInner(e,t,0):this}addInner(e,t,n){let r,o=0;e.forEach((e,i)=>{let s=i+n,l;if(l=oI(t,e,s)){for(r||(r=this.children.slice());o<r.length&&r[o]<i;)o+=3;r[o]==i?r[o+2]=r[o+2].addInner(e,l,s+1):r.splice(o,0,i,i+e.nodeSize,oD(l,e,s+1,oS)),o+=3}});let i=oM(o?oO(t):t,-n);for(let t=0;t<i.length;t++)i[t].type.valid(e,i[t])||i.splice(t--,1);return new oA(i.length?this.local.concat(i).sort(oR):this.local,r||this.children)}remove(e){return 0==e.length||this==o_?this:this.removeInner(e,0)}removeInner(e,t){let n=this.children,r=this.local;for(let r=0;r<n.length;r+=3){let o,i=n[r]+t,s=n[r+1]+t;for(let t=0,n;t<e.length;t++)(n=e[t])&&n.from>i&&n.to<s&&(e[t]=null,(o||(o=[])).push(n));if(!o)continue;n==this.children&&(n=this.children.slice());let l=n[r+2].removeInner(o,i+1);l!=o_?n[r+2]=l:(n.splice(r,3),r-=3)}if(r.length){for(let n=0,o;n<e.length;n++)if(o=e[n])for(let e=0;e<r.length;e++)r[e].eq(o,t)&&(r==this.local&&(r=this.local.slice()),r.splice(e--,1))}return n==this.children&&r==this.local?this:r.length||n.length?new oA(r,n):o_}forChild(e,t){let n,r;if(this==o_)return this;if(t.isLeaf)return oA.empty;for(let t=0;t<this.children.length;t+=3)if(this.children[t]>=e){this.children[t]==e&&(n=this.children[t+2]);break}let o=e+1,i=o+t.content.size;for(let e=0;e<this.local.length;e++){let t=this.local[e];if(t.from<i&&t.to>o&&t.type instanceof oC){let e=Math.max(o,t.from)-o,n=Math.min(i,t.to)-o;e<n&&(r||(r=[])).push(t.copy(e,n))}}if(r){let e=new oA(r.sort(oR),ox);return n?new oN([e,n]):e}return n||o_}eq(e){if(this==e)return!0;if(!(e instanceof oA)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return oL(this.localsInner(e))}localsInner(e){if(this==o_)return ox;if(e.inlineContent||!this.local.some(oC.is))return this.local;let t=[];for(let e=0;e<this.local.length;e++)this.local[e].type instanceof oC||t.push(this.local[e]);return t}forEachSet(e){e(this)}}oA.empty=new oA([],[]),oA.removeOverlap=oL;let o_=oA.empty;class oN{constructor(e){this.members=e}map(e,t){let n=this.members.map(n=>n.map(e,t,oS));return oN.from(n)}forChild(e,t){if(t.isLeaf)return oA.empty;let n=[];for(let r=0;r<this.members.length;r++){let o=this.members[r].forChild(e,t);o!=o_&&(o instanceof oN?n=n.concat(o.members):n.push(o))}return oN.from(n)}eq(e){if(!(e instanceof oN)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,n=!0;for(let r=0;r<this.members.length;r++){let o=this.members[r].localsInner(e);if(o.length)if(t){n&&(t=t.slice(),n=!1);for(let e=0;e<o.length;e++)t.push(o[e])}else t=o}return t?oL(n?t:t.sort(oR)):ox}static from(e){switch(e.length){case 0:return o_;case 1:return e[0];default:return new oN(e.every(e=>e instanceof oA)?e:e.reduce((e,t)=>e.concat(t instanceof oA?t:t.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function oM(e,t){if(!t||!e.length)return e;let n=[];for(let r=0;r<e.length;r++){let o=e[r];n.push(new ow(o.from+t,o.to+t,o.type))}return n}function oI(e,t,n){if(t.isLeaf)return null;let r=n+t.nodeSize,o=null;for(let t=0,i;t<e.length;t++)(i=e[t])&&i.from>n&&i.to<r&&((o||(o=[])).push(i),e[t]=null);return o}function oO(e){let t=[];for(let n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function oD(e,t,n,r){let o=[],i=!1;t.forEach((t,s)=>{let l=oI(e,t,s+n);if(l){i=!0;let e=oD(l,t,n+s+1,r);e!=o_&&o.push(s,s+t.nodeSize,e)}});let s=oM(i?oO(e):e,-n).sort(oR);for(let e=0;e<s.length;e++)s[e].type.valid(t,s[e])||(r.onRemove&&r.onRemove(s[e].spec),s.splice(e--,1));return s.length||o.length?new oA(s,o):o_}function oR(e,t){return e.from-t.from||e.to-t.to}function oL(e){let t=e;for(let n=0;n<t.length-1;n++){let r=t[n];if(r.from!=r.to)for(let o=n+1;o<t.length;o++){let i=t[o];if(i.from==r.from){i.to!=r.to&&(t==e&&(t=e.slice()),t[o]=i.copy(i.from,r.to),oP(t,o+1,i.copy(r.to,i.to)));continue}i.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,i.from),oP(t,o,r.copy(i.from,r.to)));break}}return t}function oP(e,t,n){for(;t<e.length&&oR(n,e[t])>0;)t++;e.splice(t,0,n)}function oB(e){let t=[];return e.someProp("decorations",n=>{let r=n(e.state);r&&r!=o_&&t.push(r)}),e.cursorWrapper&&t.push(oA.create(e.state.doc,[e.cursorWrapper.deco])),oN.from(t)}let oH={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},oj=nU&&nz<=11;class oF{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class oU{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new oF,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(e=>{for(let t=0;t<e.length;t++)this.queue.push(e[t]);nU&&nz<=11&&e.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():this.flush()}),oj&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,oH)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(rP(this.view)){if(this.suppressingSelectionUpdates)return r_(this.view);if(nU&&nz<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&n_(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,n;for(let n=e.focusNode;n;n=nw(n))t.add(n);for(let r=e.anchorNode;r;r=nw(r))if(t.has(r)){n=r;break}let r=n&&this.view.docView.nearestDesc(n);if(r&&r.ignoreMutation({type:"selection",target:3==n.nodeType?n.parentNode:n}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){var e;let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=t.domSelectionRange(),o=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&rP(t)&&!this.ignoreSelectionChange(r),i=-1,s=-1,l=!1,a=[];if(t.editable)for(let e=0;e<n.length;e++){let t=this.registerMutation(n[e],a);t&&(i=i<0?t.from:Math.min(t.from,i),s=s<0?t.to:Math.max(t.to,s),t.typeOver&&(l=!0))}if(nV&&a.length){let e=a.filter(e=>"BR"==e.nodeName);if(2==e.length){let[t,n]=e;t.parentNode&&t.parentNode.parentNode==n.parentNode?n.remove():t.remove()}else{let{focusNode:n}=this.currentSelection;for(let r of e){let e=r.parentNode;e&&"LI"==e.nodeName&&(!n||function(e,t){for(let n=t.parentNode;n&&n!=e.dom;n=n.parentNode){let t=e.docView.nearestDesc(n,!0);if(t&&t.node.isBlock)return n}return null}(t,n)!=e)&&r.remove()}}}else if((nG||nW)&&a.some(e=>"BR"==e.nodeName)&&(8==t.input.lastKeyCode||46==t.input.lastKeyCode)){for(let e of a)if("BR"==e.nodeName&&e.parentNode){let t=e.nextSibling;t&&1==t.nodeType&&"false"==t.contentEditable&&e.parentNode.removeChild(e)}}let c=null;i<0&&o&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&nD(r)&&(c=rS(t))&&c.eq(tj.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,r_(t),this.currentSelection.set(r),t.scrollToSelection()):(i>-1||o)&&(i>-1&&(t.docView.markDirty(i,s),e=t,!oz.has(e)&&(oz.set(e,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace))&&(e.requiresGeckoHackNode=nV,oV||(console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),oV=!0))),this.handleDOMChange(i,s,l,a),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(r)||r_(t),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style"))||!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(let n=0;n<e.addedNodes.length;n++){let r=e.addedNodes[n];t.push(r),3==r.nodeType&&(this.lastChangedTextNode=r)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let r=e.previousSibling,o=e.nextSibling;if(nU&&nz<=11&&e.addedNodes.length)for(let t=0;t<e.addedNodes.length;t++){let{previousSibling:n,nextSibling:i}=e.addedNodes[t];(!n||0>Array.prototype.indexOf.call(e.addedNodes,n))&&(r=n),(!i||0>Array.prototype.indexOf.call(e.addedNodes,i))&&(o=i)}let i=r&&r.parentNode==e.target?nT(r)+1:0,s=n.localPosFromDOM(e.target,i,-1),l=o&&o.parentNode==e.target?nT(o):e.target.childNodes.length;return{from:s,to:n.localPosFromDOM(e.target,l,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let oz=new WeakMap,oV=!1;function o$(e,t){let n=t.startContainer,r=t.startOffset,o=t.endContainer,i=t.endOffset,s=e.domAtPos(e.state.selection.anchor);return n_(s.node,s.offset,o,i)&&([n,r,o,i]=[o,i,n,r]),{anchorNode:n,anchorOffset:r,focusNode:o,focusOffset:i}}function oG(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(nW&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}else if(e.parentNode.lastChild==e||nW&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}let oq=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function oW(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:rL(e,t.resolve(n.anchor),t.resolve(n.head))}function oY(e,t,n){let r=e.depth,o=t?e.end():e.pos;for(;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,o++,t=!1;if(n){let t=e.node(r).maybeChild(e.indexAfter(r));for(;t&&!t.isLeaf;)t=t.firstChild,o++}return o}function oK(e){if(2!=e.length)return!1;let t=e.charCodeAt(0),n=e.charCodeAt(1);return t>=56320&&t<=57343&&n>=55296&&n<=56319}class oZ{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new r7,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(o1),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=oJ(this),oQ(this),this.nodeViews=o0(this),this.docView=rh(this.state.doc,oX(this),oB(this),this.dom,this),this.domObserver=new oU(this,(e,t,n,r)=>(function(e,t,n,r,o){let i,s,l,a=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let t=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,n=rS(e,t);if(n&&!e.state.selection.eq(n)){if(nG&&nX&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",t=>t(e,nR(13,"Enter"))))return;let r=e.state.tr.setSelection(n);"pointer"==t?r.setMeta("pointer",!0):"key"==t&&r.scrollIntoView(),a&&r.setMeta("composition",a),e.dispatch(r)}return}let c=e.state.doc.resolve(t),d=c.sharedDepth(n);t=c.before(d+1),n=e.state.doc.resolve(n).after(d+1);let u=e.state.selection,h=function(e,t,n){let r,{node:o,fromOffset:i,toOffset:s,from:l,to:a}=e.docView.parseRange(t,n),c=e.domSelectionRange(),d=c.anchorNode;if(d&&e.dom.contains(1==d.nodeType?d:d.parentNode)&&(r=[{node:d,offset:c.anchorOffset}],nD(c)||r.push({node:c.focusNode,offset:c.focusOffset})),nG&&8===e.input.lastKeyCode)for(let e=s;e>i;e--){let t=o.childNodes[e-1],n=t.pmViewDesc;if("BR"==t.nodeName&&!n){s=e;break}if(!n||n.size)break}let u=e.state.doc,h=e.someProp("domParser")||eX.fromSchema(e.state.schema),p=u.resolve(l),f=null,m=h.parse(o,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:i,to:s,preserveWhitespace:"pre"!=p.parent.type.whitespace||"full",findPositions:r,ruleFromNode:oG,context:p});if(r&&null!=r[0].pos){let e=r[0].pos,t=r[1]&&r[1].pos;null==t&&(t=e),f={anchor:e+l,head:t+l}}return{doc:m,sel:f,from:l,to:a}}(e,t,n),p=e.state.doc,f=p.slice(h.from,h.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(i=e.state.selection.to,s="end"):(i=e.state.selection.from,s="start"),e.input.lastKeyCode=null;let m=function(e,t,n,r,o){let i=e.findDiffStart(t,n);if(null==i)return null;let{a:s,b:l}=e.findDiffEnd(t,n+e.size,n+t.size);if("end"==o){let e=Math.max(0,i-Math.min(s,l));r-=s+e-i}if(s<i&&e.size<t.size){let e=r<=i&&r>=s?i-r:0;(i-=e)&&i<t.size&&oK(t.textBetween(i-1,i+1))&&(i+=e?1:-1),l=i+(l-s),s=i}else if(l<i){let t=r<=i&&r>=l?i-r:0;(i-=t)&&i<e.size&&oK(e.textBetween(i-1,i+1))&&(i+=t?1:-1),s=i+(s-l),l=i}return{start:i,endA:s,endB:l}}(f.content,h.doc.content,h.from,i,s);if(m&&e.input.domChangeCount++,(nY&&e.input.lastIOSEnter>Date.now()-225||nX)&&o.some(e=>1==e.nodeType&&!oq.test(e.nodeName))&&(!m||m.endA>=m.endB)&&e.someProp("handleKeyDown",t=>t(e,nR(13,"Enter")))){e.input.lastIOSEnter=0;return}if(!m)if(r&&u instanceof tV&&!u.empty&&u.$head.sameParent(u.$anchor)&&!e.composing&&!(h.sel&&h.sel.anchor!=h.sel.head))m={start:u.from,endA:u.to,endB:u.to};else{if(h.sel){let t=oW(e,e.state.doc,h.sel);if(t&&!t.eq(e.state.selection)){let n=e.state.tr.setSelection(t);a&&n.setMeta("composition",a),e.dispatch(n)}}return}e.state.selection.from<e.state.selection.to&&m.start==m.endB&&e.state.selection instanceof tV&&(m.start>e.state.selection.from&&m.start<=e.state.selection.from+2&&e.state.selection.from>=h.from?m.start=e.state.selection.from:m.endA<e.state.selection.to&&m.endA>=e.state.selection.to-2&&e.state.selection.to<=h.to&&(m.endB+=e.state.selection.to-m.endA,m.endA=e.state.selection.to)),nU&&nz<=11&&m.endB==m.start+1&&m.endA==m.start&&m.start>h.from&&" "==h.doc.textBetween(m.start-h.from-1,m.start-h.from+1)&&(m.start--,m.endA--,m.endB--);let g=h.doc.resolveNoCache(m.start-h.from),b=h.doc.resolveNoCache(m.endB-h.from),y=p.resolve(m.start),v=g.sameParent(b)&&g.parent.inlineContent&&y.end()>=m.endA;if((nY&&e.input.lastIOSEnter>Date.now()-225&&(!v||o.some(e=>"DIV"==e.nodeName||"P"==e.nodeName))||!v&&g.pos<h.doc.content.size&&(!g.sameParent(b)||!g.parent.inlineContent)&&g.pos<b.pos&&!/\S/.test(h.doc.textBetween(g.pos,b.pos,"","")))&&e.someProp("handleKeyDown",t=>t(e,nR(13,"Enter")))){e.input.lastIOSEnter=0;return}if(e.state.selection.anchor>m.start&&function(e,t,n,r,o){if(n-t<=o.pos-r.pos||oY(r,!0,!1)<o.pos)return!1;let i=e.resolve(t);if(!r.parent.isTextblock){let e=i.nodeAfter;return null!=e&&n==t+e.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let s=e.resolve(oY(i,!0,!0));return!(!s.parent.isTextblock||s.pos>n||oY(s,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(s.parent.content)}(p,m.start,m.endA,g,b)&&e.someProp("handleKeyDown",t=>t(e,nR(8,"Backspace")))){nX&&nG&&e.domObserver.suppressSelectionUpdates();return}nG&&m.endB==m.start&&(e.input.lastChromeDelete=Date.now()),nX&&!v&&g.start()!=b.start()&&0==b.parentOffset&&g.depth==b.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==m.endA&&(m.endB-=2,b=h.doc.resolveNoCache(m.endB-h.from),setTimeout(()=>{e.someProp("handleKeyDown",function(t){return t(e,nR(13,"Enter"))})},20));let E=m.start,k=m.endA,C=t=>{let n=t||e.state.tr.replace(E,k,h.doc.slice(m.start-h.from,m.endB-h.from));if(h.sel){let t=oW(e,n.doc,h.sel);t&&!(nG&&e.composing&&t.empty&&(m.start!=m.endB||e.input.lastChromeDelete<Date.now()-100)&&(t.head==E||t.head==n.mapping.map(k)-1)||nU&&t.empty&&t.head==E)&&n.setSelection(t)}return a&&n.setMeta("composition",a),n.scrollIntoView()};if(v)if(g.pos==b.pos){nU&&nz<=11&&0==g.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>r_(e),20));let t=C(e.state.tr.delete(E,k)),n=p.resolve(m.start).marksAcross(p.resolve(m.endA));n&&t.ensureMarks(n),e.dispatch(t)}else if(m.endA==m.endB&&(l=function(e,t){let n=e.firstChild.marks,r=t.firstChild.marks,o=n,i=r,s,l,a;for(let e=0;e<r.length;e++)o=r[e].removeFromSet(o);for(let e=0;e<n.length;e++)i=n[e].removeFromSet(i);if(1==o.length&&0==i.length)l=o[0],s="add",a=e=>e.mark(l.addToSet(e.marks));else{if(0!=o.length||1!=i.length)return null;l=i[0],s="remove",a=e=>e.mark(l.removeFromSet(e.marks))}let c=[];for(let e=0;e<t.childCount;e++)c.push(a(t.child(e)));if(em.from(c).eq(e))return{mark:l,type:s}}(g.parent.content.cut(g.parentOffset,b.parentOffset),y.parent.content.cut(y.parentOffset,m.endA-y.start())))){let t=C(e.state.tr);"add"==l.type?t.addMark(E,k,l.mark):t.removeMark(E,k,l.mark),e.dispatch(t)}else if(g.parent.child(g.index()).isText&&g.index()==b.index()-!b.textOffset){let t=g.parent.textBetween(g.parentOffset,b.parentOffset),n=()=>C(e.state.tr.insertText(t,E,k));e.someProp("handleTextInput",r=>r(e,E,k,t,n))||e.dispatch(n())}else e.dispatch(C());else e.dispatch(C())})(this,e,t,n,r)),this.domObserver.start(),function(e){for(let t in r8){let n=r8[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=t=>{!function(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}(e,t)||on(e,t)||!e.editable&&t.type in r6||n(e,t)},r9[t]?{passive:!0}:void 0)}nW&&e.dom.addEventListener("input",()=>null),ot(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;for(let t in this._props={},e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&ot(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(o1),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let e in this._props)t[e]=this._props[e];for(let n in t.state=this.state,e)t[n]=e[n];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var n,r,o;let i=this.state,s=!1,l=!1;e.storedMarks&&this.composing&&(oh(this),l=!0),this.state=e;let a=i.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let e=o0(this);(function(e,t){let n=0,r=0;for(let r in e){if(e[r]!=t[r])return!0;n++}for(let e in t)r++;return n!=r})(e,this.nodeViews)&&(this.nodeViews=e,s=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&ot(this),this.editable=oJ(this),oQ(this);let c=oB(this),d=oX(this),u=i.plugins==e.plugins||i.doc.eq(e.doc)?e.scrollToSelection>i.scrollToSelection?"to selection":"preserve":"reset",h=s||!this.docView.matchesNode(e.doc,d,c);(h||!e.selection.eq(i.selection))&&(l=!0);let p="preserve"==u&&l&&null==this.dom.style.overflowAnchor&&function(e){let t,n,r=e.dom.getBoundingClientRect(),o=Math.max(0,r.top);for(let i=(r.left+r.right)/2,s=o+1;s<Math.min(innerHeight,r.bottom);s+=5){let r=e.root.elementFromPoint(i,s);if(!r||r==e.dom||!e.dom.contains(r))continue;let l=r.getBoundingClientRect();if(l.top>=o-20){t=r,n=l.top;break}}return{refDOM:t,refTop:n,stack:n2(e.dom)}}(this);if(l){let t,n,l;this.domObserver.stop();let a=h&&(nU||nG)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&(r=i.selection,o=e.selection,l=Math.min(r.$anchor.sharedDepth(r.head),o.$anchor.sharedDepth(o.head)),r.$anchor.start(l)!=o.$anchor.start(l));if(h){let t=nG?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=function(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let n=function(e,t){for(;;){if(3==e.nodeType&&t)return e;if(1==e.nodeType&&t>0){if("false"==e.contentEditable)return null;t=nI(e=e.childNodes[t-1])}else{if(!e.parentNode||nO(e))return null;t=nT(e),e=e.parentNode}}}(t.focusNode,t.focusOffset),r=function(e,t){for(;;){if(3==e.nodeType&&t<e.nodeValue.length)return e;if(1==e.nodeType&&t<e.childNodes.length){if("false"==e.contentEditable)return null;e=e.childNodes[t],t=0}else{if(!e.parentNode||nO(e))return null;t=nT(e)+1,e=e.parentNode}}}(t.focusNode,t.focusOffset);if(n&&r&&n!=r){let t=r.pmViewDesc,o=e.domObserver.lastChangedTextNode;if(n==o||r==o)return o;if(!t||!t.isText(r.nodeValue))return r;if(e.input.compositionNode==r){let e=n.pmViewDesc;if(!(!e||!e.isText(n.nodeValue)))return r}}return n||r}(this)),(s||!this.docView.update(e.doc,d,c,this))&&(this.docView.updateOuterDeco(d),this.docView.destroy(),this.docView=rh(e.doc,d,c,this.dom,this)),t&&!this.trackWrites&&(a=!0)}a||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&(t=this.docView.domFromPos(this.state.selection.anchor,0),n=this.domSelectionRange(),n_(t.node,t.offset,n.anchorNode,n.anchorOffset)))?r_(this,a):(rD(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),(null==(n=this.dragging)?void 0:n.node)&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),"reset"==u?this.dom.scrollTop=0:"to selection"==u?this.scrollToSelection():p&&function({refDOM:e,refTop:t,stack:n}){let r=e?e.getBoundingClientRect().top:0;n4(n,0==r?0:r-t)}(p)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(e&&this.dom.contains(1==e.nodeType?e:e.parentNode))if(this.someProp("handleScrollToSelection",e=>e(this)));else if(this.state.selection instanceof tG){let t=this.docView.domAfterPos(this.state.selection.from);1==t.nodeType&&n1(this,t.getBoundingClientRect(),e)}else n1(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let t=0;t<this.pluginViews.length;t++){let n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let t=this.directPlugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let t=this.state.plugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}}}updateDraggedNode(e,t){let n=e.node,r=-1;if(this.state.doc.nodeAt(n.from)==n.node)r=n.from;else{let e=n.from+(this.state.doc.content.size-t.doc.content.size);(e>0&&this.state.doc.nodeAt(e))==n.node&&(r=e)}this.dragging=new ob(e.slice,e.move,r<0?void 0:tG.create(this.state.doc,r))}someProp(e,t){let n=this._props&&this._props[e],r;if(null!=n&&(r=t?t(n):n))return r;for(let n=0;n<this.directPlugins.length;n++){let o=this.directPlugins[n].props[e];if(null!=o&&(r=t?t(o):o))return r}let o=this.state.plugins;if(o)for(let n=0;n<o.length;n++){let i=o[n].props[e];if(null!=i&&(r=t?t(i):i))return r}}hasFocus(){if(nU){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(n5)return e.focus(n5);let t=n2(e);e.focus(null==n5?{get preventScroll(){return n5={preventScroll:!0},!0}}:void 0),n5||(n5=!1,n4(t,0))}(this.dom),r_(this),this.domObserver.start()}get root(){let e=this._root;if(null==e){for(let e=this.dom.parentNode;e;e=e.parentNode)if(9==e.nodeType||11==e.nodeType&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e}return e||document}updateRoot(){this._root=null}posAtCoords(e){return function(e,t){var n;let r,o,i=e.dom.ownerDocument,s,l=0,a=function(e,t,n){if(e.caretPositionFromPoint)try{let r=e.caretPositionFromPoint(t,n);if(r)return{node:r.offsetNode,offset:Math.min(nI(r.offsetNode),r.offset)}}catch(e){}if(e.caretRangeFromPoint){let r=e.caretRangeFromPoint(t,n);if(r)return{node:r.startContainer,offset:Math.min(nI(r.startContainer),r.startOffset)}}}(i,t.left,t.top);a&&({node:s,offset:l}=a);let c=(e.root.elementFromPoint?e.root:i).elementFromPoint(t.left,t.top);if(!c||!e.dom.contains(1!=c.nodeType?c.parentNode:c)){let n=e.dom.getBoundingClientRect();if(!n3(t,n)||!(c=function e(t,n,r){let o=t.childNodes.length;if(o&&r.top<r.bottom)for(let i=Math.max(0,Math.min(o-1,Math.floor(o*(n.top-r.top)/(r.bottom-r.top))-2)),s=i;;){let r=t.childNodes[s];if(1==r.nodeType){let t=r.getClientRects();for(let o=0;o<t.length;o++){let i=t[o];if(n3(n,i))return e(r,n,i)}}if((s=(s+1)%o)==i)break}return t}(e.dom,t,n)))return null}if(nW)for(let e=c;s&&e;e=nw(e))e.draggable&&(s=void 0);if(c=(r=(n=c).parentNode)&&/^li$/i.test(r.nodeName)&&t.left<n.getBoundingClientRect().left?r:n,s){let n;if(nV&&1==s.nodeType&&(l=Math.min(l,s.childNodes.length))<s.childNodes.length){let e=s.childNodes[l],n;"IMG"==e.nodeName&&(n=e.getBoundingClientRect()).right<=t.left&&n.bottom>t.top&&l++}nQ&&l&&1==s.nodeType&&1==(n=s.childNodes[l-1]).nodeType&&"false"==n.contentEditable&&n.getBoundingClientRect().top>=t.top&&l--,s==e.dom&&l==s.childNodes.length-1&&1==s.lastChild.nodeType&&t.top>s.lastChild.getBoundingClientRect().bottom?o=e.state.doc.content.size:(0==l||1!=s.nodeType||"BR"!=s.childNodes[l-1].nodeName)&&(o=function(e,t,n,r){let o=-1;for(let n=t,i=!1;n!=e.dom;){let t=e.docView.nearestDesc(n,!0),s;if(!t)return null;if(1==t.dom.nodeType&&(t.node.isBlock&&t.parent||!t.contentDOM)&&((s=t.dom.getBoundingClientRect()).width||s.height)&&(t.node.isBlock&&t.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(t.dom.nodeName)&&(!i&&s.left>r.left||s.top>r.top?o=t.posBefore:(!i&&s.right<r.left||s.bottom<r.top)&&(o=t.posAfter),i=!0),!t.contentDOM&&o<0&&!t.node.isText))return(t.node.isBlock?r.top<(s.top+s.bottom)/2:r.left<(s.left+s.right)/2)?t.posBefore:t.posAfter;n=t.dom.parentNode}return o>-1?o:e.docView.posFromDOM(t,n,-1)}(e,s,l,t))}null==o&&(o=function(e,t,n){let{node:r,offset:o}=function e(t,n){let r,o,i,s=2e8,l,a=0,c=n.top,d=n.top;for(let e=t.firstChild,u=0;e;e=e.nextSibling,u++){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=nS(e).getClientRects()}for(let h=0;h<t.length;h++){let p=t[h];if(p.top<=c&&p.bottom>=d){c=Math.max(p.bottom,c),d=Math.min(p.top,d);let t=p.left>n.left?p.left-n.left:p.right<n.left?n.left-p.right:0;if(t<s){i=e,s=t,l=t&&3==i.nodeType?{left:p.right<n.left?p.right:p.left,top:n.top}:n,1==e.nodeType&&t&&(a=u+ +(n.left>=(p.left+p.right)/2));continue}}else p.top>n.top&&!r&&p.left<=n.left&&p.right>=n.left&&(r=e,o={left:Math.max(p.left,Math.min(p.right,n.left)),top:p.top});!i&&(n.left>=p.right&&n.top>=p.top||n.left>=p.left&&n.top>=p.bottom)&&(a=u+1)}}return(!i&&r&&(i=r,l=o,s=0),i&&3==i.nodeType)?function(e,t){let n=e.nodeValue.length,r=document.createRange(),o;for(let i=0;i<n;i++){r.setEnd(e,i+1),r.setStart(e,i);let n=n6(r,1);if(n.top!=n.bottom&&n3(t,n)){o={node:e,offset:i+ +(t.left>=(n.left+n.right)/2)};break}}return r.detach(),o||{node:e,offset:0}}(i,l):!i||s&&1==i.nodeType?{node:t,offset:a}:e(i,l)}(t,n),i=-1;if(1==r.nodeType&&!r.firstChild){let e=r.getBoundingClientRect();i=e.left!=e.right&&n.left>(e.left+e.right)/2?1:-1}return e.docView.posFromDOM(r,o,i)}(e,c,t));let d=e.docView.nearestDesc(c,!0);return{pos:o,inside:d?d.posAtStart-d.border:-1}}(this,e)}coordsAtPos(e,t=1){return n7(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,n=-1){let r=this.docView.posFromDOM(e,t,n);if(null==r)throw RangeError("DOM position not inside the editor");return r}endOfTextblock(e,t){return function(e,t,n){let r,o;return ro==t&&ri==n?rs:(ro=t,ri=n,rs="up"==n||"down"==n?(r=t.selection,o="up"==n?r.$from:r.$to,rn(e,t,()=>{let{node:t}=e.docView.domFromPos(o.pos,"up"==n?-1:1);for(;;){let n=e.docView.nearestDesc(t,!0);if(!n)break;if(n.node.isBlock){t=n.contentDOM||n.dom;break}t=n.dom.parentNode}let r=n7(e,o.pos,1);for(let e=t.firstChild;e;e=e.nextSibling){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=nS(e,0,e.nodeValue.length).getClientRects()}for(let e=0;e<t.length;e++){let o=t[e];if(o.bottom>o.top+1&&("up"==n?r.top-o.top>(o.bottom-r.top)*2:o.bottom-r.bottom>(r.bottom-o.top)*2))return!1}}return!0})):function(e,t,n){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let o=r.parentOffset,i=o==r.parent.content.size,s=e.domSelection();return s?rr.test(r.parent.textContent)&&s.modify?rn(e,t,()=>{let{focusNode:t,focusOffset:o,anchorNode:i,anchorOffset:l}=e.domSelectionRange(),a=s.caretBidiLevel;s.modify("move",n,"character");let c=r.depth?e.docView.domAfterPos(r.before()):e.dom,{focusNode:d,focusOffset:u}=e.domSelectionRange(),h=d&&!c.contains(1==d.nodeType?d:d.parentNode)||t==d&&o==u;try{s.collapse(i,l),t&&(t!=i||o!=l)&&s.extend&&s.extend(t,o)}catch(e){}return null!=a&&(s.caretBidiLevel=a),h}):"left"==n||"backward"==n?!o:i:r.pos==r.start()||r.pos==r.end()}(e,t,n))}(this,t||this.state,e)}pasteHTML(e,t){return om(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return om(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return rZ(this,e)}destroy(){if(this.docView){for(let e in this.domObserver.stop(),this.input.eventHandlers)this.dom.removeEventListener(e,this.input.eventHandlers[e]);clearTimeout(this.input.composingTimeout),clearTimeout(this.input.lastIOSEnterFallbackTimeout),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],oB(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,nA()}}get isDestroyed(){return null==this.docView}dispatchEvent(e){!on(this,e)&&r8[e.type]&&(this.editable||!(e.type in r6))&&r8[e.type](this,e)}domSelectionRange(){let e=this.domSelection();return e?nW&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom&&function(e,t){let n;if(t.getComposedRanges){let n=t.getComposedRanges(e.root)[0];if(n)return o$(e,n)}function r(e){e.preventDefault(),e.stopImmediatePropagation(),n=e.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",r,!0),n?o$(e,n):null}(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function oX(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",n=>{if("function"==typeof n&&(n=n(e.state)),n)for(let e in n)"class"==e?t.class+=" "+n[e]:"style"==e?t.style=(t.style?t.style+";":"")+n[e]:t[e]||"contenteditable"==e||"nodeName"==e||(t[e]=String(n[e]))}),t.translate||(t.translate="no"),[ow.node(0,e.state.doc.content.size,t)]}function oQ(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:ow.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function oJ(e){return!e.someProp("editable",t=>!1===t(e.state))}function o0(e){let t=Object.create(null);function n(e){for(let n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function o1(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw RangeError("Plugins passed directly to the view must not have a state component")}oZ.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};for(var o2={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},o4={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},o5="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),o3="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),o8=0;o8<10;o8++)o2[48+o8]=o2[96+o8]=String(o8);for(var o8=1;o8<=24;o8++)o2[o8+111]="F"+o8;for(var o8=65;o8<=90;o8++)o2[o8]=String.fromCharCode(o8+32),o4[o8]=String.fromCharCode(o8);for(var o6 in o2)o4.hasOwnProperty(o6)||(o4[o6]=o2[o6]);let o9="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),o7="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function ie(e,t,n=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n&&t.shiftKey&&(e="Shift-"+e),e}function it(e){return new t4({props:{handleKeyDown:ir(e)}})}function ir(e){let t=function(e){let t=Object.create(null);for(let n in e)t[function(e){let t,n,r,o,i=e.split(/-(?!$)/),s=i[i.length-1];"Space"==s&&(s=" ");for(let e=0;e<i.length-1;e++){let s=i[e];if(/^(cmd|meta|m)$/i.test(s))o=!0;else if(/^a(lt)?$/i.test(s))t=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else if(/^s(hift)?$/i.test(s))r=!0;else if(/^mod$/i.test(s))o9?o=!0:n=!0;else throw Error("Unrecognized modifier name: "+s)}return t&&(s="Alt-"+s),n&&(s="Ctrl-"+s),o&&(s="Meta-"+s),r&&(s="Shift-"+s),s}(n)]=e[n];return t}(e);return function(e,n){var r;let o=("Esc"==(r=!(o5&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||o3&&n.shiftKey&&n.key&&1==n.key.length||"Unidentified"==n.key)&&n.key||(n.shiftKey?o4:o2)[n.keyCode]||n.key||"Unidentified")&&(r="Escape"),"Del"==r&&(r="Delete"),"Left"==r&&(r="ArrowLeft"),"Up"==r&&(r="ArrowUp"),"Right"==r&&(r="ArrowRight"),"Down"==r&&(r="ArrowDown"),r),i,s=t[ie(o,n)];if(s&&s(e.state,e.dispatch,e))return!0;if(1==o.length&&" "!=o){if(n.shiftKey){let r=t[ie(o,n,!1)];if(r&&r(e.state,e.dispatch,e))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(o7&&n.ctrlKey&&n.altKey)&&(i=o2[n.keyCode])&&i!=o){let r=t[ie(i,n)];if(r&&r(e.state,e.dispatch,e))return!0}}return!1}}var io=Object.defineProperty,ii=(e,t)=>{for(var n in t)io(e,n,{get:t[n],enumerable:!0})};function is(e){let{state:t,transaction:n}=e,{selection:r}=n,{doc:o}=n,{storedMarks:i}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return i},get selection(){return r},get doc(){return o},get tr(){return r=n.selection,o=n.doc,i=n.storedMarks,n}}}var il=class{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){let{rawCommands:e,editor:t,state:n}=this,{view:r}=t,{tr:o}=n,i=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([e,t])=>[e,(...e)=>{let n=t(...e)(i);return o.getMeta("preventDispatch")||this.hasCustomState||r.dispatch(o),n}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){let{rawCommands:n,editor:r,state:o}=this,{view:i}=r,s=[],l=!!e,a=e||o.tr,c=()=>(l||!t||a.getMeta("preventDispatch")||this.hasCustomState||i.dispatch(a),s.every(e=>!0===e)),d={...Object.fromEntries(Object.entries(n).map(([e,n])=>[e,(...e)=>{let r=this.buildProps(a,t),o=n(...e)(r);return s.push(o),d}])),run:c};return d}createCan(e){let{rawCommands:t,state:n}=this,r=e||n.tr,o=this.buildProps(r,!1);return{...Object.fromEntries(Object.entries(t).map(([e,t])=>[e,(...e)=>t(...e)({...o,dispatch:void 0})])),chain:()=>this.createChain(r,!1)}}buildProps(e,t=!0){let{rawCommands:n,editor:r,state:o}=this,{view:i}=r,s={tr:e,editor:r,view:i,state:is({state:o,transaction:e}),dispatch:t?()=>void 0:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(([e,t])=>[e,(...e)=>t(...e)(s)]))}};return s}},ia={};ii(ia,{blur:()=>ic,clearContent:()=>id,clearNodes:()=>iu,command:()=>ih,createParagraphNear:()=>ip,cut:()=>im,deleteCurrentNode:()=>ig,deleteNode:()=>iy,deleteRange:()=>iv,deleteSelection:()=>iE,enter:()=>ik,exitCode:()=>iC,extendMarkRange:()=>iN,first:()=>iM,focus:()=>iP,forEach:()=>iB,insertContent:()=>iH,insertContentAt:()=>iV,joinBackward:()=>iq,joinDown:()=>iG,joinForward:()=>iW,joinItemBackward:()=>iY,joinItemForward:()=>iK,joinTextblockBackward:()=>iZ,joinTextblockForward:()=>iX,joinUp:()=>i$,keyboardShortcut:()=>iJ,lift:()=>i1,liftEmptyBlock:()=>i2,liftListItem:()=>i4,newlineInCode:()=>i5,resetAttributes:()=>i6,scrollIntoView:()=>i9,selectAll:()=>i7,selectNodeBackward:()=>se,selectNodeForward:()=>st,selectParentNode:()=>sn,selectTextblockEnd:()=>sr,selectTextblockStart:()=>so,setContent:()=>ss,setMark:()=>sV,setMeta:()=>s$,setNode:()=>sG,setNodeSelection:()=>sq,setTextDirection:()=>sW,setTextSelection:()=>sY,sinkListItem:()=>sK,splitBlock:()=>sX,splitListItem:()=>sQ,toggleList:()=>s1,toggleMark:()=>s2,toggleNode:()=>s4,toggleWrap:()=>s5,undoInputRule:()=>s3,unsetAllMarks:()=>s8,unsetMark:()=>s6,unsetTextDirection:()=>s9,updateAttributes:()=>s7,wrapIn:()=>le,wrapInList:()=>lt});var ic=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),null==(n=null==window?void 0:window.getSelection())||n.removeAllRanges())}),!0),id=(e=!0)=>({commands:t})=>t.setContent("",{emitUpdate:e}),iu=()=>({state:e,tr:t,dispatch:n})=>{let{selection:r}=t,{ranges:o}=r;return!n||(o.forEach(({$from:n,$to:r})=>{e.doc.nodesBetween(n.pos,r.pos,(e,n)=>{if(e.type.isText)return;let{doc:r,mapping:o}=t,i=r.resolve(o.map(n)),s=r.resolve(o.map(n+e.nodeSize)),l=i.blockRange(s);if(!l)return;let a=tg(l);if(e.type.isTextblock){let{defaultType:e}=i.parent.contentMatchAt(i.index());t.setNodeMarkup(l.start,e)}(a||0===a)&&t.lift(l,a)})}),!0)},ih=e=>t=>e(t),ip=()=>({state:e,dispatch:t})=>nu(e,t),im=(e,t)=>({editor:n,tr:r})=>{let{state:o}=n,i=o.doc.slice(e.from,e.to);r.deleteRange(e.from,e.to);let s=r.mapping.map(t);return r.insert(s,i.content),r.setSelection(new tV(r.doc.resolve(Math.max(s-1,0)))),!0},ig=()=>({tr:e,dispatch:t})=>{let{selection:n}=e,r=n.$anchor.node();if(r.content.size>0)return!1;let o=e.selection.$anchor;for(let n=o.depth;n>0;n-=1)if(o.node(n).type===r.type){if(t){let t=o.before(n),r=o.after(n);e.delete(t,r).scrollIntoView()}return!0}return!1};function ib(e,t){if("string"==typeof e){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}var iy=e=>({tr:t,state:n,dispatch:r})=>{let o=ib(e,n.schema),i=t.selection.$anchor;for(let e=i.depth;e>0;e-=1)if(i.node(e).type===o){if(r){let n=i.before(e),r=i.after(e);t.delete(n,r).scrollIntoView()}return!0}return!1},iv=e=>({tr:t,dispatch:n})=>{let{from:r,to:o}=e;return n&&t.delete(r,o),!0},iE=()=>({state:e,dispatch:t})=>t6(e,t),ik=()=>({commands:e})=>e.keyboardShortcut("Enter"),iC=()=>({state:e,dispatch:t})=>nd(e,t);function iT(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function iw(e,t,n={strict:!0}){let r=Object.keys(t);return!r.length||r.every(r=>n.strict?t[r]===e[r]:iT(t[r])?t[r].test(e[r]):t[r]===e[r])}function ix(e,t,n={}){return e.find(e=>e.type===t&&iw(Object.fromEntries(Object.keys(n).map(t=>[t,e.attrs[t]])),n))}function iS(e,t,n={}){return!!ix(e,t,n)}function iA(e,t,n){var r;if(!e||!t)return;let o=e.parent.childAfter(e.parentOffset);if(o.node&&o.node.marks.some(e=>e.type===t)||(o=e.parent.childBefore(e.parentOffset)),!o.node||!o.node.marks.some(e=>e.type===t)||(n=n||(null==(r=o.node.marks[0])?void 0:r.attrs),!ix([...o.node.marks],t,n)))return;let i=o.index,s=e.start()+o.offset,l=i+1,a=s+o.node.nodeSize;for(;i>0&&iS([...e.parent.child(i-1).marks],t,n);)i-=1,s-=e.parent.child(i).nodeSize;for(;l<e.parent.childCount&&iS([...e.parent.child(l).marks],t,n);)a+=e.parent.child(l).nodeSize,l+=1;return{from:s,to:a}}function i_(e,t){if("string"==typeof e){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}var iN=(e,t={})=>({tr:n,state:r,dispatch:o})=>{let i=i_(e,r.schema),{doc:s,selection:l}=n,{$from:a,from:c,to:d}=l;if(o){let e=iA(a,i,t);if(e&&e.from<=c&&e.to>=d){let t=tV.create(s,e.from,e.to);n.setSelection(t)}}return!0},iM=e=>t=>{let n="function"==typeof e?e(t):e;for(let e=0;e<n.length;e+=1)if(n[e](t))return!0;return!1};function iI(e){return e instanceof tV}function iO(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function iD(e,t=null){if(!t)return null;let n=tj.atStart(e),r=tj.atEnd(e);if("start"===t||!0===t)return n;if("end"===t)return r;let o=n.from,i=r.to;return"all"===t?tV.create(e,iO(0,o,i),iO(e.content.size,o,i)):tV.create(e,iO(t,o,i),iO(t,o,i))}function iR(){return"Android"===navigator.platform||/android/i.test(navigator.userAgent)}function iL(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var iP=(e=null,t={})=>({editor:n,view:r,tr:o,dispatch:i})=>{t={scrollIntoView:!0,...t};let s=()=>{(iL()||iR())&&r.dom.focus(),requestAnimationFrame(()=>{!n.isDestroyed&&(r.focus(),(null==t?void 0:t.scrollIntoView)&&n.commands.scrollIntoView())})};if(r.hasFocus()&&null===e||!1===e)return!0;if(i&&null===e&&!iI(n.state.selection))return s(),!0;let l=iD(o.doc,e)||n.state.selection,a=n.state.selection.eq(l);return i&&(a||o.setSelection(l),a&&o.storedMarks&&o.setStoredMarks(o.storedMarks),s()),!0},iB=(e,t)=>n=>e.every((e,r)=>t(e,{...n,index:r})),iH=(e,t)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),ij=e=>{let t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){let r=t[n];3===r.nodeType&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?e.removeChild(r):1===r.nodeType&&ij(r)}return e};function iF(e){if("undefined"==typeof window)throw Error("[tiptap error]: there is no window object available, so this function cannot be used");let t=`<body>${e}</body>`;return ij(new window.DOMParser().parseFromString(t,"text/html").body)}function iU(e,t,n){if(e instanceof eR||e instanceof em)return e;n={slice:!0,parseOptions:{},...n};let r="object"==typeof e&&null!==e,o="string"==typeof e;if(r)try{if(Array.isArray(e)&&e.length>0)return em.fromArray(e.map(e=>t.nodeFromJSON(e)));let r=t.nodeFromJSON(e);return n.errorOnInvalidContent&&r.check(),r}catch(r){if(n.errorOnInvalidContent)throw Error("[tiptap error]: Invalid JSON content",{cause:r});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",r),iU("",t,n)}if(o){if(n.errorOnInvalidContent){let r=!1,o="",i=new eK({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:e=>(r=!0,o="string"==typeof e?e:e.outerHTML,null)}]}})});if(n.slice?eX.fromSchema(i).parseSlice(iF(e),n.parseOptions):eX.fromSchema(i).parse(iF(e),n.parseOptions),n.errorOnInvalidContent&&r)throw Error("[tiptap error]: Invalid HTML content",{cause:Error(`Invalid element found: ${o}`)})}let r=eX.fromSchema(t);return n.slice?r.parseSlice(iF(e),n.parseOptions).content:r.parse(iF(e),n.parseOptions)}return iU("",t,n)}function iz(e,t,n){let r=e.steps.length-1;if(r<t)return;let o=e.steps[r];if(!(o instanceof th||o instanceof tp))return;let i=e.mapping.maps[r],s=0;i.forEach((e,t,n,r)=>{0===s&&(s=r)}),e.setSelection(tj.near(e.doc.resolve(s),n))}var iV=(e,t,n)=>({tr:r,dispatch:o,editor:i})=>{var s;if(o){let o,l;n={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let a=e=>{i.emit("contentError",{editor:i,error:e,disableCollaboration:()=>{"collaboration"in i.storage&&"object"==typeof i.storage.collaboration&&i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!i.options.enableContentCheck&&i.options.emitContentError)try{iU(t,i.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(e){a(e)}try{o=iU(t,i.schema,{parseOptions:c,errorOnInvalidContent:null!=(s=n.errorOnInvalidContent)?s:i.options.enableContentCheck})}catch(e){return a(e),!1}let{from:d,to:u}="number"==typeof e?{from:e,to:e}:{from:e.from,to:e.to},h=!0,p=!0;if((!("type"in o)?o:[o]).forEach(e=>{e.check(),h=!!h&&e.isText&&0===e.marks.length,p=!!p&&e.isBlock}),d===u&&p){let{parent:e}=r.doc.resolve(d);!e.isTextblock||e.type.spec.code||e.childCount||(d-=1,u+=1)}if(h){if(Array.isArray(t))l=t.map(e=>e.text||"").join("");else if(t instanceof em){let e="";t.forEach(t=>{t.text&&(e+=t.text)}),l=e}else l="object"==typeof t&&t&&t.text?t.text:t;r.insertText(l,d,u)}else{l=o;let e=r.doc.resolve(d),t=e.node(),n=0===e.parentOffset,i=t.isText||t.isTextblock,s=t.content.size>0;n&&i&&s&&(d=Math.max(0,d-1)),r.replaceWith(d,u,l)}n.updateSelection&&iz(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:d,text:l}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:d,text:l})}return!0},i$=()=>({state:e,dispatch:t})=>((e,t)=>{let n=e.selection,r=n instanceof tG,o;if(r){if(n.node.isTextblock||!tC(e.doc,n.from))return!1;o=n.from}else if(null==(o=tw(e.doc,n.from,-1)))return!1;if(t){let n=e.tr.join(o);r&&n.setSelection(tG.create(n.doc,o-e.doc.resolve(o).nodeBefore.nodeSize)),t(n.scrollIntoView())}return!0})(e,t),iG=()=>({state:e,dispatch:t})=>((e,t)=>{let n=e.selection,r;if(n instanceof tG){if(n.node.isTextblock||!tC(e.doc,n.to))return!1;r=n.to}else if(null==(r=tw(e.doc,n.to,1)))return!1;return t&&t(e.tr.join(r).scrollIntoView()),!0})(e,t),iq=()=>({state:e,dispatch:t})=>t7(e,t),iW=()=>({state:e,dispatch:t})=>ni(e,t),iY=()=>({state:e,dispatch:t,tr:n})=>{try{let r=tw(e.doc,e.selection.$from.pos,-1);if(null==r)return!1;return n.join(r,2),t&&t(n),!0}catch{return!1}},iK=()=>({state:e,dispatch:t,tr:n})=>{try{let r=tw(e.doc,e.selection.$from.pos,1);if(null==r)return!1;return n.join(r,2),t&&t(n),!0}catch{return!1}},iZ=()=>({state:e,dispatch:t})=>((e,t,n)=>{let r=t9(e,n);if(!r)return!1;let o=nr(r);return!!o&&ne(e,o,t)})(e,t),iX=()=>({state:e,dispatch:t})=>((e,t,n)=>{let r=no(e,n);if(!r)return!1;let o=nl(r);return!!o&&ne(e,o,t)})(e,t);function iQ(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}var iJ=e=>({editor:t,view:n,tr:r,dispatch:o})=>{let i=(function(e){let t,n,r,o,i=e.split(/-(?!$)/),s=i[i.length-1];"Space"===s&&(s=" ");for(let e=0;e<i.length-1;e+=1){let s=i[e];if(/^(cmd|meta|m)$/i.test(s))o=!0;else if(/^a(lt)?$/i.test(s))t=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else if(/^s(hift)?$/i.test(s))r=!0;else if(/^mod$/i.test(s))iL()||iQ()?o=!0:n=!0;else throw Error(`Unrecognized modifier name: ${s}`)}return t&&(s=`Alt-${s}`),n&&(s=`Ctrl-${s}`),o&&(s=`Meta-${s}`),r&&(s=`Shift-${s}`),s})(e).split(/-(?!$)/),s=i.find(e=>!["Alt","Ctrl","Meta","Shift"].includes(e)),l=new KeyboardEvent("keydown",{key:"Space"===s?" ":s,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),a=t.captureTransaction(()=>{n.someProp("handleKeyDown",e=>e(n,l))});return null==a||a.steps.forEach(e=>{let t=e.map(r.mapping);t&&o&&r.maybeStep(t)}),!0};function i0(e,t,n={}){let{from:r,to:o,empty:i}=e.selection,s=t?ib(t,e.schema):null,l=[];e.doc.nodesBetween(r,o,(e,t)=>{if(e.isText)return;let n=Math.max(r,t),i=Math.min(o,t+e.nodeSize);l.push({node:e,from:n,to:i})});let a=o-r,c=l.filter(e=>!s||s.name===e.node.type.name).filter(e=>iw(e.node.attrs,n,{strict:!1}));return i?!!c.length:c.reduce((e,t)=>e+t.to-t.from,0)>=a}var i1=(e,t={})=>({state:n,dispatch:r})=>{let o=ib(e,n.schema);return!!i0(n,o,t)&&((e,t)=>{let{$from:n,$to:r}=e.selection,o=n.blockRange(r),i=o&&tg(o);return null!=i&&(t&&t(e.tr.lift(o,i).scrollIntoView()),!0)})(n,r)},i2=()=>({state:e,dispatch:t})=>nh(e,t),i4=e=>({state:t,dispatch:n})=>{var r;return(r=ib(e,t.schema),function(e,t){let{$from:n,$to:o}=e.selection,i=n.blockRange(o,e=>e.childCount>0&&e.firstChild.type==r);return!!i&&(!t||(n.node(i.depth-1).type==r?function(e,t,n,r){let o=e.tr,i=r.end,s=r.$to.end(r.depth);i<s&&(o.step(new tp(i-1,s,i,s,new ek(em.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new eO(o.doc.resolve(r.$from.pos),o.doc.resolve(s),r.depth));let l=tg(r);if(null==l)return!1;o.lift(r,l);let a=o.doc.resolve(o.mapping.map(i,-1)-1);return tC(o.doc,a.pos)&&a.nodeBefore.type==a.nodeAfter.type&&o.join(a.pos),t(o.scrollIntoView()),!0}(e,t,r,i):function(e,t,n){let r=e.tr,o=n.parent;for(let e=n.end,t=n.endIndex-1,i=n.startIndex;t>i;t--)e-=o.child(t).nodeSize,r.delete(e-1,e+1);let i=r.doc.resolve(n.start),s=i.nodeAfter;if(r.mapping.map(n.end)!=n.start+i.nodeAfter.nodeSize)return!1;let l=0==n.startIndex,a=n.endIndex==o.childCount,c=i.node(-1),d=i.index(-1);if(!c.canReplace(d+ +!l,d+1,s.content.append(a?em.empty:em.from(o))))return!1;let u=i.pos,h=u+s.nodeSize;return r.step(new tp(u-!!l,h+ +!!a,u+1,h-1,new ek((l?em.empty:em.from(o.copy(em.empty))).append(a?em.empty:em.from(o.copy(em.empty))),+!l,+!a),+!l)),t(r.scrollIntoView()),!0}(e,t,i)))})(t,n)},i5=()=>({state:e,dispatch:t})=>na(e,t);function i3(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function i8(e,t){let n="string"==typeof t?[t]:t;return Object.keys(e).reduce((t,r)=>(n.includes(r)||(t[r]=e[r]),t),{})}var i6=(e,t)=>({tr:n,state:r,dispatch:o})=>{let i=null,s=null,l=i3("string"==typeof e?e:e.name,r.schema);if(!l)return!1;"node"===l&&(i=ib(e,r.schema)),"mark"===l&&(s=i_(e,r.schema));let a=!1;return n.selection.ranges.forEach(e=>{r.doc.nodesBetween(e.$from.pos,e.$to.pos,(e,r)=>{i&&i===e.type&&(a=!0,o&&n.setNodeMarkup(r,void 0,i8(e.attrs,t))),s&&e.marks.length&&e.marks.forEach(i=>{s===i.type&&(a=!0,o&&n.addMark(r,r+e.nodeSize,s.create(i8(i.attrs,t))))})})}),a},i9=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),i7=()=>({tr:e,dispatch:t})=>{if(t){let t=new tW(e.doc);e.setSelection(t)}return!0},se=()=>({state:e,dispatch:t})=>nn(e,t),st=()=>({state:e,dispatch:t})=>ns(e,t),sn=()=>({state:e,dispatch:t})=>((e,t)=>{let{$from:n,to:r}=e.selection,o,i=n.sharedDepth(r);return 0!=i&&(o=n.before(i),t&&t(e.tr.setSelection(tG.create(e.doc,o))),!0)})(e,t),sr=()=>({state:e,dispatch:t})=>ng(e,t),so=()=>({state:e,dispatch:t})=>nm(e,t);function si(e,t,n={},r={}){return iU(e,t,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}var ss=(e,{errorOnInvalidContent:t,emitUpdate:n=!0,parseOptions:r={}}={})=>({editor:o,tr:i,dispatch:s,commands:l})=>{let{doc:a}=i;if("full"!==r.preserveWhitespace){let l=si(e,o.schema,r,{errorOnInvalidContent:null!=t?t:o.options.enableContentCheck});return s&&i.replaceWith(0,a.content.size,l).setMeta("preventUpdate",!n),!0}return s&&i.setMeta("preventUpdate",!n),l.insertContentAt({from:0,to:a.content.size},e,{parseOptions:r,errorOnInvalidContent:null!=t?t:o.options.enableContentCheck})};function sl(e,t){let n=i_(t,e.schema),{from:r,to:o,empty:i}=e.selection,s=[];i?(e.storedMarks&&s.push(...e.storedMarks),s.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,o,e=>{s.push(...e.marks)});let l=s.find(e=>e.type.name===n.name);return l?{...l.attrs}:{}}function sa(e,t){let n=new tB(e);return t.forEach(e=>{e.steps.forEach(e=>{n.step(e)})}),n}function sc(e,t){let n=[];return e.descendants((e,r)=>{t(e)&&n.push({node:e,pos:r})}),n}function sd(e,t,n){let r=[];return e.nodesBetween(t.from,t.to,(e,t)=>{n(e)&&r.push({node:e,pos:t})}),r}function su(e){return t=>(function(e,t){for(let n=e.depth;n>0;n-=1){let r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}})(t.$from,e)}function sh(e,t,n){return void 0===e.config[t]&&e.parent?sh(e.parent,t,n):"function"==typeof e.config[t]?e.config[t].bind({...n,parent:e.parent?sh(e.parent,t,n):null}):e.config[t]}function sp(e){return e.map(e=>{let t={name:e.name,options:e.options,storage:e.storage},n=sh(e,"addExtensions",t);return n?[e,...sp(n())]:e}).flat(10)}function sf(e,t){let n=e8.fromSchema(t).serializeFragment(e),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}function sm(e){return"function"==typeof e}function sg(e,t,...n){return sm(e)?t?e.bind(t)(...n):e(...n):e}function sb(e){let t=e.filter(e=>"extension"===e.type);return{baseExtensions:t,nodeExtensions:e.filter(e=>"node"===e.type),markExtensions:e.filter(e=>"mark"===e.type)}}function sy(e){let t=[],{nodeExtensions:n,markExtensions:r}=sb(e),o=[...n,...r],i={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(e=>{let n={name:e.name,options:e.options,storage:e.storage,extensions:o},r=sh(e,"addGlobalAttributes",n);r&&r().forEach(e=>{e.types.forEach(n=>{Object.entries(e.attributes).forEach(([e,r])=>{t.push({type:n,name:e,attribute:{...i,...r}})})})})}),o.forEach(e=>{let n={name:e.name,options:e.options,storage:e.storage},r=sh(e,"addAttributes",n);r&&Object.entries(r()).forEach(([n,r])=>{let o={...i,...r};"function"==typeof(null==o?void 0:o.default)&&(o.default=o.default()),(null==o?void 0:o.isRequired)&&(null==o?void 0:o.default)===void 0&&delete o.default,t.push({type:e.name,name:n,attribute:o})})}),t}function sv(...e){return e.filter(e=>!!e).reduce((e,t)=>{let n={...e};return Object.entries(t).forEach(([e,t])=>{if(!n[e]){n[e]=t;return}if("class"===e){let r=t?String(t).split(" "):[],o=n[e]?n[e].split(" "):[],i=r.filter(e=>!o.includes(e));n[e]=[...o,...i].join(" ")}else if("style"===e){let r=t?t.split(";").map(e=>e.trim()).filter(Boolean):[],o=n[e]?n[e].split(";").map(e=>e.trim()).filter(Boolean):[],i=new Map;o.forEach(e=>{let[t,n]=e.split(":").map(e=>e.trim());i.set(t,n)}),r.forEach(e=>{let[t,n]=e.split(":").map(e=>e.trim());i.set(t,n)}),n[e]=Array.from(i.entries()).map(([e,t])=>`${e}: ${t}`).join("; ")}else n[e]=t}),n},{})}function sE(e,t){return t.filter(t=>t.type===e.type.name).filter(e=>e.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]}).reduce((e,t)=>sv(e,t),{})}function sk(e,t){return"style"in e?e:{...e,getAttrs:n=>{let r=e.getAttrs?e.getAttrs(n):e.attrs;if(!1===r)return!1;let o=t.reduce((e,t)=>{var r;let o=t.attribute.parseHTML?t.attribute.parseHTML(n):"string"!=typeof(r=n.getAttribute(t.name))?r:r.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(r):"true"===r||"false"!==r&&r;return null==o?e:{...e,[t.name]:o}},{});return{...r,...o}}}}function sC(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>!("attrs"===e&&function(e={}){return 0===Object.keys(e).length&&e.constructor===Object}(t))&&null!=t))}function sT(e){var t,n;let r={};return!(null==(t=null==e?void 0:e.attribute)?void 0:t.isRequired)&&"default"in((null==e?void 0:e.attribute)||{})&&(r.default=e.attribute.default),(null==(n=null==e?void 0:e.attribute)?void 0:n.validate)!==void 0&&(r.validate=e.attribute.validate),[e.name,r]}function sw(e,t){var n;let r=sy(e),{nodeExtensions:o,markExtensions:i}=sb(e),s=null==(n=o.find(e=>sh(e,"topNode")))?void 0:n.name;return new eK({topNode:s,nodes:Object.fromEntries(o.map(n=>{let o=r.filter(e=>e.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:t},s=sC({...e.reduce((e,t)=>{let r=sh(t,"extendNodeSchema",i);return{...e,...r?r(n):{}}},{}),content:sg(sh(n,"content",i)),marks:sg(sh(n,"marks",i)),group:sg(sh(n,"group",i)),inline:sg(sh(n,"inline",i)),atom:sg(sh(n,"atom",i)),selectable:sg(sh(n,"selectable",i)),draggable:sg(sh(n,"draggable",i)),code:sg(sh(n,"code",i)),whitespace:sg(sh(n,"whitespace",i)),linebreakReplacement:sg(sh(n,"linebreakReplacement",i)),defining:sg(sh(n,"defining",i)),isolating:sg(sh(n,"isolating",i)),attrs:Object.fromEntries(o.map(sT))}),l=sg(sh(n,"parseHTML",i));l&&(s.parseDOM=l.map(e=>sk(e,o)));let a=sh(n,"renderHTML",i);a&&(s.toDOM=e=>a({node:e,HTMLAttributes:sE(e,o)}));let c=sh(n,"renderText",i);return c&&(s.toText=c),[n.name,s]})),marks:Object.fromEntries(i.map(n=>{let o=r.filter(e=>e.type===n.name),i={name:n.name,options:n.options,storage:n.storage,editor:t},s=sC({...e.reduce((e,t)=>{let r=sh(t,"extendMarkSchema",i);return{...e,...r?r(n):{}}},{}),inclusive:sg(sh(n,"inclusive",i)),excludes:sg(sh(n,"excludes",i)),group:sg(sh(n,"group",i)),spanning:sg(sh(n,"spanning",i)),code:sg(sh(n,"code",i)),attrs:Object.fromEntries(o.map(sT))}),l=sg(sh(n,"parseHTML",i));l&&(s.parseDOM=l.map(e=>sk(e,o)));let a=sh(n,"renderHTML",i);return a&&(s.toDOM=e=>a({mark:e,HTMLAttributes:sE(e,o)})),[n.name,s]}))})}function sx(e){return e.sort((e,t)=>{let n=sh(e,"priority")||100,r=sh(t,"priority")||100;return n>r?-1:+(n<r)})}function sS(e){var t;let n=sx(sp(e)),r=Array.from(new Set((t=n.map(e=>e.name)).filter((e,n)=>t.indexOf(e)!==n)));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(e=>`'${e}'`).join(", ")}]. This can lead to issues.`),n}function sA(e,t,n){let{from:r,to:o}=t,{blockSeparator:i="\n\n",textSerializers:s={}}=n||{},l="";return e.nodesBetween(r,o,(e,n,a,c)=>{var d;e.isBlock&&n>r&&(l+=i);let u=null==s?void 0:s[e.type.name];if(u)return a&&(l+=u({node:e,pos:n,parent:a,index:c,range:t})),!1;e.isText&&(l+=null==(d=null==e?void 0:e.text)?void 0:d.slice(Math.max(r,n)-n,o-n))}),l}function s_(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}function sN(e,t){let n=i3("string"==typeof t?t:t.name,e.schema);return"node"===n?function(e,t){let n=ib(t,e.schema),{from:r,to:o}=e.selection,i=[];e.doc.nodesBetween(r,o,e=>{i.push(e)});let s=i.reverse().find(e=>e.type.name===n.name);return s?{...s.attrs}:{}}(e,t):"mark"===n?sl(e,t):{}}function sM(e){let t,{mapping:n,steps:r}=e,o=[];return n.maps.forEach((e,t)=>{let i=[];if(e.ranges.length)e.forEach((e,t)=>{i.push({from:e,to:t})});else{let{from:e,to:n}=r[t];if(void 0===e||void 0===n)return;i.push({from:e,to:n})}i.forEach(({from:e,to:r})=>{let i=n.slice(t).map(e,-1),s=n.slice(t).map(r),l=n.invert().map(i,-1),a=n.invert().map(s);o.push({oldRange:{from:l,to:a},newRange:{from:i,to:s}})})}),1===(t=function(e,t=JSON.stringify){let n={};return e.filter(e=>{let r=t(e);return!Object.prototype.hasOwnProperty.call(n,r)&&(n[r]=!0)})}(o)).length?t:t.filter((e,n)=>!t.filter((e,t)=>t!==n).some(t=>e.oldRange.from>=t.oldRange.from&&e.oldRange.to<=t.oldRange.to&&e.newRange.from>=t.newRange.from&&e.newRange.to<=t.newRange.to))}function sI(e,t,n){let r=[];return e===t?n.resolve(e).marks().forEach(t=>{let o=iA(n.resolve(e),t.type);o&&r.push({mark:t,...o})}):n.nodesBetween(e,t,(e,t)=>{e&&(null==e?void 0:e.nodeSize)!==void 0&&r.push(...e.marks.map(n=>({from:t,to:t+e.nodeSize,mark:n})))}),r}function sO(e,t){return t.nodes[e]||t.marks[e]||null}function sD(e,t,n){return Object.fromEntries(Object.entries(n).filter(([n])=>{let r=e.find(e=>e.type===t&&e.name===n);return!!r&&r.attribute.keepOnSplit}))}function sR(e,t,n={}){let{empty:r,ranges:o}=e.selection,i=t?i_(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(e=>!i||i.name===e.type.name).find(e=>iw(e.attrs,n,{strict:!1}));let s=0,l=[];if(o.forEach(({$from:t,$to:n})=>{let r=t.pos,o=n.pos;e.doc.nodesBetween(r,o,(e,t)=>{if(!e.isText&&!e.marks.length)return;let n=Math.max(r,t),i=Math.min(o,t+e.nodeSize);s+=i-n,l.push(...e.marks.map(e=>({mark:e,from:n,to:i})))})}),0===s)return!1;let a=l.filter(e=>!i||i.name===e.mark.type.name).filter(e=>iw(e.mark.attrs,n,{strict:!1})).reduce((e,t)=>e+t.to-t.from,0),c=l.filter(e=>!i||e.mark.type!==i&&e.mark.type.excludes(i)).reduce((e,t)=>e+t.to-t.from,0);return(a>0?a+c:a)>=s}function sL(e,t){return Array.isArray(t)?t.some(t=>("string"==typeof t?t:t.name)===e.name):t}function sP(e,t){let{nodeExtensions:n}=sb(t),r=n.find(t=>t.name===e);if(!r)return!1;let o={name:r.name,options:r.options,storage:r.storage},i=sg(sh(r,"group",o));return"string"==typeof i&&i.split(" ").includes("list")}function sB(e,{checkChildren:t=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if("hardBreak"===e.type.name)return!0;if(e.isText)return/^\s*$/m.test(null!=(r=e.text)?r:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(0===e.content.childCount)return!0;if(t){let r=!0;return e.content.forEach(e=>{!1!==r&&(sB(e,{ignoreWhitespace:n,checkChildren:t})||(r=!1))}),r}return!1}function sH(e){return e instanceof tG}var sj=class e{constructor(e){this.position=e}static fromJSON(t){return new e(t.position)}toJSON(){return{position:this.position}}};function sF(e,t){let n=t.mapping.mapResult(e.position);return{position:new sj(n.pos),mapResult:n}}function sU(e){return new sj(e)}function sz(e,t,n){let r=e.state.doc.content.size,o=iO(t,0,r),i=iO(n,0,r),s=e.coordsAtPos(o),l=e.coordsAtPos(i,-1),a=Math.min(s.top,l.top),c=Math.max(s.bottom,l.bottom),d=Math.min(s.left,l.left),u=Math.max(s.right,l.right),h={top:a,bottom:c,left:d,right:u,width:u-d,height:c-a,x:d,y:a};return{...h,toJSON:()=>h}}var sV=(e,t={})=>({tr:n,state:r,dispatch:o})=>{let{selection:i}=n,{empty:s,ranges:l}=i,a=i_(e,r.schema);if(o)if(s){let e=sl(r,a);n.addStoredMark(a.create({...e,...t}))}else l.forEach(e=>{let o=e.$from.pos,i=e.$to.pos;r.doc.nodesBetween(o,i,(e,r)=>{let s=Math.max(r,o),l=Math.min(r+e.nodeSize,i);e.marks.find(e=>e.type===a)?e.marks.forEach(e=>{a===e.type&&n.addMark(s,l,a.create({...e.attrs,...t}))}):n.addMark(s,l,a.create(t))})});return function(e,t,n){var r;let{selection:o}=t,i=null;if(iI(o)&&(i=o.$cursor),i){let t=null!=(r=e.storedMarks)?r:i.marks();return i.parent.type.allowsMarkType(n)&&(!!n.isInSet(t)||!t.some(e=>e.type.excludes(n)))}let{ranges:s}=o;return s.some(({$from:t,$to:r})=>{let o=0===t.depth&&e.doc.inlineContent&&e.doc.type.allowsMarkType(n);return e.doc.nodesBetween(t.pos,r.pos,(e,t,r)=>{if(o)return!1;if(e.isInline){let t=!r||r.type.allowsMarkType(n),i=!!n.isInSet(e.marks)||!e.marks.some(e=>e.type.excludes(n));o=t&&i}return!o}),o})}(r,n,a)},s$=(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),sG=(e,t={})=>({state:n,dispatch:r,chain:o})=>{let i,s=ib(e,n.schema);return(n.selection.$anchor.sameParent(n.selection.$head)&&(i=n.selection.$anchor.parent.attrs),s.isTextblock)?o().command(({commands:e})=>!!nb(s,{...i,...t})(n)||e.clearNodes()).command(({state:e})=>nb(s,{...i,...t})(e,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},sq=e=>({tr:t,dispatch:n})=>{if(n){let{doc:n}=t,r=iO(e,0,n.content.size),o=tG.create(n,r);t.setSelection(o)}return!0},sW=(e,t)=>({tr:n,state:r,dispatch:o})=>{let i,s,{selection:l}=r;return"number"==typeof t?(i=t,s=t):t&&"from"in t&&"to"in t?(i=t.from,s=t.to):(i=l.from,s=l.to),o&&n.doc.nodesBetween(i,s,(t,r)=>{t.isText||n.setNodeMarkup(r,void 0,{...t.attrs,dir:e})}),!0},sY=e=>({tr:t,dispatch:n})=>{if(n){let{doc:n}=t,{from:r,to:o}="number"==typeof e?{from:e,to:e}:e,i=tV.atStart(n).from,s=tV.atEnd(n).to,l=iO(r,i,s),a=iO(o,i,s),c=tV.create(n,l,a);t.setSelection(c)}return!0},sK=e=>({state:t,dispatch:n})=>{var r;return(r=ib(e,t.schema),function(e,t){let{$from:n,$to:o}=e.selection,i=n.blockRange(o,e=>e.childCount>0&&e.firstChild.type==r);if(!i)return!1;let s=i.startIndex;if(0==s)return!1;let l=i.parent,a=l.child(s-1);if(a.type!=r)return!1;if(t){let n=a.lastChild&&a.lastChild.type==l.type,o=em.from(n?r.create():null),s=new ek(em.from(r.create(null,em.from(l.type.create(null,o)))),n?3:1,0),c=i.start,d=i.end;t(e.tr.step(new tp(c-(n?3:1),d,c,d,s,1,!0)).scrollIntoView())}return!0})(t,n)};function sZ(e,t){let n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){let r=n.filter(e=>null==t?void 0:t.includes(e.type.name));e.tr.ensureMarks(r)}}var sX=({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:r,editor:o})=>{let{selection:i,doc:s}=t,{$from:l,$to:a}=i,c=sD(o.extensionManager.attributes,l.node().type.name,l.node().attrs);if(i instanceof tG&&i.node.isBlock)return!!l.parentOffset&&!!tk(s,l.pos)&&(r&&(e&&sZ(n,o.extensionManager.splittableMarks),t.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;let d=a.parentOffset===a.parent.content.size,u=0===l.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(l.node(-1).contentMatchAt(l.indexAfter(-1))),h=d&&u?[{type:u,attrs:c}]:void 0,p=tk(t.doc,t.mapping.map(l.pos),1,h);if(!h&&!p&&tk(t.doc,t.mapping.map(l.pos),1,u?[{type:u}]:void 0)&&(p=!0,h=u?[{type:u,attrs:c}]:void 0),r){if(p&&(i instanceof tV&&t.deleteSelection(),t.split(t.mapping.map(l.pos),1,h),u&&!d&&!l.parentOffset&&l.parent.type!==u)){let e=t.mapping.map(l.before()),n=t.doc.resolve(e);l.node(-1).canReplaceWith(n.index(),n.index()+1,u)&&t.setNodeMarkup(t.mapping.map(l.before()),u)}e&&sZ(n,o.extensionManager.splittableMarks),t.scrollIntoView()}return p},sQ=(e,t={})=>({tr:n,state:r,dispatch:o,editor:i})=>{var s;let l=ib(e,r.schema),{$from:a,$to:c}=r.selection,d=r.selection.node;if(d&&d.isBlock||a.depth<2||!a.sameParent(c))return!1;let u=a.node(-1);if(u.type!==l)return!1;let h=i.extensionManager.attributes;if(0===a.parent.content.size&&a.node(-1).childCount===a.indexAfter(-1)){if(2===a.depth||a.node(-3).type!==l||a.index(-2)!==a.node(-2).childCount-1)return!1;if(o){let e=em.empty,r=a.index(-1)?1:a.index(-2)?2:3;for(let t=a.depth-r;t>=a.depth-3;t-=1)e=em.from(a.node(t).copy(e));let o=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,i={...sD(h,a.node().type.name,a.node().attrs),...t},c=(null==(s=l.contentMatch.defaultType)?void 0:s.createAndFill(i))||void 0;e=e.append(em.from(l.createAndFill(null,c)||void 0));let d=a.before(a.depth-(r-1));n.replace(d,a.after(-o),new ek(e,4-r,0));let u=-1;n.doc.nodesBetween(d,n.doc.content.size,(e,t)=>{if(u>-1)return!1;e.isTextblock&&0===e.content.size&&(u=t+1)}),u>-1&&n.setSelection(tV.near(n.doc.resolve(u))),n.scrollIntoView()}return!0}let p=c.pos===a.end()?u.contentMatchAt(0).defaultType:null,f={...sD(h,u.type.name,u.attrs),...t},m={...sD(h,a.node().type.name,a.node().attrs),...t};n.delete(a.pos,c.pos);let g=p?[{type:l,attrs:f},{type:p,attrs:m}]:[{type:l,attrs:f}];if(!tk(n.doc,a.pos,2))return!1;if(o){let{selection:e,storedMarks:t}=r,{splittableMarks:s}=i.extensionManager,l=t||e.$to.parentOffset&&e.$from.marks();if(n.split(a.pos,2,g).scrollIntoView(),!l||!o)return!0;let c=l.filter(e=>s.includes(e.type.name));n.ensureMarks(c)}return!0},sJ=(e,t)=>{let n=su(e=>e.type===t)(e.selection);if(!n)return!0;let r=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===r)return!0;let o=e.doc.nodeAt(r);return!(n.node.type===(null==o?void 0:o.type)&&tC(e.doc,n.pos))||(e.join(n.pos),!0)},s0=(e,t)=>{let n=su(e=>e.type===t)(e.selection);if(!n)return!0;let r=e.doc.resolve(n.start).after(n.depth);if(void 0===r)return!0;let o=e.doc.nodeAt(r);return!(n.node.type===(null==o?void 0:o.type)&&tC(e.doc,r))||(e.join(r),!0)},s1=(e,t,n,r={})=>({editor:o,tr:i,state:s,dispatch:l,chain:a,commands:c,can:d})=>{let{extensions:u,splittableMarks:h}=o.extensionManager,p=ib(e,s.schema),f=ib(t,s.schema),{selection:m,storedMarks:g}=s,{$from:b,$to:y}=m,v=b.blockRange(y),E=g||m.$to.parentOffset&&m.$from.marks();if(!v)return!1;let k=su(e=>sP(e.type.name,u))(m);if(v.depth>=1&&k&&v.depth-k.depth<=1){if(k.node.type===p)return c.liftListItem(f);if(sP(k.node.type.name,u)&&p.validContent(k.node.content)&&l)return a().command(()=>(i.setNodeMarkup(k.pos,p),!0)).command(()=>sJ(i,p)).command(()=>s0(i,p)).run()}return n&&E&&l?a().command(()=>{let e=d().wrapInList(p,r),t=E.filter(e=>h.includes(e.type.name));return i.ensureMarks(t),!!e||c.clearNodes()}).wrapInList(p,r).command(()=>sJ(i,p)).command(()=>s0(i,p)).run():a().command(()=>!!d().wrapInList(p,r)||c.clearNodes()).wrapInList(p,r).command(()=>sJ(i,p)).command(()=>s0(i,p)).run()},s2=(e,t={},n={})=>({state:r,commands:o})=>{let{extendEmptyMarkRange:i=!1}=n,s=i_(e,r.schema);return sR(r,s,t)?o.unsetMark(s,{extendEmptyMarkRange:i}):o.setMark(s,t)},s4=(e,t,n={})=>({state:r,commands:o})=>{let i,s=ib(e,r.schema),l=ib(t,r.schema),a=i0(r,s,n);return(r.selection.$anchor.sameParent(r.selection.$head)&&(i=r.selection.$anchor.parent.attrs),a)?o.setNode(l,i):o.setNode(s,{...i,...n})},s5=(e,t={})=>({state:n,commands:r})=>{let o=ib(e,n.schema);return i0(n,o,t)?r.lift(o):r.wrapIn(o,t)},s3=()=>({state:e,dispatch:t})=>{let n=e.plugins;for(let r=0;r<n.length;r+=1){let o,i=n[r];if(i.spec.isInputRules&&(o=i.getState(e))){if(t){let t=e.tr,n=o.transform;for(let e=n.steps.length-1;e>=0;e-=1)t.step(n.steps[e].invert(n.docs[e]));if(o.text){let n=t.doc.resolve(o.from).marks();t.replaceWith(o.from,o.to,e.schema.text(o.text,n))}else t.delete(o.from,o.to)}return!0}}return!1},s8=()=>({tr:e,dispatch:t})=>{let{selection:n}=e,{empty:r,ranges:o}=n;return!!r||(t&&o.forEach(t=>{e.removeMark(t.$from.pos,t.$to.pos)}),!0)},s6=(e,t={})=>({tr:n,state:r,dispatch:o})=>{var i;let{extendEmptyMarkRange:s=!1}=t,{selection:l}=n,a=i_(e,r.schema),{$from:c,empty:d,ranges:u}=l;if(!o)return!0;if(d&&s){let{from:e,to:t}=l,r=null==(i=c.marks().find(e=>e.type===a))?void 0:i.attrs,o=iA(c,a,r);o&&(e=o.from,t=o.to),n.removeMark(e,t,a)}else u.forEach(e=>{n.removeMark(e.$from.pos,e.$to.pos,a)});return n.removeStoredMark(a),!0},s9=e=>({tr:t,state:n,dispatch:r})=>{let o,i,{selection:s}=n;return"number"==typeof e?(o=e,i=e):e&&"from"in e&&"to"in e?(o=e.from,i=e.to):(o=s.from,i=s.to),r&&t.doc.nodesBetween(o,i,(e,n)=>{if(e.isText)return;let r={...e.attrs};delete r.dir,t.setNodeMarkup(n,void 0,r)}),!0},s7=(e,t={})=>({tr:n,state:r,dispatch:o})=>{let i=null,s=null,l=i3("string"==typeof e?e:e.name,r.schema);if(!l)return!1;"node"===l&&(i=ib(e,r.schema)),"mark"===l&&(s=i_(e,r.schema));let a=!1;return n.selection.ranges.forEach(e=>{let l,c,d,u,h=e.$from.pos,p=e.$to.pos;n.selection.empty?r.doc.nodesBetween(h,p,(e,t)=>{i&&i===e.type&&(a=!0,d=Math.max(t,h),u=Math.min(t+e.nodeSize,p),l=t,c=e)}):r.doc.nodesBetween(h,p,(e,r)=>{r<h&&i&&i===e.type&&(a=!0,d=Math.max(r,h),u=Math.min(r+e.nodeSize,p),l=r,c=e),r>=h&&r<=p&&(i&&i===e.type&&(a=!0,o&&n.setNodeMarkup(r,void 0,{...e.attrs,...t})),s&&e.marks.length&&e.marks.forEach(i=>{if(s===i.type&&(a=!0,o)){let o=Math.max(r,h),l=Math.min(r+e.nodeSize,p);n.addMark(o,l,s.create({...i.attrs,...t}))}}))}),c&&(void 0!==l&&o&&n.setNodeMarkup(l,void 0,{...c.attrs,...t}),s&&c.marks.length&&c.marks.forEach(e=>{s===e.type&&o&&n.addMark(d,u,s.create({...e.attrs,...t}))}))}),a},le=(e,t={})=>({state:n,dispatch:r})=>(function(e,t=null){return function(n,r){let{$from:o,$to:i}=n.selection,s=o.blockRange(i),l=s&&tb(s,e,t);return!!l&&(r&&r(n.tr.wrap(s,l).scrollIntoView()),!0)}})(ib(e,n.schema),t)(n,r),lt=(e,t={})=>({state:n,dispatch:r})=>(function(e,t=null){return function(n,r){let{$from:o,$to:i}=n.selection,s=o.blockRange(i);if(!s)return!1;let l=r?n.tr:null;return!!function(e,t,n,r=null){let o=!1,i=t,s=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(n)&&0==t.startIndex){if(0==t.$from.index(t.depth-1))return!1;let e=s.resolve(t.start-2);i=new eO(e,e,t.depth),t.endIndex<t.parent.childCount&&(t=new eO(t.$from,s.resolve(t.$to.end(t.depth)),t.depth)),o=!0}let l=tb(i,n,r,t);return!!l&&(e&&function(e,t,n,r,o){let i=em.empty;for(let e=n.length-1;e>=0;e--)i=em.from(n[e].type.create(n[e].attrs,i));e.step(new tp(t.start-2*!!r,t.end,t.start,t.end,new ek(i,0,0),n.length,!0));let s=0;for(let e=0;e<n.length;e++)n[e].type==o&&(s=e+1);let l=n.length-s,a=t.start+n.length-2*!!r,c=t.parent;for(let n=t.startIndex,r=t.endIndex,o=!0;n<r;n++,o=!1)!o&&tk(e.doc,a,l)&&(e.split(a,l),a+=2*l),a+=c.child(n).nodeSize}(e,t,l,o,n),!0)}(l,s,e,t)&&(r&&r(l.scrollIntoView()),!0)}})(ib(e,n.schema),t)(n,r),ln=class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){let n=this.callbacks[e];return n&&n.forEach(e=>e.apply(this,t)),this}off(e,t){let n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(e=>e!==t):delete this.callbacks[e]),this}once(e,t){let n=(...r)=>{this.off(e,n),t.apply(this,r)};return this.on(e,n)}removeAllListeners(){this.callbacks={}}},lr=class{constructor(e){var t;this.find=e.find,this.handler=e.handler,this.undoable=null==(t=e.undoable)||t}};function lo(e){var t;let{editor:n,from:r,to:o,text:i,rules:s,plugin:l}=e,{view:a}=n;if(a.composing)return!1;let c=a.state.doc.resolve(r);if(c.parent.type.spec.code||(null==(t=c.nodeBefore||c.nodeAfter)?void 0:t.marks.find(e=>e.type.spec.code)))return!1;let d=!1,u=((e,t=500)=>{let n="",r=e.parentOffset;return e.parent.nodesBetween(Math.max(0,r-t),r,(e,t,o,i)=>{var s,l;let a=(null==(l=(s=e.type.spec).toText)?void 0:l.call(s,{node:e,pos:t,parent:o,index:i}))||e.textContent||"%leaf%";n+=e.isAtom&&!e.isText?a:a.slice(0,Math.max(0,r-t))}),n})(c)+i;return s.forEach(e=>{if(d)return;let t=((e,t)=>{if(iT(t))return t.exec(e);let n=t(e);if(!n)return null;let r=[n.text];return r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r})(u,e.find);if(!t)return;let s=a.state.tr,c=is({state:a.state,transaction:s}),h={from:r-(t[0].length-i.length),to:o},{commands:p,chain:f,can:m}=new il({editor:n,state:c});null!==e.handler({state:c,range:h,match:t,commands:p,chain:f,can:m})&&s.steps.length&&(e.undoable&&s.setMeta(l,{transform:s,from:r,to:o,text:i}),a.dispatch(s),d=!0)}),d}function li(e){return"Object"===Object.prototype.toString.call(e).slice(8,-1)&&e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}var ls=class{constructor(e={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...e},this.name=this.config.name}get options(){return{...sg(sh(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...sg(sh(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(e={}){let t=this.extend({...this.config,addOptions:()=>(function e(t,n){let r={...t};return li(t)&&li(n)&&Object.keys(n).forEach(o=>{li(n[o])&&li(t[o])?r[o]=e(t[o],n[o]):r[o]=n[o]}),r})(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){let t=new this.constructor({...this.config,...e});return t.parent=this,this.child=t,t.name="name"in e?e.name:t.parent.name,t}},ll=class e extends ls{constructor(){super(...arguments),this.type="mark"}static create(t={}){return new e("function"==typeof t?t():t)}static handleExit({editor:e,mark:t}){let{tr:n}=e.state,r=e.state.selection.$from;if(r.pos===r.end()){let o=r.marks();if(!o.find(e=>(null==e?void 0:e.type.name)===t.name))return!1;let i=o.find(e=>(null==e?void 0:e.type.name)===t.name);return i&&n.removeStoredMark(i),n.insertText(" ",r.pos),e.view.dispatch(n),!0}return!1}configure(e){return super.configure(e)}extend(e){let t="function"==typeof e?e():e;return super.extend(t)}},la=class{constructor(e){this.find=e.find,this.handler=e.handler}},lc=null,ld=class{constructor(e,t){this.splittableMarks=[],this.editor=t,this.baseExtensions=e,this.extensions=sS(e),this.schema=sw(this.extensions,t),this.setupExtensions()}get commands(){return this.extensions.reduce((e,t)=>{let n={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:sO(t.name,this.schema)},r=sh(t,"addCommands",n);return r?{...e,...r()}:e},{})}get plugins(){let{editor:e}=this;return sx([...this.extensions].reverse()).flatMap(t=>{let n={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:e,type:sO(t.name,this.schema)},r=[],o=sh(t,"addKeyboardShortcuts",n),i={};if("mark"===t.type&&sh(t,"exitable",n)&&(i.ArrowRight=()=>ll.handleExit({editor:e,mark:t})),o){let t=Object.fromEntries(Object.entries(o()).map(([t,n])=>[t,()=>n({editor:e})]));i={...i,...t}}let s=it(i);r.push(s);let l=sh(t,"addInputRules",n);if(sL(t,e.options.enableInputRules)&&l){let t=l();if(t&&t.length){let n=function(e){let{editor:t,rules:n}=e,r=new t4({state:{init:()=>null,apply(e,o,i){let s=e.getMeta(r);if(s)return s;let l=e.getMeta("applyInputRules");return l&&setTimeout(()=>{let{text:e}=l;"string"==typeof e||(e=sf(em.from(e),i.schema));let{from:o}=l,s=o+e.length;lo({editor:t,from:o,to:s,text:e,rules:n,plugin:r})}),e.selectionSet||e.docChanged?null:o}},props:{handleTextInput:(e,o,i,s)=>lo({editor:t,from:o,to:i,text:s,rules:n,plugin:r}),handleDOMEvents:{compositionend:e=>(setTimeout(()=>{let{$cursor:o}=e.state.selection;o&&lo({editor:t,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(e,o){if("Enter"!==o.key)return!1;let{$cursor:i}=e.state.selection;return!!i&&lo({editor:t,from:i.pos,to:i.pos,text:"\n",rules:n,plugin:r})}},isInputRules:!0});return r}({editor:e,rules:t}),o=Array.isArray(n)?n:[n];r.push(...o)}}let a=sh(t,"addPasteRules",n);if(sL(t,e.options.enablePasteRules)&&a){let t=a();if(t&&t.length){let n=function(e){let t,{editor:n,rules:r}=e,o=null,i=!1,s=!1,l="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null;try{t="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch{t=null}let a=({state:e,from:r,to:o,rule:i,pasteEvt:s})=>{let a=e.tr;if(function(e){let{editor:t,state:n,from:r,to:o,rule:i,pasteEvent:s,dropEvent:l}=e,{commands:a,chain:c,can:d}=new il({editor:t,state:n}),u=[];return n.doc.nodesBetween(r,o,(e,t)=>{var h,p,f,m,g;if((null==(p=null==(h=e.type)?void 0:h.spec)?void 0:p.code)||!(e.isText||e.isTextblock||e.isInline))return;let b=null!=(g=null!=(m=null==(f=e.content)?void 0:f.size)?m:e.nodeSize)?g:0,y=Math.max(r,t),v=Math.min(o,t+b);y>=v||((e,t,n)=>{if(iT(t))return[...e.matchAll(t)];let r=t(e,n);return r?r.map(t=>{let n=[t.text];return n.index=t.index,n.input=e,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(t.replaceWith)),n}):[]})(e.isText?e.text||"":e.textBetween(y-t,v-t,void 0,""),i.find,s).forEach(e=>{if(void 0===e.index)return;let t=y+e.index+1,r=t+e[0].length,o={from:n.tr.mapping.map(t),to:n.tr.mapping.map(r)},h=i.handler({state:n,range:o,match:e,commands:a,chain:c,can:d,pasteEvent:s,dropEvent:l});u.push(h)})}),u.every(e=>null!==e)}({editor:n,state:is({state:e,transaction:a}),from:Math.max(r-1,0),to:o.b-1,rule:i,pasteEvent:s,dropEvent:t})&&a.steps.length){try{t="undefined"!=typeof DragEvent?new DragEvent("drop"):null}catch{t=null}return l="undefined"!=typeof ClipboardEvent?new ClipboardEvent("paste"):null,a}};return r.map(e=>new t4({view(e){let t=t=>{var r;(o=(null==(r=e.dom.parentElement)?void 0:r.contains(t.target))?e.dom.parentElement:null)&&(lc=n)},r=()=>{lc&&(lc=null)};return window.addEventListener("dragstart",t),window.addEventListener("dragend",r),{destroy(){window.removeEventListener("dragstart",t),window.removeEventListener("dragend",r)}}},props:{handleDOMEvents:{drop:(e,n)=>{if(s=o===e.dom.parentElement,t=n,!s){let e=lc;(null==e?void 0:e.isEditable)&&setTimeout(()=>{let t=e.state.selection;t&&e.commands.deleteRange({from:t.from,to:t.to})},10)}return!1},paste:(e,t)=>{var n;let r=null==(n=t.clipboardData)?void 0:n.getData("text/html");return l=t,i=!!(null==r?void 0:r.includes("data-pm-slice")),!1}}},appendTransaction:(t,n,r)=>{let o=t[0],c="paste"===o.getMeta("uiEvent")&&!i,d="drop"===o.getMeta("uiEvent")&&!s,u=o.getMeta("applyPasteRules"),h=!!u;if(!c&&!d&&!h)return;if(h){var p,f;let t,{text:n}=u;"string"==typeof n||(n=sf(em.from(n),r.schema));let{from:o}=u,i=o+n.length;return a({rule:e,state:r,from:o,to:{b:i},pasteEvt:(p=n,null==(f=(t=new ClipboardEvent("paste",{clipboardData:new DataTransfer})).clipboardData)||f.setData("text/html",p),t)})}let m=n.doc.content.findDiffStart(r.doc.content),g=n.doc.content.findDiffEnd(r.doc.content);if("number"==typeof m&&g&&m!==g.b)return a({rule:e,state:r,from:m,to:g,pasteEvt:l})}}))}({editor:e,rules:t});r.push(...n)}}let c=sh(t,"addProseMirrorPlugins",n);if(c){let e=c();r.push(...e)}return r})}get attributes(){return sy(this.extensions)}get nodeViews(){let{editor:e}=this,{nodeExtensions:t}=sb(this.extensions);return Object.fromEntries(t.filter(e=>!!sh(e,"addNodeView")).map(t=>{let n=this.attributes.filter(e=>e.type===t.name),r={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:e,type:ib(t.name,this.schema)},o=sh(t,"addNodeView",r);if(!o)return[];let i=o();return i?[t.name,(r,o,s,l,a)=>{let c=sE(r,n);return i({node:r,view:o,getPos:s,decorations:l,innerDecorations:a,editor:e,extension:t,HTMLAttributes:c})}]:[]}))}get markViews(){let{editor:e}=this,{markExtensions:t}=sb(this.extensions);return Object.fromEntries(t.filter(e=>!!sh(e,"addMarkView")).map(t=>{let n=this.attributes.filter(e=>e.type===t.name),r={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:e,type:i_(t.name,this.schema)},o=sh(t,"addMarkView",r);return o?[t.name,(r,i,s)=>{let l=sE(r,n);return o()({mark:r,view:i,inline:s,editor:e,extension:t,HTMLAttributes:l,updateAttributes:t=>{!function(e,t,n={}){let{state:r}=t,{doc:o,tr:i}=r;o.descendants((t,r)=>{let o=i.mapping.map(r),s=i.mapping.map(r)+t.nodeSize,l=null;if(t.marks.forEach(t=>{if(t!==e)return!1;l=t}),!l)return;let a=!1;if(Object.keys(n).forEach(e=>{n[e]!==l.attrs[e]&&(a=!0)}),a){let t=e.type.create({...e.attrs,...n});i.removeMark(o,s,e.type),i.addMark(o,s,t)}}),i.docChanged&&t.view.dispatch(i)}(r,e,t)}})}]:[]}))}setupExtensions(){let e=this.extensions;this.editor.extensionStorage=Object.fromEntries(e.map(e=>[e.name,e.storage])),e.forEach(e=>{var t;let n={name:e.name,options:e.options,storage:this.editor.extensionStorage[e.name],editor:this.editor,type:sO(e.name,this.schema)};"mark"===e.type&&(null==(t=sg(sh(e,"keepOnSplit",n)))||t)&&this.splittableMarks.push(e.name);let r=sh(e,"onBeforeCreate",n),o=sh(e,"onCreate",n),i=sh(e,"onUpdate",n),s=sh(e,"onSelectionUpdate",n),l=sh(e,"onTransaction",n),a=sh(e,"onFocus",n),c=sh(e,"onBlur",n),d=sh(e,"onDestroy",n);r&&this.editor.on("beforeCreate",r),o&&this.editor.on("create",o),i&&this.editor.on("update",i),s&&this.editor.on("selectionUpdate",s),l&&this.editor.on("transaction",l),a&&this.editor.on("focus",a),c&&this.editor.on("blur",c),d&&this.editor.on("destroy",d)})}};ld.resolve=sS,ld.sort=sx,ld.flatten=sp;var lu={};ii(lu,{ClipboardTextSerializer:()=>lp,Commands:()=>lf,Delete:()=>lm,Drop:()=>lg,Editable:()=>lb,FocusEvents:()=>lv,Keymap:()=>lE,Paste:()=>lk,Tabindex:()=>lC,TextDirection:()=>lT,focusEventsPluginKey:()=>ly});var lh=class e extends ls{constructor(){super(...arguments),this.type="extension"}static create(t={}){return new e("function"==typeof t?t():t)}configure(e){return super.configure(e)}extend(e){let t="function"==typeof e?e():e;return super.extend(t)}},lp=lh.create({name:"clipboardTextSerializer",addOptions:()=>({blockSeparator:void 0}),addProseMirrorPlugins(){return[new t4({key:new t8("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{let{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:o}=t,{ranges:i}=o,s=Math.min(...i.map(e=>e.$from.pos)),l=Math.max(...i.map(e=>e.$to.pos)),a=s_(n);return sA(r,{from:s,to:l},{...void 0!==this.options.blockSeparator?{blockSeparator:this.options.blockSeparator}:{},textSerializers:a})}}})]}}),lf=lh.create({name:"commands",addCommands:()=>({...ia})}),lm=lh.create({name:"delete",onUpdate({transaction:e,appendedTransactions:t}){var n,r,o;let i=()=>{var n,r,o,i;if(null!=(i=null==(o=null==(r=null==(n=this.editor.options.coreExtensionOptions)?void 0:n.delete)?void 0:r.filterTransaction)?void 0:o.call(r,e))?i:e.getMeta("y-sync$"))return;let s=sa(e.before,[e,...t]);sM(s).forEach(t=>{s.mapping.mapResult(t.oldRange.from).deletedAfter&&s.mapping.mapResult(t.oldRange.to).deletedBefore&&s.before.nodesBetween(t.oldRange.from,t.oldRange.to,(n,r)=>{let o=r+n.nodeSize-2,i=t.oldRange.from<=r&&o<=t.oldRange.to;this.editor.emit("delete",{type:"node",node:n,from:r,to:o,newFrom:s.mapping.map(r),newTo:s.mapping.map(o),deletedRange:t.oldRange,newRange:t.newRange,partial:!i,editor:this.editor,transaction:e,combinedTransform:s})})});let l=s.mapping;s.steps.forEach((t,n)=>{var r,o;if(t instanceof tc){let i=l.slice(n).map(t.from,-1),a=l.slice(n).map(t.to),c=l.invert().map(i,-1),d=l.invert().map(a),u=null==(r=s.doc.nodeAt(i-1))?void 0:r.marks.some(e=>e.eq(t.mark)),h=null==(o=s.doc.nodeAt(a))?void 0:o.marks.some(e=>e.eq(t.mark));this.editor.emit("delete",{type:"mark",mark:t.mark,from:t.from,to:t.to,deletedRange:{from:c,to:d},newRange:{from:i,to:a},partial:!!(h||u),editor:this.editor,transaction:e,combinedTransform:s})}})};null==(o=null==(r=null==(n=this.editor.options.coreExtensionOptions)?void 0:n.delete)?void 0:r.async)||o?setTimeout(i,0):i()}}),lg=lh.create({name:"drop",addProseMirrorPlugins(){return[new t4({key:new t8("tiptapDrop"),props:{handleDrop:(e,t,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:n,moved:r})}}})]}}),lb=lh.create({name:"editable",addProseMirrorPlugins(){return[new t4({key:new t8("editable"),props:{editable:()=>this.editor.options.editable}})]}}),ly=new t8("focusEvents"),lv=lh.create({name:"focusEvents",addProseMirrorPlugins(){let{editor:e}=this;return[new t4({key:ly,props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;let r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;let r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),lE=lh.create({name:"keymap",addKeyboardShortcuts(){let e=()=>this.editor.commands.first(({commands:e})=>[()=>e.undoInputRule(),()=>e.command(({tr:t})=>{let{selection:n,doc:r}=t,{empty:o,$anchor:i}=n,{pos:s,parent:l}=i,a=i.parent.isTextblock&&s>0?t.doc.resolve(s-1):i,c=a.parent.type.spec.isolating,d=i.pos-i.parentOffset,u=c&&1===a.parent.childCount?d===i.pos:tj.atStart(r).from===s;return!!o&&!!l.type.isTextblock&&!l.textContent.length&&!!u&&(!u||"paragraph"!==i.parent.type.name)&&e.clearNodes()}),()=>e.deleteSelection(),()=>e.joinBackward(),()=>e.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:e})=>[()=>e.deleteSelection(),()=>e.deleteCurrentNode(),()=>e.joinForward(),()=>e.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:e})=>[()=>e.newlineInCode(),()=>e.createParagraphNear(),()=>e.liftEmptyBlock(),()=>e.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},r={...n},o={...n,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return iL()||iQ()?o:r},addProseMirrorPlugins(){return[new t4({key:new t8("clearDocument"),appendTransaction:(e,t,n)=>{if(e.some(e=>e.getMeta("composition")))return;let r=e.some(e=>e.docChanged)&&!t.doc.eq(n.doc),o=e.some(e=>e.getMeta("preventClearDocument"));if(!r||o)return;let{empty:i,from:s,to:l}=t.selection,a=tj.atStart(t.doc).from,c=tj.atEnd(t.doc).to;if(i||s!==a||l!==c||!sB(n.doc))return;let d=n.tr,u=is({state:n,transaction:d}),{commands:h}=new il({editor:this.editor,state:u});if(h.clearNodes(),d.steps.length)return d}})]}}),lk=lh.create({name:"paste",addProseMirrorPlugins(){return[new t4({key:new t8("tiptapPaste"),props:{handlePaste:(e,t,n)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:n})}}})]}}),lC=lh.create({name:"tabindex",addProseMirrorPlugins(){return[new t4({key:new t8("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),lT=lh.create({name:"textDirection",addOptions:()=>({direction:void 0}),addGlobalAttributes(){if(!this.options.direction)return[];let{nodeExtensions:e}=sb(this.extensions);return[{types:e.filter(e=>"text"!==e.name).map(e=>e.name),attributes:{dir:{default:this.options.direction,parseHTML:e=>{let t=e.getAttribute("dir");return t&&("ltr"===t||"rtl"===t||"auto"===t)?t:this.options.direction},renderHTML:e=>e.dir?{dir:e.dir}:{}}}}]},addProseMirrorPlugins(){return[new t4({key:new t8("textDirection"),props:{attributes:()=>{let e=this.options.direction;return e?{dir:e}:{}}}})]}}),lw=class e{constructor(e,t,n=!1,r=null){this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=t,this.currentNode=r}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return null!=(e=this.actualDepth)?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,n=this.to;if(this.isBlock){if(0===this.content.size)return void console.error(`You can\u2019t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);t=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:t,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+ +!this.node.isText}get parent(){if(0===this.depth)return null;let t=this.resolvedPos.start(this.resolvedPos.depth-1);return new e(this.resolvedPos.doc.resolve(t),this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new e(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new e(t,this.editor)}get children(){let t=[];return this.node.content.forEach((n,r)=>{let o=n.isBlock&&!n.isTextblock,i=n.isAtom&&!n.isText,s=this.pos+r+ +!i;if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;let l=this.resolvedPos.doc.resolve(s);if(!o&&l.depth<=this.depth)return;let a=new e(l,this.editor,o,o?n:null);o&&(a.actualDepth=this.depth+1),t.push(new e(l,this.editor,o,o?n:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){let e=this.children;return e[e.length-1]||null}closest(e,t={}){let n=null,r=this.parent;for(;r&&!n;){if(r.node.type.name===e)if(Object.keys(t).length>0){let e=r.node.attrs,n=Object.keys(t);for(let r=0;r<n.length;r+=1){let o=n[r];if(e[o]!==t[o])break}}else n=r;r=r.parent}return n}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},n=!1){let r=[];if(!this.children||0===this.children.length)return r;let o=Object.keys(t);return this.children.forEach(i=>{n&&r.length>0||(i.node.type.name===e&&o.every(e=>t[e]===i.node.attrs[e])&&r.push(i),n&&r.length>0||(r=r.concat(i.querySelectorAll(e,t,n))))}),r}setAttribute(e){let{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}},lx=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`,lS=class extends ln{constructor(e={}){super(),this.css=null,this.className="tiptap",this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:"undefined"!=typeof document?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,textDirection:void 0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onMount:()=>null,onUnmount:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:e})=>{throw e},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.utils={getUpdatedPosition:sF,createMappablePosition:sU},this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("mount",this.options.onMount),this.on("unmount",this.options.onUnmount),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:e,slice:t,moved:n})=>this.options.onDrop(e,t,n)),this.on("paste",({event:e,slice:t})=>this.options.onPaste(e,t)),this.on("delete",this.options.onDelete);const t=this.createDoc(),n=iD(t,this.options.autofocus);this.editorState=t2.create({doc:t,schema:this.schema,selection:n||void 0}),this.options.element&&this.mount(this.options.element)}mount(e){if("undefined"==typeof document)throw Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(e),this.emit("mount",{editor:this}),this.css&&!document.head.contains(this.css)&&document.head.appendChild(this.css),window.setTimeout(()=>{this.isDestroyed||(!1!==this.options.autofocus&&null!==this.options.autofocus&&this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){if(this.editorView){let e=this.editorView.dom;(null==e?void 0:e.editor)&&delete e.editor,this.editorView.destroy()}if(this.editorView=null,this.isInitialized=!1,this.css&&!document.querySelectorAll(`.${this.className}`).length)try{"function"==typeof this.css.remove?this.css.remove():this.css.parentNode&&this.css.parentNode.removeChild(this.css)}catch(e){console.warn("Failed to remove CSS element:",e)}this.css=null,this.emit("unmount",{editor:this})}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&"undefined"!=typeof document&&(this.css=function(e,t,n){let r=document.querySelector("style[data-tiptap-style]");if(null!==r)return r;let o=document.createElement("style");return t&&o.setAttribute("nonce",t),o.setAttribute("data-tiptap-style",""),o.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(o),o}(lx,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},this.editorView&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:e=>{this.editorState=e},dispatch:e=>{this.dispatchTransaction(e)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(e,t)=>{if(this.editorView)return this.editorView[t];if("state"===t)return this.editorState;if(t in e)return Reflect.get(e,t);throw Error(`[tiptap error]: The editor view is not available. Cannot access view['${t}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(e,t){let n=sm(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(e){if(this.isDestroyed)return;let t=this.state.plugins,n=t;if([].concat(e).forEach(e=>{let t="string"==typeof e?`${e}$`:e.key;n=n.filter(e=>!e.key.startsWith(t))}),t.length===n.length)return;let r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var e,t;let n=[...this.options.enableCoreExtensions?[lb,lp.configure({blockSeparator:null==(t=null==(e=this.options.coreExtensionOptions)?void 0:e.clipboardTextSerializer)?void 0:t.blockSeparator}),lf,lv,lE,lC,lg,lk,lm,lT.configure({direction:this.options.textDirection})].filter(e=>"object"!=typeof this.options.enableCoreExtensions||!1!==this.options.enableCoreExtensions[e.name]):[],...this.options.extensions].filter(e=>["extension","node","mark"].includes(null==e?void 0:e.type));this.extensionManager=new ld(n,this)}createCommandManager(){this.commandManager=new il({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let e;try{e=si(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(t){if(!(t instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(t.message))throw t;this.emit("contentError",{editor:this,error:t,disableCollaboration:()=>{"collaboration"in this.storage&&"object"==typeof this.storage.collaboration&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(e=>"collaboration"!==e.name),this.createExtensionManager()}}),e=si(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return e}createView(e){var t;this.editorView=new oZ(e,{...this.options.editorProps,attributes:{role:"textbox",...null==(t=this.options.editorProps)?void 0:t.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState,markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews});let n=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(n),this.prependClass(),this.injectCSS(),this.view.dom.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`${this.className} ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;let t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(e=>{var t;return null==(t=this.capturedTransaction)?void 0:t.step(e)});return}let{state:t,transactions:n}=this.state.applyTransaction(e),r=!this.state.selection.eq(t.selection),o=n.includes(e),i=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),!o)return;this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e,appendedTransactions:n.slice(1)}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});let s=n.findLast(e=>e.getMeta("focus")||e.getMeta("blur")),l=null==s?void 0:s.getMeta("focus"),a=null==s?void 0:s.getMeta("blur");l&&this.emit("focus",{editor:this,event:l.event,transaction:s}),a&&this.emit("blur",{editor:this,event:a.event,transaction:s}),e.getMeta("preventUpdate")||!n.some(e=>e.docChanged)||i.doc.eq(t.doc)||this.emit("update",{editor:this,transaction:e,appendedTransactions:n.slice(1)})}getAttributes(e){return sN(this.state,e)}isActive(e,t){let n="string"==typeof e?e:null,r="string"==typeof e?t:e;return function(e,t,n={}){if(!t)return i0(e,null,n)||sR(e,null,n);let r=i3(t,e.schema);return"node"===r?i0(e,t,n):"mark"===r&&sR(e,t,n)}(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return sf(this.state.doc.content,this.schema)}getText(e){var t,n;let r,{blockSeparator:o="\n\n",textSerializers:i={}}=e||{};return t=this.state.doc,n={blockSeparator:o,textSerializers:{...s_(this.schema),...i}},r={from:0,to:t.content.size},sA(t,r,n)}get isEmpty(){return sB(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var e,t;return null==(t=null==(e=this.editorView)?void 0:e.isDestroyed)||t}$node(e,t){var n;return(null==(n=this.$doc)?void 0:n.querySelector(e,t))||null}$nodes(e,t){var n;return(null==(n=this.$doc)?void 0:n.querySelectorAll(e,t))||null}$pos(e){return new lw(this.state.doc.resolve(e),this)}get $doc(){return this.$pos(0)}};function lA(e){return new lr({find:e.find,handler:({state:t,range:n,match:r})=>{let o=sg(e.getAttributes,void 0,r);if(!1===o||null===o)return null;let{tr:i}=t,s=r[r.length-1],l=r[0];if(s){let r=l.search(/\S/),a=n.from+l.indexOf(s),c=a+s.length;if(sI(n.from,n.to,t.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>a).length)return null;c<n.to&&i.delete(c,n.to),a>n.from&&i.delete(n.from+r,a);let d=n.from+r+s.length;i.addMark(n.from+r,d,e.type.create(o||{})),i.removeStoredMark(e.type)}},undoable:e.undoable})}function l_(e){if(!(null==e?void 0:e.trim()))return{};let t={},n=[],r=e.replace(/["']([^"']*)["']/g,e=>(n.push(e),`__QUOTED_${n.length-1}__`)),o=r.match(/(?:^|\s)\.([a-zA-Z][\w-]*)/g);o&&(t.class=o.map(e=>e.trim().slice(1)).join(" "));let i=r.match(/(?:^|\s)#([a-zA-Z][\w-]*)/);i&&(t.id=i[1]),Array.from(r.matchAll(/([a-zA-Z][\w-]*)\s*=\s*(__QUOTED_\d+__)/g)).forEach(([,e,r])=>{var o;let i=n[parseInt((null==(o=r.match(/__QUOTED_(\d+)__/))?void 0:o[1])||"0",10)];i&&(t[e]=i.slice(1,-1))});let s=r.replace(/(?:^|\s)\.([a-zA-Z][\w-]*)/g,"").replace(/(?:^|\s)#([a-zA-Z][\w-]*)/g,"").replace(/([a-zA-Z][\w-]*)\s*=\s*__QUOTED_\d+__/g,"").trim();return s&&s.split(/\s+/).filter(Boolean).forEach(e=>{e.match(/^[a-zA-Z][\w-]*$/)&&(t[e]=!0)}),t}function lN(e){if(!e||0===Object.keys(e).length)return"";let t=[];return e.class&&String(e.class).split(/\s+/).filter(Boolean).forEach(e=>t.push(`.${e}`)),e.id&&t.push(`#${e.id}`),Object.entries(e).forEach(([e,n])=>{"class"!==e&&"id"!==e&&(!0===n?t.push(e):!1!==n&&null!=n&&t.push(`${e}="${String(n)}"`))}),t.join(" ")}function lM(e){let{nodeName:t,name:n,parseAttributes:r=l_,serializeAttributes:o=lN,defaultAttributes:i={},requiredAttributes:s=[],allowedAttributes:l}=e,a=n||t;return{parseMarkdown:(e,n)=>{let r={...i,...e.attributes};return n.createNode(t,r,[])},markdownTokenizer:{name:t,level:"block",start(e){var t;let n=RegExp(`^:::${a}(?:\\s|$)`,"m"),r=null==(t=e.match(n))?void 0:t.index;return void 0!==r?r:-1},tokenize(e,n,o){let i=RegExp(`^:::${a}(?:\\s+\\{([^}]*)\\})?\\s*:::(?:\\n|$)`),l=e.match(i);if(!l)return;let c=r(l[1]||"");if(!s.find(e=>!(e in c)))return{type:t,raw:l[0],attributes:c}}},renderMarkdown:e=>{let t=o((e=>{if(!l)return e;let t={};return l.forEach(n=>{n in e&&(t[n]=e[n])}),t})(e.attrs||{})),n=t?` {${t}}`:"";return`:::${a}${n} :::`}}}function lI(e){let{nodeName:t,name:n,getContent:r,parseAttributes:o=l_,serializeAttributes:i=lN,defaultAttributes:s={},content:l="block",allowedAttributes:a}=e,c=n||t;return{parseMarkdown:(e,n)=>{let o;if(r){let t=r(e);o="string"==typeof t?[{type:"text",text:t}]:t}else o="block"===l?n.parseChildren(e.tokens||[]):n.parseInline(e.tokens||[]);let i={...s,...e.attributes};return n.createNode(t,i,o)},markdownTokenizer:{name:t,level:"block",start(e){var t;let n=RegExp(`^:::${c}`,"m"),r=null==(t=e.match(n))?void 0:t.index;return void 0!==r?r:-1},tokenize(e,n,r){var i;let s=RegExp(`^:::${c}(?:\\s+\\{([^}]*)\\})?\\s*\\n`),a=e.match(s);if(!a)return;let[d,u=""]=a,h=o(u),p=1,f=d.length,m="",g=/^:::([\w-]*)(\s.*)?/gm,b=e.slice(f);for(g.lastIndex=0;;){let n=g.exec(b);if(null===n)break;let o=n.index,s=n[1];if(null==(i=n[2])||!i.endsWith(":::")){if(s)p+=1;else if(0==(p-=1)){let i=b.slice(0,o);m=i.trim();let s=e.slice(0,f+o+n[0].length),a=[];if(m)if("block"===l)for((a=r.blockTokens(i)).forEach(e=>{e.text&&(!e.tokens||0===e.tokens.length)&&(e.tokens=r.inlineTokens(e.text))});a.length>0;){let e=a[a.length-1];if("paragraph"!==e.type||e.text&&""!==e.text.trim())break;a.pop()}else a=r.inlineTokens(m);return{type:t,raw:s,attributes:h,content:m,tokens:a}}}}}},renderMarkdown:(e,t)=>{let n=i((e=>{if(!a)return e;let t={};return a.forEach(n=>{n in e&&(t[n]=e[n])}),t})(e.attrs||{})),r=n?` {${n}}`:"",o=t.renderChildren(e.content||[],"\n\n");return`:::${c}${r}

${o}

:::`}}}function lO(e){if(!e.trim())return{};let t={},n=/(\w+)=(?:"([^"]*)"|'([^']*)')/g,r=n.exec(e);for(;null!==r;){let[,o,i,s]=r;t[o]=i||s,r=n.exec(e)}return t}function lD(e){return Object.entries(e).filter(([,e])=>null!=e).map(([e,t])=>`${e}="${t}"`).join(" ")}function lR(e){let{nodeName:t,name:n,getContent:r,parseAttributes:o=lO,serializeAttributes:i=lD,defaultAttributes:s={},selfClosing:l=!1,allowedAttributes:a}=e,c=n||t,d=c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{parseMarkdown:(e,n)=>{let o={...s,...e.attributes};if(l)return n.createNode(t,o);let i=r?r(e):e.content||"";return i?n.createNode(t,o,[n.createTextNode(i)]):n.createNode(t,o,[])},markdownTokenizer:{name:t,level:"inline",start(e){let t=l?RegExp(`\\[${d}\\s*[^\\]]*\\]`):RegExp(`\\[${d}\\s*[^\\]]*\\][\\s\\S]*?\\[\\/${d}\\]`),n=e.match(t),r=null==n?void 0:n.index;return void 0!==r?r:-1},tokenize(e,n,r){let i=l?RegExp(`^\\[${d}\\s*([^\\]]*)\\]`):RegExp(`^\\[${d}\\s*([^\\]]*)\\]([\\s\\S]*?)\\[\\/${d}\\]`),s=e.match(i);if(!s)return;let a="",c="";if(l){let[,e]=s;c=e}else{let[,e,t]=s;c=e,a=t||""}let u=o(c.trim());return{type:t,raw:s[0],content:a.trim(),attributes:u}}},renderMarkdown:e=>{let t="";r?t=r(e):e.content&&e.content.length>0&&(t=e.content.filter(e=>"text"===e.type).map(e=>e.text).join(""));let n=i((e=>{if(!a)return e;let t={};return a.forEach(n=>{let r="string"==typeof n?n:n.name,o="string"==typeof n?void 0:n.skipIfDefault;if(r in e){let n=e[r];if(void 0!==o&&n===o)return;t[r]=n}}),t})(e.attrs||{})),o=n?` ${n}`:"";return l?`[${c}${o}]`:`[${c}${o}]${t}[/${c}]`}}}function lL(e,t,n){var r,o,i,s;let l=e.split("\n"),a=[],c="",d=0,u=t.baseIndentSize||2;for(;d<l.length;){let e,h=l[d],p=h.match(t.itemPattern);if(!p)if(a.length>0)break;else{if(""!==h.trim())return;d+=1,c=`${c}${h}
`;continue}let f=t.extractItemData(p),{indentLevel:m,mainContent:g}=f;c=`${c}${h}
`;let b=[g];for(d+=1;d<l.length;){let e=l[d];if(""===e.trim()){let t=l.slice(d+1).findIndex(e=>""!==e.trim());if(-1===t)break;if(((null==(o=null==(r=l[d+1+t].match(/^(\s*)/))?void 0:r[1])?void 0:o.length)||0)>m){b.push(e),c=`${c}${e}
`,d+=1;continue}break}if(((null==(s=null==(i=e.match(/^(\s*)/))?void 0:i[1])?void 0:s.length)||0)>m)b.push(e),c=`${c}${e}
`,d+=1;else break}let y=b.slice(1);if(y.length>0){let r=y.map(e=>e.slice(m+u)).join("\n");r.trim()&&(e=t.customNestedParser?t.customNestedParser(r):n.blockTokens(r))}let v=t.createToken(f,e);a.push(v)}if(0!==a.length)return{items:a,raw:c}}function lP(e,t,n,r){if(!e||!Array.isArray(e.content))return"";let o="function"==typeof n?n(r):n,[i,...s]=e.content,l=t.renderChildren([i]),a=[`${o}${l}`];return s&&s.length>0&&s.forEach(e=>{let n=t.renderChildren([e]);if(n){let e=n.split("\n").map(e=>e?t.indent(e):"").join("\n");a.push(e)}}),a.join("\n")}ii({},{createAtomBlockMarkdownSpec:()=>lM,createBlockMarkdownSpec:()=>lI,createInlineMarkdownSpec:()=>lR,parseAttributes:()=>l_,parseIndentedBlocks:()=>lL,renderNestedMarkdownContent:()=>lP,serializeAttributes:()=>lN});var lB=class e extends ls{constructor(){super(...arguments),this.type="node"}static create(t={}){return new e("function"==typeof t?t():t)}configure(e){return super.configure(e)}extend(e){let t="function"==typeof e?e():e;return super.extend(t)}},lH=class{constructor(e,t,n){this.isDragging=!1,this.component=e,this.editor=t.editor,this.options={stopEvent:null,ignoreMutation:null,...n},this.extension=t.extension,this.node=t.node,this.decorations=t.decorations,this.innerDecorations=t.innerDecorations,this.view=t.view,this.HTMLAttributes=t.HTMLAttributes,this.getPos=t.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(e){var t,n,r,o,i,s,l;let{view:a}=this.editor,c=e.target,d=3===c.nodeType?null==(t=c.parentElement)?void 0:t.closest("[data-drag-handle]"):c.closest("[data-drag-handle]");if(!this.dom||(null==(n=this.contentDOM)?void 0:n.contains(c))||!d)return;let u=0,h=0;if(this.dom!==d){let t=this.dom.getBoundingClientRect(),n=d.getBoundingClientRect(),l=null!=(o=e.offsetX)?o:null==(r=e.nativeEvent)?void 0:r.offsetX,a=null!=(s=e.offsetY)?s:null==(i=e.nativeEvent)?void 0:i.offsetY;u=n.x-t.x+l,h=n.y-t.y+a}let p=this.dom.cloneNode(!0);try{let e=this.dom.getBoundingClientRect();p.style.width=`${Math.round(e.width)}px`,p.style.height=`${Math.round(e.height)}px`,p.style.boxSizing="border-box",p.style.pointerEvents="none"}catch{}let f=null;try{(f=document.createElement("div")).style.position="absolute",f.style.top="-9999px",f.style.left="-9999px",f.style.pointerEvents="none",f.appendChild(p),document.body.appendChild(f),null==(l=e.dataTransfer)||l.setDragImage(p,u,h)}finally{f&&setTimeout(()=>{try{null==f||f.remove()}catch{}},0)}let m=this.getPos();if("number"!=typeof m)return;let g=tG.create(a.state.doc,m),b=a.state.tr.setSelection(g);a.dispatch(b)}stopEvent(e){var t;if(!this.dom)return!1;if("function"==typeof this.options.stopEvent)return this.options.stopEvent({event:e});let n=e.target;if(!(this.dom.contains(n)&&!(null==(t=this.contentDOM)?void 0:t.contains(n))))return!1;let r=e.type.startsWith("drag"),o="drop"===e.type;if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(n.tagName)||n.isContentEditable)&&!o&&!r)return!0;let{isEditable:i}=this.editor,{isDragging:s}=this,l=!!this.node.type.spec.draggable,a=tG.isSelectable(this.node),c="copy"===e.type,d="paste"===e.type,u="cut"===e.type,h="mousedown"===e.type;if(!l&&a&&r&&e.target===this.dom&&e.preventDefault(),l&&r&&!s&&e.target===this.dom)return e.preventDefault(),!1;if(l&&i&&!s&&h){let e=n.closest("[data-drag-handle]");e&&(this.dom===e||this.dom.contains(e))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!s&&!o&&!c&&!d&&!u&&(!h||!a)}ignoreMutation(e){return!this.dom||!this.contentDOM||("function"==typeof this.options.ignoreMutation?this.options.ignoreMutation({mutation:e}):!!this.node.isLeaf||!!this.node.isAtom||!("selection"===e.type||this.dom.contains(e.target)&&"childList"===e.type&&(iL()||iR())&&this.editor.isFocused&&[...Array.from(e.addedNodes),...Array.from(e.removedNodes)].every(e=>e.isContentEditable))&&(this.contentDOM===e.target&&"attributes"===e.type||!this.contentDOM.contains(e.target)))}updateAttributes(e){this.editor.commands.command(({tr:t})=>{let n=this.getPos();return"number"==typeof n&&(t.setNodeMarkup(n,void 0,{...this.node.attrs,...e}),!0)})}deleteNode(){let e=this.getPos();if("number"!=typeof e)return;let t=e+this.node.nodeSize;this.editor.commands.deleteRange({from:e,to:t})}};function lj(e){return new la({find:e.find,handler:({state:t,range:n,match:r,pasteEvent:o})=>{let i=sg(e.getAttributes,void 0,r,o);if(!1===i||null===i)return null;let{tr:s}=t,l=r[r.length-1],a=r[0],c=n.to;if(l){let r=a.search(/\S/),o=n.from+a.indexOf(l),d=o+l.length;if(sI(n.from,n.to,t.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>o).length)return null;d<n.to&&s.delete(d,n.to),o>n.from&&s.delete(n.from+r,o),c=n.from+r+l.length,s.addMark(n.from+r,c,e.type.create(i||{})),s.removeStoredMark(e.type)}}})}var lF=new Uint8Array(16);let lU=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var lz=[],lV=0;lV<256;++lV)lz.push((lV+256).toString(16).substr(1));let l$=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(lz[e[t+0]]+lz[e[t+1]]+lz[e[t+2]]+lz[e[t+3]]+"-"+lz[e[t+4]]+lz[e[t+5]]+"-"+lz[e[t+6]]+lz[e[t+7]]+"-"+lz[e[t+8]]+lz[e[t+9]]+"-"+lz[e[t+10]]+lz[e[t+11]]+lz[e[t+12]]+lz[e[t+13]]+lz[e[t+14]]+lz[e[t+15]]).toLowerCase();if(!("string"==typeof n&&lU.test(n)))throw TypeError("Stringified UUID is invalid");return n},lG=function(e,t,n){var r=(e=e||{}).random||(e.rng||function(){if(!M&&!(M="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return M(lF)})();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return l$(r)},lq=lh.create({name:"uniqueID",priority:1e4,addOptions:()=>({attributeName:"id",types:[],setIdAttribute:!1,generateID:()=>{if("u">typeof window&&window.__TEST_OPTIONS){let e=window.__TEST_OPTIONS;return void 0===e.mockID?e.mockID=0:e.mockID++,e.mockID.toString()}return lG()},filterTransaction:null}),addGlobalAttributes(){return[{types:this.options.types,attributes:{[this.options.attributeName]:{default:null,parseHTML:e=>e.getAttribute(`data-${this.options.attributeName}`),renderHTML:e=>{let t={[`data-${this.options.attributeName}`]:e[this.options.attributeName]};return this.options.setIdAttribute?{...t,id:e[this.options.attributeName]}:t}}}}]},addProseMirrorPlugins(){let e=null,t=!1;return[new t4({key:new t8("uniqueID"),appendTransaction:(e,t,n)=>{let r=e.some(e=>e.docChanged)&&!t.doc.eq(n.doc),o=this.options.filterTransaction&&e.some(e=>{var t,n;return!(null!=(n=(t=this.options).filterTransaction)&&n.call(t,e))});if(!r||o)return;let{tr:i}=n,{types:s,attributeName:l,generateID:a}=this.options,c=sa(t.doc,e),{mapping:d}=c;if(sM(c).forEach(({newRange:e})=>{var r;let o=sd(n.doc,e,e=>s.includes(e.type.name)),c=function(e,t=JSON.stringify){let n={};return e.filter(e=>{let r=t(e);return!Object.prototype.hasOwnProperty.call(n,r)&&(n[r]=!0)})}((r=o.map(({node:e})=>e.attrs[l]).filter(e=>null!==e)).filter((e,t)=>r.indexOf(e)!==t));o.forEach(({node:e,pos:r})=>{var o;let s=null==(o=i.doc.nodeAt(r))?void 0:o.attrs[l];if(null===s){let o=t.doc.type.createAndFill().content;if(null===t.doc.content.findDiffStart(o)){let t=JSON.parse(JSON.stringify(n.doc.toJSON()));if(t.content[0].content[0].attrs.id="initialBlockId",JSON.stringify(t.content)===JSON.stringify(o.toJSON()))return void i.setNodeMarkup(r,void 0,{...e.attrs,[l]:"initialBlockId"})}i.setNodeMarkup(r,void 0,{...e.attrs,[l]:a()});return}let{deleted:u}=d.invert().mapResult(r);u&&c.includes(s)&&i.setNodeMarkup(r,void 0,{...e.attrs,[l]:a()})})}),i.steps.length)return i.setMeta("uniqueID",!0),i},view(t){let n=n=>{let r;e=null!=(r=t.dom.parentElement)&&r.contains(n.target)?t.dom.parentElement:null};return window.addEventListener("dragstart",n),{destroy(){window.removeEventListener("dragstart",n)}}},props:{handleDOMEvents:{drop:(n,r)=>{let o;return t=e!==n.dom.parentElement||(null==(o=r.dataTransfer)?void 0:o.effectAllowed)==="copy",e=null,!1},paste:()=>(t=!0,!1)},transformPasted:e=>{if(!t)return e;let{types:n,attributeName:r}=this.options,o=e=>{let t=[];return e.forEach(e=>{if(e.isText)return void t.push(e);if(!n.includes(e.type.name))return void t.push(e.copy(o(e.content)));let i=e.type.create({...e.attrs,[r]:null},o(e.content),e.marks);t.push(i)}),em.from(t)};return t=!1,new ek(o(e.content),e.openStart,e.openEnd)}}})]}});function lW(e){return"link"===e.type}function lY(e){return"string"!=typeof e&&"link"===e.type}function lK(e){return"string"!=typeof e&&"text"===e.type}function lZ(e){var t,n,r,o,i;return lQ(e)?{...e}:lX(e)?{type:"tableCell",content:[].concat(e.content),props:{backgroundColor:(null==(t=e.props)?void 0:t.backgroundColor)??"default",textColor:(null==(n=e.props)?void 0:n.textColor)??"default",textAlignment:(null==(r=e.props)?void 0:r.textAlignment)??"left",colspan:(null==(o=e.props)?void 0:o.colspan)??1,rowspan:(null==(i=e.props)?void 0:i.rowspan)??1}}:{type:"tableCell",content:[].concat(e),props:{backgroundColor:"default",textColor:"default",textAlignment:"left",colspan:1,rowspan:1}}}function lX(e){return null!=e&&"string"!=typeof e&&!Array.isArray(e)&&"tableCell"===e.type}function lQ(e){return lX(e)&&void 0!==e.props&&void 0!==e.content}function lJ(e){return lQ(e)?e.props.colspan??1:1}function l0(e){return lQ(e)?e.props.rowspan??1:1}class l1 extends Error{constructor(e){super(`Unreachable case: ${e}`)}}function l2(e,t=!0){let{"data-test":n,...r}=e;if(Object.keys(r).length>0&&t)throw Error("Object must be empty "+JSON.stringify(e))}function l4(e,t){let n=e.resolve(t);if(n.nodeAfter&&n.nodeAfter.type.isInGroup("bnBlock"))return{posBeforeNode:n.pos,node:n.nodeAfter};let r=n.depth,o=n.node(r);for(;r>0;){if(o.type.isInGroup("bnBlock"))return{posBeforeNode:n.before(r),node:o};r--,o=n.node(r)}let i=[];e.descendants((e,t)=>{e.type.isInGroup("bnBlock")&&i.push(t)}),console.warn(`Position ${t} is not within a blockContainer node.`);let s=e.resolve(i.find(e=>e>=t)||i[i.length-1]);return{posBeforeNode:s.pos,node:s.nodeAfter}}function l5(e,t){if(!e.type.isInGroup("bnBlock"))throw Error(`Attempted to get bnBlock node at position but found node of different type ${e.type.name}`);let n=t+e.nodeSize,r={node:e,beforePos:t,afterPos:n};if("blockContainer"===e.type.name){let n,o;if(e.forEach((e,r)=>{if("blockContent"===e.type.spec.group){let o=t+r+1,i=o+e.nodeSize;n={node:e,beforePos:o,afterPos:i}}else if("blockGroup"===e.type.name){let n=t+r+1,i=n+e.nodeSize;o={node:e,beforePos:n,afterPos:i}}}),!n)throw Error(`blockContainer node does not contain a blockContent node in its children: ${e}`);return{isBlockContainer:!0,bnBlock:r,blockContent:n,childContainer:o,blockNoteType:n.node.type.name}}if(!r.node.type.isInGroup("childContainer"))throw Error(`bnBlock node is not in the childContainer group: ${r.node}`);return{isBlockContainer:!1,bnBlock:r,childContainer:r,blockNoteType:r.node.type.name}}function l3(e){return l5(e.node,e.posBeforeNode)}function l8(e){if(!e.nodeAfter)throw Error(`Attempted to get blockContainer node at position ${e.pos} but a node at this position does not exist`);return l5(e.nodeAfter,e.pos)}function l6(e){return l3(l4(e.doc,e.selection.anchor))}function l9(e){return l3(l4(e.doc,e.selection.anchor))}function l7(e){return"doc"in e?e.doc.type.schema:e.type.schema}function ae(e){return e.cached.blockNoteEditor}function at(e){return ae(e).schema}function an(e){return at(e).blockSchema}function ar(e){return at(e).inlineContentSchema}function ao(e){return at(e).styleSchema}function ai(e){return ae(e).blockCache}function as(e,t,n){var r,o;let i={type:"tableContent",columnWidths:[],headerRows:void 0,headerCols:void 0,rows:[]},s=[];e.content.forEach((e,r,o)=>{let l={cells:[]};0===o&&e.content.forEach(e=>{let t=e.attrs.colwidth;null==t&&(t=Array(e.attrs.colspan??1).fill(void 0)),i.columnWidths.push(...t)}),l.cells=e.content.content.map((e,r)=>(s[o]||(s[o]=[]),s[o][r]="tableHeader"===e.type.name,{type:"tableCell",content:e.content.content.map(e=>al(e,t,n)).reduce((e,t)=>{if(!e.length)return t;let n=e[e.length-1],r=t[0];return r&&lK(n)&&lK(r)&&JSON.stringify(n.styles)===JSON.stringify(r.styles)?(n.text+=`
`+r.text,e.push(...t.slice(1))):e.push(...t),e},[]),props:{colspan:e.attrs.colspan,rowspan:e.attrs.rowspan,backgroundColor:e.attrs.backgroundColor,textColor:e.attrs.textColor,textAlignment:e.attrs.textAlignment}})),i.rows.push(l)});for(let e=0;e<s.length;e++)null!=(r=s[e])&&r.every(e=>e)&&(i.headerRows=(i.headerRows??0)+1);for(let e=0;e<(null==(o=s[0])?void 0:o.length);e++)null!=s&&s.every(t=>t[e])&&(i.headerCols=(i.headerCols??0)+1);return i}function al(e,t,n){let r,o=[];return e.content.forEach(e=>{let i;if("hardBreak"===e.type.name){if(r)if(lK(r))r.text+=`
`;else if(lW(r))r.content[r.content.length-1].text+=`
`;else throw Error("unexpected");else r={type:"text",text:`
`,styles:{}};return}if("link"!==e.type.name&&"text"!==e.type.name)return t[e.type.name]?(r&&(o.push(r),r=void 0),void o.push(aa(e,t,n))):void console.warn("unrecognized inline content type",e.type.name);let s={};for(let t of e.marks)if("link"===t.type.name)i=t;else{let e=n[t.type.name];if(!e){if(t.type.spec.blocknoteIgnore)continue;throw Error(`style ${t.type.name} not found in styleSchema`)}if("boolean"===e.propSchema)s[e.type]=!0;else if("string"===e.propSchema)s[e.type]=t.attrs.stringValue;else throw new l1(e.propSchema)}r?lK(r)?i?(o.push(r),r={type:"link",href:i.attrs.href,content:[{type:"text",text:e.textContent,styles:s}]}):JSON.stringify(r.styles)===JSON.stringify(s)?r.text+=e.textContent:(o.push(r),r={type:"text",text:e.textContent,styles:s}):lW(r)&&(i?r.href===i.attrs.href?JSON.stringify(r.content[r.content.length-1].styles)===JSON.stringify(s)?r.content[r.content.length-1].text+=e.textContent:r.content.push({type:"text",text:e.textContent,styles:s}):(o.push(r),r={type:"link",href:i.attrs.href,content:[{type:"text",text:e.textContent,styles:s}]}):(o.push(r),r={type:"text",text:e.textContent,styles:s})):r=i?{type:"link",href:i.attrs.href,content:[{type:"text",text:e.textContent,styles:s}]}:{type:"text",text:e.textContent,styles:s}}),r&&o.push(r),o}function aa(e,t,n){let r;if("text"===e.type.name||"link"===e.type.name)throw Error("unexpected");let o={},i=t[e.type.name];for(let[t,n]of Object.entries(e.attrs)){if(!i)throw Error("ic node is of an unrecognized type: "+e.type.name);t in i.propSchema&&(o[t]=n)}return r="styled"===i.content?al(e,t,n):void 0,{type:e.type.name,props:o,content:r}}function ac(e,t,n=an(t),r=ar(t),o=ao(t),i=ai(t)){var s;let l;if(!e.type.isInGroup("bnBlock"))throw Error("Node should be a bnBlock, but is instead: "+e.type.name);let a=null==i?void 0:i.get(e);if(a)return a;let c=l5(e,0),d=c.bnBlock.node.attrs.id;null===d&&(d=lq.options.generateID());let u=n[c.blockNoteType];if(!u)throw Error("Block is of an unrecognized type: "+c.blockNoteType);let h={};for(let[t,n]of Object.entries({...e.attrs,...c.isBlockContainer?c.blockContent.node.attrs:{}})){let e=u.propSchema;t in e&&(void 0!==e[t].default||void 0!==n)&&(h[t]=n)}let p=n[c.blockNoteType],f=[];if(null==(s=c.childContainer)||s.node.forEach(e=>{f.push(ac(e,t,n,r,o,i))}),"inline"===p.content){if(!c.isBlockContainer)throw Error("impossible");l=al(c.blockContent.node,r,o)}else if("table"===p.content){if(!c.isBlockContainer)throw Error("impossible");l=as(c.blockContent.node,r,o)}else if("none"===p.content)l=void 0;else throw new l1(p.content);let m={id:d,type:p.type,props:h,content:l,children:f};return null==i||i.set(e,m),m}function ad(e){let{height:t,width:n}=ap(e),r=Array(t).fill(!1).map(()=>Array(n).fill(null)),o=(e,o)=>{for(let i=e;i<t;i++)for(let e=o;e<n;e++)if(!r[i][e])return{row:i,col:e};throw Error("Unable to create occupancy grid for table, no more available cells")};for(let t=0;t<e.content.rows.length;t++)for(let n=0;n<e.content.rows[t].cells.length;n++){let i=lZ(e.content.rows[t].cells[n]),s=l0(i),l=lJ(i),{row:a,col:c}=o(t,n);for(let e=a;e<a+s;e++)for(let o=c;o<c+l;o++){if(r[e][o])throw Error(`Unable to create occupancy grid for table, cell at ${e},${o} is already occupied`);r[e][o]={row:t,col:n,rowspan:s,colspan:l,cell:i}}}return r}function au(e){let t=new Set;return e.map(e=>({cells:e.map(e=>!t.has(e.row+":"+e.col)&&(t.add(e.row+":"+e.col),e.cell)).filter(e=>!1!==e)}))}function ah(e,t,n=ad(t)){for(let t=0;t<n.length;t++)for(let r=0;r<n[t].length;r++){let o=n[t][r];if(o&&o.row===e.row&&o.col===e.col)return{row:t,col:r,cell:o.cell}}throw Error(`Unable to resolve relative table cell indices for table, cell at ${e.row},${e.col} is not occupied`)}function ap(e){let t=e.content.rows.length,n=0;return e.content.rows.forEach(e=>{let t=0;e.cells.forEach(e=>{t+=lJ(e)}),n=Math.max(n,t)}),{height:t,width:n}}function af(e,t,n=ad(t)){var r;let o=null==(r=n[e.row])?void 0:r[e.col];if(o)return{row:o.row,col:o.col,cell:o.cell}}function am(e,t){var n;let r=ad(e);if(t<0||t>=r.length)return[];let o=0;for(let e=0;e<t;e++){let e=null==(n=r[o])?void 0:n[0];if(!e)return[];o+=e.rowspan}let i=Array(r[0].length).fill(!1).map((t,n)=>af({row:o,col:n},e,r)).filter(e=>void 0!==e);return i.filter((e,t)=>i.findIndex(t=>t.row===e.row&&t.col===e.col)===t)}function ag(e,t){var n;let r=ad(e);if(t<0||t>=r[0].length)return[];let o=0;for(let e=0;e<t;e++){let e=null==(n=r[0])?void 0:n[o];if(!e)return[];o+=e.colspan}let i=Array(r.length).fill(!1).map((t,n)=>af({row:n,col:o},e,r)).filter(e=>void 0!==e);return i.filter((e,t)=>i.findIndex(t=>t.row===e.row&&t.col===e.col)===t)}function ab(e){return!e||(lX(e)?ab(e.content):"string"==typeof e?0===e.length:!!Array.isArray(e)&&e.every(e=>"string"==typeof e?0===e.length:lK(e)?0===e.text.length:!!lY(e)&&("string"==typeof e.content?0===e.content.length:e.content.every(e=>0===e.text.length))))}function ay(e,t,n){let r=am(e,n);if(!r.some(e=>l0(e.cell)>1))return!0;let o=n,i=n;return r.forEach(e=>{let t=l0(e.cell);o=Math.max(o,e.row+t-1),i=Math.min(i,e.row)}),t<n?n===o:n===i}function av(e,t,n){let r=ag(e,n);if(!r.some(e=>lJ(e.cell)>1))return!0;let o=n,i=n;return r.forEach(e=>{let t=lJ(e.cell);o=Math.max(o,e.col+t-1),i=Math.min(i,e.col)}),t<n?n===o:n===i}function aE(e,t,n,r){let o=[];for(let[r,i]of Object.entries(e.styles||{})){let e=n[r];if(!e)throw Error(`style ${r} not found in styleSchema`);if("boolean"===e.propSchema)i&&o.push(t.mark(r));else if("string"===e.propSchema)i&&o.push(t.mark(r,{stringValue:i}));else throw new l1(e.propSchema)}return r&&t.nodes[r].spec.code?e.text.length>0?[t.text(e.text,o)]:[]:e.text.split(/(\n)/g).filter(e=>e.length>0).map(e=>e===`
`?t.nodes.hardBreak.createChecked():t.text(e,o))}function ak(e,t,n,r){let o=[];if("string"==typeof e)return o.push(...aE({text:e,styles:{}},t,n,r)),o;for(let i of e)o.push(...aE(i,t,n,r));return o}function aC(e,t,n,r=ao(t)){let o=[];for(let i of e)"string"==typeof i?o.push(...ak(i,t,r,n)):lY(i)?o.push(...function(e,t,n){let r=t.marks.link.create({href:e.href});return ak(e.content,t,n).map(e=>{if("text"===e.type.name)return e.mark([...e.marks,r]);if("hardBreak"===e.type.name)return e;throw Error("unexpected node type")})}(i,t,r)):lK(i)?o.push(...ak([i],t,r,n)):o.push(aw(i,t,r));return o}function aT(e,t,n=ao(t)){let r=[],o=Array(e.headerRows??0).fill(!0),i=Array(e.headerCols??0).fill(!0),s=e.columnWidths??[];for(let l=0;l<e.rows.length;l++){let a=e.rows[l],c=[],d=o[l];for(let r=0;r<a.cells.length;r++){let o=a.cells[r],u=i[r],h,p=null,f=ah({row:l,col:r},{content:e}),m=s[f.col]?[s[f.col]]:null;if(o)if("string"==typeof o)p=t.text(o);else if(lX(o)){o.content&&(p=aC(o.content,t,"tableParagraph",n));let e=lJ(o);e>1&&(m=Array(e).fill(!1).map((e,t)=>s[f.col+t]??void 0))}else p=aC(o,t,"tableParagraph",n);let g=t.nodes[u||d?"tableHeader":"tableCell"].createChecked({...lX(o)?o.props:{},colwidth:m},t.nodes.tableParagraph.createChecked(h,p));c.push(g)}let u=t.nodes.tableRow.createChecked({},c);r.push(u)}return r}function aw(e,t,n){let r,o=e.type;if(void 0===o&&(o="paragraph"),!t.nodes[o])throw Error(`node type ${o} not found in schema`);if(e.content)if("string"==typeof e.content){let i=aC([e.content],t,o,n);r=t.nodes[o].createChecked(e.props,i)}else if(Array.isArray(e.content)){let i=aC(e.content,t,o,n);r=t.nodes[o].createChecked(e.props,i)}else if("tableContent"===e.content.type){let i=aT(e.content,t,n);r=t.nodes[o].createChecked(e.props,i)}else throw new l1(e.content.type);else r=t.nodes[o].createChecked(e.props);return r}function ax(e,t,n=ao(t)){let r=e.id;void 0===r&&(r=lq.options.generateID());let o=[];if(e.children)for(let r of e.children)o.push(ax(r,t,n));if(!e.type||t.nodes[e.type].isInGroup("blockContent")){let i=aw(e,t,n),s=o.length>0?t.nodes.blockGroup.createChecked({},o):void 0;return t.nodes.blockContainer.createChecked({id:r,...e.props},s?[i,s]:i)}if(t.nodes[e.type].isInGroup("bnBlock"))return t.nodes[e.type].createChecked({id:r,...e.props},o);throw Error(`block type ${e.type} doesn't match blockContent or bnBlock group`)}var aS=e.i(11771);if("undefined"!=typeof WeakMap){let e=new WeakMap;t=t=>e.get(t),n=(t,n)=>(e.set(t,n),n)}else{let e=[],r=0;t=t=>{for(let n=0;n<e.length;n+=2)if(e[n]==t)return e[n+1]},n=(t,n)=>(10==r&&(r=0),e[r++]=t,e[r++]=n)}var aA=class{constructor(e,t,n,r){this.width=e,this.height=t,this.map=n,this.problems=r}findCell(e){for(let t=0;t<this.map.length;t++){let n=this.map[t];if(n!=e)continue;let r=t%this.width,o=t/this.width|0,i=r+1,s=o+1;for(let e=1;i<this.width&&this.map[t+e]==n;e++)i++;for(let e=1;s<this.height&&this.map[t+this.width*e]==n;e++)s++;return{left:r,top:o,right:i,bottom:s}}throw RangeError(`No cell with offset ${e} found`)}colCount(e){for(let t=0;t<this.map.length;t++)if(this.map[t]==e)return t%this.width;throw RangeError(`No cell with offset ${e} found`)}nextCell(e,t,n){let{left:r,right:o,top:i,bottom:s}=this.findCell(e);return"horiz"==t?(n<0?0==r:o==this.width)?null:this.map[i*this.width+(n<0?r-1:o)]:(n<0?0==i:s==this.height)?null:this.map[r+this.width*(n<0?i-1:s)]}rectBetween(e,t){let{left:n,right:r,top:o,bottom:i}=this.findCell(e),{left:s,right:l,top:a,bottom:c}=this.findCell(t);return{left:Math.min(n,s),top:Math.min(o,a),right:Math.max(r,l),bottom:Math.max(i,c)}}cellsInRect(e){let t=[],n={};for(let r=e.top;r<e.bottom;r++)for(let o=e.left;o<e.right;o++){let i=r*this.width+o,s=this.map[i];!n[s]&&(n[s]=!0,o==e.left&&o&&this.map[i-1]==s||r==e.top&&r&&this.map[i-this.width]==s||t.push(s))}return t}positionAt(e,t,n){for(let r=0,o=0;;r++){let i=o+n.child(r).nodeSize;if(r==e){let n=t+e*this.width,r=(e+1)*this.width;for(;n<r&&this.map[n]<o;)n++;return n==r?i-1:this.map[n]}o=i}}static get(e){return t(e)||n(e,function(e){if("table"!=e.type.spec.tableRole)throw RangeError("Not a table node: "+e.type.name);let t=function(e){let t=-1,n=!1;for(let r=0;r<e.childCount;r++){let o=e.child(r),i=0;if(n)for(let t=0;t<r;t++){let n=e.child(t);for(let e=0;e<n.childCount;e++){let o=n.child(e);t+o.attrs.rowspan>r&&(i+=o.attrs.colspan)}}for(let e=0;e<o.childCount;e++){let t=o.child(e);i+=t.attrs.colspan,t.attrs.rowspan>1&&(n=!0)}-1==t?t=i:t!=i&&(t=Math.max(t,i))}return t}(e),n=e.childCount,r=[],o=0,i=null,s=[];for(let e=0,o=t*n;e<o;e++)r[e]=0;for(let l=0,a=0;l<n;l++){let c=e.child(l);a++;for(let e=0;;e++){for(;o<r.length&&0!=r[o];)o++;if(e==c.childCount)break;let d=c.child(e),{colspan:u,rowspan:h,colwidth:p}=d.attrs;for(let e=0;e<h;e++){if(e+l>=n){(i||(i=[])).push({type:"overlong_rowspan",pos:a,n:h-e});break}let c=o+e*t;for(let e=0;e<u;e++){0==r[c+e]?r[c+e]=a:(i||(i=[])).push({type:"collision",row:l,pos:a,n:u-e});let n=p&&p[e];if(n){let r=(c+e)%t*2,o=s[r];null==o||o!=n&&1==s[r+1]?(s[r]=n,s[r+1]=1):o==n&&s[r+1]++}}}o+=u,a+=d.nodeSize}let d=(l+1)*t,u=0;for(;o<d;)0==r[o++]&&u++;u&&(i||(i=[])).push({type:"missing",row:l,n:u}),a++}(0===t||0===n)&&(i||(i=[])).push({type:"zero_sized"});let l=new aA(t,n,r,i),a=!1;for(let e=0;!a&&e<s.length;e+=2)null!=s[e]&&s[e+1]<n&&(a=!0);return a&&function(e,t,n){e.problems||(e.problems=[]);let r={};for(let o=0;o<e.map.length;o++){let i=e.map[o];if(r[i])continue;r[i]=!0;let s=n.nodeAt(i);if(!s)throw RangeError(`No cell with offset ${i} found`);let l=null,a=s.attrs;for(let n=0;n<a.colspan;n++){let r=t[(o+n)%e.width*2];null==r||a.colwidth&&a.colwidth[n]==r||((l||(l=function(e){if(e.colwidth)return e.colwidth.slice();let t=[];for(let n=0;n<e.colspan;n++)t.push(0);return t}(a)))[n]=r)}l&&e.problems.unshift({type:"colwidth mismatch",pos:i,colwidth:l})}}(l,s,e),l}(e))}};function a_(e){let t=e.cached.tableNodeTypes;if(!t)for(let n in t=e.cached.tableNodeTypes={},e.nodes){let r=e.nodes[n],o=r.spec.tableRole;o&&(t[o]=r)}return t}let aN=new t8("selectingCells");function aM(e){for(let t=e.depth-1;t>0;t--)if("row"==e.node(t).type.spec.tableRole)return e.node(0).resolve(e.before(t+1));return null}function aI(e){let t=e.selection.$head;for(let e=t.depth;e>0;e--)if("row"==t.node(e).type.spec.tableRole)return!0;return!1}function aO(e){let t=e.selection;if("$anchorCell"in t&&t.$anchorCell)return t.$anchorCell.pos>t.$headCell.pos?t.$anchorCell:t.$headCell;if("node"in t&&t.node&&"cell"==t.node.type.spec.tableRole)return t.$anchor;let n=aM(t.$head)||function(e){for(let t=e.nodeAfter,n=e.pos;t;t=t.firstChild,n++){let r=t.type.spec.tableRole;if("cell"==r||"header_cell"==r)return e.doc.resolve(n)}for(let t=e.nodeBefore,n=e.pos;t;t=t.lastChild,n--){let r=t.type.spec.tableRole;if("cell"==r||"header_cell"==r)return e.doc.resolve(n-t.nodeSize)}}(t.$head);if(n)return n;throw RangeError(`No cell found around position ${t.head}`)}function aD(e){return"row"==e.parent.type.spec.tableRole&&!!e.nodeAfter}function aR(e,t){return e.depth==t.depth&&e.pos>=t.start(-1)&&e.pos<=t.end(-1)}function aL(e,t,n){let r=e.node(-1),o=aA.get(r),i=e.start(-1),s=o.nextCell(e.pos-i,t,n);return null==s?null:e.node(0).resolve(i+s)}function aP(e,t,n=1){let r={...e,colspan:e.colspan-n};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(t,n),r.colwidth.some(e=>e>0)||(r.colwidth=null)),r}function aB(e,t,n=1){let r={...e,colspan:e.colspan+n};if(r.colwidth){r.colwidth=r.colwidth.slice();for(let e=0;e<n;e++)r.colwidth.splice(t,0,0)}return r}var aH=class e extends tj{constructor(e,t=e){const n=e.node(-1),r=aA.get(n),o=e.start(-1),i=r.rectBetween(e.pos-o,t.pos-o),s=e.node(0),l=r.cellsInRect(i).filter(e=>e!=t.pos-o);l.unshift(t.pos-o);const a=l.map(e=>{let t=n.nodeAt(e);if(!t)throw RangeError(`No cell with offset ${e} found`);let r=o+e+1;return new tF(s.resolve(r),s.resolve(r+t.content.size))});super(a[0].$from,a[0].$to,a),this.$anchorCell=e,this.$headCell=t}map(t,n){let r=t.resolve(n.map(this.$anchorCell.pos)),o=t.resolve(n.map(this.$headCell.pos));if(aD(r)&&aD(o)&&aR(r,o)){let t=this.$anchorCell.node(-1)!=r.node(-1);return t&&this.isRowSelection()?e.rowSelection(r,o):t&&this.isColSelection()?e.colSelection(r,o):new e(r,o)}return tV.between(r,o)}content(){let e=this.$anchorCell.node(-1),t=aA.get(e),n=this.$anchorCell.start(-1),r=t.rectBetween(this.$anchorCell.pos-n,this.$headCell.pos-n),o={},i=[];for(let n=r.top;n<r.bottom;n++){let s=[];for(let i=n*t.width+r.left,l=r.left;l<r.right;l++,i++){let n=t.map[i];if(o[n])continue;o[n]=!0;let l=t.findCell(n),a=e.nodeAt(n);if(!a)throw RangeError(`No cell with offset ${n} found`);let c=r.left-l.left,d=l.right-r.right;if(c>0||d>0){let e=a.attrs;if(c>0&&(e=aP(e,0,c)),d>0&&(e=aP(e,e.colspan-d,d)),l.left<r.left){if(!(a=a.type.createAndFill(e)))throw RangeError(`Could not create cell with attrs ${JSON.stringify(e)}`)}else a=a.type.create(e,a.content)}if(l.top<r.top||l.bottom>r.bottom){let e={...a.attrs,rowspan:Math.min(l.bottom,r.bottom)-Math.max(l.top,r.top)};a=l.top<r.top?a.type.createAndFill(e):a.type.create(e,a.content)}s.push(a)}i.push(e.child(n).copy(em.from(s)))}let s=this.isColSelection()&&this.isRowSelection()?e:i;return new ek(em.from(s),1,1)}replace(e,t=ek.empty){let n=e.steps.length,r=this.ranges;for(let o=0;o<r.length;o++){let{$from:i,$to:s}=r[o],l=e.mapping.slice(n);e.replace(l.map(i.pos),l.map(s.pos),o?ek.empty:t)}let o=tj.findFrom(e.doc.resolve(e.mapping.slice(n).map(this.to)),-1);o&&e.setSelection(o)}replaceWith(e,t){this.replace(e,new ek(em.from(t),0,0))}forEachCell(e){let t=this.$anchorCell.node(-1),n=aA.get(t),r=this.$anchorCell.start(-1),o=n.cellsInRect(n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r));for(let n=0;n<o.length;n++)e(t.nodeAt(o[n]),r+o[n])}isColSelection(){let e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);return!(Math.min(e,t)>0)&&Math.max(e+this.$anchorCell.nodeAfter.attrs.rowspan,t+this.$headCell.nodeAfter.attrs.rowspan)==this.$headCell.node(-1).childCount}static colSelection(t,n=t){let r=t.node(-1),o=aA.get(r),i=t.start(-1),s=o.findCell(t.pos-i),l=o.findCell(n.pos-i),a=t.node(0);return s.top<=l.top?(s.top>0&&(t=a.resolve(i+o.map[s.left])),l.bottom<o.height&&(n=a.resolve(i+o.map[o.width*(o.height-1)+l.right-1]))):(l.top>0&&(n=a.resolve(i+o.map[l.left])),s.bottom<o.height&&(t=a.resolve(i+o.map[o.width*(o.height-1)+s.right-1]))),new e(t,n)}isRowSelection(){let e=this.$anchorCell.node(-1),t=aA.get(e),n=this.$anchorCell.start(-1),r=t.colCount(this.$anchorCell.pos-n),o=t.colCount(this.$headCell.pos-n);return!(Math.min(r,o)>0)&&Math.max(r+this.$anchorCell.nodeAfter.attrs.colspan,o+this.$headCell.nodeAfter.attrs.colspan)==t.width}eq(t){return t instanceof e&&t.$anchorCell.pos==this.$anchorCell.pos&&t.$headCell.pos==this.$headCell.pos}static rowSelection(t,n=t){let r=t.node(-1),o=aA.get(r),i=t.start(-1),s=o.findCell(t.pos-i),l=o.findCell(n.pos-i),a=t.node(0);return s.left<=l.left?(s.left>0&&(t=a.resolve(i+o.map[s.top*o.width])),l.right<o.width&&(n=a.resolve(i+o.map[o.width*(l.top+1)-1]))):(l.left>0&&(n=a.resolve(i+o.map[l.top*o.width])),s.right<o.width&&(t=a.resolve(i+o.map[o.width*(s.top+1)-1]))),new e(t,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(t,n){return new e(t.resolve(n.anchor),t.resolve(n.head))}static create(t,n,r=n){return new e(t.resolve(n),t.resolve(r))}getBookmark(){return new aj(this.$anchorCell.pos,this.$headCell.pos)}};aH.prototype.visible=!1,tj.jsonID("cell",aH);var aj=class e{constructor(e,t){this.anchor=e,this.head=t}map(t){return new e(t.map(this.anchor),t.map(this.head))}resolve(e){let t=e.resolve(this.anchor),n=e.resolve(this.head);return"row"==t.parent.type.spec.tableRole&&"row"==n.parent.type.spec.tableRole&&t.index()<t.parent.childCount&&n.index()<n.parent.childCount&&aR(t,n)?new aH(t,n):tj.near(n,1)}};function aF(e){if(!(e.selection instanceof aH))return null;let t=[];return e.selection.forEachCell((e,n)=>{t.push(ow.node(n,n+e.nodeSize,{class:"selectedCell"}))}),oA.create(e.doc,t)}let aU=new t8("fix-tables");function az(e){let t=e.selection,n=aO(e),r=n.node(-1),o=n.start(-1),i=aA.get(r);return{...t instanceof aH?i.rectBetween(t.$anchorCell.pos-o,t.$headCell.pos-o):i.findCell(n.pos-o),tableStart:o,map:i,table:r}}function aV(e,{map:t,tableStart:n,table:r},o){let i=o>0?-1:0;(function(e,t,n){let r=a_(t.type.schema).header_cell;for(let o=0;o<e.height;o++)if(t.nodeAt(e.map[n+o*e.width]).type!=r)return!1;return!0})(t,r,o+i)&&(i=0==o||o==t.width?null:0);for(let s=0;s<t.height;s++){let l=s*t.width+o;if(o>0&&o<t.width&&t.map[l-1]==t.map[l]){let i=t.map[l],a=r.nodeAt(i);e.setNodeMarkup(e.mapping.map(n+i),null,aB(a.attrs,o-t.colCount(i))),s+=a.attrs.rowspan-1}else{let a=null==i?a_(r.type.schema).cell:r.nodeAt(t.map[l+i]).type,c=t.positionAt(s,o,r);e.insert(e.mapping.map(n+c),a.createAndFill())}}return e}function a$(e,{map:t,tableStart:n,table:r},o){let i=n;for(let e=0;e<o;e++)i+=r.child(e).nodeSize;let s=[],l=o>0?-1:0;(function(e,t,n){var r;let o=a_(t.type.schema).header_cell;for(let i=0;i<e.width;i++)if((null==(r=t.nodeAt(e.map[i+n*e.width]))?void 0:r.type)!=o)return!1;return!0})(t,r,o+l)&&(l=0==o||o==t.height?null:0);for(let i=0,c=t.width*o;i<t.width;i++,c++)if(o>0&&o<t.height&&t.map[c]==t.map[c-t.width]){let o=t.map[c],s=r.nodeAt(o).attrs;e.setNodeMarkup(n+o,null,{...s,rowspan:s.rowspan+1}),i+=s.colspan-1}else{var a;let e=null==l?a_(r.type.schema).cell:null==(a=r.nodeAt(t.map[c+l*t.width]))?void 0:a.type,n=null==e?void 0:e.createAndFill();n&&s.push(n)}return e.insert(i,a_(r.type.schema).row.create(null,s)),e}function aG(e){let t=e.content;return 1==t.childCount&&t.child(0).isTextblock&&0==t.child(0).childCount}function aq(e,t,n){let r=t.map.cellsInRect({left:0,top:0,right:"row"==e?t.map.width:1,bottom:"column"==e?t.map.height:1});for(let e=0;e<r.length;e++){let o=t.table.nodeAt(r[e]);if(o&&o.type!==n.header_cell)return!1}return!0}function aW(e,t){if((t=t||{useDeprecatedLogic:!1}).useDeprecatedLogic)return function(t,n){if(!aI(t))return!1;if(n){let r=a_(t.schema),o=az(t),i=t.tr,s=o.map.cellsInRect("column"==e?{left:o.left,top:0,right:o.right,bottom:o.map.height}:"row"==e?{left:0,top:o.top,right:o.map.width,bottom:o.bottom}:o),l=s.map(e=>o.table.nodeAt(e));for(let e=0;e<s.length;e++)l[e].type==r.header_cell&&i.setNodeMarkup(o.tableStart+s[e],r.cell,l[e].attrs);if(0===i.steps.length)for(let e=0;e<s.length;e++)i.setNodeMarkup(o.tableStart+s[e],r.header_cell,l[e].attrs);n(i)}return!0};return function(t,n){if(!aI(t))return!1;if(n){let r=a_(t.schema),o=az(t),i=t.tr,s=aq("row",o,r),l=aq("column",o,r),a=+("column"===e?!!s:"row"===e&&!!l),c="column"==e?{left:0,top:a,right:1,bottom:o.map.height}:"row"==e?{left:a,top:0,right:o.map.width,bottom:1}:o,d="column"==e?l?r.cell:r.header_cell:"row"==e?s?r.cell:r.header_cell:r.cell;o.map.cellsInRect(c).forEach(e=>{let t=e+o.tableStart,n=i.doc.nodeAt(t);n&&i.setNodeMarkup(t,d,n.attrs)}),n(i)}return!0}}function aY(e){return function(t,n){if(!aI(t))return!1;let r=function(e,t){if(t<0){let t=e.nodeBefore;if(t)return e.pos-t.nodeSize;for(let t=e.index(-1)-1,n=e.before();t>=0;t--){let r=e.node(-1).child(t),o=r.lastChild;if(o)return n-1-o.nodeSize;n-=r.nodeSize}}else{if(e.index()<e.parent.childCount-1)return e.pos+e.nodeAfter.nodeSize;let t=e.node(-1);for(let n=e.indexAfter(-1),r=e.after();n<t.childCount;n++){let e=t.child(n);if(e.childCount)return r+1;r+=e.nodeSize}}return null}(aO(t),e);if(null==r)return!1;if(n){let e=t.doc.resolve(r);n(t.tr.setSelection(tV.between(e,e.node(0).resolve(e.pos+e.nodeAfter.nodeSize))).scrollIntoView())}return!0}}function aK(e,t){let n=e.selection;if(!(n instanceof aH))return!1;if(t){let r=e.tr,o=a_(e.schema).cell.createAndFill().content;n.forEachCell((e,t)=>{e.content.eq(o)||r.replace(r.mapping.map(t+1),r.mapping.map(t+e.nodeSize-1),new ek(o,0,0))}),r.docChanged&&t(r)}return!0}function aZ(e,t){let n=e.createAndFill();return new tB(n).replace(0,n.content.size,t).doc}function aX(e,t,n,r,o,i,s,l){if(0==s||s==t.height)return!1;let a=!1;for(let c=o;c<i;c++){let o=s*t.width+c,i=t.map[o];if(t.map[o-t.width]==i){a=!0;let o=n.nodeAt(i),{top:d,left:u}=t.findCell(i);e.setNodeMarkup(e.mapping.slice(l).map(i+r),null,{...o.attrs,rowspan:s-d}),e.insert(e.mapping.slice(l).map(t.positionAt(s,u,n)),o.type.createAndFill({...o.attrs,rowspan:d+o.attrs.rowspan-s})),c+=o.attrs.colspan-1}}return a}function aQ(e,t,n,r,o,i,s,l){if(0==s||s==t.width)return!1;let a=!1;for(let c=o;c<i;c++){let o=c*t.width+s,i=t.map[o];if(t.map[o-1]==i){a=!0;let o=n.nodeAt(i),d=t.colCount(i),u=e.mapping.slice(l).map(i+r);e.setNodeMarkup(u,null,aP(o.attrs,s-d,o.attrs.colspan-(s-d))),e.insert(u+o.nodeSize,o.type.createAndFill(aP(o.attrs,0,s-d))),c+=o.attrs.rowspan-1}}return a}function aJ(e,t,n,r,o){let i=n?e.doc.nodeAt(n-1):e.doc;if(!i)throw Error("No table found");let s=aA.get(i),{top:l,left:a}=r,c=a+o.width,d=l+o.height,u=e.tr,h=0;function p(){if(!(i=n?u.doc.nodeAt(n-1):u.doc))throw Error("No table found");s=aA.get(i),h=u.mapping.maps.length}(function(e,t,n,r,o,i,s){let l,a,c=a_(e.doc.type.schema);if(o>t.width)for(let i=0,s=0;i<t.height;i++){let d,u=n.child(i);s+=u.nodeSize;let h=[];d=null==u.lastChild||u.lastChild.type==c.cell?l||(l=c.cell.createAndFill()):a||(a=c.header_cell.createAndFill());for(let e=t.width;e<o;e++)h.push(d);e.insert(e.mapping.slice(0).map(s-1+r),h)}if(i>t.height){let s=[];for(let e=0,r=(t.height-1)*t.width;e<Math.max(t.width,o);e++){let o=!(e>=t.width)&&n.nodeAt(t.map[r+e]).type==c.header_cell;s.push(o?a||(a=c.header_cell.createAndFill()):l||(l=c.cell.createAndFill()))}let d=c.row.create(null,em.from(s)),u=[];for(let e=t.height;e<i;e++)u.push(d);e.insert(e.mapping.slice(0).map(r+n.nodeSize-2),u)}return!!(l||a)})(u,s,i,n,c,d,0)&&p(),aX(u,s,i,n,a,c,l,h)&&p(),aX(u,s,i,n,a,c,d,h)&&p(),aQ(u,s,i,n,l,d,a,h)&&p(),aQ(u,s,i,n,l,d,c,h)&&p();for(let e=l;e<d;e++){let t=s.positionAt(e,a,i),r=s.positionAt(e,c,i);u.replace(u.mapping.slice(h).map(t+n),u.mapping.slice(h).map(r+n),new ek(o.rows[e-l],0,0))}p(),u.setSelection(new aH(u.doc.resolve(n+s.positionAt(l,a,i)),u.doc.resolve(n+s.positionAt(d-1,c-1,i)))),t(u)}aW("row",{useDeprecatedLogic:!0}),aW("column",{useDeprecatedLogic:!0}),aW("cell",{useDeprecatedLogic:!0});let a0=ir({ArrowLeft:a2("horiz",-1),ArrowRight:a2("horiz",1),ArrowUp:a2("vert",-1),ArrowDown:a2("vert",1),"Shift-ArrowLeft":a4("horiz",-1),"Shift-ArrowRight":a4("horiz",1),"Shift-ArrowUp":a4("vert",-1),"Shift-ArrowDown":a4("vert",1),Backspace:aK,"Mod-Backspace":aK,Delete:aK,"Mod-Delete":aK});function a1(e,t,n){return!n.eq(e.selection)&&(t&&t(e.tr.setSelection(n).scrollIntoView()),!0)}function a2(e,t){return(n,r,o)=>{if(!o)return!1;let i=n.selection;if(i instanceof aH)return a1(n,r,tj.near(i.$headCell,t));if("horiz"!=e&&!i.empty)return!1;let s=a6(o,e,t);if(null==s)return!1;if("horiz"==e)return a1(n,r,tj.near(n.doc.resolve(i.head+t),t));{let o,i=n.doc.resolve(s),l=aL(i,e,t);return o=l?tj.near(l,1):t<0?tj.near(n.doc.resolve(i.before(-1)),-1):tj.near(n.doc.resolve(i.after(-1)),1),a1(n,r,o)}}}function a4(e,t){return(n,r,o)=>{let i;if(!o)return!1;let s=n.selection;if(s instanceof aH)i=s;else{let r=a6(o,e,t);if(null==r)return!1;i=new aH(n.doc.resolve(r))}let l=aL(i.$headCell,e,t);return!!l&&a1(n,r,new aH(i.$anchorCell,l))}}function a5(e,t){let n=aM(e.state.doc.resolve(t));return!!n&&(e.dispatch(e.state.tr.setSelection(new aH(n))),!0)}function a3(e,t,n){if(!aI(e.state))return!1;let r=function(e){if(0===e.size)return null;let{content:t,openStart:n,openEnd:r}=e;for(;1==t.childCount&&(n>0&&r>0||"table"==t.child(0).type.spec.tableRole);)n--,r--,t=t.child(0).content;let o=t.child(0),i=o.type.spec.tableRole,s=o.type.schema,l=[];if("row"==i)for(let e=0;e<t.childCount;e++){let o=t.child(e).content,i=e?0:Math.max(0,n-1),a=e<t.childCount-1?0:Math.max(0,r-1);(i||a)&&(o=aZ(a_(s).row,new ek(o,i,a)).content),l.push(o)}else{if("cell"!=i&&"header_cell"!=i)return null;l.push(n||r?aZ(a_(s).row,new ek(t,n,r)).content:t)}return function(e,t){let n=[];for(let e=0;e<t.length;e++){let r=t[e];for(let t=r.childCount-1;t>=0;t--){let{rowspan:o,colspan:i}=r.child(t).attrs;for(let t=e;t<e+o;t++)n[t]=(n[t]||0)+i}}let r=0;for(let e=0;e<n.length;e++)r=Math.max(r,n[e]);for(let o=0;o<n.length;o++)if(o>=t.length&&t.push(em.empty),n[o]<r){let i=a_(e).cell.createAndFill(),s=[];for(let e=n[o];e<r;e++)s.push(i);t[o]=t[o].append(em.from(s))}return{height:t.length,width:r,rows:t}}(s,l)}(n),o=e.state.selection;if(o instanceof aH){r||(r={width:1,height:1,rows:[em.from(aZ(a_(e.state.schema).cell,n))]});let t=o.$anchorCell.node(-1),i=o.$anchorCell.start(-1),s=aA.get(t).rectBetween(o.$anchorCell.pos-i,o.$headCell.pos-i);return r=function({width:e,height:t,rows:n},r,o){if(e!=r){let t=[],o=[];for(let e=0;e<n.length;e++){let i=n[e],s=[];for(let n=t[e]||0,o=0;n<r;o++){let l=i.child(o%i.childCount);n+l.attrs.colspan>r&&(l=l.type.createChecked(aP(l.attrs,l.attrs.colspan,n+l.attrs.colspan-r),l.content)),s.push(l),n+=l.attrs.colspan;for(let n=1;n<l.attrs.rowspan;n++)t[e+n]=(t[e+n]||0)+l.attrs.colspan}o.push(em.from(s))}n=o,e=r}if(t!=o){let e=[];for(let r=0,i=0;r<o;r++,i++){let s=[],l=n[i%t];for(let e=0;e<l.childCount;e++){let t=l.child(e);r+t.attrs.rowspan>o&&(t=t.type.create({...t.attrs,rowspan:Math.max(1,o-t.attrs.rowspan)},t.content)),s.push(t)}e.push(em.from(s))}n=e,t=o}return{width:e,height:t,rows:n}}(r,s.right-s.left,s.bottom-s.top),aJ(e.state,e.dispatch,i,s,r),!0}if(!r)return!1;{let t=aO(e.state),n=t.start(-1);return aJ(e.state,e.dispatch,n,aA.get(t.node(-1)).findCell(t.pos-n),r),!0}}function a8(e,t){var n;let r;if(0!=t.button||t.ctrlKey||t.metaKey)return;let o=a9(e,t.target);if(t.shiftKey&&e.state.selection instanceof aH)i(e.state.selection.$anchorCell,t),t.preventDefault();else if(t.shiftKey&&o&&null!=(r=aM(e.state.selection.$anchor))&&(null==(n=a7(e,t))?void 0:n.pos)!=r.pos)i(r,t),t.preventDefault();else if(!o)return;function i(t,n){let r=a7(e,n),o=null==aN.getState(e.state);if(!r||!aR(t,r))if(!o)return;else r=t;let i=new aH(t,r);if(o||!e.state.selection.eq(i)){let n=e.state.tr.setSelection(i);o&&n.setMeta(aN,t.pos),e.dispatch(n)}}function s(){e.root.removeEventListener("mouseup",s),e.root.removeEventListener("dragstart",s),e.root.removeEventListener("mousemove",l),null!=aN.getState(e.state)&&e.dispatch(e.state.tr.setMeta(aN,-1))}function l(n){let r,l=aN.getState(e.state);if(null!=l)r=e.state.doc.resolve(l);else if(a9(e,n.target)!=o&&!(r=a7(e,t)))return s();r&&i(r,n)}e.root.addEventListener("mouseup",s),e.root.addEventListener("dragstart",s),e.root.addEventListener("mousemove",l)}function a6(e,t,n){if(!(e.state.selection instanceof tV))return null;let{$head:r}=e.state.selection;for(let o=r.depth-1;o>=0;o--){let i=r.node(o);if((n<0?r.index(o):r.indexAfter(o))!=(n<0?0:i.childCount))break;if("cell"==i.type.spec.tableRole||"header_cell"==i.type.spec.tableRole){let i=r.before(o),s="vert"==t?n>0?"down":"up":n>0?"right":"left";return e.endOfTextblock(s)?i:null}}return null}function a9(e,t){for(;t&&t!=e.dom;t=t.parentNode)if("TD"==t.nodeName||"TH"==t.nodeName)return t;return null}function a7(e,t){let n=e.posAtCoords({left:t.clientX,top:t.clientY});if(!n)return null;let{inside:r,pos:o}=n;return r>=0&&aM(e.state.doc.resolve(r))||aM(e.state.doc.resolve(o))}var ce=class{constructor(e,t){this.node=e,this.defaultCellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${t}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),ct(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type==this.node.type&&(this.node=e,ct(e,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(e){return"attributes"==e.type&&(e.target==this.table||this.colgroup.contains(e.target))}};function ct(e,t,n,r,o,i){let s=0,l=!0,a=t.firstChild,c=e.firstChild;if(c){for(let e=0,n=0;e<c.childCount;e++){let{colspan:d,colwidth:u}=c.child(e).attrs;for(let e=0;e<d;e++,n++){let c=o==n?i:u&&u[e],d=c?c+"px":"";if(s+=c||r,c||(l=!1),a)a.style.width!=d&&(a.style.width=d),a=a.nextSibling;else{let e=document.createElement("col");e.style.width=d,t.appendChild(e)}}}for(;a;){var d;let e=a.nextSibling;null==(d=a.parentNode)||d.removeChild(a),a=e}l?(n.style.width=s+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=s+"px")}}let cn=new t8("tableColumnResizing");var cr=class e{constructor(e,t){this.activeHandle=e,this.dragging=t}apply(t){let n=t.getMeta(cn);if(n&&null!=n.setHandle)return new e(n.setHandle,!1);if(n&&void 0!==n.setDragging)return new e(this.activeHandle,n.setDragging);if(this.activeHandle>-1&&t.docChanged){let n=t.mapping.map(this.activeHandle,-1);return aD(t.doc.resolve(n))||(n=-1),new e(n,this.dragging)}return this}};function co(e,t,n,r){let o=e.posAtCoords({left:t.clientX+("right"==n?-r:r),top:t.clientY});if(!o)return -1;let{pos:i}=o,s=aM(e.state.doc.resolve(i));if(!s)return -1;if("right"==n)return s.pos;let l=aA.get(s.node(-1)),a=s.start(-1),c=l.map.indexOf(s.pos-a);return c%l.width==0?-1:a+l.map[c-1]}function ci(e,t,n){let r=t.clientX-e.startX;return Math.max(n,e.startWidth+r)}function cs(e,t){e.dispatch(e.state.tr.setMeta(cn,{setHandle:t}))}function cl(e,t,n,r){let o=e.state.doc.resolve(t),i=o.node(-1),s=o.start(-1),l=aA.get(i).colCount(o.pos-s)+o.nodeAfter.attrs.colspan-1,a=e.domAtPos(o.start(-1)).node;for(;a&&"TABLE"!=a.nodeName;)a=a.parentNode;a&&ct(i,a.firstChild,a,r,l,n)}let ca=new t8("y-sync"),cc=new t8("y-undo"),cd=new t8("yjs-cursor"),cu=Math.floor,ch=Math.abs,cp=(e,t)=>e<t?e:t,cf=(e,t)=>e>t?e:t,cm=e=>0!==e?e<0:1/e<0,cg=Symbol("Equality"),cb=(e,t)=>e===t||!!e?.[cg]?.(t),cy=Object.assign,cv=Object.keys,cE=(e,t)=>{for(let n in e)if(!t(e[n],n))return!1;return!0},ck=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),cC=Object.freeze,cT=e=>{for(let t in e){let n=e[t];("object"==typeof n||"function"==typeof n)&&cT(e[t])}return cC(e)},cw=()=>new Set,cx=e=>e[e.length-1],cS=(e,t)=>{for(let n=0;n<t.length;n++)e.push(t[n])},cA=Array.from,c_=(e,t)=>{for(let n=0;n<e.length;n++)if(!t(e[n],n,e))return!1;return!0},cN=(e,t)=>{for(let n=0;n<e.length;n++)if(t(e[n],n,e))return!0;return!1},cM=Array.isArray,cI=(e,t,n=0)=>{try{for(;n<e.length;n++)e[n](...t)}finally{n<e.length&&cI(e,t,n+1)}},cO=e=>e,cD=(e,t)=>{if(e===t)return!0;if(null==e||null==t||e.constructor!==t.constructor&&(e.constructor||Object)!==(t.constructor||Object))return!1;if(null!=e[cg])return e[cg](t);switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:if(e.byteLength!==t.byteLength)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;break;case Set:if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;break;case Map:if(e.size!==t.size)return!1;for(let n of e.keys())if(!t.has(n)||!cD(e.get(n),t.get(n)))return!1;break;case void 0:case Object:if(cv(e).length!==cv(t).length)return!1;for(let n in e)if(!ck(e,n)||!cD(e[n],t[n]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!cD(e[n],t[n]))return!1;break;default:return!1}return!0},cR=/[\uD800-\uDBFF]/,cL=/[\uDC00-\uDFFF]/,cP=()=>{throw Error("Method unimplemented")},cB=()=>{throw Error("Unexpected case")},cH=()=>new Map,cj=e=>{let t=cH();return e.forEach((e,n)=>{t.set(n,e)}),t},cF=(e,t,n)=>{let r=e.get(t);return void 0===r&&e.set(t,r=n()),r};class cU{constructor(){this._observers=cH()}on(e,t){return cF(this._observers,e,cw).add(t),t}once(e,t){let n=(...r)=>{this.off(e,n),t(...r)};this.on(e,n)}off(e,t){let n=this._observers.get(e);void 0!==n&&(n.delete(t),0===n.size&&this._observers.delete(e))}emit(e,t){return cA((this._observers.get(e)||cH()).values()).forEach(e=>e(...t))}destroy(){this._observers=cH()}}let cz=Number.MAX_SAFE_INTEGER,cV=Number.MIN_SAFE_INTEGER,c$=Number.isInteger||(e=>"number"==typeof e&&isFinite(e)&&cu(e)===e),cG=String.fromCharCode;cG(65535);let cq=/^\s*/g,cW=/([A-Z])/g,cY=(e,t)=>e.replace(cW,e=>`${t}${e.toLowerCase()}`).replace(cq,""),cK="undefined"!=typeof TextEncoder?new TextEncoder:null,cZ=cK?e=>cK.encode(e):e=>{let t=unescape(encodeURIComponent(e)),n=t.length,r=new Uint8Array(n);for(let e=0;e<n;e++)r[e]=t.codePointAt(e);return r},cX="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});cX&&1===cX.decode(new Uint8Array).length&&(cX=null);let cQ=(e,t)=>((e,t)=>{let n=Array(e);for(let r=0;r<e;r++)n[r]=t(r,n);return n})(t,()=>e).join("");class cJ{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}let c0=()=>new cJ,c1=e=>{let t=new Uint8Array((e=>{let t=e.cpos;for(let n=0;n<e.bufs.length;n++)t+=e.bufs[n].length;return t})(e)),n=0;for(let r=0;r<e.bufs.length;r++){let o=e.bufs[r];t.set(o,n),n+=o.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),n),t},c2=(e,t)=>{let n=e.cbuf.length;e.cpos===n&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*n),e.cpos=0),e.cbuf[e.cpos++]=t},c4=(e,t)=>{for(;t>127;)c2(e,128|127&t),t=cu(t/128);c2(e,127&t)},c5=(e,t)=>{let n=cm(t);for(n&&(t=-t),c2(e,128*(t>63)|64*!!n|63&t),t=cu(t/64);t>0;)c2(e,128*(t>127)|127&t),t=cu(t/128)},c3=new Uint8Array(3e4),c8=c3.length/3,c6=cK&&cK.encodeInto?(e,t)=>{if(t.length<c8){let n=cK.encodeInto(t,c3).written||0;c4(e,n);for(let t=0;t<n;t++)c2(e,c3[t])}else c7(e,cZ(t))}:(e,t)=>{let n=unescape(encodeURIComponent(t)),r=n.length;c4(e,r);for(let t=0;t<r;t++)c2(e,n.codePointAt(t))},c9=(e,t)=>{let n=e.cbuf.length,r=e.cpos,o=cp(n-r,t.length),i=t.length-o;e.cbuf.set(t.subarray(0,o),r),e.cpos+=o,i>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(cf(2*n,i)),e.cbuf.set(t.subarray(o)),e.cpos=i)},c7=(e,t)=>{c4(e,t.byteLength),c9(e,t)},de=(e,t)=>{let n;(n=e.cbuf.length)-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(2*cf(n,t)),e.cpos=0);let r=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,r},dt=new DataView(new ArrayBuffer(4)),dn=(e,t)=>{switch(typeof t){case"string":c2(e,119),c6(e,t);break;case"number":if(c$(t)&&0x7fffffff>=ch(t))c2(e,125),c5(e,t);else if(dt.setFloat32(0,t),dt.getFloat32(0)===t)c2(e,124),de(e,4).setFloat32(0,t,!1);else c2(e,123),de(e,8).setFloat64(0,t,!1);break;case"bigint":c2(e,122),de(e,8).setBigInt64(0,t,!1);break;case"object":if(null===t)c2(e,126);else if(cM(t)){c2(e,117),c4(e,t.length);for(let n=0;n<t.length;n++)dn(e,t[n])}else if(t instanceof Uint8Array)c2(e,116),c7(e,t);else{c2(e,118);let n=Object.keys(t);c4(e,n.length);for(let r=0;r<n.length;r++){let o=n[r];c6(e,o),dn(e,t[o])}}break;case"boolean":c2(e,t?120:121);break;default:c2(e,127)}};class dr extends cJ{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&c4(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}let di=e=>{e.count>0&&(c5(e.encoder,1===e.count?e.s:-e.s),e.count>1&&c4(e.encoder,e.count-2))};class ds{constructor(){this.encoder=new cJ,this.s=0,this.count=0}write(e){this.s===e?this.count++:(di(this),this.count=1,this.s=e)}toUint8Array(){return di(this),c1(this.encoder)}}let dl=e=>{if(e.count>0){let t=2*e.diff+ +(1!==e.count);c5(e.encoder,t),e.count>1&&c4(e.encoder,e.count-2)}};class da{constructor(){this.encoder=new cJ,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(dl(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return dl(this),c1(this.encoder)}}class dc{constructor(){this.sarr=[],this.s="",this.lensE=new ds}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){let e=new cJ;return this.sarr.push(this.s),this.s="",c6(e,this.sarr.join("")),c9(e,this.lensE.toUint8Array()),c1(e)}}let dd=Error("Unexpected end of array"),du=Error("Integer out of Range");class dh{constructor(e){this.arr=e,this.pos=0}}let dp=e=>new dh(e),df=e=>{var t;let n;return t=dg(e),n=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t),e.pos+=t,n},dm=e=>e.arr[e.pos++],dg=e=>{let t=0,n=1,r=e.arr.length;for(;e.pos<r;){let r=e.arr[e.pos++];if(t+=(127&r)*n,n*=128,r<128)return t;if(t>cz)throw du}throw dd},db=e=>{let t=e.arr[e.pos++],n=63&t,r=64,o=(64&t)>0?-1:1;if((128&t)==0)return o*n;let i=e.arr.length;for(;e.pos<i;){if(n+=(127&(t=e.arr[e.pos++]))*r,r*=128,t<128)return o*n;if(n>cz)throw du}throw dd},dy=cX?e=>cX.decode(df(e)):e=>{let t=dg(e);if(0===t)return"";{let n=String.fromCodePoint(dm(e));if(--t<100)for(;t--;)n+=String.fromCodePoint(dm(e));else for(;t>0;){let r=t<1e4?t:1e4,o=e.arr.subarray(e.pos,e.pos+r);e.pos+=r,n+=String.fromCodePoint.apply(null,o),t-=r}return decodeURIComponent(escape(n))}},dv=(e,t)=>{let n=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,n},dE=[e=>void 0,e=>null,db,e=>dv(e,4).getFloat32(0,!1),e=>dv(e,8).getFloat64(0,!1),e=>dv(e,8).getBigInt64(0,!1),e=>!1,e=>!0,dy,e=>{let t=dg(e),n={};for(let r=0;r<t;r++)n[dy(e)]=dk(e);return n},e=>{let t=dg(e),n=[];for(let r=0;r<t;r++)n.push(dk(e));return n},df],dk=e=>dE[127-dm(e)](e);class dC extends dh{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){0===this.count&&(this.s=this.reader(this),this.pos!==this.arr.length?this.count=dg(this)+1:this.count=-1);return this.count--,this.s}}class dT extends dh{constructor(e){super(e),this.s=0,this.count=0}read(){if(0===this.count){this.s=db(this);let e=cm(this.s);this.count=1,e&&(this.s=-this.s,this.count=dg(this)+2)}return this.count--,this.s}}class dw extends dh{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(0===this.count){let e=db(this);this.diff=cu(e/2),this.count=1,1&e&&(this.count=dg(this)+2)}return this.s+=this.diff,this.count--,this.s}}class dx{constructor(e){this.decoder=new dT(e),this.str=dy(this.decoder),this.spos=0}read(){let e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}crypto.subtle;let dS=crypto.getRandomValues.bind(crypto),dA=Math.random,d_=()=>dS(new Uint32Array(1))[0],dN=Date.now,dM=e=>new Promise(e);Promise.all.bind(Promise);var dI=e.i(94670);let dO=e=>void 0===e?null:e,dD=new class{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}};try{"undefined"!=typeof localStorage&&localStorage&&(dD=localStorage)}catch(e){}let dR=dD,dL=void 0!==aS.default&&aS.default.release&&/node|io\.js/.test(aS.default.release.name)&&"[object process]"===Object.prototype.toString.call(void 0!==aS.default?aS.default:0),dP="undefined"!=typeof window&&"undefined"!=typeof document&&!dL;"undefined"!=typeof navigator&&/Mac/.test(navigator.platform);let dB=[],dH=e=>(()=>{if(void 0===r)if(dL){r=cH();let e=aS.default.argv,t=null;for(let n=0;n<e.length;n++){let o=e[n];"-"===o[0]?(null!==t&&r.set(t,""),t=o):null!==t?(r.set(t,o),t=null):dB.push(o)}null!==t&&r.set(t,"")}else"object"==typeof location?(r=cH(),(location.search||"?").slice(1).split("&").forEach(e=>{if(0!==e.length){let[t,n]=e.split("=");r.set(`--${cY(t,"-")}`,n),r.set(`-${cY(t,"-")}`,n)}})):r=cH();return r})().has(e),dj=e=>dL?dO(aS.default.env[e.toUpperCase().replaceAll("-","_")]):dO(dR.getItem(e)),dF=e=>dH("--"+e)||null!==dj(e),dU=dF("production"),dz=dL&&["true","1","2"].includes(aS.default.env.FORCE_COLOR)||!dH("--no-colors")&&!dF("no-color")&&(!dL||aS.default.stdout.isTTY)&&(!dL||dH("--color")||null!==dj("COLORTERM")||(dj("TERM")||"").includes("color")),dV=dP?e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=cG(e[n]);return btoa(t)}:e=>dI.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64");class d${constructor(e,t){this.left=e,this.right=t}}let dG=(e,t)=>new d$(e,t),dq=e=>e.next()>=.5,dW=(e,t,n)=>cu(e.next()*(n+1-t)+t),dY=(e,t,n)=>cu(e.next()*(n+1-t)+t),dK=e=>cG(dY(e,97,122)),dZ=(e,t)=>t[dY(e,0,t.length-1)],dX=Symbol("0schema");class dQ{constructor(){this._rerrs=[]}extend(e,t,n,r=null){this._rerrs.push({path:e,expected:t,has:n,message:r})}toString(){let e=[];for(let t=this._rerrs.length-1;t>0;t--){let n=this._rerrs[t];e.push(cQ(" ",(this._rerrs.length-t)*2)+`${null!=n.path?`[${n.path}] `:""}${n.has} doesn't match ${n.expected}. ${n.message}`)}return e.join("\n")}}let dJ=(e,t)=>e===t||null!=e&&null!=t&&e.constructor===t.constructor&&(e[cg]?cb(e,t):cM(e)?c_(e,e=>cN(t,t=>dJ(e,t))):"object"==typeof e&&cE(e,(e,n)=>dJ(e,t[n])));class d0{static _dilutes=!1;extends(e){let[t,n]=[this.shape,e.shape];return this.constructor._dilutes&&([n,t]=[t,n]),dJ(t,n)}equals(e){return this.constructor===e.constructor&&cD(this.shape,e.shape)}[dX](){return!0}[cg](e){return this.equals(e)}validate(e){return this.check(e)}check(e,t){cP()}get nullable(){return uE(this,uL)}get optional(){return new ut(this)}cast(e){return uj(e,this),e}expect(e){return uj(e,this),e}}class d1 extends d0{constructor(e,t){super(),this.shape=e,this._c=t}check(e,t){let n=e?.constructor===this.shape&&(null==this._c||this._c(e));return n||t?.extend(null,this.shape.name,e?.constructor.name,e?.constructor!==this.shape?"Constructor match failed":"Check failed"),n}}let d2=(e,t=null)=>new d1(e,t);d2(d1);class d4 extends d0{constructor(e){super(),this.shape=e}check(e,t){let n=this.shape(e);return n||t?.extend(null,"custom prop",e?.constructor.name,"failed to check custom prop"),n}}let d5=e=>new d4(e);d2(d4);class d3 extends d0{constructor(e){super(),this.shape=e}check(e,t){let n=this.shape.some(t=>t===e);return n||t?.extend(null,this.shape.join(" | "),e.toString()),n}}let d8=(...e)=>new d3(e),d6=d2(d3),d9=RegExp.escape||(e=>e.replace(/[().|&,$^[\]]/g,e=>"\\"+e)),d7=e=>uM.check(e)?[d9(e)]:d6.check(e)?e.shape.map(e=>e+""):uN.check(e)?["[+-]?\\d+.?\\d*"]:uI.check(e)?[".*"]:uk.check(e)?e.shape.map(d7).flat(1):void cB();d2(class extends d0{constructor(e){super(),this.shape=e,this._r=RegExp("^"+e.map(d7).map(e=>`(${e.join("|")})`).join("")+"$")}check(e,t){let n=null!=this._r.exec(e);return n||t?.extend(null,this._r.toString(),e.toString(),"String doesn't match string template."),n}});let ue=Symbol("optional");class ut extends d0{constructor(e){super(),this.shape=e}check(e,t){let n=void 0===e||this.shape.check(e);return n||t?.extend(null,"undefined (optional)","()"),n}get[ue](){return!0}}let un=d2(ut);class ur extends d0{check(e,t){return t?.extend(null,"never",typeof e),!1}}new ur,d2(ur);class uo extends d0{constructor(e,t=!1){super(),this.shape=e,this._isPartial=t}static _dilutes=!0;get partial(){return new uo(this.shape,!0)}check(e,t){return null==e?(t?.extend(null,"object","null"),!1):cE(this.shape,(n,r)=>{let o=this._isPartial&&!ck(e,r)||n.check(e[r],t);return o||t?.extend(r.toString(),n.toString(),typeof e[r],"Object property does not match"),o})}}let ui=d2(uo),us=d5(e=>null!=e&&(e.constructor===Object||null==e.constructor));class ul extends d0{constructor(e,t){super(),this.shape={keys:e,values:t}}check(e,t){return null!=e&&cE(e,(n,r)=>{let o=this.shape.keys.check(r,t);return o||t?.extend(r+"","Record",typeof e,o?"Key doesn't match schema":"Value doesn't match value"),o&&this.shape.values.check(n,t)})}}let ua=(e,t)=>new ul(e,t),uc=d2(ul);class ud extends d0{constructor(e){super(),this.shape=e}check(e,t){return null!=e&&cE(this.shape,(n,r)=>{let o=n.check(e[r],t);return o||t?.extend(r.toString(),"Tuple",typeof n),o})}}d2(ud);class uu extends d0{constructor(e){super(),this.shape=1===e.length?e[0]:new uv(e)}check(e,t){let n=cM(e)&&c_(e,e=>this.shape.check(e));return n||t?.extend(null,"Array",""),n}}let uh=(...e)=>new uu(e),up=d2(uu),uf=d5(e=>cM(e));class um extends d0{constructor(e,t){super(),this.shape=e,this._c=t}check(e,t){let n=e instanceof this.shape&&(null==this._c||this._c(e));return n||t?.extend(null,this.shape.name,e?.constructor.name),n}}d2(um);let ug=((e,t=null)=>new um(e,t))(d0),ub=d2(class extends d0{constructor(e){super(),this.len=e.length-1,this.args=((...e)=>new ud(e))(...e.slice(-1)),this.res=e[this.len]}check(e,t){let n=e.constructor===Function&&e.length<=this.len;return n||t?.extend(null,"function",typeof e),n}}),uy=d5(e=>"function"==typeof e);d2(class extends d0{constructor(e){super(),this.shape=e}check(e,t){let n=c_(this.shape,n=>n.check(e,t));return n||t?.extend(null,"Intersectinon",typeof e),n}},e=>e.shape.length>0);class uv extends d0{static _dilutes=!0;constructor(e){super(),this.shape=e}check(e,t){let n=cN(this.shape,n=>n.check(e,t));return t?.extend(null,"Union",typeof e),n}}let uE=(...e)=>e.findIndex(e=>uk.check(e))>=0?uE(...e.map(e=>uH(e)).map(e=>uk.check(e)?e.shape:[e]).flat(1)):1===e.length?e[0]:new uv(e),uk=d2(uv),uC=()=>!0,uT=d5(uC),uw=d2(d4,e=>e.shape===uC),ux=d5(e=>"bigint"==typeof e),uS=d5(e=>e===ux),uA=d5(e=>"symbol"==typeof e);d5(e=>e===uA);let u_=d5(e=>"number"==typeof e),uN=d5(e=>e===u_),uM=d5(e=>"string"==typeof e),uI=d5(e=>e===uM),uO=d5(e=>"boolean"==typeof e),uD=d5(e=>e===uO),uR=d8(void 0);d2(d3,e=>1===e.shape.length&&void 0===e.shape[0]),d8(void 0);let uL=d8(null),uP=d2(d3,e=>1===e.shape.length&&null===e.shape[0]);d2(Uint8Array),d2(d1,e=>e.shape===Uint8Array);let uB=uE(u_,uM,uL,uR,ux,uO,uA);c=uh(uT),d=ua(uM,uT),u=uE(u_,uM,uL,uO,c,d),c.shape=u,d.shape.values=u;let uH=e=>{if(ug.check(e))return e;if(us.check(e)){let t={};for(let n in e)t[n]=uH(e[n]);return new uo(t)}if(uf.check(e))return uE(...e.map(uH));if(uB.check(e))return d8(e);if(uy.check(e))return d2(e);cB()},uj=dU?()=>{}:(e,t)=>{let n=new dQ;if(!t.check(e,n))throw Error(`Expected value to be of type ${t.constructor.name}.
${n.toString()}`)},uF=new class e{constructor(e){this.patterns=[],this.$state=e}if(e,t){return this.patterns.push({if:uH(e),h:t}),this}else(e){return this.if(uT,e)}done(){return(e,t)=>{for(let n=0;n<this.patterns.length;n++){let r=this.patterns[n];if(r.if.check(e))return r.h(e,t)}throw Error("Unhandled pattern")}}}(uT).if(uN,(e,t)=>dW(t,cV,cz)).if(uI,(e,t)=>((e,t=0,n=20)=>{let r=dY(e,t,n),o="";for(let t=0;t<r;t++)o+=dK(e);return o})(t)).if(uD,(e,t)=>dq(t)).if(uS,(e,t)=>BigInt(dW(t,cV,cz))).if(uk,(e,t)=>uU(t,dZ(t,e.shape))).if(ui,(e,t)=>{let n={};for(let r in e.shape){let o=e.shape[r];if(un.check(o)){if(dq(t))continue;o=o.shape}n[r]=uF(o,t)}return n}).if(up,(e,t)=>{let n=[],r=dY(t,0,42);for(let o=0;o<r;o++)n.push(uU(t,e.shape));return n}).if(d6,(e,t)=>dZ(t,e.shape)).if(uP,(e,t)=>null).if(ub,(e,t)=>{let n=uU(t,e.res);return()=>n}).if(uw,(e,t)=>uU(t,dZ(t,[u_,uM,uL,uR,ux,uO,uh(u_),ua(uE("a","b","c"),u_)]))).if(uc,(e,t)=>{let n={},r=dW(t,0,3);for(let o=0;o<r;o++){let r=uU(t,e.shape.keys),o=uU(t,e.shape.values);n[r]=o}return n}).done(),uU=(e,t)=>uF(uH(t),e),uz="undefined"!=typeof document?document:{};d5(e=>e.nodeType===uW),"undefined"!=typeof DOMParser&&new DOMParser,d5(e=>e.nodeType===u$),d5(e=>e.nodeType===uG);let uV=e=>((e,t)=>{let n=[];for(let[r,o]of e)n.push(t(o,r));return n})(e,(e,t)=>`${t}:${e};`).join(""),u$=uz.ELEMENT_NODE,uG=uz.TEXT_NODE;uz.CDATA_SECTION_NODE,uz.COMMENT_NODE;let uq=uz.DOCUMENT_NODE;uz.DOCUMENT_TYPE_NODE;let uW=uz.DOCUMENT_FRAGMENT_NODE;d5(e=>e.nodeType===uq);let uY=e=>class{constructor(e){this._=e}destroy(){e(this._)}},uK=uY(clearTimeout),uZ=(e,t)=>new uK(setTimeout(t,e));uY(clearInterval),uY(e=>"undefined"!=typeof requestAnimationFrame&&cancelAnimationFrame(e)),uY(e=>"undefined"!=typeof cancelIdleCallback&&cancelIdleCallback(e));let uX=Symbol,uQ=uX(),uJ=uX(),u0=uX(),u1=uX(),u2=uX(),u4=uX(),u5=uX(),u3=uX(),u8=uX();dN();let u6={[uQ]:dG("font-weight","bold"),[uJ]:dG("font-weight","normal"),[u0]:dG("color","blue"),[u2]:dG("color","green"),[u1]:dG("color","grey"),[u4]:dG("color","red"),[u5]:dG("color","purple"),[u3]:dG("color","orange"),[u8]:dG("color","black")},u9=dz?e=>{1===e.length&&e[0]?.constructor===Function&&(e=e[0]());let t=[],n=[],r=cH(),o=[],i=0;for(;i<e.length;i++){let o=e[i],s=u6[o];if(void 0!==s)r.set(s.left,s.right);else{if(void 0===o)break;if(o.constructor===String||o.constructor===Number){let e=uV(r);i>0||e.length>0?(t.push("%c"+o),n.push(e)):t.push(o)}else break}}for(i>0&&(o=n).unshift(t.join(""));i<e.length;i++){let t=e[i];t instanceof Symbol||o.push(t)}return o}:e=>{1===e.length&&e[0]?.constructor===Function&&(e=e[0]());let t=[],n=[],r=0;for(;r<e.length;r++){let n=e[r];if(void 0===n)break;if(n.constructor===String||n.constructor===Number)t.push(n);else if(n.constructor===Object)break}for(r>0&&n.push(t.join(""));r<e.length;r++){let t=e[r];t instanceof Symbol||n.push(t)}return n},u7=(...e)=>{console.warn(...u9(e)),e.unshift(u3),he.forEach(t=>t.print(e))},he=cw(),ht=e=>({[Symbol.iterator](){return this},next:e}),hn=(e,t)=>ht(()=>{let{done:n,value:r}=e.next();return{done:n,value:n?void 0:t(r)}});class hr{constructor(e,t){this.clock=e,this.len=t}}class ho{constructor(){this.clients=new Map}}let hi=(e,t,n)=>t.clients.forEach((t,r)=>{let o=e.doc.store.clients.get(r);if(null!=o){let r=o[o.length-1],i=r.id.clock+r.length;for(let r=0,s=t[r];r<t.length&&s.clock<i;s=t[++r])h5(e,o,s.clock,s.len,n)}}),hs=(e,t)=>{let n=e.clients.get(t.client);return void 0!==n&&null!==((e,t)=>{let n=0,r=e.length-1;for(;n<=r;){let o=cu((n+r)/2),i=e[o],s=i.clock;if(s<=t){if(t<s+i.len)return o;n=o+1}else r=o-1}return null})(n,t.clock)},hl=e=>{e.clients.forEach(e=>{let t,n;for(e.sort((e,t)=>e.clock-t.clock),t=1,n=1;t<e.length;t++){let r=e[n-1],o=e[t];r.clock+r.len>=o.clock?r.len=cf(r.len,o.clock+o.len-r.clock):(n<t&&(e[n]=o),n++)}e.length=n})},ha=e=>{let t=new ho;for(let n=0;n<e.length;n++)e[n].clients.forEach((r,o)=>{if(!t.clients.has(o)){let i=r.slice();for(let t=n+1;t<e.length;t++)cS(i,e[t].clients.get(o)||[]);t.clients.set(o,i)}});return hl(t),t},hc=(e,t,n,r)=>{cF(e.clients,t,()=>[]).push(new hr(n,r))},hd=()=>new ho,hu=e=>{let t=hd();return e.clients.forEach((e,n)=>{let r=[];for(let t=0;t<e.length;t++){let n=e[t];if(n.deleted){let o=n.id.clock,i=n.length;if(t+1<e.length)for(let n=e[t+1];t+1<e.length&&n.deleted;n=e[++t+1])i+=n.length;r.push(new hr(o,i))}}r.length>0&&t.clients.set(n,r)}),t},hh=(e,t)=>{c4(e.restEncoder,t.clients.size),cA(t.clients.entries()).sort((e,t)=>t[0]-e[0]).forEach(([t,n])=>{e.resetDsCurVal(),c4(e.restEncoder,t);let r=n.length;c4(e.restEncoder,r);for(let t=0;t<r;t++){let r=n[t];e.writeDsClock(r.clock),e.writeDsLen(r.len)}})},hp=e=>{let t=new ho,n=dg(e.restDecoder);for(let r=0;r<n;r++){e.resetDsCurVal();let n=dg(e.restDecoder),r=dg(e.restDecoder);if(r>0){let o=cF(t.clients,n,()=>[]);for(let t=0;t<r;t++)o.push(new hr(e.readDsClock(),e.readDsLen()))}}return t},hf=(e,t,n)=>{let r=new ho,o=dg(e.restDecoder);for(let i=0;i<o;i++){e.resetDsCurVal();let o=dg(e.restDecoder),i=dg(e.restDecoder),s=n.clients.get(o)||[],l=hX(n,o);for(let n=0;n<i;n++){let n=e.readDsClock(),i=n+e.readDsLen();if(n<l){l<i&&hc(r,o,l,i-l);let e=hJ(s,n),a=s[e];for(!a.deleted&&a.id.clock<n&&(s.splice(e+1,0,fS(t,a,n-a.id.clock)),e++);e<s.length;)if((a=s[e++]).id.clock<i)a.deleted||(i<a.id.clock+a.length&&s.splice(e,0,fS(t,a,i-a.id.clock)),a.delete(t));else break}else hc(r,o,n,i-n)}}if(r.clients.size>0){let e=new hT;return c4(e.restEncoder,0),hh(e,r),e.toUint8Array()}return null};class hm extends cU{constructor({guid:e="10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(e^d_()&15>>e/4).toString(16)),collectionid:t=null,gc:n=!0,gcFilter:r=()=>!0,meta:o=null,autoLoad:i=!1,shouldLoad:s=!0}={}){super(),this.gc=n,this.gcFilter=r,this.clientID=d_(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new hK,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=s,this.autoLoad=i,this.meta=o,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=dM(e=>{this.on("load",()=>{this.isLoaded=!0,e(this)})});const l=()=>dM(e=>{let t=n=>{(void 0===n||!0===n)&&(this.off("sync",t),e())};this.on("sync",t)});this.on("sync",e=>{!1===e&&this.isSynced&&(this.whenSynced=l()),this.isSynced=void 0===e||!0===e,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=l()}load(){let e=this._item;null===e||this.shouldLoad||pe(e.parent.doc,e=>{e.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(cA(this.subdocs).map(e=>e.guid))}transact(e,t=null){return pe(this,e,t)}get(e,t=px){let n=cF(this.share,e,()=>{let e=new t;return e._integrate(this,null),e}),r=n.constructor;if(t!==px&&r!==t)if(r===px){let r=new t;r._map=n._map,n._map.forEach(e=>{for(;null!==e;e=e.left)e.parent=r}),r._start=n._start;for(let e=r._start;null!==e;e=e.right)e.parent=r;return r._length=n._length,this.share.set(e,r),r._integrate(this,null),r}else throw Error(`Type with the name ${e} has already been defined with a different constructor`);return n}getArray(e=""){return this.get(e,pz)}getText(e=""){return this.get(e,p8)}getMap(e=""){return this.get(e,p$)}getXmlElement(e=""){return this.get(e,p7)}getXmlFragment(e=""){return this.get(e,p9)}toJSON(){let e={};return this.share.forEach((t,n)=>{e[n]=t.toJSON()}),e}destroy(){this.isDestroyed=!0,cA(this.subdocs).forEach(e=>e.destroy());let e=this._item;if(null!==e){this._item=null;let t=e.content;t.doc=new hm({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,pe(e.parent.doc,n=>{let r=t.doc;e.deleted||n.subdocsAdded.add(r),n.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class hg{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return dg(this.restDecoder)}readDsLen(){return dg(this.restDecoder)}}class hb extends hg{readLeftID(){return hL(dg(this.restDecoder),dg(this.restDecoder))}readRightID(){return hL(dg(this.restDecoder),dg(this.restDecoder))}readClient(){return dg(this.restDecoder)}readInfo(){return dm(this.restDecoder)}readString(){return dy(this.restDecoder)}readParentInfo(){return 1===dg(this.restDecoder)}readTypeRef(){return dg(this.restDecoder)}readLen(){return dg(this.restDecoder)}readAny(){return dk(this.restDecoder)}readBuf(){var e=df(this.restDecoder);let t=new Uint8Array(e.byteLength);return t.set(e),t}readJSON(){return JSON.parse(dy(this.restDecoder))}readKey(){return dy(this.restDecoder)}}class hy{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=dg(this.restDecoder),this.dsCurrVal}readDsLen(){let e=dg(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class hv extends hy{constructor(e){super(e),this.keys=[],dg(e),this.keyClockDecoder=new dw(df(e)),this.clientDecoder=new dT(df(e)),this.leftClockDecoder=new dw(df(e)),this.rightClockDecoder=new dw(df(e)),this.infoDecoder=new dC(df(e),dm),this.stringDecoder=new dx(df(e)),this.parentInfoDecoder=new dC(df(e),dm),this.typeRefDecoder=new dT(df(e)),this.lenDecoder=new dT(df(e))}readLeftID(){return new hD(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new hD(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return 1===this.parentInfoDecoder.read()}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return dk(this.restDecoder)}readBuf(){return df(this.restDecoder)}readJSON(){return dk(this.restDecoder)}readKey(){let e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{let e=this.stringDecoder.read();return this.keys.push(e),e}}}class hE{constructor(){this.restEncoder=c0()}toUint8Array(){return c1(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){c4(this.restEncoder,e)}writeDsLen(e){c4(this.restEncoder,e)}}class hk extends hE{writeLeftID(e){c4(this.restEncoder,e.client),c4(this.restEncoder,e.clock)}writeRightID(e){c4(this.restEncoder,e.client),c4(this.restEncoder,e.clock)}writeClient(e){c4(this.restEncoder,e)}writeInfo(e){c2(this.restEncoder,e)}writeString(e){c6(this.restEncoder,e)}writeParentInfo(e){c4(this.restEncoder,+!!e)}writeTypeRef(e){c4(this.restEncoder,e)}writeLen(e){c4(this.restEncoder,e)}writeAny(e){dn(this.restEncoder,e)}writeBuf(e){c7(this.restEncoder,e)}writeJSON(e){c6(this.restEncoder,JSON.stringify(e))}writeKey(e){c6(this.restEncoder,e)}}class hC{constructor(){this.restEncoder=c0(),this.dsCurrVal=0}toUint8Array(){return c1(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){let t=e-this.dsCurrVal;this.dsCurrVal=e,c4(this.restEncoder,t)}writeDsLen(e){0===e&&cB(),c4(this.restEncoder,e-1),this.dsCurrVal+=e}}class hT extends hC{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new da,this.clientEncoder=new ds,this.leftClockEncoder=new da,this.rightClockEncoder=new da,this.infoEncoder=new dr(c2),this.stringEncoder=new dc,this.parentInfoEncoder=new dr(c2),this.typeRefEncoder=new ds,this.lenEncoder=new ds}toUint8Array(){let e=c0();return c4(e,0),c7(e,this.keyClockEncoder.toUint8Array()),c7(e,this.clientEncoder.toUint8Array()),c7(e,this.leftClockEncoder.toUint8Array()),c7(e,this.rightClockEncoder.toUint8Array()),c7(e,c1(this.infoEncoder)),c7(e,this.stringEncoder.toUint8Array()),c7(e,c1(this.parentInfoEncoder)),c7(e,this.typeRefEncoder.toUint8Array()),c7(e,this.lenEncoder.toUint8Array()),c9(e,c1(this.restEncoder)),c1(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(+!!e)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){dn(this.restEncoder,e)}writeBuf(e){c7(this.restEncoder,e)}writeJSON(e){dn(this.restEncoder,e)}writeKey(e){let t=this.keyMap.get(e);void 0===t?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}let hw=(e,t,n)=>{let r=new Map;n.forEach((e,n)=>{hX(t,n)>e&&r.set(n,e)}),hZ(t).forEach((e,t)=>{n.has(t)||r.set(t,0)}),c4(e.restEncoder,r.size),cA(r.entries()).sort((e,t)=>t[0]-e[0]).forEach(([n,r])=>{((e,t,n,r)=>{r=cf(r,t[0].id.clock);let o=hJ(t,r);c4(e.restEncoder,t.length-o),e.writeClient(n),c4(e.restEncoder,r);let i=t[o];i.write(e,r-i.id.clock);for(let n=o+1;n<t.length;n++)t[n].write(e,0)})(e,t.clients.get(n),n,r)})},hx=(e,t,n,r=hv)=>{let o=dp(t);((e,t,n,r=new hv(e))=>pe(t,e=>{e.local=!1;let t=!1,n=e.doc,o=n.store,i=((e,t,n)=>{let r=[],o=cA(n.keys()).sort((e,t)=>e-t);if(0===o.length)return null;let i=()=>{if(0===o.length)return null;let e=n.get(o[o.length-1]);for(;e.refs.length===e.i;){if(o.pop(),!(o.length>0))return null;e=n.get(o[o.length-1])}return e},s=i();if(null===s)return null;let l=new hK,a=new Map,c=(e,t)=>{let n=a.get(e);(null==n||n>t)&&a.set(e,t)},d=s.refs[s.i++],u=new Map,h=()=>{for(let e of r){let t=e.id.client,r=n.get(t);r?(r.i--,l.clients.set(t,r.refs.slice(r.i)),n.delete(t),r.i=0,r.refs=[]):l.clients.set(t,[e]),o=o.filter(e=>e!==t)}r.length=0};for(;;){if(d.constructor!==fO){let o=cF(u,d.id.client,()=>hX(t,d.id.client))-d.id.clock;if(o<0)r.push(d),c(d.id.client,d.id.clock-1),h();else{let i=d.getMissing(e,t);if(null!==i){r.push(d);let e=n.get(i)||{refs:[],i:0};if(e.refs.length===e.i)c(i,hX(t,i)),h();else{d=e.refs[e.i++];continue}}else(0===o||o<d.length)&&(d.integrate(e,o),u.set(d.id.client,d.id.clock+d.length))}}if(r.length>0)d=r.pop();else if(null!==s&&s.i<s.refs.length)d=s.refs[s.i++];else{if(null===(s=i()))break;d=s.refs[s.i++]}}if(l.clients.size>0){let e=new hT;return hw(e,l,new Map),c4(e.restEncoder,0),{missing:a,update:e.toUint8Array()}}return null})(e,o,((e,t)=>{let n=cH(),r=dg(e.restDecoder);for(let o=0;o<r;o++){let r=dg(e.restDecoder),o=Array(r),i=e.readClient(),s=dg(e.restDecoder);n.set(i,{i:0,refs:o});for(let n=0;n<r;n++){let r=e.readInfo();switch(31&r){case 0:{let t=e.readLen();o[n]=new fo(hL(i,s),t),s+=t;break}case 10:{let t=dg(e.restDecoder);o[n]=new fO(hL(i,s),t),s+=t;break}default:{let l=(192&r)==0,a=new fN(hL(i,s),null,(128&r)==128?e.readLeftID():null,null,(64&r)==64?e.readRightID():null,l?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,l&&(32&r)==32?e.readString():null,fM(e,r));o[n]=a,s+=a.length}}}}return n})(r,n)),s=o.pendingStructs;if(s){for(let[e,n]of s.missing)if(n<hX(o,e)){t=!0;break}if(i){for(let[e,t]of i.missing){let n=s.missing.get(e);(null==n||n>t)&&s.missing.set(e,t)}s.update=pc([s.update,i.update])}}else o.pendingStructs=i;let l=hf(r,e,o);if(o.pendingDs){let t=new hv(dp(o.pendingDs));dg(t.restDecoder);let n=hf(t,e,o);l&&n?o.pendingDs=pc([l,n]):o.pendingDs=l||n}else o.pendingDs=l;if(t){let t=o.pendingStructs.update;o.pendingStructs=null,hx(e.doc,t)}},n,!1))(o,e,n,new r(o))},hS=(e,t)=>((e,t=new Uint8Array([0]),n=new hT)=>{((e,t,n=new Map)=>{hw(e,t.store,n),hh(e,hu(t.store))})(n,e,hA(t));let r=[n.toUint8Array()];if(e.store.pendingDs&&r.push(e.store.pendingDs),e.store.pendingStructs&&r.push(pd(e.store.pendingStructs.update,t)),r.length>1){if(n.constructor===hk)return pl(r.map((e,t)=>0===t?e:pf(e)));else if(n.constructor===hT)return pc(r)}return r[0]})(e,t,new hk),hA=e=>(e=>{let t=new Map,n=dg(e.restDecoder);for(let r=0;r<n;r++){let n=dg(e.restDecoder),r=dg(e.restDecoder);t.set(n,r)}return t})(new hg(dp(e))),h_=(e,t)=>(c4(e.restEncoder,t.size),cA(t.entries()).sort((e,t)=>t[0]-e[0]).forEach(([t,n])=>{c4(e.restEncoder,t),c4(e.restEncoder,n)}),e);class hN{constructor(){this.l=[]}}let hM=()=>new hN,hI=(e,t)=>{let n=e.l,r=n.length;e.l=n.filter(e=>t!==e),r===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},hO=(e,t,n)=>cI(e.l,[t,n]);class hD{constructor(e,t){this.client=e,this.clock=t}}let hR=(e,t)=>e===t||null!==e&&null!==t&&e.client===t.client&&e.clock===t.clock,hL=(e,t)=>new hD(e,t),hP=e=>{for(let[t,n]of e.doc.share.entries())if(n===e)return t;throw cB()},hB=(e,t)=>{for(;null!==t;){if(t.parent===e)return!0;t=t.parent._item}return!1};class hH{constructor(e,t,n,r=0){this.type=e,this.tname=t,this.item=n,this.assoc=r}}let hj=e=>new hH(null==e.type?null:hL(e.type.client,e.type.clock),e.tname??null,null==e.item?null:hL(e.item.client,e.item.clock),null==e.assoc?0:e.assoc);class hF{constructor(e,t,n=0){this.type=e,this.index=t,this.assoc=n}}let hU=(e,t,n)=>{let r=null,o=null;return null===e._item?o=hP(e):r=hL(e._item.id.client,e._item.id.clock),new hH(r,o,t,n)},hz=(e,t,n=0)=>{let r=e._start;if(n<0){if(0===t)return hU(e,null,n);t--}for(;null!==r;){if(!r.deleted&&r.countable){if(r.length>t)return hU(e,hL(r.id.client,r.id.clock+t),n);t-=r.length}if(null===r.right&&n<0)return hU(e,r.lastId,n);r=r.right}return hU(e,null,n)},hV=(e,t)=>e===t||null!==e&&null!==t&&e.tname===t.tname&&hR(e.item,t.item)&&hR(e.type,t.type)&&e.assoc===t.assoc;class h${constructor(e,t){this.ds=e,this.sv=t}}let hG=(e,t)=>new h$(e,t);hG(hd(),new Map);let hq=e=>hG(hu(e.store),hZ(e.store)),hW=(e,t)=>void 0===t?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!hs(t.ds,e.id),hY=(e,t)=>{let n=cF(e.meta,hY,cw),r=e.doc.store;n.has(t)||(t.sv.forEach((t,n)=>{t<hX(r,n)&&h2(e,hL(n,t))}),hi(e,t.ds,e=>{}),n.add(t))};class hK{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}let hZ=e=>{let t=new Map;return e.clients.forEach((e,n)=>{let r=e[e.length-1];t.set(n,r.id.clock+r.length)}),t},hX=(e,t)=>{let n=e.clients.get(t);if(void 0===n)return 0;let r=n[n.length-1];return r.id.clock+r.length},hQ=(e,t)=>{let n=e.clients.get(t.id.client);if(void 0===n)n=[],e.clients.set(t.id.client,n);else{let e=n[n.length-1];if(e.id.clock+e.length!==t.id.clock)throw cB()}n.push(t)},hJ=(e,t)=>{let n=0,r=e.length-1,o=e[r],i=o.id.clock;if(i===t)return r;let s=cu(t/(i+o.length-1)*r);for(;n<=r;){if((i=(o=e[s]).id.clock)<=t){if(t<i+o.length)return s;n=s+1}else r=s-1;s=cu((n+r)/2)}throw cB()},h0=(e,t)=>{let n=e.clients.get(t.client);return n[hJ(n,t.clock)]},h1=(e,t,n)=>{let r=hJ(t,n),o=t[r];return o.id.clock<n&&o instanceof fN?(t.splice(r+1,0,fS(e,o,n-o.id.clock)),r+1):r},h2=(e,t)=>{let n=e.doc.store.clients.get(t.client);return n[h1(e,n,t.clock)]},h4=(e,t,n)=>{let r=t.clients.get(n.client),o=hJ(r,n.clock),i=r[o];return n.clock!==i.id.clock+i.length-1&&i.constructor!==fo&&r.splice(o+1,0,fS(e,i,n.clock-i.id.clock+1)),i},h5=(e,t,n,r,o)=>{let i;if(0===r)return;let s=n+r,l=h1(e,t,n);do s<(i=t[l++]).id.clock+i.length&&h1(e,t,s),o(i);while(l<t.length&&t[l].id.clock<s)};class h3{constructor(e,t,n){this.doc=e,this.deleteSet=new ho,this.beforeState=hZ(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=n,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}let h8=(e,t)=>(0!==t.deleteSet.clients.size||!!((e,t)=>{for(let[n,r]of e)if(t(r,n))return!0;return!1})(t.afterState,(e,n)=>t.beforeState.get(n)!==e))&&(hl(t.deleteSet),hw(e,t.doc.store,t.beforeState),hh(e,t.deleteSet),!0),h6=(e,t,n)=>{let r=t._item;(null===r||r.id.clock<(e.beforeState.get(r.id.client)||0)&&!r.deleted)&&cF(e.changed,t,cw).add(n)},h9=(e,t)=>{let n=e[t],r=e[t-1],o=t;for(;o>0;n=r,r=e[--o-1]){if(r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n)){n instanceof fN&&null!==n.parentSub&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r);continue}break}let i=t-o;return i&&e.splice(t+1-i,i),i},h7=(e,t)=>{if(t<e.length){let n=e[t],r=n.doc,o=r.store,i=n.deleteSet,s=n._mergeStructs;try{hl(i),n.afterState=hZ(n.doc.store),r.emit("beforeObserverCalls",[n,r]);let e=[];n.changed.forEach((t,r)=>e.push(()=>{null!==r._item&&r._item.deleted||r._callObserver(n,t)})),e.push(()=>{n.changedParentTypes.forEach((e,t)=>{t._dEH.l.length>0&&(null===t._item||!t._item.deleted)&&((e=e.filter(e=>null===e.target._item||!e.target._item.deleted)).forEach(e=>{e.currentTarget=t,e._path=null}),e.sort((e,t)=>e.path.length-t.path.length),hO(t._dEH,e,n))})}),e.push(()=>r.emit("afterTransaction",[n,r])),cI(e,[]),n._needFormattingCleanup&&p4(n)}finally{r.gc&&((e,t,n)=>{for(let[r,o]of e.clients.entries()){let e=t.clients.get(r);for(let r=o.length-1;r>=0;r--){let i=o[r],s=i.clock+i.len;for(let r=hJ(e,i.clock),o=e[r];r<e.length&&o.id.clock<s;o=e[++r]){let o=e[r];if(i.clock+i.len<=o.id.clock)break;o instanceof fN&&o.deleted&&!o.keep&&n(o)&&o.gc(t,!1)}}}})(i,o,r.gcFilter),i.clients.forEach((e,t)=>{let n=o.clients.get(t);for(let t=e.length-1;t>=0;t--){let r=e[t],o=cp(n.length-1,1+hJ(n,r.clock+r.len-1));for(let e=o,t=n[e];e>0&&t.id.clock>=r.clock;t=n[e])e-=1+h9(n,e)}}),n.afterState.forEach((e,t)=>{let r=n.beforeState.get(t)||0;if(r!==e){let e=o.clients.get(t),n=cf(hJ(e,r),1);for(let t=e.length-1;t>=n;)t-=1+h9(e,t)}});for(let e=s.length-1;e>=0;e--){let{client:t,clock:n}=s[e].id,r=o.clients.get(t),i=hJ(r,n);!(i+1<r.length&&h9(r,i+1)>1)&&i>0&&h9(r,i)}if(n.local||n.afterState.get(r.clientID)===n.beforeState.get(r.clientID)||(((...e)=>{console.log(...u9(e)),he.forEach(t=>t.print(e))})(u3,uQ,"[yjs] ",uJ,u4,"Changed the client-id because another client seems to be using it."),r.clientID=d_()),r.emit("afterTransactionCleanup",[n,r]),r._observers.has("update")){let e=new hk;h8(e,n)&&r.emit("update",[e.toUint8Array(),n.origin,r,n])}if(r._observers.has("updateV2")){let e=new hT;h8(e,n)&&r.emit("updateV2",[e.toUint8Array(),n.origin,r,n])}let{subdocsAdded:l,subdocsLoaded:a,subdocsRemoved:c}=n;(l.size>0||c.size>0||a.size>0)&&(l.forEach(e=>{e.clientID=r.clientID,null==e.collectionid&&(e.collectionid=r.collectionid),r.subdocs.add(e)}),c.forEach(e=>r.subdocs.delete(e)),r.emit("subdocs",[{loaded:a,added:l,removed:c},r,n]),c.forEach(e=>e.destroy())),e.length<=t+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,e])):h7(e,t+1)}}},pe=(e,t,n=null,r=!0)=>{let o=e._transactionCleanups,i=!1,s=null;null===e._transaction&&(i=!0,e._transaction=new h3(e,n,r),o.push(e._transaction),1===o.length&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{s=t(e._transaction)}finally{if(i){let t=e._transaction===o[0];e._transaction=null,t&&h7(o,0)}}return s};class pt{constructor(e,t){this.insertions=t,this.deletions=e,this.meta=new Map}}let pn=(e,t,n)=>{hi(e,n.deletions,n=>{n instanceof fN&&t.scope.some(t=>t===e.doc||hB(t,n))&&fx(n,!1)})},pr=(e,t,n)=>{let r=null,o=e.doc,i=e.scope;pe(o,n=>{for(;t.length>0&&null===e.currStackItem;){let r=o.store,s=t.pop(),l=new Set,a=[],c=!1;hi(n,s.insertions,e=>{if(e instanceof fN){if(null!==e.redone){let{item:t,diff:o}=fw(r,e.id);o>0&&(t=h2(n,hL(t.id.client,t.id.clock+o))),e=t}!e.deleted&&i.some(t=>t===n.doc||hB(t,e))&&a.push(e)}}),hi(n,s.deletions,e=>{e instanceof fN&&i.some(t=>t===n.doc||hB(t,e))&&!hs(s.insertions,e.id)&&l.add(e)}),l.forEach(t=>{c=null!==f_(n,t,l,s.insertions,e.ignoreRemoteMapChanges,e)||c});for(let t=a.length-1;t>=0;t--){let r=a[t];e.deleteFilter(r)&&(r.delete(n),c=!0)}e.currStackItem=c?s:null}n.changed.forEach((e,t)=>{e.has(null)&&t._searchMarker&&(t._searchMarker.length=0)}),r=n},e);let s=e.currStackItem;if(null!=s){let t=r.changedParentTypes;e.emit("stack-item-popped",[{stackItem:s,type:n,changedParentTypes:t,origin:e},e]),e.currStackItem=null}return s};class po extends cU{constructor(e,{captureTimeout:t=500,captureTransaction:n=e=>!0,deleteFilter:r=()=>!0,trackedOrigins:o=new Set([null]),ignoreRemoteMapChanges:i=!1,doc:s=cM(e)?e[0].doc:e instanceof hm?e:e.doc}={}){super(),this.scope=[],this.doc=s,this.addToScope(e),this.deleteFilter=r,o.add(this),this.trackedOrigins=o,this.captureTransaction=n,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=i,this.captureTimeout=t,this.afterTransactionHandler=e=>{if(!this.captureTransaction(e)||!this.scope.some(t=>e.changedParentTypes.has(t)||t===this.doc)||!this.trackedOrigins.has(e.origin)&&(!e.origin||!this.trackedOrigins.has(e.origin.constructor)))return;let t=this.undoing,n=this.redoing,r=t?this.redoStack:this.undoStack;t?this.stopCapturing():n||this.clear(!1,!0);let o=new ho;e.afterState.forEach((t,n)=>{let r=e.beforeState.get(n)||0,i=t-r;i>0&&hc(o,n,r,i)});let i=dN(),s=!1;if(this.lastChange>0&&i-this.lastChange<this.captureTimeout&&r.length>0&&!t&&!n){let t=r[r.length-1];t.deletions=ha([t.deletions,e.deleteSet]),t.insertions=ha([t.insertions,o])}else r.push(new pt(e.deleteSet,o)),s=!0;t||n||(this.lastChange=i),hi(e,e.deleteSet,t=>{t instanceof fN&&this.scope.some(n=>n===e.doc||hB(n,t))&&fx(t,!0)});let l=[{stackItem:r[r.length-1],origin:e.origin,type:t?"redo":"undo",changedParentTypes:e.changedParentTypes},this];s?this.emit("stack-item-added",l):this.emit("stack-item-updated",l)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(e){let t=new Set(this.scope);(e=cM(e)?e:[e]).forEach(e=>{t.has(e)||(t.add(e),(e instanceof px?e.doc!==this.doc:e!==this.doc)&&u7("[yjs#509] Not same Y.Doc"),this.scope.push(e))})}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(e=!0,t=!0){(e&&this.canUndo()||t&&this.canRedo())&&this.doc.transact(n=>{e&&(this.undoStack.forEach(e=>pn(n,this,e)),this.undoStack=[]),t&&(this.redoStack.forEach(e=>pn(n,this,e)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:t}])})}stopCapturing(){this.lastChange=0}undo(){let e;this.undoing=!0;try{e=pr(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){let e;this.redoing=!0;try{e=pr(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}class pi{constructor(e,t){this.gen=function*(e){let t=dg(e.restDecoder);for(let n=0;n<t;n++){let t=dg(e.restDecoder),n=e.readClient(),r=dg(e.restDecoder);for(let o=0;o<t;o++){let t=e.readInfo();if(10===t){let t=dg(e.restDecoder);yield new fO(hL(n,r),t),r+=t}else if((31&t)!=0){let o=(192&t)==0,i=new fN(hL(n,r),null,(128&t)==128?e.readLeftID():null,null,(64&t)==64?e.readRightID():null,o?e.readParentInfo()?e.readString():e.readLeftID():null,o&&(32&t)==32?e.readString():null,fM(e,t));yield i,r+=i.length}else{let t=e.readLen();yield new fo(hL(n,r),t),r+=t}}}}(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&null!==this.curr&&this.curr.constructor===fO)return this.curr}}class ps{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}let pl=e=>pc(e,hb,hk),pa=(e,t)=>{if(e.constructor===fo){let{client:n,clock:r}=e.id;return new fo(hL(n,r+t),e.length-t)}if(e.constructor===fO){let{client:n,clock:r}=e.id;return new fO(hL(n,r+t),e.length-t)}{let{client:n,clock:r}=e.id;return new fN(hL(n,r+t),null,hL(n,r+t-1),null,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t))}},pc=(e,t=hv,n=hT)=>{if(1===e.length)return e[0];let r=e.map(e=>new t(dp(e))),o=r.map(e=>new pi(e,!0)),i=null,s=new n,l=new ps(s);for(;(o=o.filter(e=>null!==e.curr)).sort((e,t)=>{if(e.curr.id.client!==t.curr.id.client)return t.curr.id.client-e.curr.id.client;{let n=e.curr.id.clock-t.curr.id.clock;return 0===n?e.curr.constructor===t.curr.constructor?0:e.curr.constructor===fO?1:-1:n}}),0!==o.length;){let e=o[0],t=e.curr.id.client;if(null!==i){let n=e.curr,r=!1;for(;null!==n&&n.id.clock+n.length<=i.struct.id.clock+i.struct.length&&n.id.client>=i.struct.id.client;)n=e.next(),r=!0;if(null===n||n.id.client!==t||r&&n.id.clock>i.struct.id.clock+i.struct.length)continue;if(t!==i.struct.id.client)ph(l,i.struct,i.offset),i={struct:n,offset:0},e.next();else if(i.struct.id.clock+i.struct.length<n.id.clock)if(i.struct.constructor===fO)i.struct.length=n.id.clock+n.length-i.struct.id.clock;else{ph(l,i.struct,i.offset);let e=n.id.clock-i.struct.id.clock-i.struct.length;i={struct:new fO(hL(t,i.struct.id.clock+i.struct.length),e),offset:0}}else{let t=i.struct.id.clock+i.struct.length-n.id.clock;t>0&&(i.struct.constructor===fO?i.struct.length-=t:n=pa(n,t)),i.struct.mergeWith(n)||(ph(l,i.struct,i.offset),i={struct:n,offset:0},e.next())}}else i={struct:e.curr,offset:0},e.next();for(let n=e.curr;null!==n&&n.id.client===t&&n.id.clock===i.struct.id.clock+i.struct.length&&n.constructor!==fO;n=e.next())ph(l,i.struct,i.offset),i={struct:n,offset:0}}return null!==i&&(ph(l,i.struct,i.offset),i=null),pp(l),hh(s,ha(r.map(e=>hp(e)))),s.toUint8Array()},pd=(e,t,n=hv,r=hT)=>{let o=hA(t),i=new r,s=new ps(i),l=new n(dp(e)),a=new pi(l,!1);for(;a.curr;){let e=a.curr,t=e.id.client,n=o.get(t)||0;if(a.curr.constructor===fO){a.next();continue}if(e.id.clock+e.length>n)for(ph(s,e,cf(n-e.id.clock,0)),a.next();a.curr&&a.curr.id.client===t;)ph(s,a.curr,0),a.next();else for(;a.curr&&a.curr.id.client===t&&a.curr.id.clock+a.curr.length<=n;)a.next()}return pp(s),hh(i,hp(l)),i.toUint8Array()},pu=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:c1(e.encoder.restEncoder)}),e.encoder.restEncoder=c0(),e.written=0)},ph=(e,t,n)=>{e.written>0&&e.currClient!==t.id.client&&pu(e),0===e.written&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),c4(e.encoder.restEncoder,t.id.clock+n)),t.write(e.encoder,n),e.written++},pp=e=>{pu(e);let t=e.encoder.restEncoder;c4(t,e.clientStructs.length);for(let n=0;n<e.clientStructs.length;n++){let r=e.clientStructs[n];c4(t,r.written),c9(t,r.restEncoder)}},pf=e=>((e,t,n,r)=>{let o=new n(dp(e)),i=new pi(o,!1),s=new r,l=new ps(s);for(let e=i.curr;null!==e;e=i.next())ph(l,t(e),0);return pp(l),hh(s,hp(o)),s.toUint8Array()})(e,cO,hv,hk),pm="You must not compute changes after the event-handler fired.";class pg{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=pb(this.currentTarget,this.target))}deletes(e){return hs(this.transaction.deleteSet,e.id)}get keys(){if(null===this._keys){if(0===this.transaction.doc._transactionCleanups.length)throw Error(pm);let e=new Map,t=this.target;this.transaction.changed.get(t).forEach(n=>{if(null!==n){let r,o,i=t._map.get(n);if(this.adds(i)){let e=i.left;for(;null!==e&&this.adds(e);)e=e.left;if(this.deletes(i))if(!(null!==e&&this.deletes(e)))return;else r="delete",o=cx(e.content.getContent());else null!==e&&this.deletes(e)?(r="update",o=cx(e.content.getContent())):(r="add",o=void 0)}else{if(!this.deletes(i))return;r="delete",o=cx(i.content.getContent())}e.set(n,{action:r,oldValue:o})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(null===e){if(0===this.transaction.doc._transactionCleanups.length)throw Error(pm);let t=this.target,n=cw(),r=cw(),o=[];if(e={added:n,deleted:r,delta:o,keys:this.keys},this.transaction.changed.get(t).has(null)){let e=null,i=()=>{e&&o.push(e)};for(let o=t._start;null!==o;o=o.right)o.deleted?this.deletes(o)&&!this.adds(o)&&((null===e||void 0===e.delete)&&(i(),e={delete:0}),e.delete+=o.length,r.add(o)):this.adds(o)?((null===e||void 0===e.insert)&&(i(),e={insert:[]}),e.insert=e.insert.concat(o.content.getContent()),n.add(o)):((null===e||void 0===e.retain)&&(i(),e={retain:0}),e.retain+=o.length);null!==e&&void 0===e.retain&&i()}this._changes=e}return e}}let pb=(e,t)=>{let n=[];for(;null!==t._item&&t!==e;){if(null!==t._item.parentSub)n.unshift(t._item.parentSub);else{let e=0,r=t._item.parent._start;for(;r!==t._item&&null!==r;)!r.deleted&&r.countable&&(e+=r.length),r=r.right;n.unshift(e)}t=t._item.parent}return n},py=()=>{u7("Invalid access: Add Yjs type to a document before reading data.")},pv=0;class pE{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=pv++}}let pk=(e,t,n)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=n,e.timestamp=pv++},pC=(e,t)=>{if(null===e._start||0===t||null===e._searchMarker)return null;let n=0===e._searchMarker.length?null:e._searchMarker.reduce((e,n)=>ch(t-e.index)<ch(t-n.index)?e:n),r=e._start,o=0;for(null!==n&&(r=n.p,o=n.index,n.timestamp=pv++);null!==r.right&&o<t;){if(!r.deleted&&r.countable){if(t<o+r.length)break;o+=r.length}r=r.right}for(;null!==r.left&&o>t;)!(r=r.left).deleted&&r.countable&&(o-=r.length);for(;null!==r.left&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)!(r=r.left).deleted&&r.countable&&(o-=r.length);if(null!==n&&ch(n.index-o)<r.parent.length/80)return pk(n,r,o),n;var i=e._searchMarker,s=r,l=o;if(i.length>=80){let e=i.reduce((e,t)=>e.timestamp<t.timestamp?e:t);return pk(e,s,l),e}{let e=new pE(s,l);return i.push(e),e}},pT=(e,t,n)=>{for(let r=e.length-1;r>=0;r--){let o=e[r];if(n>0){let t=o.p;for(t.marker=!1;t&&(t.deleted||!t.countable);)(t=t.left)&&!t.deleted&&t.countable&&(o.index-=t.length);if(null===t||!0===t.marker){e.splice(r,1);continue}o.p=t,t.marker=!0}(t<o.index||n>0&&t===o.index)&&(o.index=cf(t,o.index+n))}},pw=(e,t,n)=>{let r=e,o=t.changedParentTypes;for(;cF(o,e,()=>[]).push(n),null!==e._item;)e=e._item.parent;hO(r._eH,n,t)};class px{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=hM(),this._dEH=hM(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw cP()}clone(){throw cP()}_write(e){}get _first(){let e=this._start;for(;null!==e&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){let t;t=this._eH,t.l.push(e)}observeDeep(e){let t;t=this._dEH,t.l.push(e)}unobserve(e){hI(this._eH,e)}unobserveDeep(e){hI(this._dEH,e)}toJSON(){}}let pS=(e,t,n)=>{e.doc??py(),t<0&&(t=e._length+t),n<0&&(n=e._length+n);let r=n-t,o=[],i=e._start;for(;null!==i&&r>0;){if(i.countable&&!i.deleted){let e=i.content.getContent();if(e.length<=t)t-=e.length;else{for(let n=t;n<e.length&&r>0;n++)o.push(e[n]),r--;t=0}}i=i.right}return o},pA=e=>{e.doc??py();let t=[],n=e._start;for(;null!==n;){if(n.countable&&!n.deleted){let e=n.content.getContent();for(let n=0;n<e.length;n++)t.push(e[n])}n=n.right}return t},p_=(e,t)=>{let n=[],r=e._start;for(;null!==r;){if(r.countable&&hW(r,t)){let e=r.content.getContent();for(let t=0;t<e.length;t++)n.push(e[t])}r=r.right}return n},pN=(e,t)=>{let n=0,r=e._start;for(e.doc??py();null!==r;){if(r.countable&&!r.deleted){let o=r.content.getContent();for(let r=0;r<o.length;r++)t(o[r],n++,e)}r=r.right}},pM=(e,t)=>{let n=[];return pN(e,(r,o)=>{n.push(t(r,o,e))}),n},pI=(e,t)=>{e.doc??py();let n=pC(e,t),r=e._start;for(null!==n&&(r=n.p,t-=n.index);null!==r;r=r.right)if(!r.deleted&&r.countable){if(t<r.length)return r.content.getContent()[t];t-=r.length}},pO=(e,t,n,r)=>{let o=n,i=e.doc,s=i.clientID,l=i.store,a=null===n?t._start:n.right,c=[],d=()=>{c.length>0&&((o=new fN(hL(s,hX(l,s)),o,o&&o.lastId,a,a&&a.id,t,null,new fp(c))).integrate(e,0),c=[])};r.forEach(n=>{if(null===n)c.push(n);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:c.push(n);break;default:switch(d(),n.constructor){case Uint8Array:case ArrayBuffer:(o=new fN(hL(s,hX(l,s)),o,o&&o.lastId,a,a&&a.id,t,null,new fi(new Uint8Array(n)))).integrate(e,0);break;case hm:(o=new fN(hL(s,hX(l,s)),o,o&&o.lastId,a,a&&a.id,t,null,new fa(n))).integrate(e,0);break;default:if(n instanceof px)(o=new fN(hL(s,hX(l,s)),o,o&&o.lastId,a,a&&a.id,t,null,new fT(n))).integrate(e,0);else throw Error("Unexpected content type in insert operation")}}}),d()},pD=(e,t,n,r)=>{if(n>t._length)throw Error("Length exceeded!");if(0===n)return t._searchMarker&&pT(t._searchMarker,n,r.length),pO(e,t,null,r);let o=n,i=pC(t,n),s=t._start;for(null!==i&&(s=i.p,0==(n-=i.index)&&(n+=(s=s.prev)&&s.countable&&!s.deleted?s.length:0));null!==s;s=s.right)if(!s.deleted&&s.countable){if(n<=s.length){n<s.length&&h2(e,hL(s.id.client,s.id.clock+n));break}n-=s.length}return t._searchMarker&&pT(t._searchMarker,o,r.length),pO(e,t,s,r)},pR=(e,t,n,r)=>{if(0===r)return;let o=n,i=r,s=pC(t,n),l=t._start;for(null!==s&&(l=s.p,n-=s.index);null!==l&&n>0;l=l.right)!l.deleted&&l.countable&&(n<l.length&&h2(e,hL(l.id.client,l.id.clock+n)),n-=l.length);for(;r>0&&null!==l;)l.deleted||(r<l.length&&h2(e,hL(l.id.client,l.id.clock+r)),l.delete(e),r-=l.length),l=l.right;if(r>0)throw Error("Length exceeded!");t._searchMarker&&pT(t._searchMarker,o,-i+r)},pL=(e,t,n)=>{let r=t._map.get(n);void 0!==r&&r.delete(e)},pP=(e,t,n,r)=>{let o,i=t._map.get(n)||null,s=e.doc,l=s.clientID;if(null==r)o=new fp([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:case Date:case BigInt:o=new fp([r]);break;case Uint8Array:o=new fi(r);break;case hm:o=new fa(r);break;default:if(r instanceof px)o=new fT(r);else throw Error("Unexpected content type")}new fN(hL(l,hX(s.store,l)),i,i&&i.lastId,null,null,t,n,o).integrate(e,0)},pB=(e,t)=>{e.doc??py();let n=e._map.get(t);return void 0===n||n.deleted?void 0:n.content.getContent()[n.length-1]},pH=e=>{let t={};return e.doc??py(),e._map.forEach((e,n)=>{e.deleted||(t[n]=e.content.getContent()[e.length-1])}),t},pj=(e,t)=>{e.doc??py();let n=e._map.get(t);return void 0!==n&&!n.deleted},pF=e=>{let t,n;return e.doc??py(),t=e._map.entries(),n=e=>!e[1].deleted,ht(()=>{let e;do e=t.next();while(!e.done&&!n(e.value))return e})};class pU extends pg{}class pz extends px{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){let t=new pz;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new pz}clone(){let e=new pz;return e.insert(0,this.toArray().map(e=>e instanceof px?e.clone():e)),e}get length(){return this.doc??py(),this._length}_callObserver(e,t){super._callObserver(e,t),pw(this,e,new pU(this,e))}insert(e,t){null!==this.doc?pe(this.doc,n=>{pD(n,this,e,t)}):this._prelimContent.splice(e,0,...t)}push(e){null!==this.doc?pe(this.doc,t=>{((e,t,n)=>{let r=(t._searchMarker||[]).reduce((e,t)=>t.index>e.index?t:e,{index:0,p:t._start}).p;if(r)for(;r.right;)r=r.right;return pO(e,t,r,n)})(t,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){null!==this.doc?pe(this.doc,n=>{pR(n,this,e,t)}):this._prelimContent.splice(e,t)}get(e){return pI(this,e)}toArray(){return pA(this)}slice(e=0,t=this.length){return pS(this,e,t)}toJSON(){return this.map(e=>e instanceof px?e.toJSON():e)}map(e){return pM(this,e)}forEach(e){pN(this,e)}[Symbol.iterator](){let e,t,n;return e=this._start,t=null,n=0,{[Symbol.iterator](){return this},next:()=>{if(null===t){for(;null!==e&&e.deleted;)e=e.right;if(null===e)return{done:!0,value:void 0};t=e.content.getContent(),n=0,e=e.right}let r=t[n++];return t.length<=n&&(t=null),{done:!1,value:r}}}}_write(e){e.writeTypeRef(fg)}}class pV extends pg{constructor(e,t,n){super(e,t),this.keysChanged=n}}class p$ extends px{constructor(e){super(),this._prelimContent=null,void 0===e?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach((e,t)=>{this.set(t,e)}),this._prelimContent=null}_copy(){return new p$}clone(){let e=new p$;return this.forEach((t,n)=>{e.set(n,t instanceof px?t.clone():t)}),e}_callObserver(e,t){pw(this,e,new pV(this,e,t))}toJSON(){this.doc??py();let e={};return this._map.forEach((t,n)=>{if(!t.deleted){let r=t.content.getContent()[t.length-1];e[n]=r instanceof px?r.toJSON():r}}),e}get size(){return[...pF(this)].length}keys(){return hn(pF(this),e=>e[0])}values(){return hn(pF(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return hn(pF(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??py(),this._map.forEach((t,n)=>{t.deleted||e(t.content.getContent()[t.length-1],n,this)})}[Symbol.iterator](){return this.entries()}delete(e){null!==this.doc?pe(this.doc,t=>{pL(t,this,e)}):this._prelimContent.delete(e)}set(e,t){return null!==this.doc?pe(this.doc,n=>{pP(n,this,e,t)}):this._prelimContent.set(e,t),t}get(e){return pB(this,e)}has(e){return pj(this,e)}clear(){null!==this.doc?pe(this.doc,e=>{this.forEach(function(t,n,r){pL(e,r,n)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(fb)}}let pG=(e,t)=>{let n,r;return e===t||"object"==typeof e&&"object"==typeof t&&e&&t&&((n=e)===(r=t)||cv(n).length===cv(r).length&&cE(n,(e,t)=>(void 0!==e||ck(r,t))&&cb(r[t],e)))};class pq{constructor(e,t,n,r){this.left=e,this.right=t,this.index=n,this.currentAttributes=r}forward(){null===this.right&&cB(),this.right.content.constructor===fd?this.right.deleted||pZ(this.currentAttributes,this.right.content):this.right.deleted||(this.index+=this.right.length),this.left=this.right,this.right=this.right.right}}let pW=(e,t,n)=>{for(;null!==t.right&&n>0;)t.right.content.constructor===fd?t.right.deleted||pZ(t.currentAttributes,t.right.content):t.right.deleted||(n<t.right.length&&h2(e,hL(t.right.id.client,t.right.id.clock+n)),t.index+=t.right.length,n-=t.right.length),t.left=t.right,t.right=t.right.right;return t},pY=(e,t,n,r)=>{let o=new Map,i=r?pC(t,n):null;return i?pW(e,new pq(i.p.left,i.p,i.index,o),n-i.index):pW(e,new pq(null,t._start,0,o),n)},pK=(e,t,n,r)=>{for(;null!==n.right&&(!0===n.right.deleted||n.right.content.constructor===fd&&pG(r.get(n.right.content.key),n.right.content.value));)n.right.deleted||r.delete(n.right.content.key),n.forward();let o=e.doc,i=o.clientID;r.forEach((r,s)=>{let l=n.left,a=n.right,c=new fN(hL(i,hX(o.store,i)),l,l&&l.lastId,a,a&&a.id,t,null,new fd(s,r));c.integrate(e,0),n.right=c,n.forward()})},pZ=(e,t)=>{let{key:n,value:r}=t;null===r?e.delete(n):e.set(n,r)},pX=(e,t)=>{for(;null!==e.right&&(e.right.deleted||e.right.content.constructor===fd&&pG(t[e.right.content.key]??null,e.right.content.value));){;e.forward()}},pQ=(e,t,n,r)=>{let o=e.doc,i=o.clientID,s=new Map;for(let l in r){let a=r[l],c=n.currentAttributes.get(l)??null;if(!pG(c,a)){s.set(l,c);let{left:r,right:d}=n;n.right=new fN(hL(i,hX(o.store,i)),r,r&&r.lastId,d,d&&d.id,t,null,new fd(l,a)),n.right.integrate(e,0),n.forward()}}return s},pJ=(e,t,n,r,o)=>{n.currentAttributes.forEach((e,t)=>{void 0===o[t]&&(o[t]=null)});let i=e.doc,s=i.clientID;pX(n,o);let l=pQ(e,t,n,o),a=r.constructor===String?new ff(r):r instanceof px?new fT(r):new fc(r),{left:c,right:d,index:u}=n;t._searchMarker&&pT(t._searchMarker,n.index,a.getLength()),(d=new fN(hL(s,hX(i.store,s)),c,c&&c.lastId,d,d&&d.id,t,null,a)).integrate(e,0),n.right=d,n.index=u,n.forward(),pK(e,t,n,l)},p0=(e,t,n,r,o)=>{let i=e.doc,s=i.clientID;pX(n,o);let l=pQ(e,t,n,o);for(;null!==n.right&&(r>0||l.size>0&&(n.right.deleted||n.right.content.constructor===fd));){if(!n.right.deleted)if(n.right.content.constructor===fd){let{key:t,value:i}=n.right.content,s=o[t];if(void 0!==s){if(pG(s,i))l.delete(t);else{if(0===r)break;l.set(t,i)}n.right.delete(e)}else n.currentAttributes.set(t,i)}else r<n.right.length&&h2(e,hL(n.right.id.client,n.right.id.clock+r)),r-=n.right.length;n.forward()}if(r>0){let o="";for(;r>0;r--)o+="\n";n.right=new fN(hL(s,hX(i.store,s)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,t,null,new ff(o)),n.right.integrate(e,0),n.forward()}pK(e,t,n,l)},p1=(e,t,n,r,o)=>{let i=t,s=cH();for(;i&&(!i.countable||i.deleted);){if(!i.deleted&&i.content.constructor===fd){let e=i.content;s.set(e.key,e)}i=i.right}let l=0,a=!1;for(;t!==i;){if(n===t&&(a=!0),!t.deleted){let n=t.content;if(n.constructor===fd){let{key:i,value:c}=n,d=r.get(i)??null;(s.get(i)!==n||d===c)&&(t.delete(e),l++,a||(o.get(i)??null)!==c||d===c||(null===d?o.delete(i):o.set(i,d))),a||t.deleted||pZ(o,n)}}t=t.right}return l},p2=e=>{let t=0;return pe(e.doc,n=>{let r=e._start,o=e._start,i=cH(),s=cj(i);for(;o;)!1===o.deleted&&(o.content.constructor===fd?pZ(s,o.content):(t+=p1(n,r,o,i,s),i=cj(s),r=o)),o=o.right}),t},p4=e=>{let t=new Set,n=e.doc;for(let[r,o]of e.afterState.entries()){let i=e.beforeState.get(r)||0;o!==i&&h5(e,n.store.clients.get(r),i,o,e=>{e.deleted||e.content.constructor!==fd||e.constructor===fo||t.add(e.parent)})}pe(n,n=>{for(let r of(hi(e,e.deleteSet,e=>{if(e instanceof fo||!e.parent._hasFormatting||t.has(e.parent))return;let r=e.parent;if(e.content.constructor===fd)t.add(r);else{for(var o=e;o&&o.right&&(o.right.deleted||!o.right.countable);)o=o.right;let t=new Set;for(;o&&(o.deleted||!o.countable);){if(!o.deleted&&o.content.constructor===fd){let e=o.content.key;t.has(e)?o.delete(n):t.add(e)}o=o.left}}}),t))p2(r)})},p5=(e,t,n)=>{let r=n,o=cj(t.currentAttributes),i=t.right;for(;n>0&&null!==t.right;){if(!1===t.right.deleted)switch(t.right.content.constructor){case fT:case fc:case ff:n<t.right.length&&h2(e,hL(t.right.id.client,t.right.id.clock+n)),n-=t.right.length,t.right.delete(e)}t.forward()}i&&p1(e,i,t.right,o,t.currentAttributes);let s=(t.left||t.right).parent;return s._searchMarker&&pT(s._searchMarker,t.index,-r+n),t};class p3 extends pg{constructor(e,t,n){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,n.forEach(e=>{null===e?this.childListChanged=!0:this.keysChanged.add(e)})}get changes(){if(null===this._changes){let e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(null===this._delta){let e=this.target.doc,t=[];pe(e,e=>{let n=new Map,r=new Map,o=this.target._start,i=null,s={},l="",a=0,c=0,d=()=>{if(null!==i){let e=null;switch(i){case"delete":c>0&&(e={delete:c}),c=0;break;case"insert":("object"==typeof l||l.length>0)&&(e={insert:l},n.size>0&&(e.attributes={},n.forEach((t,n)=>{null!==t&&(e.attributes[n]=t)}))),l="";break;case"retain":a>0&&(e={retain:a},(e=>{for(let t in e)return!1;return!0})(s)||(e.attributes=cy({},s))),a=0}e&&t.push(e),i=null}};for(;null!==o;){switch(o.content.constructor){case fT:case fc:this.adds(o)?this.deletes(o)||(d(),i="insert",l=o.content.getContent()[0],d()):this.deletes(o)?("delete"!==i&&(d(),i="delete"),c+=1):o.deleted||("retain"!==i&&(d(),i="retain"),a+=1);break;case ff:this.adds(o)?this.deletes(o)||("insert"!==i&&(d(),i="insert"),l+=o.content.str):this.deletes(o)?("delete"!==i&&(d(),i="delete"),c+=o.length):o.deleted||("retain"!==i&&(d(),i="retain"),a+=o.length);break;case fd:{let{key:t,value:l}=o.content;if(this.adds(o))this.deletes(o)||(pG(n.get(t)??null,l)?null!==l&&o.delete(e):("retain"===i&&d(),pG(l,r.get(t)??null)?delete s[t]:s[t]=l));else if(this.deletes(o)){r.set(t,l);let e=n.get(t)??null;pG(e,l)||("retain"===i&&d(),s[t]=e)}else if(!o.deleted){r.set(t,l);let n=s[t];void 0!==n&&(pG(n,l)?null!==n&&o.delete(e):("retain"===i&&d(),null===l?delete s[t]:s[t]=l))}o.deleted||("insert"===i&&d(),pZ(n,o.content))}}o=o.right}for(d();t.length>0;){let e=t[t.length-1];if(void 0!==e.retain&&void 0===e.attributes)t.pop();else break}}),this._delta=t}return this._delta}}class p8 extends px{constructor(e){super(),this._pending=void 0!==e?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??py(),this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach(e=>e())}catch(e){console.error(e)}this._pending=null}_copy(){return new p8}clone(){let e=new p8;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);let n=new p3(this,e,t);pw(this,e,n),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??py();let e="",t=this._start;for(;null!==t;)!t.deleted&&t.countable&&t.content.constructor===ff&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){null!==this.doc?pe(this.doc,n=>{let r=new pq(null,this._start,0,new Map);for(let o=0;o<e.length;o++){let i=e[o];if(void 0!==i.insert){let s=t||"string"!=typeof i.insert||o!==e.length-1||null!==r.right||"\n"!==i.insert.slice(-1)?i.insert:i.insert.slice(0,-1);("string"!=typeof s||s.length>0)&&pJ(n,this,r,s,i.attributes||{})}else void 0!==i.retain?p0(n,this,r,i.retain,i.attributes||{}):void 0!==i.delete&&p5(n,r,i.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,t,n){this.doc??py();let r=[],o=new Map,i=this.doc,s="",l=this._start;function a(){if(s.length>0){let e={},t=!1;o.forEach((n,r)=>{t=!0,e[r]=n});let n={insert:s};t&&(n.attributes=e),r.push(n),s=""}}let c=()=>{for(;null!==l;){if(hW(l,e)||void 0!==t&&hW(l,t))switch(l.content.constructor){case ff:{let r=o.get("ychange");void 0===e||hW(l,e)?void 0===t||hW(l,t)?void 0!==r&&(a(),o.delete("ychange")):(void 0===r||r.user!==l.id.client||"added"!==r.type)&&(a(),o.set("ychange",n?n("added",l.id):{type:"added"})):(void 0===r||r.user!==l.id.client||"removed"!==r.type)&&(a(),o.set("ychange",n?n("removed",l.id):{type:"removed"})),s+=l.content.str;break}case fT:case fc:{a();let e={insert:l.content.getContent()[0]};if(o.size>0){let t={};e.attributes=t,o.forEach((e,n)=>{t[n]=e})}r.push(e);break}case fd:hW(l,e)&&(a(),pZ(o,l.content))}l=l.right}a()};return e||t?pe(i,n=>{e&&hY(n,e),t&&hY(n,t),c()},"cleanup"):c(),r}insert(e,t,n){if(t.length<=0)return;let r=this.doc;null!==r?pe(r,r=>{let o=pY(r,this,e,!n);n||(n={},o.currentAttributes.forEach((e,t)=>{n[t]=e})),pJ(r,this,o,t,n)}):this._pending.push(()=>this.insert(e,t,n))}insertEmbed(e,t,n){let r=this.doc;null!==r?pe(r,r=>{let o=pY(r,this,e,!n);pJ(r,this,o,t,n||{})}):this._pending.push(()=>this.insertEmbed(e,t,n||{}))}delete(e,t){if(0===t)return;let n=this.doc;null!==n?pe(n,n=>{p5(n,pY(n,this,e,!0),t)}):this._pending.push(()=>this.delete(e,t))}format(e,t,n){if(0===t)return;let r=this.doc;null!==r?pe(r,r=>{let o=pY(r,this,e,!1);null!==o.right&&p0(r,this,o,t,n)}):this._pending.push(()=>this.format(e,t,n))}removeAttribute(e){null!==this.doc?pe(this.doc,t=>{pL(t,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,t){null!==this.doc?pe(this.doc,n=>{pP(n,this,e,t)}):this._pending.push(()=>this.setAttribute(e,t))}getAttribute(e){return pB(this,e)}getAttributes(){return pH(this)}_write(e){e.writeTypeRef(fy)}}class p6{constructor(e,t=()=>!0){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??py()}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(null!==e&&(!this._firstCall||e.deleted||!this._filter(t)))do if(t=e.content.type,e.deleted||t.constructor!==p7&&t.constructor!==p9||null===t._start)for(;null!==e;){let t=e.next;if(null!==t){e=t;break}e=e.parent===this._root?null:e.parent._item}else e=t._start;while(null!==e&&(e.deleted||!this._filter(e.content.type)))return(this._firstCall=!1,null===e)?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class p9 extends px{constructor(){super(),this._prelimContent=[]}get firstChild(){let e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new p9}clone(){let e=new p9;return e.insert(0,this.toArray().map(e=>e instanceof px?e.clone():e)),e}get length(){return this.doc??py(),null===this._prelimContent?this._length:this._prelimContent.length}createTreeWalker(e){return new p6(this,e)}querySelector(e){e=e.toUpperCase();let t=new p6(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e).next();return t.done?null:t.value}querySelectorAll(e){return e=e.toUpperCase(),cA(new p6(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e))}_callObserver(e,t){pw(this,e,new fe(this,t,e))}toString(){return pM(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},n){let r=e.createDocumentFragment();return void 0!==n&&n._createAssociation(r,this),pN(this,o=>{r.insertBefore(o.toDOM(e,t,n),null)}),r}insert(e,t){null!==this.doc?pe(this.doc,n=>{pD(n,this,e,t)}):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(null!==this.doc)pe(this.doc,n=>{pO(n,this,e&&e instanceof px?e._item:e,t)});else{let n=this._prelimContent,r=null===e?0:n.findIndex(t=>t===e)+1;if(0===r&&null!==e)throw Error("Reference item not found");n.splice(r,0,...t)}}delete(e,t=1){null!==this.doc?pe(this.doc,n=>{pR(n,this,e,t)}):this._prelimContent.splice(e,t)}toArray(){return pA(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return pI(this,e)}slice(e=0,t=this.length){return pS(this,e,t)}forEach(e){pN(this,e)}_write(e){e.writeTypeRef(fE)}}class p7 extends p9{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){let e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){let e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach((e,t)=>{this.setAttribute(t,e)}),this._prelimAttrs=null}_copy(){return new p7(this.nodeName)}clone(){let e=new p7(this.nodeName);var t=this.getAttributes(),n=(t,n)=>{e.setAttribute(n,t)};for(let e in t)n(t[e],e);return e.insert(0,this.toArray().map(e=>e instanceof px?e.clone():e)),e}toString(){let e=this.getAttributes(),t=[],n=[];for(let t in e)n.push(t);n.sort();let r=n.length;for(let o=0;o<r;o++){let r=n[o];t.push(r+'="'+e[r]+'"')}let o=this.nodeName.toLocaleLowerCase(),i=t.length>0?" "+t.join(" "):"";return`<${o}${i}>${super.toString()}</${o}>`}removeAttribute(e){null!==this.doc?pe(this.doc,t=>{pL(t,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,t){null!==this.doc?pe(this.doc,n=>{pP(n,this,e,t)}):this._prelimAttrs.set(e,t)}getAttribute(e){return pB(this,e)}hasAttribute(e){return pj(this,e)}getAttributes(e){let t;return e?(t={},this._map.forEach((n,r)=>{let o=n;for(;null!==o&&(!e.sv.has(o.id.client)||o.id.clock>=(e.sv.get(o.id.client)||0));)o=o.left;null!==o&&hW(o,e)&&(t[r]=o.content.getContent()[o.length-1])}),t):pH(this)}toDOM(e=document,t={},n){let r=e.createElement(this.nodeName),o=this.getAttributes();for(let e in o){let t=o[e];"string"==typeof t&&r.setAttribute(e,t)}return pN(this,o=>{r.appendChild(o.toDOM(e,t,n))}),void 0!==n&&n._createAssociation(r,this),r}_write(e){e.writeTypeRef(fv),e.writeKey(this.nodeName)}}class fe extends pg{constructor(e,t,n){super(e,n),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach(e=>{null===e?this.childListChanged=!0:this.attributesChanged.add(e)})}}class ft extends p${constructor(e){super(),this.hookName=e}_copy(){return new ft(this.hookName)}clone(){let e=new ft(this.hookName);return this.forEach((t,n)=>{e.set(n,t)}),e}toDOM(e=document,t={},n){let r,o=t[this.hookName];return(r=void 0!==o?o.createDom(this):document.createElement(this.hookName)).setAttribute("data-yjs-hook",this.hookName),void 0!==n&&n._createAssociation(r,this),r}_write(e){e.writeTypeRef(fk),e.writeKey(this.hookName)}}class fn extends p8{get nextSibling(){let e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){let e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new fn}clone(){let e=new fn;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,n){let r=e.createTextNode(this.toString());return void 0!==n&&n._createAssociation(r,this),r}toString(){return this.toDelta().map(e=>{let t=[];for(let n in e.attributes){let r=[];for(let t in e.attributes[n])r.push({key:t,value:e.attributes[n][t]});r.sort((e,t)=>e.key<t.key?-1:1),t.push({nodeName:n,attrs:r})}t.sort((e,t)=>e.nodeName<t.nodeName?-1:1);let n="";for(let e=0;e<t.length;e++){let r=t[e];n+=`<${r.nodeName}`;for(let e=0;e<r.attrs.length;e++){let t=r.attrs[e];n+=` ${t.key}="${t.value}"`}n+=">"}n+=e.insert;for(let e=t.length-1;e>=0;e--)n+=`</${t[e].nodeName}>`;return n}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(fC)}}class fr{constructor(e,t){this.id=e,this.length=t}get deleted(){throw cP()}mergeWith(e){return!1}write(e,t,n){throw cP()}integrate(e,t){throw cP()}}class fo extends fr{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),hQ(e.doc.store,this)}write(e,t){e.writeInfo(0),e.writeLen(this.length-t)}getMissing(e,t){return null}}class fi{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new fi(this.content)}splice(e){throw cP()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}class fs{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new fs(this.len)}splice(e){let t=new fs(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){hc(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}let fl=(e,t)=>new hm({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class fa{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),null!==e.meta&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new fa(fl(this.doc.guid,this.opts))}splice(e){throw cP()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}class fc{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new fc(this.embed)}splice(e){throw cP()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}class fd{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new fd(this.key,this.value)}splice(e){throw cP()}mergeWith(e){return!1}integrate(e,t){let n=t.parent;n._searchMarker=null,n._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}class fu{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new fu(this.arr)}splice(e){let t=new fu(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){let n=this.arr.length;e.writeLen(n-t);for(let r=t;r<n;r++){let t=this.arr[r];e.writeString(void 0===t?"undefined":JSON.stringify(t))}}getRef(){return 2}}let fh="development"===dj("node_env");class fp{constructor(e){this.arr=e,fh&&cT(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new fp(this.arr)}splice(e){let t=new fp(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){let n=this.arr.length;e.writeLen(n-t);for(let r=t;r<n;r++){let t=this.arr[r];e.writeAny(t)}}getRef(){return 8}}class ff{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new ff(this.str)}splice(e){let t=new ff(this.str.slice(e));this.str=this.str.slice(0,e);let n=this.str.charCodeAt(e-1);return n>=55296&&n<=56319&&(this.str=this.str.slice(0,e-1)+"",t.str=""+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(0===t?this.str:this.str.slice(t))}getRef(){return 4}}let fm=[e=>new pz,e=>new p$,e=>new p8,e=>new p7(e.readKey()),e=>new p9,e=>new ft(e.readKey()),e=>new fn],fg=0,fb=1,fy=2,fv=3,fE=4,fk=5,fC=6;class fT{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new fT(this.type._copy())}splice(e){throw cP()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;null!==t;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach(t=>{t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e)}),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;null!==t;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach(t=>{for(;null!==t;)t.gc(e,!0),t=t.left}),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}let fw=(e,t)=>{let n,r=t,o=0;do o>0&&(r=hL(r.client,r.clock+o)),n=h0(e,r),o=r.clock-n.id.clock,r=n.redone;while(null!==r&&n instanceof fN)return{item:n,diff:o}},fx=(e,t)=>{for(;null!==e&&e.keep!==t;)e.keep=t,e=e.parent._item},fS=(e,t,n)=>{let{client:r,clock:o}=t.id,i=new fN(hL(r,o+n),t,hL(r,o+n-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(n));return t.deleted&&i.markDeleted(),t.keep&&(i.keep=!0),null!==t.redone&&(i.redone=hL(t.redone.client,t.redone.clock+n)),t.right=i,null!==i.right&&(i.right.left=i),e._mergeStructs.push(i),null!==i.parentSub&&null===i.right&&i.parent._map.set(i.parentSub,i),t.length=n,i},fA=(e,t)=>cN(e,e=>hs(e.deletions,t)),f_=(e,t,n,r,o,i)=>{let s,l=e.doc,a=l.store,c=l.clientID,d=t.redone;if(null!==d)return h2(e,d);let u=t.parent._item,h=null;if(null!==u&&!0===u.deleted){if(null===u.redone&&(!n.has(u)||null===f_(e,u,n,r,o,i)))return null;for(;null!==u.redone;)u=h2(e,u.redone)}let p=null===u?t.parent:u.content.type;if(null===t.parentSub){for(h=t.left,s=t;null!==h;){let t=h;for(;null!==t&&t.parent._item!==u;)t=null===t.redone?null:h2(e,t.redone);if(null!==t&&t.parent._item===u){h=t;break}h=h.left}for(;null!==s;){let t=s;for(;null!==t&&t.parent._item!==u;)t=null===t.redone?null:h2(e,t.redone);if(null!==t&&t.parent._item===u){s=t;break}s=s.right}}else if(s=null,t.right&&!o){for(h=t;null!==h&&null!==h.right&&(h.right.redone||hs(r,h.right.id)||fA(i.undoStack,h.right.id)||fA(i.redoStack,h.right.id));)for(h=h.right;h.redone;)h=h2(e,h.redone);if(h&&null!==h.right)return null}else h=p._map.get(t.parentSub)||null;let f=hX(a,c),m=hL(c,f),g=new fN(m,h,h&&h.lastId,s,s&&s.id,p,t.parentSub,t.content.copy());return t.redone=m,fx(g,!0),g.integrate(e,0),g};class fN extends fr{constructor(e,t,n,r,o,i,s,l){super(e,l.getLength()),this.origin=n,this.left=t,this.right=r,this.rightOrigin=o,this.parent=i,this.parentSub=s,this.redone=null,this.content=l,this.info=2*!!this.content.isCountable()}set marker(e){(8&this.info)>0!==e&&(this.info^=8)}get marker(){return(8&this.info)>0}get keep(){return(1&this.info)>0}set keep(e){this.keep!==e&&(this.info^=1)}get countable(){return(2&this.info)>0}get deleted(){return(4&this.info)>0}set deleted(e){this.deleted!==e&&(this.info^=4)}markDeleted(){this.info|=4}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=hX(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=hX(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===hD&&this.id.client!==this.parent.client&&this.parent.clock>=hX(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=h4(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=h2(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===fo||this.right&&this.right.constructor===fo)this.parent=null;else if(this.parent){if(this.parent.constructor===hD){let e=h0(t,this.parent);e.constructor===fo?this.parent=null:this.parent=e.content.type}}else this.left&&this.left.constructor===fN?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===fN&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=h4(e,e.doc.store,hL(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||null!==this.right.left)||this.left&&this.left.right!==this.right){let t,n=this.left;if(null!==n)t=n.right;else if(null!==this.parentSub)for(t=this.parent._map.get(this.parentSub)||null;null!==t&&null!==t.left;)t=t.left;else t=this.parent._start;let r=new Set,o=new Set;for(;null!==t&&t!==this.right;){if(o.add(t),r.add(t),hR(this.origin,t.origin)){if(t.id.client<this.id.client)n=t,r.clear();else if(hR(this.rightOrigin,t.rightOrigin))break}else if(null!==t.origin&&o.has(h0(e.doc.store,t.origin)))r.has(h0(e.doc.store,t.origin))||(n=t,r.clear());else break;t=t.right}this.left=n}if(null!==this.left){let e=this.left.right;this.right=e,this.left.right=this}else{let e;if(null!==this.parentSub)for(e=this.parent._map.get(this.parentSub)||null;null!==e&&null!==e.left;)e=e.left;else e=this.parent._start,this.parent._start=this;this.right=e}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(e)),null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length),hQ(e.doc.store,this),this.content.integrate(e,this),h6(e,this.parent,this.parentSub),(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(e)}else new fo(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;null!==e&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;null!==e&&e.deleted;)e=e.left;return e}get lastId(){return 1===this.length?this.id:hL(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&hR(e.origin,this.lastId)&&this.right===e&&hR(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&null===this.redone&&null===e.redone&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){let t=this.parent._searchMarker;return t&&t.forEach(t=>{t.p===e&&(t.p=this,!this.deleted&&this.countable&&(t.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,null!==this.right&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){let t=this.parent;this.countable&&null===this.parentSub&&(t._length-=this.length),this.markDeleted(),hc(e.deleteSet,this.id.client,this.id.clock,this.length),h6(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw cB();if(this.content.gc(e),t){var n;let t;n=new fo(this.id,this.length),(t=e.clients.get(this.id.client))[hJ(t,this.id.clock)]=n}else this.content=new fs(this.length)}write(e,t){let n=t>0?hL(this.id.client,this.id.clock+t-1):this.origin,r=this.rightOrigin,o=this.parentSub,i=31&this.content.getRef()|128*(null!==n)|64*(null!==r)|32*(null!==o);if(e.writeInfo(i),null!==n&&e.writeLeftID(n),null!==r&&e.writeRightID(r),null===n&&null===r){let t=this.parent;if(void 0!==t._item){let n=t._item;if(null===n){let n=hP(t);e.writeParentInfo(!0),e.writeString(n)}else e.writeParentInfo(!1),e.writeLeftID(n.id)}else t.constructor===String?(e.writeParentInfo(!0),e.writeString(t)):t.constructor===hD?(e.writeParentInfo(!1),e.writeLeftID(t)):cB();null!==o&&e.writeString(o)}this.content.write(e,t)}}let fM=(e,t)=>fI[31&t](e),fI=[()=>{cB()},e=>new fs(e.readLen()),e=>{let t=e.readLen(),n=[];for(let r=0;r<t;r++){let t=e.readString();"undefined"===t?n.push(void 0):n.push(JSON.parse(t))}return new fu(n)},e=>new fi(e.readBuf()),e=>new ff(e.readString()),e=>new fc(e.readJSON()),e=>new fd(e.readKey(),e.readJSON()),e=>new fT(fm[e.readTypeRef()](e)),e=>{let t=e.readLen(),n=[];for(let r=0;r<t;r++)n.push(e.readAny());return new fp(n)},e=>new fa(fl(e.readString(),e.readAny())),()=>{cB()}];class fO extends fr{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){cB()}write(e,t){e.writeInfo(10),c4(e.restEncoder,this.length-t)}getMissing(e,t){return null}}let fD="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:e.g,fR="__ $YJS$ __";!0===fD[fR]&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),fD[fR]=!0;let fL=(e,t)=>e>>>t|e<<32-t,fP=e=>fL(e,2)^fL(e,13)^fL(e,22),fB=e=>fL(e,6)^fL(e,11)^fL(e,25),fH=e=>fL(e,7)^fL(e,18)^e>>>3,fj=e=>fL(e,17)^fL(e,19)^e>>>10,fF=new Uint32Array([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),fU=new Uint32Array([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]);class fz{constructor(){const e=new ArrayBuffer(320);this._H=new Uint32Array(e,0,8),this._H.set(fU),this._W=new Uint32Array(e,64,64)}_updateHash(){let e=this._H,t=this._W;for(let e=16;e<64;e++)t[e]=fj(t[e-2])+t[e-7]+fH(t[e-15])+t[e-16];let n=e[0],r=e[1],o=e[2],i=e[3],s=e[4],l=e[5],a=e[6],c=e[7];for(let e=0,d,u;e<64;e++)d=c+fB(s)+(s&l^~s&a)+fF[e]+t[e]>>>0,u=fP(n)+(n&r^n&o^r&o)>>>0,c=a,a=l,l=s,s=i+d>>>0,i=o,o=r,r=n,n=d+u>>>0;e[0]+=n,e[1]+=r,e[2]+=o,e[3]+=i,e[4]+=s,e[5]+=l,e[6]+=a,e[7]+=c}digest(e){let t=0;for(;t+56<=e.length;){let n=0;for(;n<16&&t+3<e.length;n++)this._W[n]=e[t++]<<24|e[t++]<<16|e[t++]<<8|e[t++];if(t%64!=0){for(this._W.fill(0,n,16);t<e.length;)this._W[n]|=e[t]<<(3-t%4)*8,t++;this._W[n]|=128<<(3-t%4)*8}this._updateHash()}let n=t%64!=0;this._W.fill(0,0,16);let r=0;for(;t<e.length;r++)for(let n=3;n>=0&&t<e.length;n--)this._W[r]|=e[t++]<<8*n;n||(this._W[r-(t%4!=0)]|=128<<(3-t%4)*8),this._W[14]=e.byteLength/0x20000000,this._W[15]=8*e.byteLength,this._updateHash();let o=new Uint8Array(32);for(let e=0;e<this._H.length;e++)for(let t=0;t<4;t++)o[4*e+t]=this._H[e]>>>(3-t)*8;return o}}let fV=(e,t)=>void 0===t?!e.deleted:t.sv.has(e.id.client)&&t.sv.get(e.id.client)>e.id.clock&&!hs(t.ds,e.id),f$=[{light:"#ecd44433",dark:"#ecd444"}],fG=(e,t)=>({type:t.selection.jsonID,anchor:mr(t.selection.anchor,e.type,e.mapping),head:mr(t.selection.head,e.type,e.mapping)});class fq{constructor(e,t=new Map){this.type=e,this.prosemirrorView=null,this.mux=(()=>{let e=!0;return(t,n)=>{if(e){e=!1;try{t()}finally{e=!0}}else void 0!==n&&n()}})(),this.mapping=t,this.isOMark=new Map,this._observeFunction=this._typeChanged.bind(this),this.doc=e.doc,this.beforeTransactionSelection=null,this.beforeAllTransactions=()=>{null===this.beforeTransactionSelection&&null!=this.prosemirrorView&&(this.beforeTransactionSelection=fG(this,this.prosemirrorView.state))},this.afterAllTransactions=()=>{this.beforeTransactionSelection=null},this._domSelectionInView=null}get _tr(){return this.prosemirrorView.state.tr.setMeta("addToHistory",!1)}_isLocalCursorInView(){return!!this.prosemirrorView.hasFocus()&&(dP&&null===this._domSelectionInView&&(uZ(0,()=>{this._domSelectionInView=null}),this._domSelectionInView=this._isDomSelectionInView()),this._domSelectionInView)}_isDomSelectionInView(){let e=this.prosemirrorView._root.getSelection();if(null==e||null==e.anchorNode)return!1;let t=this.prosemirrorView._root.createRange();t.setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.focusNode,e.focusOffset),0===t.getClientRects().length&&t.startContainer&&t.collapsed&&t.selectNodeContents(t.startContainer);let n=t.getBoundingClientRect(),r=uz.documentElement;return n.bottom>=0&&n.right>=0&&n.left<=(window.innerWidth||r.clientWidth||0)&&n.top<=(window.innerHeight||r.clientHeight||0)}renderSnapshot(e,t){t||(t=hG(hd(),new Map)),this.prosemirrorView.dispatch(this._tr.setMeta(ca,{snapshot:e,prevSnapshot:t}))}unrenderSnapshot(){this.mapping.clear(),this.mux(()=>{let e=this.type.toArray().map(e=>fY(e,this.prosemirrorView.state.schema,this)).filter(e=>null!==e),t=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new ek(em.from(e),0,0));t.setMeta(ca,{snapshot:null,prevSnapshot:null}),this.prosemirrorView.dispatch(t)})}_forceRerender(){this.mapping.clear(),this.mux(()=>{let e=null!==this.beforeTransactionSelection?null:this.prosemirrorView.state.selection,t=this.type.toArray().map(e=>fY(e,this.prosemirrorView.state.schema,this)).filter(e=>null!==e),n=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new ek(em.from(t),0,0));if(e){let t=cp(cf(e.anchor,0),n.doc.content.size),r=cp(cf(e.head,0),n.doc.content.size);n.setSelection(tV.create(n.doc,t,r))}this.prosemirrorView.dispatch(n.setMeta(ca,{isChangeOrigin:!0,binding:this}))})}_renderSnapshot(e,t,n){let r=this.doc,o=this.type;if(e||(e=hq(this.doc)),e instanceof Uint8Array||t instanceof Uint8Array)if(e instanceof Uint8Array&&t instanceof Uint8Array||cB(),hx(r=new hm({gc:!1}),t),t=hq(r),hx(r,e),e=hq(r),null===o._item){let e=Array.from(this.doc.share.keys()).find(e=>this.doc.share.get(e)===this.type);o=r.getXmlFragment(e)}else{let e=r.store.clients.get(o._item.id.client)??[],t=hJ(e,o._item.id.clock);o=e[t].content.type}this.mapping.clear(),this.mux(()=>{r.transact(r=>{let i=n.permanentUserData;i&&i.dss.forEach(e=>{hi(r,e,e=>{})});let s=(e,t)=>{let r="added"===e?i.getUserByClientId(t.client):i.getUserByDeletedId(t);return{user:r,type:e,color:((e,t,n)=>{if(!e.has(n)){let r;if(e.size<t.length){let n=cw();e.forEach(e=>n.add(e)),t=t.filter(e=>!n.has(e))}e.set(n,(r=t)[cu(dA()*r.length)])}return e.get(n)})(n.colorMapping,n.colors,r)}},l=p_(o,new h$(t.ds,e.sv)).map(n=>!n._item.deleted||fV(n._item,e)||fV(n._item,t)?fY(n,this.prosemirrorView.state.schema,{mapping:new Map,isOMark:new Map},e,t,s):null).filter(e=>null!==e),a=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new ek(em.from(l),0,0));this.prosemirrorView.dispatch(a.setMeta(ca,{isChangeOrigin:!0}))},ca)})}_typeChanged(e,t){if(null==this.prosemirrorView)return;let n=ca.getState(this.prosemirrorView.state);0===e.length||null!=n.snapshot||null!=n.prevSnapshot?this.renderSnapshot(n.snapshot,n.prevSnapshot):this.mux(()=>{let e=(e,t)=>this.mapping.delete(t);hi(t,t.deleteSet,e=>{if(e.constructor===fN){let t=e.content.type;t&&this.mapping.delete(t)}}),t.changed.forEach(e),t.changedParentTypes.forEach(e);let n=this.type.toArray().map(e=>fW(e,this.prosemirrorView.state.schema,this)).filter(e=>null!==e),r=this._tr.replace(0,this.prosemirrorView.state.doc.content.size,new ek(em.from(n),0,0));((e,t,n)=>{if(null!==t&&null!==t.anchor&&null!==t.head)if("all"===t.type)e.setSelection(new tW(e.doc));else if("node"===t.type){let r=mi(n.doc,n.type,t.anchor,n.mapping);e.setSelection(tG.create(e.doc,r))}else{let r=mi(n.doc,n.type,t.anchor,n.mapping),o=mi(n.doc,n.type,t.head,n.mapping);if(null!==r&&null!==o){let t=tV.between(e.doc.resolve(r),e.doc.resolve(o));e.setSelection(t)}}})(r,this.beforeTransactionSelection,this),r=r.setMeta(ca,{isChangeOrigin:!0,isUndoRedoOperation:t.origin instanceof po}),null!==this.beforeTransactionSelection&&this._isLocalCursorInView()&&r.scrollIntoView(),this.prosemirrorView.dispatch(r)})}_prosemirrorChanged(e){this.doc.transact(()=>{f7(this.doc,this.type,e,this),this.beforeTransactionSelection=fG(this,this.prosemirrorView.state)},ca)}initView(e){null!=this.prosemirrorView&&this.destroy(),this.prosemirrorView=e,this.doc.on("beforeAllTransactions",this.beforeAllTransactions),this.doc.on("afterAllTransactions",this.afterAllTransactions),this.type.observeDeep(this._observeFunction)}destroy(){null!=this.prosemirrorView&&(this.prosemirrorView=null,this.type.unobserveDeep(this._observeFunction),this.doc.off("beforeAllTransactions",this.beforeAllTransactions),this.doc.off("afterAllTransactions",this.afterAllTransactions))}}let fW=(e,t,n,r,o,i)=>{let s=n.mapping.get(e);if(void 0===s)if(e instanceof p7)return fY(e,t,n,r,o,i);else throw cP();return s},fY=(e,t,n,r,o,i)=>{let s=[],l=e=>{if(e instanceof p7){let l=fW(e,t,n,r,o,i);null!==l&&s.push(l)}else{let l=e._item.right?.content?.type;l instanceof p8&&!l._item.deleted&&l._item.id.client===l.doc.clientID&&(e.applyDelta([{retain:e.length},...l.toDelta()]),l.doc.transact(e=>{l._item.delete(e)}));let a=fK(e,t,n,r,o,i);null!==a&&a.forEach(e=>{null!==e&&s.push(e)})}};void 0===r||void 0===o?e.toArray().forEach(l):p_(e,new h$(o.ds,r.sv)).forEach(l);try{let l=e.getAttributes(r);void 0!==r&&(fV(e._item,r)?fV(e._item,o)||(l.ychange=i?i("added",e._item.id):{type:"added"}):l.ychange=i?i("removed",e._item.id):{type:"removed"});let a=t.node(e.nodeName,l,s);return n.mapping.set(e,a),a}catch(t){return e.doc.transact(t=>{e._item.delete(t)},ca),n.mapping.delete(e),null}},fK=(e,t,n,r,o,i)=>{let s=[],l=e.toDelta(r,o,i);try{for(let e=0;e<l.length;e++){let n=l[e];s.push(t.text(n.insert,f6(n.attributes,t)))}}catch(t){return e.doc.transact(t=>{e._item.delete(t)},ca),null}return s},fZ=(e,t)=>{let n,r;return e instanceof Array?(n=new fn,r=e.map(e=>({insert:e.text,attributes:f9(e.marks,t)})),n.applyDelta(r),t.mapping.set(n,e),n):((e,t)=>{let n=new p7(e.type.name);for(let t in e.attrs){let r=e.attrs[t];null!==r&&"ychange"!==t&&n.setAttribute(t,r)}return n.insert(0,fJ(e).map(e=>fZ(e,t))),t.mapping.set(n,e),n})(e,t)},fX=e=>"object"==typeof e&&null!==e,fQ=(e,t)=>{let n=Object.keys(e).filter(t=>null!==e[t]),r=n.length===(null==t?0:Object.keys(t).filter(e=>null!==t[e]).length);for(let o=0;o<n.length&&r;o++){let i=n[o],s=e[i],l=t[i];r="ychange"===i||s===l||fX(s)&&fX(l)&&fQ(s,l)}return r},fJ=e=>{let t=e.content.content,n=[];for(let e=0;e<t.length;e++){let r=t[e];if(r.isText){let r=[];for(let n=t[e];e<t.length&&n.isText;n=t[++e])r.push(n);e--,n.push(r)}else n.push(r)}return n},f0=(e,t)=>{let n=e.toDelta();return n.length===t.length&&n.every((e,n)=>e.insert===t[n].text&&cv(e.attributes||{}).length===t[n].marks.length&&cE(e.attributes,(e,r)=>{let o=f8(r),i=t[n].marks;return fQ(e,i.find(e=>e.type.name===o)?.attrs)}))},f1=(e,t)=>{if(e instanceof p7&&!(t instanceof Array)&&me(e,t)){let n=fJ(t);return e._length===n.length&&fQ(e.getAttributes(),t.attrs)&&e.toArray().every((e,t)=>f1(e,n[t]))}return e instanceof fn&&t instanceof Array&&f0(e,t)},f2=(e,t)=>e===t||e instanceof Array&&t instanceof Array&&e.length===t.length&&e.every((e,n)=>t[n]===e),f4=(e,t,n)=>{let r=e.toArray(),o=fJ(t),i=o.length,s=r.length,l=cp(s,i),a=0,c=0,d=!1;for(;a<l;a++){let e=r[a],t=o[a];if(f2(n.mapping.get(e),t))d=!0;else if(!f1(e,t))break}for(;a+c<l;c++){let e=r[s-c-1],t=o[i-c-1];if(f2(n.mapping.get(e),t))d=!0;else if(!f1(e,t))break}return{equalityFactor:a+c,foundMappedChild:d}},f5=(e,t,n)=>{n.mapping.set(e,t);let{nAttrs:r,str:o}=(e=>{let t="",n=e._start,r={};for(;null!==n;)!n.deleted&&(n.countable&&n.content instanceof ff?t+=n.content.str:n.content instanceof fd&&(r[n.content.key]=null)),n=n.right;return{str:t,nAttrs:r}})(e),i=t.map(e=>({insert:e.text,attributes:Object.assign({},r,f9(e.marks,n))})),{insert:s,remove:l,index:a}=((e,t)=>{let n=0,r=0;for(;n<e.length&&n<t.length&&e[n]===t[n];)n++;for(n>0&&cR.test(e[n-1])&&n--;r+n<e.length&&r+n<t.length&&e[e.length-r-1]===t[t.length-r-1];)r++;return r>0&&cL.test(e[e.length-r])&&r--,{index:n,remove:e.length-n-r,insert:t.slice(n,t.length-r)}})(o,i.map(e=>e.insert).join(""));e.delete(a,l),e.insert(a,s),e.applyDelta(i.map(e=>({retain:e.insert.length,attributes:e.attributes})))},f3=/(.*)(--[a-zA-Z0-9+/=]{8})$/,f8=e=>f3.exec(e)?.[1]??e,f6=(e,t)=>{let n=[];for(let r in e)n.push(t.mark(f8(r),e[r]));return n},f9=(e,t)=>{let n={};return e.forEach(e=>{if("ychange"!==e.type.name){var r;let o,i;n[cF(t.isOMark,e.type,()=>!e.type.excludes(e.type))?`${e.type.name}--${dV((e=>{for(let t=6;t<e.length;t++)e[t%6]=e[t%6]^e[t];return e.slice(0,6)})((r=e.toJSON(),(e=>dn(e,r))(o=c0()),i=c1(o),new fz().digest(i))))}`:e.type.name]=e.attrs}}),n},f7=(e,t,n,r)=>{if(t instanceof p7&&t.nodeName!==n.type.name)throw Error("node name mismatch!");if(r.mapping.set(t,n),t instanceof p7){let e=t.getAttributes(),r=n.attrs;for(let n in r)null!==r[n]?e[n]!==r[n]&&"ychange"!==n&&t.setAttribute(n,r[n]):t.removeAttribute(n);for(let n in e)void 0===r[n]&&t.removeAttribute(n)}let o=fJ(n),i=o.length,s=t.toArray(),l=s.length,a=cp(i,l),c=0,d=0;for(;c<a;c++){let e=s[c],t=o[c];if(!f2(r.mapping.get(e),t))if(f1(e,t))r.mapping.set(e,t);else break}for(;d+c<a;d++){let e=s[l-d-1],t=o[i-d-1];if(!f2(r.mapping.get(e),t))if(f1(e,t))r.mapping.set(e,t);else break}e.transact(()=>{for(;l-c-d>0&&i-c-d>0;){let n=s[c],a=o[c],u=s[l-d-1],h=o[i-d-1];if(n instanceof fn&&a instanceof Array)f0(n,a)||f5(n,a,r),c+=1;else{let o=n instanceof p7&&me(n,a),i=u instanceof p7&&me(u,h);if(o&&i){let e=f4(n,a,r),t=f4(u,h,r);e.foundMappedChild&&!t.foundMappedChild?i=!1:!e.foundMappedChild&&t.foundMappedChild||e.equalityFactor<t.equalityFactor?o=!1:i=!1}o?(f7(e,n,a,r),c+=1):i?(f7(e,u,h,r),d+=1):(r.mapping.delete(t.get(c)),t.delete(c,1),t.insert(c,[fZ(a,r)]),c+=1)}}let n=l-c-d;if(1===l&&0===i&&s[0]instanceof fn?(r.mapping.delete(s[0]),s[0].delete(0,s[0].length)):n>0&&(t.slice(c,c+n).forEach(e=>r.mapping.delete(e)),t.delete(c,n)),c+d<i){let e=[];for(let t=c;t<i-d;t++)e.push(fZ(o[t],r));t.insert(c,e)}},ca)},me=(e,t)=>!(t instanceof Array)&&e.nodeName===t.type.name,mt=null,mn=()=>{let e=mt;mt=null,e.forEach((e,t)=>{let n=t.state.tr,r=ca.getState(t.state);r&&r.binding&&!r.binding.isDestroyed&&(e.forEach((e,t)=>{n.setMeta(t,e)}),t.dispatch(n))})},mr=(e,t,n)=>{if(0===e)return hz(t,0,0===t.length?-1:0);let r=null===t._first?null:t._first.content.type;for(;null!==r&&t!==r;){if(r instanceof fn){if(r._length>=e)return hz(r,e,0===t.length?-1:0);if(e-=r._length,null!==r._item&&null!==r._item.next)r=r._item.next.content.type;else{do r=null===r._item?null:r._item.parent,e--;while(r!==t&&null!==r&&null!==r._item&&null===r._item.next)null!==r&&r!==t&&(r=null===r._item?null:r._item.next.content.type)}}else{let o=(n.get(r)||{nodeSize:0}).nodeSize;if(null!==r._first&&e<o)r=r._first.content.type,e--;else{if(1===e&&0===r._length&&o>1)return new hH(null===r._item?null:r._item.id,null===r._item?hP(r):null,null);if(e-=o,null!==r._item&&null!==r._item.next)r=r._item.next.content.type;else{if(0===e)return new hH(null===(r=null===r._item?r:r._item.parent)._item?null:r._item.id,null===r._item?hP(r):null,null);do r=r._item.parent,e--;while(r!==t&&null===r._item.next)r!==t&&(r=r._item.next.content.type)}}}if(null===r)throw cB();if(0===e&&r.constructor!==fn&&r!==t)return mo(r._item.parent,r._item)}return hz(t,t._length,0===t.length?-1:0)},mo=(e,t)=>{let n=null,r=null;return null===e._item?r=hP(e):n=hL(e._item.id.client,e._item.id.clock),new hH(n,r,t.id)},mi=(e,t,n,r)=>{let o=((e,t,n=!0)=>{let r=t.store,o=e.item,i=e.type,s=e.tname,l=e.assoc,a=null,c=0;if(null!==o){let e,t;if(hX(r,o.client)<=o.clock)return null;let i=n?fw(r,o):(e=h0(r,o),t=o.clock-e.id.clock,{item:e,diff:t}),s=i.item;if(!(s instanceof fN))return null;if(null===(a=s.parent)._item||!a._item.deleted){c=s.deleted||!s.countable?0:i.diff+(l>=0?0:1);let e=s.left;for(;null!==e;)!e.deleted&&e.countable&&(c+=e.length),e=e.left}}else{if(null!==s)a=t.get(s);else if(null!==i){if(hX(r,i.client)<=i.clock)return null;let{item:e}=n?fw(r,i):{item:h0(r,i)};if(!(e instanceof fN)||!(e.content instanceof fT))return null;a=e.content.type}else throw cB();c=l>=0?a._length:0}return((e,t,n=0)=>new hF(e,t,n))(a,c,e.assoc)})(n,e);if(null===o||o.type!==t&&!hB(t,o.type._item))return null;let i=o.type,s=0;if(i.constructor===fn)s=o.index;else if(null===i._item||!i._item.deleted){let e=i._first,t=0;for(;t<i._length&&t<o.index&&null!==e;){if(!e.deleted){let n=e.content.type;t++,n instanceof fn?s+=n._length:s+=r.get(n).nodeSize}e=e.right}s+=1}for(;i!==t&&null!==i._item;){let e=i._item.parent;if(null===e._item||!e._item.deleted){s+=1;let t=e._first;for(;null!==t;){let e=t.content.type;if(e===i)break;t.deleted||(e instanceof fn?s+=e._length:s+=r.get(e).nodeSize),t=t.right}}i=e}return s-1};class ms{constructor(e){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{let e=this.options.deps.length,t=Array(e),n=Array(e);for(let r=0;r<e;r++){let e=this.options.deps[r];t[r]=e.prevState,n[r]=e.state}return this.lastSeenDepValues=n,{prevDepVals:t,currDepVals:n,prevVal:this.prevState??void 0}},this.recompute=()=>{var e,t;this.prevState=this.state;let n=this.getDepVals();this.state=this.options.fn(n),null==(t=(e=this.options).onUpdate)||t.call(e)},this.checkIfRecalculationNeededDeeply=()=>{for(let e of this.options.deps)e instanceof ms&&e.checkIfRecalculationNeededDeeply();let e=!1,t=this.lastSeenDepValues,{currDepVals:n}=this.getDepVals();for(let r=0;r<n.length;r++)if(n[r]!==t[r]){e=!0;break}e&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{for(let e of(this.unregisterFromGraph(),this._subscriptions))e()}),this.subscribe=e=>{var t,n;this.listeners.add(e);let r=null==(n=(t=this.options).onSubscribe)?void 0:n.call(t,e,this);return()=>{this.listeners.delete(e),null==r||r()}},this.options=e,this.state=e.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(e=this.options.deps){for(let t of e)if(t instanceof ms)t.registerOnGraph(),this.registerOnGraph(t.options.deps);else if(t instanceof mp){let e=ml.get(t);e||(e=new Set,ml.set(t,e)),e.add(this);let n=ma.get(this);n||(n=new Set,ma.set(this,n)),n.add(t)}}unregisterFromGraph(e=this.options.deps){for(let t of e)if(t instanceof ms)this.unregisterFromGraph(t.options.deps);else if(t instanceof mp){let e=ml.get(t);e&&e.delete(this);let n=ma.get(this);n&&n.delete(t)}}}let ml=new WeakMap,ma=new WeakMap,mc={current:[]},md=!1,mu=new Set,mh=new Map;class mp{constructor(e,t){this.listeners=new Set,this.subscribe=e=>{var t,n;this.listeners.add(e);let r=null==(n=null==(t=this.options)?void 0:t.onSubscribe)?void 0:n.call(t,e,this);return()=>{this.listeners.delete(e),null==r||r()}},this.prevState=e,this.state=e,this.options=t}setState(e){var t,n,r;(this.prevState=this.state,null==(t=this.options)?void 0:t.updateFn)?this.state=this.options.updateFn(this.prevState)(e):"function"==typeof e?this.state=e(this.prevState):this.state=e,null==(r=null==(n=this.options)?void 0:n.onUpdate)||r.call(n),function(e){if(mu.add(e),!md)try{for(md=!0;mu.size>0;){let e=Array.from(mu);for(let t of(mu.clear(),e)){let e=mh.get(t)??t.prevState;t.prevState=e,function(e){let t={prevVal:e.prevState,currentVal:e.state};for(let n of e.listeners)n(t)}(t)}for(let t of e){let e=ml.get(t);e&&(mc.current.push(t),function e(t){for(let n of Array.from(t).sort((e,t)=>e instanceof ms&&e.options.deps.includes(t)?1:t instanceof ms&&t.options.deps.includes(e)?-1:0)){if(mc.current.includes(n))continue;mc.current.push(n),n.recompute();let t=ma.get(n);if(t)for(let n of t){let t=ml.get(n);t&&e(t)}}}(e))}for(let t of e){let e=ml.get(t);if(e)for(let t of e)!function(e){let t={prevVal:e.prevState,currentVal:e.state};for(let n of e.listeners)n(t)}(t)}}}finally{md=!1,mc.current=[],mh.clear()}}(this)}}let mf=Symbol("originalFactory");function mm(e){if("object"==typeof e&&"key"in e)return function t(){return e[mf]=t,e};if("function"!=typeof e)throw Error("factory must be a function");return function t(n){return r=>{let o=e({editor:r.editor,options:n});return o[mf]=t,o}}}function mg(e,t){return new mp(e,t)}var mb=(e,t)=>{if("slot"===e)return 0;if(e instanceof Function)return e(t);let{children:n,...r}=null!=t?t:{};if("svg"===e)throw Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[e,r,n]},my=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,mv=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,mE=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,mk=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,mC=ll.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return mb("strong",{...sv(this.options.HTMLAttributes,e),children:mb("slot",{})})},markdownTokenName:"strong",parseMarkdown:(e,t)=>t.applyMark("bold",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`**${t.renderChildren(e)}**`,addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[lA({find:my,type:this.type}),lA({find:mE,type:this.type})]},addPasteRules(){return[lj({find:mv,type:this.type}),lj({find:mk,type:this.type})]}}),mT=/(^|[^`])`([^`]+)`(?!`)$/,mw=/(^|[^`])`([^`]+)`(?!`)/g,mx=ll.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:e}){return["code",sv(this.options.HTMLAttributes,e),0]},markdownTokenName:"codespan",parseMarkdown:(e,t)=>t.applyMark("code",[{type:"text",text:e.text||""}]),renderMarkdown:(e,t)=>e.content?`\`${t.renderChildren(e.content)}\``:"",addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[lA({find:mT,type:this.type})]},addPasteRules(){return[lj({find:mw,type:this.type})]}}),mS=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,mA=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,m_=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,mN=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,mM=ll.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",sv(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},markdownTokenName:"em",parseMarkdown:(e,t)=>t.applyMark("italic",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`*${t.renderChildren(e)}*`,addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[lA({find:mS,type:this.type}),lA({find:m_,type:this.type})]},addPasteRules(){return[lj({find:mA,type:this.type}),lj({find:mN,type:this.type})]}}),mI=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,mO=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,mD=ll.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML({HTMLAttributes:e}){return["s",sv(this.options.HTMLAttributes,e),0]},markdownTokenName:"del",parseMarkdown:(e,t)=>t.applyMark("strike",t.parseInline(e.tokens||[])),renderMarkdown:(e,t)=>`~~${t.renderChildren(e)}~~`,addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[lA({find:mI,type:this.type})]},addPasteRules(){return[lj({find:mO,type:this.type})]}}),mR=ll.create({name:"underline",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("underline")&&{}}],renderHTML({HTMLAttributes:e}){return["u",sv(this.options.HTMLAttributes,e),0]},parseMarkdown(e,t){return t.applyMark(this.name||"underline",t.parseInline(e.tokens||[]))},renderMarkdown:(e,t)=>`++${t.renderChildren(e)}++`,markdownTokenizer:{name:"underline",level:"inline",start:e=>e.indexOf("++"),tokenize(e,t,n){let r=/^(\+\+)([\s\S]+?)(\+\+)/.exec(e);if(!r)return;let o=r[2].trim();return{type:"underline",raw:r[0],text:o,tokens:n.inlineTokens(o)}}},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),mL=class e{constructor(e){this.cache=new Map(e)}get(e){return this.cache.get(e)}set(e,t,n){e<0||this.cache.set(e,[t,n])}replace(e,t,n,r){this.remove(e),this.set(t,n,r)}remove(e){this.cache.delete(e)}invalidate(t){let n=new e(this.cache),r=t.mapping;return this.cache.forEach(([e,o],i)=>{if(i<0)return;let s=r.mapResult(i),l=t.doc.nodeAt(s.pos);if(!s.deleted&&(null==l?void 0:l.eq(e))){if(i!==s.pos){let e=o.map(e=>e.map(r,0,0)).filter(e=>null!=e);n.replace(i,s.pos,l,e)}}else n.remove(i)}),n}};function mP(e,t,n,r,o){let i=[],s=[];return e.descendants((e,l)=>{if(!e.type.isTextblock)return!0;if(n.includes(e.type.name)){let n=r(e),a=o.get(l);if(a){let[e,t]=a;i.push(...t)}else{let r=t({content:e.textContent,language:n||void 0,pos:l,size:e.nodeSize});r&&Array.isArray(r)?(o.set(l,e,r),i.push(...r)):r instanceof Promise&&(o.remove(l),s.push(r))}}return!1}),[oA.create(e,i),s]}var mB=Object.defineProperty,mH=(e,t,n)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?mB(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n};function mj(e,t="Ctrl"){return"u">typeof navigator&&(/Mac/.test(navigator.platform)||/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent))?e.replace("Mod",""):e.replace("Mod",t)}function mF(...e){return[...new Set(e.filter(e=>e).join(" ").split(" "))].join(" ")}let mU=(e,t)=>{let n=ax(e,t.pmSchema);"blockContainer"===n.type.name&&(n=n.firstChild);let r=t.pmSchema.nodes[n.type.name].spec.toDOM;if(void 0===r)throw Error("This block has no default HTML serialization as its corresponding TipTap node doesn't implement `renderHTML`.");let o=r(n);if("object"!=typeof o||!("dom"in o))throw Error("Cannot use this block's default HTML serialization as its corresponding TipTap node's `renderHTML` function does not return an object with the `dom` property.");return o};function mz(e){return"data-"+e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function mV(e){let t=e.split("/");return t.length&&""!==t[t.length-1]?t[t.length-1]:e}function m$(e,t,n,r){let o=e();if(void 0===o)throw Error("Cannot find node position");let i=n.state.doc.resolve(o).node().attrs.id;if(!i)throw Error("Block doesn't have id");let s=t.getBlock(i);if(s.type!==r)throw Error("Block type does not match");return s}function mG(e,t,n,r,o=!1,i){let s=document.createElement("div");if(void 0!==i)for(let[e,t]of Object.entries(i))"class"!==e&&s.setAttribute(e,t);for(let[e,o]of(s.className=mF("bn-block-content",(null==i?void 0:i.class)||""),s.setAttribute("data-content-type",t),Object.entries(n)))o!==r[e].default&&s.setAttribute(mz(e),o);return o&&s.setAttribute("data-file-block",""),s.appendChild(e.dom),e.contentDOM&&(e.contentDOM.className=mF("bn-inline-content",e.contentDOM.className)),{...e,dom:s}}function mq(e,t,n){return (r={})=>{let o="function"==typeof e?e(r):e,i="function"==typeof t?t(r):t,s=n?"function"==typeof n?n(r):n:void 0;return{config:o,implementation:{...i,toExternalHTML(e,t){var n,r;let s=null==(n=i.toExternalHTML)?void 0:n.call({blockContentDOMAttributes:this.blockContentDOMAttributes},e,t);if(void 0!==s)return mG(s,e.type,e.props,o.propSchema,(null==(r=i.meta)?void 0:r.fileBlockAccept)!==void 0)},render(e,t){var n;return mG(i.render.call({blockContentDOMAttributes:this.blockContentDOMAttributes,renderType:this.renderType,props:this.props},e,t),e.type,e.props,o.propSchema,(null==(n=i.meta)?void 0:n.fileBlockAccept)!==void 0,this.blockContentDOMAttributes)}},extensions:s}}}function mW(e){return Object.fromEntries(Object.entries(e).map(([e,t])=>[e,t.config]))}function mY(e,t,n,r){return e.dom.setAttribute("data-style-type",t),"string"===r&&e.dom.setAttribute("data-value",n),e.contentDOM&&e.contentDOM.setAttribute("data-editable",""),e}function mK(e,t){return{config:e,implementation:t}}function mZ(e,t){return mK({type:e.name,propSchema:t},{mark:e,render(t,n){let r=n.pmSchema.marks[e.name].spec.toDOM;if(void 0===r)throw Error("This block has no default HTML serialization as its corresponding TipTap node doesn't implement `renderHTML`.");let o=n.pmSchema.mark(e.name,{stringValue:t}),i=e8.renderSpec(document,r(o,!0));if("object"!=typeof i||!("dom"in i))throw Error("Cannot use this block's default HTML serialization as its corresponding TipTap mark's `renderHTML` function does not return an object with the `dom` property.");return i},toExternalHTML(t,n){let r=n.pmSchema.marks[e.name].spec.toDOM;if(void 0===r)throw Error("This block has no default HTML serialization as its corresponding TipTap node doesn't implement `renderHTML`.");let o=n.pmSchema.mark(e.name,{stringValue:t}),i=e8.renderSpec(document,r(o,!0));if("object"!=typeof i||!("dom"in i))throw Error("Cannot use this block's default HTML serialization as its corresponding TipTap mark's `renderHTML` function does not return an object with the `dom` property.");return i}})}function mX(e){return Object.fromEntries(Object.entries(e).map(([e,t])=>[e,t.config]))}function mQ(e,t){let n=ll.create({name:e.type,addAttributes:()=>"boolean"===e.propSchema?{}:{stringValue:{default:void 0,keepOnSplit:!0,parseHTML:e=>e.getAttribute("data-value"),renderHTML:e=>void 0!==e.stringValue?{"data-value":e.stringValue}:{}}},parseHTML:()=>{var n;let r;return n=t.parse,r=[{tag:`[data-style-type="${e.type}"]`,contentElement:e=>e.matches("[data-editable]")?e:e.querySelector("[data-editable]")||e}],n&&r.push({tag:"*",consuming:!1,getAttrs(e){if("string"==typeof e)return!1;let t=null==n?void 0:n(e);return void 0!==t&&{stringValue:t}}}),r},renderHTML:({mark:n})=>mY((t.toExternalHTML||t.render)(n.attrs.stringValue),e.type,n.attrs.stringValue,e.propSchema),addMarkView:()=>({mark:n})=>mY(t.render(n.attrs.stringValue),e.type,n.attrs.stringValue,e.propSchema)});return mK(e,{...t,mark:n,render:n=>mY(t.render(n),e.type,n,e.propSchema),toExternalHTML:n=>mY((t.toExternalHTML||t.render)(n),e.type,n,e.propSchema)})}function mJ(e,t){let n,r;if(t.firstChild.descendants((t,o)=>!n&&(!m0(t)||t.attrs.id!==e||(n=t,r=o+1,!1))),void 0!==n&&void 0!==r)return{node:n,posBeforeNode:r}}function m0(e){return e.type.isInGroup("bnBlock")}function m1(e,t,n,r,o){let i=l8(e.doc.resolve(t)),s=null;"table"===i.blockNoteType&&(s=function(e){let t="selection"in e?e.selection:null;if(!(t instanceof tV))return null;let n=e.doc.resolve(t.head),r=-1,o=-1;for(let e=n.depth;e>=0;e--){let t=n.node(e).type.name;if(r<0&&("tableCell"===t||"tableHeader"===t)&&(r=e),"table"===t){o=e;break}}if(r<0||o<0)return null;let i=n.before(r),s=n.before(o),l=e.doc.nodeAt(s);if(!l||"table"!==l.type.name)return null;let a=aA.get(l),c=i-(s+1),d=a.map.indexOf(c);return d<0?null:{row:Math.floor(d/a.width),col:d%a.width,offset:Math.max(0,t.head-(i+1+1))}}(e));let l=l7(e);if(void 0!==r&&void 0!==o&&r>o)throw Error("Invalid replaceFromPos or replaceToPos");let a=l.nodes[i.blockNoteType],c=l.nodes[n.type||i.blockNoteType],d=c.isInGroup("bnBlock")?c:l.nodes.blockContainer;if(i.isBlockContainer&&c.isInGroup("blockContent")){let t=void 0!==r&&r>i.blockContent.beforePos&&r<i.blockContent.afterPos?r-i.blockContent.beforePos-1:void 0,s=void 0!==o&&o>i.blockContent.beforePos&&o<i.blockContent.afterPos?o-i.blockContent.beforePos-1:void 0;m2(n,e,i),function(e,t,n,r,o,i,s){let l=l7(t),a="keep";if(e.content)if("string"==typeof e.content)a=aC([e.content],l,r.name);else if(Array.isArray(e.content))a=aC(e.content,l,r.name);else if("tableContent"===e.content.type)a=aT(e.content,l);else throw new l1(e.content.type);else""===n.spec.content||r.spec.content!==n.spec.content&&(a=[]);if("keep"===a)t.setNodeMarkup(o.blockContent.beforePos,r,{...o.blockContent.node.attrs,...e.props});else if(void 0!==i||void 0!==s){t.setNodeMarkup(o.blockContent.beforePos,r,{...o.blockContent.node.attrs,...e.props});let n=o.blockContent.beforePos+1+(i??0),l=o.blockContent.beforePos+1+(s??o.blockContent.node.content.size),c=t.doc.resolve(o.blockContent.beforePos).depth,d=t.doc.resolve(n).depth,u=t.doc.resolve(l).depth;t.replace(n,l,new ek(em.from(a),d-c-1,u-c-1))}else t.replaceWith(o.blockContent.beforePos,o.blockContent.afterPos,r.createChecked({...o.blockContent.node.attrs,...e.props},a))}(n,e,a,c,i,t,s)}else if(!i.isBlockContainer&&c.isInGroup("bnBlock"))m2(n,e,i);else{let t=ac(i.bnBlock.node,l);e.replaceWith(i.bnBlock.beforePos,i.bnBlock.afterPos,ax({children:t.children,...n},l));return}e.setNodeMarkup(i.bnBlock.beforePos,d,{...i.bnBlock.node.attrs,...n.props}),s&&function(e,t,n){var r;if("table"!==t.blockNoteType)return;let o=-1;if(t.isBlockContainer)o=e.mapping.map(t.blockContent.beforePos);else{let n=e.mapping.map(t.bnBlock.beforePos),i=n+((null==(r=e.doc.nodeAt(n))?void 0:r.nodeSize)||0);e.doc.nodesBetween(n,i,(e,t)=>"table"!==e.type.name||(o=t,!1))}let i=o>=0?e.doc.nodeAt(o):null;if(!i||"table"!==i.type.name)return;let s=aA.get(i),l=Math.max(0,Math.min(n.row,s.height-1)),a=Math.max(0,Math.min(n.col,s.width-1)),c=l*s.width+a,d=s.map[c];if(null==d)return;let u=o+1+d+1,h=e.doc.nodeAt(u),p=u+1,f=h?h.content.size:0,m=p+Math.max(0,Math.min(n.offset,f));"selection"in e&&e.setSelection(tV.create(e.doc,m))}(e,i,s)}function m2(e,t,n){let r=l7(t);if(void 0!==e.children&&e.children.length>0){let o=e.children.map(e=>ax(e,r));if(n.childContainer)t.step(new th(n.childContainer.beforePos+1,n.childContainer.afterPos-1,new ek(em.from(o),0,0)));else{if(!n.isBlockContainer)throw Error("impossible");t.insert(n.blockContent.afterPos,r.nodes.blockGroup.createChecked({},o))}}}let m4={gray:{text:"#9b9a97",background:"#ebeced"},brown:{text:"#64473a",background:"#e9e5e3"},red:{text:"#e03e3e",background:"#fbe4e4"},orange:{text:"#d9730d",background:"#f6e9d9"},yellow:{text:"#dfab01",background:"#fbf3db"},green:{text:"#4d6461",background:"#ddedea"},blue:{text:"#0b6e99",background:"#ddebf1"},purple:{text:"#6940a5",background:"#eae4f2"},pink:{text:"#ad1a72",background:"#f4dfeb"}},m5={backgroundColor:{default:"default"},textColor:{default:"default"},textAlignment:{default:"left",values:["left","center","right","justify"]}},m3=e=>{let t={};return e.hasAttribute("data-background-color")?t.backgroundColor=e.getAttribute("data-background-color"):e.style.backgroundColor&&(t.backgroundColor=e.style.backgroundColor),e.hasAttribute("data-text-color")?t.textColor=e.getAttribute("data-text-color"):e.style.color&&(t.textColor=e.style.color),t.textAlignment=m5.textAlignment.values.includes(e.style.textAlign)?e.style.textAlign:void 0,t},m8=(e,t)=>{e.backgroundColor&&e.backgroundColor!==m5.backgroundColor.default&&(t.style.backgroundColor=e.backgroundColor in m4?m4[e.backgroundColor].background:e.backgroundColor),e.textColor&&e.textColor!==m5.textColor.default&&(t.style.color=e.textColor in m4?m4[e.textColor].text:e.textColor),e.textAlignment&&e.textAlignment!==m5.textAlignment.default&&(t.style.textAlign=e.textAlignment)},m6=(e,t)=>{let n=e.querySelector(t);if(!n)return;let r=e.querySelector("figcaption");return{targetElement:n,caption:(null==r?void 0:r.textContent)??void 0}},m9=mm(({editor:e})=>{let t=mg(void 0);function n(){t.setState(void 0)}return{key:"filePanel",store:t,mount({signal:t}){let r=e.onChange(n,!1),o=e.onSelectionChange(n,!1);t.addEventListener("abort",()=>{r(),o()})},closeMenu:n,showMenu(e){t.setState(e)}}}),m7=(e,t,n,r)=>{let o=document.createElement("div");if(o.className="bn-file-block-content-wrapper",""===e.props.url){let n,i,s,l,a,c=((n=document.createElement("div")).className="bn-add-file-button",(i=document.createElement("div")).className="bn-add-file-button-icon",r?i.appendChild(r):i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 8L9.00319 2H19.9978C20.5513 2 21 2.45531 21 2.9918V21.0082C21 21.556 20.5551 22 20.0066 22H3.9934C3.44476 22 3 21.5501 3 20.9932V8ZM10 4V9H5V20H19V4H10Z"></path></svg>',n.appendChild(i),(s=document.createElement("p")).className="bn-add-file-button-text",s.innerHTML=e.type in t.dictionary.file_blocks.add_button_text?t.dictionary.file_blocks.add_button_text[e.type]:t.dictionary.file_blocks.add_button_text.file,n.appendChild(s),l=e=>{e.preventDefault(),e.stopPropagation()},a=()=>{var n;t.isEditable&&(null==(n=t.getExtension(m9))||n.showMenu(e.id))},n.addEventListener("mousedown",l,!0),n.addEventListener("click",a,!0),{dom:n,destroy:()=>{n.removeEventListener("mousedown",l,!0),n.removeEventListener("click",a,!0)}});o.appendChild(c.dom);let d=t.onUploadStart(t=>{if(t===e.id){o.removeChild(c.dom);let e=document.createElement("div");e.className="bn-file-loading-preview",e.textContent="Loading...",o.appendChild(e)}});return{dom:o,destroy:()=>{d(),c.destroy()}}}let i={dom:o};if(!1!==e.props.showPreview&&n)o.appendChild(n.dom);else{let t,n,r,s=((t=document.createElement("div")).className="bn-file-name-with-icon",(n=document.createElement("div")).className="bn-file-icon",n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 8L9.00319 2H19.9978C20.5513 2 21 2.45531 21 2.9918V21.0082C21 21.556 20.5551 22 20.0066 22H3.9934C3.44476 22 3 21.5501 3 20.9932V8ZM10 4V9H5V20H19V4H10Z"></path></svg>',t.appendChild(n),(r=document.createElement("p")).className="bn-file-name",r.textContent=e.props.name,t.appendChild(r),{dom:t});o.appendChild(s.dom),i.destroy=()=>{var e;null==(e=s.destroy)||e.call(s)}}if(e.props.caption){let t=document.createElement("p");t.className="bn-file-caption",t.textContent=e.props.caption,o.appendChild(t)}return i},ge=(e,t)=>{let n=document.createElement("figure"),r=document.createElement("figcaption");return r.textContent=t,n.appendChild(e),n.appendChild(r),{dom:n}},gt=(e,t)=>{let n=document.createElement("div"),r=document.createElement("p");return r.textContent=t,n.appendChild(e),n.appendChild(r),{dom:n}},gn=e=>({url:e.src||void 0}),gr=e=>({type:"audio",propSchema:{backgroundColor:m5.backgroundColor,name:{default:""},url:{default:""},caption:{default:""},showPreview:{default:!0}},content:"none"}),go=(e={})=>e=>{if("AUDIO"===e.tagName){if(e.closest("figure"))return;let{backgroundColor:t}=m3(e);return{...gn(e),backgroundColor:t}}if("FIGURE"===e.tagName){let t=m6(e,"audio");if(!t)return;let{targetElement:n,caption:r}=t,{backgroundColor:o}=m3(e);return{...gn(n),backgroundColor:o,caption:r}}},gi=mq(gr,e=>({meta:{fileBlockAccept:["audio/*"]},parse:go(e),render:((e={})=>(t,n)=>{let r=document.createElement("div");r.innerHTML=e.icon??'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M2 16.0001H5.88889L11.1834 20.3319C11.2727 20.405 11.3846 20.4449 11.5 20.4449C11.7761 20.4449 12 20.2211 12 19.9449V4.05519C12 3.93977 11.9601 3.8279 11.887 3.73857C11.7121 3.52485 11.3971 3.49335 11.1834 3.66821L5.88889 8.00007H2C1.44772 8.00007 1 8.44778 1 9.00007V15.0001C1 15.5524 1.44772 16.0001 2 16.0001ZM23 12C23 15.292 21.5539 18.2463 19.2622 20.2622L17.8445 18.8444C19.7758 17.1937 21 14.7398 21 12C21 9.26016 19.7758 6.80629 17.8445 5.15557L19.2622 3.73779C21.5539 5.75368 23 8.70795 23 12ZM18 12C18 10.0883 17.106 8.38548 15.7133 7.28673L14.2842 8.71584C15.3213 9.43855 16 10.64 16 12C16 13.36 15.3213 14.5614 14.2842 15.2841L15.7133 16.7132C17.106 15.6145 18 13.9116 18 12Z"></path></svg>';let o=document.createElement("audio");return o.className="bn-audio",n.resolveFileUrl?n.resolveFileUrl(t.props.url).then(e=>{o.src=e}):o.src=t.props.url,o.controls=!0,o.contentEditable="false",o.draggable=!1,m7(t,n,{dom:o},r.firstElementChild)})(e),toExternalHTML:((e={})=>(e,t)=>{let n;if(!e.props.url){let e=document.createElement("p");return e.textContent="Add audio",{dom:e}}return e.props.showPreview?(n=document.createElement("audio")).src=e.props.url:((n=document.createElement("a")).href=e.props.url,n.textContent=e.props.name||e.props.url),e.props.caption?e.props.showPreview?ge(n,e.props.caption):gt(n,e.props.caption):{dom:n}})(e),runsBefore:["file"]})),gs=Symbol.for("blocknote.shikiParser"),gl=Symbol.for("blocknote.shikiHighlighterPromise"),ga=mq(({defaultLanguage:e="text"})=>({type:"codeBlock",propSchema:{language:{default:e}},content:"inline"}),e=>({meta:{code:!0,defining:!0,isolating:!1},parse:e=>{var t,n;if("PRE"!==e.tagName||1!==e.childElementCount||(null==(t=e.firstElementChild)?void 0:t.tagName)!=="CODE")return;let r=e.firstElementChild;return{language:r.getAttribute("data-language")||(null==(n=r.className.split(" ").find(e=>e.includes("language-")))?void 0:n.replace("language-",""))}},parseContent:({el:e,schema:t})=>{let n=eX.fromSchema(t),r=e.firstElementChild;return n.parse(r,{preserveWhitespace:"full",topNode:t.nodes.codeBlock.create()}).content},render(t,n){let r,o=document.createDocumentFragment(),i=document.createElement("pre"),s=document.createElement("code");if(i.appendChild(s),e.supportedLanguages){let i=document.createElement("select");Object.entries(e.supportedLanguages??{}).forEach(([e,{name:t}])=>{let n=document.createElement("option");n.value=e,n.text=t,i.appendChild(n)}),i.value=t.props.language||e.defaultLanguage||"text";let s=e=>{let r=e.target.value;n.updateBlock(t.id,{props:{language:r}})};i.addEventListener("change",s),r=()=>i.removeEventListener("change",s);let l=document.createElement("div");l.contentEditable="false",l.appendChild(i),o.appendChild(l)}return o.appendChild(i),{dom:o,contentDOM:s,destroy:()=>{null==r||r()}}},toExternalHTML(e){let t=document.createElement("pre"),n=document.createElement("code");return n.className=`language-${e.props.language}`,n.dataset.language=e.props.language,t.appendChild(n),{dom:t,contentDOM:n}}}),e=>{let t,n,r;return[mm({key:"code-block-highlighter",prosemirrorPlugins:[(t=globalThis,function({parser:e,nodeTypes:t=["code_block","codeBlock"],languageExtractor:n=e=>e.attrs.language}){let r=new t8("prosemirror-highlight");return new t4({key:r,state:{init(r,o){let i=new mL,[s,l]=mP(o.doc,e,t,n,i);return{cache:i,decorations:s,promises:l}},apply:(r,o)=>{let i=o.cache.invalidate(r),s=!!r.getMeta("prosemirror-highlight-refresh");if(!r.docChanged&&!s)return{cache:i,decorations:o.decorations.map(r.mapping,r.doc),promises:o.promises};let[l,a]=mP(r.doc,e,t,n,i);return{cache:i,decorations:l,promises:a}}},view:e=>{let t=new Set,n=()=>{if(t.size>0)return;let n=e.state.tr.setMeta("prosemirror-highlight-refresh",!0);e.dispatch(n)},o=()=>{var o;let i=r.getState(e.state);for(let e of null!=(o=null==i?void 0:i.promises)?o:[])t.add(e),e.then(()=>{t.delete(e),n()}).catch(()=>{t.delete(e)})};return o(),{update:()=>{o()}}},props:{decorations(e){var t;return null==(t=this.getState(e))?void 0:t.decorations}}})}({parser:o=>{var i;if(!e.createHighlighter)return[];if(!n)return t[gl]=t[gl]||e.createHighlighter(),t[gl].then(e=>{n=e});let s=gc(e,o.language);return s&&"text"!==s&&"none"!==s&&"plaintext"!==s&&"txt"!==s?n.getLoadedLanguages().includes(s)?(r||(r=t[gs]||(i=n,function({content:e,language:t,pos:n,size:r}){var o,s;let l=[],{tokens:a,fg:c,bg:d,rootStyle:u}=i.codeToTokens(e,{lang:t,...{theme:i.getLoadedThemes()[0]}}),h=u||(c&&d?`--prosemirror-highlight:${c};--prosemirror-highlight-bg:${d}`:"");if(h){let e=ow.node(n,n+r,{style:h});l.push(e)}let p=n+1;for(let e of a){for(let t of e){let e=p+t.content.length,n=ow.inline(p,e,{style:"string"==typeof(s=null!=(o=t.htmlStyle)?o:`color: ${t.color}`)?s:Object.entries(s).map(([e,t])=>`${e}:${t}`).join(";"),class:"shiki"});l.push(n),p=e}p+=1}return l}),t[gs]=r),r(o)):n.loadLanguage(s):[]},languageExtractor:e=>e.attrs.language,nodeTypes:["codeBlock"]}))]}),mm({key:"code-block-keyboard-shortcuts",keyboardShortcuts:{Delete:({editor:e})=>e.transact(t=>{let{block:n}=e.getTextCursorPosition();if("codeBlock"!==n.type)return!1;let{$from:r}=t.selection;return!r.parent.textContent&&(e.removeBlocks([n]),!0)}),Tab:({editor:t})=>!1!==e.indentLineWithTab&&t.transact(e=>{let{block:n}=t.getTextCursorPosition();return"codeBlock"===n.type&&(e.insertText("  "),!0)}),Enter:({editor:e})=>e.transact(t=>{let{block:n,nextBlock:r}=e.getTextCursorPosition();if("codeBlock"!==n.type)return!1;let{$from:o}=t.selection,i=o.parentOffset===o.parent.nodeSize-2,s=o.parent.textContent.endsWith(`

`);if(i&&s){if(t.delete(o.pos-2,o.pos),r)return e.setTextCursorPosition(r,"start"),!0;let[i]=e.insertBlocks([{type:"paragraph"}],n,"after");return e.setTextCursorPosition(i,"start"),!0}return t.insertText(`
`),!0}),"Shift-Enter":({editor:e})=>e.transact(()=>{let{block:t}=e.getTextCursorPosition();if("codeBlock"!==t.type)return!1;let[n]=e.insertBlocks([{type:"paragraph"}],t,"after");return e.setTextCursorPosition(n,"start"),!0})},inputRules:[{find:/^```(.*?)\s$/,replace:({match:t})=>{let n=t[1].trim();return{type:"codeBlock",props:{language:({language:gc(e,n)??n}).language},content:[]}}}]})]});function gc(e,t){var n;return null==(n=Object.entries(e.supportedLanguages??{}).find(([e,{aliases:n}])=>(null==n?void 0:n.includes(t))||e===t))?void 0:n[0]}let gd=mq(()=>({type:"divider",propSchema:{},content:"none"}),{meta:{isolating:!1},parse(e){if("HR"===e.tagName)return{}},render:()=>({dom:document.createElement("hr")})},[mm({key:"divider-block-shortcuts",inputRules:[{find:RegExp("^---$"),replace:()=>({type:"divider",props:{},content:[]})}]})]),gu=e=>({url:e.src||void 0}),gh=()=>({type:"file",propSchema:{backgroundColor:m5.backgroundColor,name:{default:""},url:{default:""},caption:{default:""}},content:"none"}),gp=()=>e=>{if("EMBED"===e.tagName){if(e.closest("figure"))return;let{backgroundColor:t}=m3(e);return{...gu(e),backgroundColor:t}}if("FIGURE"===e.tagName){let t=m6(e,"embed");if(!t)return;let{targetElement:n,caption:r}=t,{backgroundColor:o}=m3(e);return{...gu(n),backgroundColor:o,caption:r}}},gf=mq(gh,{meta:{fileBlockAccept:["*/*"]},parse:gp(),render:(e,t)=>m7(e,t),toExternalHTML(e){if(!e.props.url){let e=document.createElement("p");return e.textContent="Add file",{dom:e}}let t=document.createElement("a");return t.href=e.props.url,t.textContent=e.props.name||e.props.url,e.props.caption?gt(t,e.props.caption):{dom:t}}}),gm={set:(e,t)=>window.localStorage.setItem(`toggle-${e.id}`,t?"true":"false"),get:e=>"true"===window.localStorage.getItem(`toggle-${e.id}`)},gg=(e,t,n,r=gm)=>{if("isToggleable"in e.props&&!e.props.isToggleable)return{dom:n};let o=document.createElement("div"),i=document.createElement("div");i.className="bn-toggle-wrapper";let s=document.createElement("button");s.className="bn-toggle-button",s.type="button",s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="CURRENTCOLOR"><path d="M320-200v-560l440 280-440 280Z"/></svg>';let l=e=>e.preventDefault();s.addEventListener("mousedown",l);let a=()=>{var n;"true"===i.getAttribute("data-show-children")?(i.setAttribute("data-show-children","false"),r.set(t.getBlock(e),!1),o.contains(c)&&o.removeChild(c)):(i.setAttribute("data-show-children","true"),r.set(t.getBlock(e),!0),t.isEditable&&(null==(n=t.getBlock(e))?void 0:n.children.length)===0&&!o.contains(c)&&o.appendChild(c))};s.addEventListener("click",a),i.appendChild(s),i.appendChild(n);let c=document.createElement("button");c.className="bn-toggle-add-block-button",c.type="button",c.textContent=t.dictionary.toggle_blocks.add_block_button;let d=e=>e.preventDefault();c.addEventListener("mousedown",d);let u=()=>{t.transact(()=>{let n=t.updateBlock(e,{children:[{}]});t.setTextCursorPosition(n.children[0].id,"end"),t.focus()})};c.addEventListener("click",u),o.appendChild(i);let h=e.children.length,p=t.onChange(()=>{var n;let s=(null==(n=t.getBlock(e))?void 0:n.children.length)??0;s>h?("false"===i.getAttribute("data-show-children")&&(i.setAttribute("data-show-children","true"),r.set(t.getBlock(e),!0)),o.contains(c)&&o.removeChild(c)):0===s&&s<h&&("true"===i.getAttribute("data-show-children")&&(i.setAttribute("data-show-children","false"),r.set(t.getBlock(e),!1)),o.contains(c)&&o.removeChild(c)),h=s});return r.get(e)?(i.setAttribute("data-show-children","true"),t.isEditable&&0===e.children.length&&o.appendChild(c)):i.setAttribute("data-show-children","false"),{dom:o,ignoreMutation:e=>e instanceof MutationRecord&&("attributes"===e.type&&e.target===i&&"data-show-children"===e.attributeName||"childList"===e.type&&(e.addedNodes[0]===c||e.removedNodes[0]===c)),destroy:()=>{s.removeEventListener("mousedown",l),s.removeEventListener("click",a),c.removeEventListener("mousedown",d),c.removeEventListener("click",u),null==p||p()}}},gb=[1,2,3,4,5,6],gy=mq(({defaultLevel:e=1,levels:t=gb,allowToggleHeadings:n=!0}={})=>({type:"heading",propSchema:{...m5,level:{default:e,values:t},...n?{isToggleable:{default:!1,optional:!0}}:{}},content:"inline"}),({allowToggleHeadings:e=!0}={})=>({meta:{isolating:!1},parse(e){let t;switch(e.tagName){case"H1":t=1;break;case"H2":t=2;break;case"H3":t=3;break;case"H4":t=4;break;case"H5":t=5;break;case"H6":t=6;break;default:return}return{...m3(e),level:t}},render(t,n){let r=document.createElement(`h${t.props.level}`);return e?{...gg(t,n,r),contentDOM:r}:{dom:r,contentDOM:r}},toExternalHTML(e){let t=document.createElement(`h${e.props.level}`);return m8(e.props,t),{dom:t,contentDOM:t}}}),({levels:e=gb}={})=>[mm({key:"heading-shortcuts",keyboardShortcuts:Object.fromEntries(e.map(e=>[`Mod-Alt-${e}`,({editor:t})=>{let n=t.getTextCursorPosition();return"inline"===t.schema.blockSchema[n.block.type].content&&(t.updateBlock(n.block,{type:"heading",props:{level:e}}),!0)}])??[]),inputRules:e.map(e=>({find:RegExp(`^(#{${e}})\\s$`),replace:({match:e})=>({type:"heading",props:{level:e[1].length}})}))})]),gv=(e,t,n,r,o)=>{let{dom:i,destroy:s}=m7(e,t,n,o);i.style.position="relative",e.props.url&&e.props.showPreview&&(e.props.previewWidth?i.style.width=`${e.props.previewWidth}px`:i.style.width="fit-content");let l=document.createElement("div");l.className="bn-resize-handle",l.style.left="4px";let a=document.createElement("div");a.className="bn-resize-handle",a.style.right="4px";let c=document.createElement("div");c.style.position="absolute",c.style.height="100%",c.style.width="100%";let d,u=e.props.previewWidth,h=n=>{var o,s;if(!d){!t.isEditable&&r.contains(l)&&r.contains(a)&&(r.removeChild(l),r.removeChild(a));return}let c="touches"in n?n.touches[0].clientX:n.clientX;u=Math.min(Math.max("center"===e.props.textAlignment?"left"===d.handleUsed?d.initialWidth+(d.initialClientX-c)*2:d.initialWidth+(c-d.initialClientX)*2:"left"===d.handleUsed?d.initialWidth+d.initialClientX-c:d.initialWidth+c-d.initialClientX,64),(null==(s=null==(o=t.domElement)?void 0:o.firstElementChild)?void 0:s.clientWidth)||Number.MAX_VALUE),i.style.width=`${u}px`},p=n=>{(!n.target||!i.contains(n.target)||!t.isEditable)&&r.contains(l)&&r.contains(a)&&(r.removeChild(l),r.removeChild(a)),d&&(d=void 0,i.contains(c)&&i.removeChild(c),t.updateBlock(e,{props:{previewWidth:u}}))},f=()=>{t.isEditable&&(r.appendChild(l),r.appendChild(a))},m=e=>{e.relatedTarget===l||e.relatedTarget===a||d||t.isEditable&&r.contains(l)&&r.contains(a)&&(r.removeChild(l),r.removeChild(a))},g=e=>{e.preventDefault(),i.contains(c)||i.appendChild(c);let t="touches"in e?e.touches[0].clientX:e.clientX;d={handleUsed:"left",initialWidth:i.clientWidth,initialClientX:t}},b=e=>{e.preventDefault(),i.contains(c)||i.appendChild(c);let t="touches"in e?e.touches[0].clientX:e.clientX;d={handleUsed:"right",initialWidth:i.clientWidth,initialClientX:t}};return window.addEventListener("mousemove",h),window.addEventListener("touchmove",h),window.addEventListener("mouseup",p),window.addEventListener("touchend",p),i.addEventListener("mouseenter",f),i.addEventListener("mouseleave",m),l.addEventListener("mousedown",g),l.addEventListener("touchstart",g),a.addEventListener("mousedown",b),a.addEventListener("touchstart",b),{dom:i,destroy:()=>{null==s||s(),window.removeEventListener("mousemove",h),window.removeEventListener("touchmove",h),window.removeEventListener("mouseup",p),window.removeEventListener("touchend",p),i.removeEventListener("mouseenter",f),i.removeEventListener("mouseleave",m),l.removeEventListener("mousedown",g),l.removeEventListener("touchstart",g),a.removeEventListener("mousedown",b),a.removeEventListener("touchstart",b)}}},gE=e=>({url:e.src||void 0,previewWidth:e.width||void 0,name:e.alt||void 0}),gk=(e={})=>({type:"image",propSchema:{textAlignment:m5.textAlignment,backgroundColor:m5.backgroundColor,name:{default:""},url:{default:""},caption:{default:""},showPreview:{default:!0},previewWidth:{default:void 0,type:"number"}},content:"none"}),gC=(e={})=>e=>{if("IMG"===e.tagName){if(e.closest("figure"))return;let{backgroundColor:t}=m3(e);return{...gE(e),backgroundColor:t}}if("FIGURE"===e.tagName){let t=m6(e,"img");if(!t)return;let{targetElement:n,caption:r}=t,{backgroundColor:o}=m3(e);return{...gE(n),backgroundColor:o,caption:r}}},gT=mq(gk,e=>({meta:{fileBlockAccept:["image/*"]},parse:gC(e),render:((e={})=>(t,n)=>{let r=document.createElement("div");r.innerHTML=e.icon??'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M5 11.1005L7 9.1005L12.5 14.6005L16 11.1005L19 14.1005V5H5V11.1005ZM4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3ZM15.5 10C14.6716 10 14 9.32843 14 8.5C14 7.67157 14.6716 7 15.5 7C16.3284 7 17 7.67157 17 8.5C17 9.32843 16.3284 10 15.5 10Z"></path></svg>';let o=document.createElement("div");o.className="bn-visual-media-wrapper";let i=document.createElement("img");return i.className="bn-visual-media",n.resolveFileUrl?n.resolveFileUrl(t.props.url).then(e=>{i.src=e}):i.src=t.props.url,i.alt=t.props.name||t.props.caption||"BlockNote image",i.contentEditable="false",i.draggable=!1,o.appendChild(i),gv(t,n,{dom:o},o,r.firstElementChild)})(e),toExternalHTML:((e={})=>(e,t)=>{let n;if(!e.props.url){let e=document.createElement("p");return e.textContent="Add image",{dom:e}}return e.props.showPreview?((n=document.createElement("img")).src=e.props.url,n.alt=e.props.name||e.props.caption||"BlockNote image",e.props.previewWidth&&(n.width=e.props.previewWidth)):((n=document.createElement("a")).href=e.props.url,n.textContent=e.props.name||e.props.url),e.props.caption?e.props.showPreview?ge(n,e.props.caption):gt(n,e.props.caption):{dom:n}})(e),runsBefore:["file"]})),gw=(e,t,n,r)=>{let o=l3(l4(e.doc,t));if(!o.isBlockContainer)return!1;let i=l7(e),s=[{type:o.bnBlock.node.type,attrs:r?{...o.bnBlock.node.attrs,id:void 0}:{}},{type:n?o.blockContent.node.type:i.nodes.paragraph,attrs:r?{...o.blockContent.node.attrs}:{}}];return e.split(t,2,s),!0},gx=(e,t)=>{let{blockInfo:n,selectionEmpty:r}=e.transact(e=>({blockInfo:l9(e),selectionEmpty:e.selection.anchor===e.selection.head}));if(!n.isBlockContainer)return!1;let{bnBlock:o,blockContent:i}=n;return i.node.type.name===t&&!!r&&(0===i.node.childCount?(e.transact(e=>{m1(e,o.beforePos,{type:"paragraph",props:{}})}),!0):i.node.childCount>0&&e.transact(e=>(e.deleteSelection(),gw(e,e.selection.from,!0))))};function gS(e,t,n){var r,o,i;let s=eX.fromSchema(t),l=document.createElement("div");for(let t of(l.setAttribute("data-node-type","blockGroup"),Array.from(e.childNodes)))l.appendChild(t.cloneNode(!0));let a=s.parse(l,{topNode:t.nodes.blockGroup.create()});(null==(o=null==(r=a.firstChild)?void 0:r.firstChild)?void 0:o.type.name)==="checkListItem"&&(a=a.copy(a.content.cut(a.firstChild.firstChild.nodeSize+2)));let c=null==(i=a.firstChild)?void 0:i.firstChild;if(!(null!=c&&c.isTextblock))return em.from(a);let d=t.nodes[n].create({},c.content),u=a.content.cut(c.nodeSize+2);if(u.size>0){let e=a.copy(u);return d.content.addToEnd(e)}return d.content}let gA=mq(()=>({type:"bulletListItem",propSchema:{...m5},content:"inline"}),{meta:{isolating:!1},parse(e){var t;if("LI"!==e.tagName)return;let n=e.parentElement;if(null!==n&&("UL"===n.tagName||"DIV"===n.tagName&&(null==(t=n.parentElement)?void 0:t.tagName)==="UL"))return m3(e)},parseContent:({el:e,schema:t})=>gS(e,t,"bulletListItem"),render(){let e=document.createElement("p");return{dom:e,contentDOM:e}},toExternalHTML(e){let t=document.createElement("li"),n=document.createElement("p");return m8(e.props,t),t.appendChild(n),{dom:t,contentDOM:n}}},[mm({key:"bullet-list-item-shortcuts",keyboardShortcuts:{Enter:({editor:e})=>gx(e,"bulletListItem"),"Mod-Shift-8":({editor:e})=>{let t=e.getTextCursorPosition();return"inline"===e.schema.blockSchema[t.block.type].content&&(e.updateBlock(t.block,{type:"bulletListItem",props:{}}),!0)}},inputRules:[{find:RegExp("^[-+*]\\s$"),replace({editor:e}){if("heading"!==l6(e.prosemirrorState).blockNoteType)return{type:"bulletListItem",props:{}}}}]})]),g_=mq(()=>({type:"checkListItem",propSchema:{...m5,checked:{default:!1,type:"boolean"}},content:"inline"}),{meta:{isolating:!1},parse(e){var t;if("input"===e.tagName)return e.closest("[data-content-type]")||e.closest("li")?void 0:"checkbox"===e.type?{checked:e.checked}:void 0;if("LI"!==e.tagName)return;let n=e.parentElement;if(null!==n&&("UL"===n.tagName||"DIV"===n.tagName&&(null==(t=n.parentElement)?void 0:t.tagName)==="UL")){let t=e.querySelector("input[type=checkbox]")||null;return null===t?void 0:{...m3(e),checked:t.checked}}},parseContent:({el:e,schema:t})=>gS(e,t,"checkListItem"),render(e,t){let n=document.createDocumentFragment(),r=document.createElement("input");r.type="checkbox",r.checked=e.props.checked,e.props.checked&&r.setAttribute("checked",""),r.addEventListener("change",()=>{t.updateBlock(e,{props:{checked:!e.props.checked}})});let o=document.createElement("p");return n.appendChild(r),n.appendChild(o),{dom:n,contentDOM:o}},toExternalHTML(e){let t=document.createElement("li"),n=document.createElement("input");n.type="checkbox",n.checked=e.props.checked,e.props.checked&&n.setAttribute("checked","");let r=document.createElement("p");return m8(e.props,t),t.appendChild(n),t.appendChild(r),{dom:t,contentDOM:r}},runsBefore:["bulletListItem"]},[mm({key:"check-list-item-shortcuts",keyboardShortcuts:{Enter:({editor:e})=>gx(e,"checkListItem"),"Mod-Shift-9":({editor:e})=>{let t=e.getTextCursorPosition();return"inline"===e.schema.blockSchema[t.block.type].content&&(e.updateBlock(t.block,{type:"checkListItem",props:{}}),!0)}},inputRules:[{find:RegExp("^\\[\\s*\\]\\s$"),replace:()=>({type:"checkListItem",props:{checked:!1},content:[]})},{find:RegExp("^\\[[Xx]\\]\\s$"),replace:()=>({type:"checkListItem",props:{checked:!0}})}]})]);function gN(e,t){let n=new Map,r=t.decorations.map(e.mapping,e.doc),o=[];e.doc.nodesBetween(0,e.doc.nodeSize-2,(t,i)=>{if("blockContainer"===t.type.name&&"numberedListItem"===t.firstChild.type.name){let{index:s,isFirst:l,hasStart:a}=function e(t,n,r,o){let i=t.firstChild.attrs.start||1,s=!0,l=!!t.firstChild.attrs.start,a=l3({posBeforeNode:n,node:t});if(!a.isBlockContainer)throw Error("impossible");let c=r.doc.resolve(a.bnBlock.beforePos).nodeBefore,d=c?o.get(c):void 0;return void 0!==d?(i=d+1,s=!1):c&&"numberedListItem"===l3({posBeforeNode:a.bnBlock.beforePos-c.nodeSize,node:c}).blockNoteType&&(i=e(c,a.bnBlock.beforePos-c.nodeSize,r,o).index+1,s=!1),o.set(t,i),{index:i,isFirst:s,hasStart:l}}(t,i,e,n);if(0===r.find(i,i+t.nodeSize,e=>e.index===s&&e.isFirst===l&&e.hasStart===a).length){let t=e.doc.nodeAt(i+1);o.push(ow.node(i+1,i+1+t.nodeSize,{"data-index":s.toString()}))}}});let i=o.flatMap(e=>r.find(e.from,e.to));return{decorations:r.remove(i).add(e.doc,o)}}let gM=mq(()=>({type:"numberedListItem",propSchema:{...m5,start:{default:void 0,type:"number"}},content:"inline"}),{meta:{isolating:!1},parse(e){var t;if("LI"!==e.tagName)return;let n=e.parentElement;if(null!==n&&("OL"===n.tagName||"DIV"===n.tagName&&(null==(t=n.parentElement)?void 0:t.tagName)==="OL")){let t=parseInt(n.getAttribute("start")||"1"),r=m3(e);return e.previousElementSibling||1===t?r:{...r,start:t}}},parseContent:({el:e,schema:t})=>gS(e,t,"numberedListItem"),render(){let e=document.createElement("p");return{dom:e,contentDOM:e}},toExternalHTML(e){let t=document.createElement("li"),n=document.createElement("p");return m8(e.props,t),t.appendChild(n),{dom:t,contentDOM:n}}},[mm({key:"numbered-list-item-shortcuts",inputRules:[{find:RegExp("^(\\d+)\\.\\s$"),replace({match:e,editor:t}){if("heading"===l6(t.prosemirrorState).blockNoteType)return;let n=parseInt(e[1]);return{type:"numberedListItem",props:{start:1!==n?n:void 0}}}}],keyboardShortcuts:{Enter:({editor:e})=>gx(e,"numberedListItem"),"Mod-Shift-7":({editor:e})=>{let t=e.getTextCursorPosition();return"inline"===e.schema.blockSchema[t.block.type].content&&(e.updateBlock(t.block,{type:"numberedListItem",props:{}}),!0)}},prosemirrorPlugins:[new t4({key:new t8("numbered-list-indexing-decorations"),state:{init:(e,t)=>gN(t.tr,{decorations:oA.empty}),apply:(e,t)=>e.docChanged||e.selectionSet||!t.decorations?gN(e,t):t},props:{decorations(e){var t;return(null==(t=this.getState(e))?void 0:t.decorations)??oA.empty}}})]})]),gI=mq(()=>({type:"toggleListItem",propSchema:{...m5},content:"inline"}),{meta:{isolating:!1},render(e,t){let n=document.createElement("p");return{...gg(e,t,n),contentDOM:n}},toExternalHTML(e){let t=document.createElement("li"),n=document.createElement("p");return m8(e.props,t),t.appendChild(n),{dom:t,contentDOM:n}}},[mm({key:"toggle-list-item-shortcuts",keyboardShortcuts:{Enter:({editor:e})=>gx(e,"toggleListItem"),"Mod-Shift-6":({editor:e})=>{let t=e.getTextCursorPosition();return"inline"===e.schema.blockSchema[t.block.type].content&&(e.updateBlock(t.block,{type:"toggleListItem",props:{}}),!0)}}})]),gO=mq(()=>({type:"paragraph",propSchema:m5,content:"inline"}),{meta:{isolating:!1},parse:e=>{var t;if("P"===e.tagName&&null!=(t=e.textContent)&&t.trim())return m3(e)},render:()=>{let e=document.createElement("p");return{dom:e,contentDOM:e}},toExternalHTML:e=>{let t=document.createElement("p");return m8(e.props,t),{dom:t,contentDOM:t}},runsBefore:["default"]},[mm({key:"paragraph-shortcuts",keyboardShortcuts:{"Mod-Alt-0":({editor:e})=>{let t=e.getTextCursorPosition();return"inline"===e.schema.blockSchema[t.block.type].content&&(e.updateBlock(t.block,{type:"paragraph",props:{}}),!0)}}})]),gD=mq(()=>({type:"quote",propSchema:{backgroundColor:m5.backgroundColor,textColor:m5.textColor},content:"inline"}),{meta:{isolating:!1},parse(e){if("BLOCKQUOTE"===e.tagName){let{backgroundColor:t,textColor:n}=m3(e);return{backgroundColor:t,textColor:n}}},render(){let e=document.createElement("blockquote");return{dom:e,contentDOM:e}},toExternalHTML(e){let t=document.createElement("blockquote");return m8(e.props,t),{dom:t,contentDOM:t}}},[mm({key:"quote-block-shortcuts",keyboardShortcuts:{"Mod-Alt-q":({editor:e})=>{let t=e.getTextCursorPosition();return"inline"===e.schema.blockSchema[t.block.type].content&&(e.updateBlock(t.block,{type:"quote",props:{}}),!0)}},inputRules:[{find:RegExp("^>\\s$"),replace:()=>({type:"quote",props:{}})}]})]),gR=lh.create({name:"BlockNoteTableExtension",addProseMirrorPlugins:()=>[function({handleWidth:e=5,cellMinWidth:t=25,defaultCellMinWidth:n=100,View:r=ce,lastColumnResizable:o=!0}={}){let i=new t4({key:cn,state:{init(e,t){var o;let s=null==(o=i.spec)||null==(o=o.props)?void 0:o.nodeViews,l=a_(t.schema).table.name;return r&&s&&(s[l]=(e,t)=>new r(e,n,t)),new cr(-1,!1)},apply:(e,t)=>t.apply(e)},props:{attributes:e=>{let t=cn.getState(e);return t&&t.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(t,n)=>{!function(e,t,n,r){if(!e.editable)return;let o=cn.getState(e.state);if(o&&!o.dragging){let i=function(e){for(;e&&"TD"!=e.nodeName&&"TH"!=e.nodeName;)e=e.classList&&e.classList.contains("ProseMirror")?null:e.parentNode;return e}(t.target),s=-1;if(i){let{left:r,right:o}=i.getBoundingClientRect();t.clientX-r<=n?s=co(e,t,"left",n):o-t.clientX<=n&&(s=co(e,t,"right",n))}if(s!=o.activeHandle){if(!r&&-1!==s){let t=e.state.doc.resolve(s),n=t.node(-1),r=aA.get(n),o=t.start(-1);if(r.colCount(t.pos-o)+t.nodeAfter.attrs.colspan-1==r.width-1)return}cs(e,s)}}}(t,n,e,o)},mouseleave:e=>{!function(e){if(!e.editable)return;let t=cn.getState(e.state);t&&t.activeHandle>-1&&!t.dragging&&cs(e,-1)}(e)},mousedown:(e,r)=>{!function(e,t,n,r){var o;if(!e.editable)return;let i=null!=(o=e.dom.ownerDocument.defaultView)?o:window,s=cn.getState(e.state);if(!s||-1==s.activeHandle||s.dragging)return;let l=e.state.doc.nodeAt(s.activeHandle),a=function(e,t,{colspan:n,colwidth:r}){let o=r&&r[r.length-1];if(o)return o;let i=e.domAtPos(t),s=i.node.childNodes[i.offset].offsetWidth,l=n;if(r)for(let e=0;e<n;e++)r[e]&&(s-=r[e],l--);return s/l}(e,s.activeHandle,l.attrs);function c(t){i.removeEventListener("mouseup",c),i.removeEventListener("mousemove",d);let r=cn.getState(e.state);(null==r?void 0:r.dragging)&&(function(e,t,n){let r=e.state.doc.resolve(t),o=r.node(-1),i=aA.get(o),s=r.start(-1),l=i.colCount(r.pos-s)+r.nodeAfter.attrs.colspan-1,a=e.state.tr;for(let e=0;e<i.height;e++){let t=e*i.width+l;if(e&&i.map[t]==i.map[t-i.width])continue;let r=i.map[t],c=o.nodeAt(r).attrs,d=1==c.colspan?0:l-i.colCount(r);if(c.colwidth&&c.colwidth[d]==n)continue;let u=c.colwidth?c.colwidth.slice():Array(c.colspan).fill(0);u[d]=n,a.setNodeMarkup(s+r,null,{...c,colwidth:u})}a.docChanged&&e.dispatch(a)}(e,r.activeHandle,ci(r.dragging,t,n)),e.dispatch(e.state.tr.setMeta(cn,{setDragging:null})))}function d(t){if(!t.which)return c(t);let o=cn.getState(e.state);if(o&&o.dragging){let i=ci(o.dragging,t,n);cl(e,o.activeHandle,i,r)}}e.dispatch(e.state.tr.setMeta(cn,{setDragging:{startX:t.clientX,startWidth:a}})),cl(e,s.activeHandle,a,r),i.addEventListener("mouseup",c),i.addEventListener("mousemove",d),t.preventDefault()}(e,r,t,n)}},decorations:e=>{let t=cn.getState(e);if(t&&t.activeHandle>-1)return function(e,t){let n=[],r=e.doc.resolve(t),o=r.node(-1);if(!o)return oA.empty;let i=aA.get(o),s=r.start(-1),l=i.colCount(r.pos-s)+r.nodeAfter.attrs.colspan-1;for(let t=0;t<i.height;t++){let r=l+t*i.width;if((l==i.width-1||i.map[r]!=i.map[r+1])&&(0==t||i.map[r]!=i.map[r-i.width])){var a;let t=i.map[r],l=s+t+o.nodeAt(t).nodeSize-1,c=document.createElement("div");c.className="column-resize-handle",(null==(a=cn.getState(e))?void 0:a.dragging)&&n.push(ow.node(s+t,s+t+o.nodeAt(t).nodeSize,{class:"column-resize-dragging"})),n.push(ow.widget(l,c))}}return oA.create(e.doc,n)}(e,t.activeHandle)},nodeViews:{}}});return i}({cellMinWidth:35,defaultCellMinWidth:120,View:null}),function({allowTableNodeSelection:e=!1}={}){return new t4({key:aN,state:{init:()=>null,apply(e,t){let n=e.getMeta(aN);if(null!=n)return -1==n?null:n;if(null==t||!e.docChanged)return t;let{deleted:r,pos:o}=e.mapping.mapResult(t);return r?null:o}},props:{decorations:aF,handleDOMEvents:{mousedown:a8},createSelectionBetween:e=>null!=aN.getState(e.state)?e.state.selection:null,handleTripleClick:a5,handleKeyDown:a0,handlePaste:a3},appendTransaction:(t,n,r)=>{let o,i;return function(e,t,n){let r,o,i=(t||e).selection,s=(t||e).doc;if(i instanceof tG&&(o=i.node.type.spec.tableRole)){if("cell"==o||"header_cell"==o)r=aH.create(s,i.from);else if("row"==o){let e=s.resolve(i.from+1);r=aH.rowSelection(e,e)}else if(!n){let e=aA.get(i.node),t=i.from+1,n=t+e.map[e.width*e.height-1];r=aH.create(s,t+1,n)}}else i instanceof tV&&function({$from:e,$to:t}){if(e.pos==t.pos||e.pos<t.pos-6)return!1;let n=e.pos,r=t.pos,o=e.depth;for(;o>=0&&!(e.after(o+1)<e.end(o));o--,n++);for(let e=t.depth;e>=0&&!(t.before(e+1)>t.start(e));e--,r--);return n==r&&/row|table/.test(e.node(o).type.spec.tableRole)}(i)?r=tV.create(s,i.from):i instanceof tV&&function({$from:e,$to:t}){let n,r;for(let t=e.depth;t>0;t--){let r=e.node(t);if("cell"===r.type.spec.tableRole||"header_cell"===r.type.spec.tableRole){n=r;break}}for(let e=t.depth;e>0;e--){let n=t.node(e);if("cell"===n.type.spec.tableRole||"header_cell"===n.type.spec.tableRole){r=n;break}}return n!==r&&0===t.parentOffset}(i)&&(r=tV.create(s,i.$from.start(),i.$from.end()));return r&&(t||(t=e.tr)).setSelection(r),t}(r,(i=(e,t)=>{"table"==e.type.spec.tableRole&&(o=function(e,t,n,r){let o,i,s=aA.get(t);if(!s.problems)return r;r||(r=e.tr);let l=[];for(let e=0;e<s.height;e++)l.push(0);for(let e=0;e<s.problems.length;e++){let o=s.problems[e];if("collision"==o.type){let e=t.nodeAt(o.pos);if(!e)continue;let i=e.attrs;for(let e=0;e<i.rowspan;e++)l[o.row+e]+=o.n;r.setNodeMarkup(r.mapping.map(n+1+o.pos),null,aP(i,i.colspan-o.n,o.n))}else if("missing"==o.type)l[o.row]+=o.n;else if("overlong_rowspan"==o.type){let e=t.nodeAt(o.pos);if(!e)continue;r.setNodeMarkup(r.mapping.map(n+1+o.pos),null,{...e.attrs,rowspan:e.attrs.rowspan-o.n})}else if("colwidth mismatch"==o.type){let e=t.nodeAt(o.pos);if(!e)continue;r.setNodeMarkup(r.mapping.map(n+1+o.pos),null,{...e.attrs,colwidth:o.colwidth})}else if("zero_sized"==o.type){let e=r.mapping.map(n);r.delete(e,e+t.nodeSize)}}for(let e=0;e<l.length;e++)l[e]&&(null==o&&(o=e),i=e);for(let a=0,c=n+1;a<s.height;a++){let n=t.child(a),s=c+n.nodeSize,d=l[a];if(d>0){let t="cell";n.firstChild&&(t=n.firstChild.type.spec.tableRole);let l=[];for(let n=0;n<d;n++){let n=a_(e.schema)[t].createAndFill();n&&l.push(n)}let u=(0==a||o==a-1)&&i==a?c+1:s-1;r.insert(r.mapping.map(u),l)}c=s}return r.setMeta(aU,{fixTables:!0})}(r,e,t,o))},n?n.doc!=r.doc&&function e(t,n,r,o){let i=t.childCount,s=n.childCount;n:for(let l=0,a=0;l<s;l++){let s=n.child(l);for(let e=a,n=Math.min(i,l+3);e<n;e++)if(t.child(e)==s){a=e+1,r+=s.nodeSize;continue n}o(s,r),a<i&&t.child(a).sameMarkup(s)?e(t.child(a),s,r+1,o):s.nodesBetween(0,s.content.size,o,r+1),r+=s.nodeSize}}(n.doc,r.doc,0,i):r.doc.descendants(i),o),e)}})}()],addKeyboardShortcuts(){return{Enter:()=>!!this.editor.state.selection.empty&&"tableParagraph"===this.editor.state.selection.$head.parent.type.name&&(this.editor.commands.insertContent({type:"hardBreak"}),!0),Backspace:()=>{let e=this.editor.state.selection,t=e.empty,n=0===e.$head.parentOffset,r="tableParagraph"===e.$head.node().type.name;return t&&n&&r},Tab:()=>this.editor.commands.command(({state:e,dispatch:t,view:n})=>aY(1)(e,t,n)),"Shift-Tab":()=>this.editor.commands.command(({state:e,dispatch:t,view:n})=>aY(-1)(e,t,n))}},extendNodeSchema(e){let t={name:e.name,options:e.options,storage:e.storage};return{tableRole:sg(sh(e,"tableRole",t))}}}),gL={textColor:m5.textColor},gP=lB.create({name:"tableHeader",addOptions:()=>({HTMLAttributes:{}}),content:"tableContent+",addAttributes:()=>({colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{let t=e.getAttribute("colwidth");return t?t.split(",").map(e=>parseInt(e,10)):null}}}),tableRole:"header_cell",isolating:!0,parseHTML:()=>[{tag:"th",getContent:(e,t)=>gU(e,t)}],renderHTML({HTMLAttributes:e}){return["th",sv(this.options.HTMLAttributes,e),0]}}),gB=lB.create({name:"tableCell",addOptions:()=>({HTMLAttributes:{}}),content:"tableContent+",addAttributes:()=>({colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{let t=e.getAttribute("colwidth");return t?t.split(",").map(e=>parseInt(e,10)):null}}}),tableRole:"cell",isolating:!0,parseHTML:()=>[{tag:"td",getContent:(e,t)=>gU(e,t)}],renderHTML({HTMLAttributes:e}){return["td",sv(this.options.HTMLAttributes,e),0]}}),gH=lB.create({name:"table",content:"tableRow+",group:"blockContent",tableRole:"table",marks:"deletion insertion modification",isolating:!0,parseHTML:()=>[{tag:"table"}],renderHTML({node:e,HTMLAttributes:t}){var n,r,o;let i=function(e,t,n,r){let o=document.createElement("div");for(let[t,r]of(o.className=mF("bn-block-content",n.class),o.setAttribute("data-content-type",e),Object.entries(n)))"class"!==t&&o.setAttribute(t,r);let i=document.createElement(t);for(let[e,t]of(i.className=mF("bn-inline-content",r.class),Object.entries(r)))"class"!==e&&i.setAttribute(e,t);return o.appendChild(i),{dom:o,contentDOM:i}}(this.name,"table",{...(null==(n=this.options.domAttributes)?void 0:n.blockContent)||{},...t},(null==(r=this.options.domAttributes)?void 0:r.inlineContent)||{}),s=document.createElement("colgroup");for(let t of e.children[0].children)if(t.attrs.colwidth)for(let e of t.attrs.colwidth){let t=document.createElement("col");e&&(t.style=`width: ${e}px`),s.appendChild(t)}else s.appendChild(document.createElement("col"));return null==(o=i.dom.firstChild)||o.appendChild(s),i},addNodeView(){return({node:e,HTMLAttributes:t})=>{var n;return new class extends ce{constructor(e,t,n){super(e,t),this.node=e,this.cellMinWidth=t,this.blockContentHTMLAttributes=n;const r=document.createElement("div");for(const[e,t]of(r.className=mF("bn-block-content",n.class),r.setAttribute("data-content-type","table"),Object.entries(n)))"class"!==e&&r.setAttribute(e,t);const o=this.dom,i=document.createElement("div");i.className="tableWrapper-inner",i.appendChild(o.firstChild),o.appendChild(i),r.appendChild(o);const s=document.createElement("div");s.className="table-widgets-container",s.style.position="relative",o.appendChild(s),this.dom=r}ignoreMutation(e){return!e.target.closest(".tableWrapper-inner")||super.ignoreMutation(e)}}(e,120,{...(null==(n=this.options.domAttributes)?void 0:n.blockContent)||{},...t})}}}),gj=lB.create({name:"tableParagraph",group:"tableContent",content:"inline*",parseHTML:()=>[{tag:"p",getAttrs:e=>{if("string"==typeof e||!e.textContent||!e.closest("[data-content-type]"))return!1;let t=e.parentElement;return null!==t&&("TD"===t.tagName||"TH"===t.tagName)&&{}},node:"tableParagraph"}],renderHTML:({HTMLAttributes:e})=>["p",e,0]}),gF=lB.create({name:"tableRow",addOptions:()=>({HTMLAttributes:{}}),content:"(tableCell | tableHeader)+",tableRole:"row",marks:"deletion insertion modification",parseHTML:()=>[{tag:"tr"}],renderHTML({HTMLAttributes:e}){return["tr",sv(this.options.HTMLAttributes,e),0]}});function gU(e,t){let n=eX.fromSchema(t).parse(e,{topNode:t.nodes.blockGroup.create()}),r=[];return n.content.descendants(e=>{if(e.isInline)return r.push(e),!1}),em.fromArray(r)}let gz=e=>({url:e.src||void 0,previewWidth:e.width||void 0}),gV=e=>({type:"video",propSchema:{textAlignment:m5.textAlignment,backgroundColor:m5.backgroundColor,name:{default:""},url:{default:""},caption:{default:""},showPreview:{default:!0},previewWidth:{default:void 0,type:"number"}},content:"none"}),g$=e=>e=>{if("VIDEO"===e.tagName){if(e.closest("figure"))return;let{backgroundColor:t}=m3(e);return{...gz(e),backgroundColor:t}}if("FIGURE"===e.tagName){let t=m6(e,"video");if(!t)return;let{targetElement:n,caption:r}=t,{backgroundColor:o}=m3(e);return{...gz(n),backgroundColor:o,caption:r}}},gG=mq(gV,e=>({meta:{fileBlockAccept:["video/*"]},parse:g$(),render(t,n){let r=document.createElement("div");r.innerHTML=e.icon??'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M2 3.9934C2 3.44476 2.45531 3 2.9918 3H21.0082C21.556 3 22 3.44495 22 3.9934V20.0066C22 20.5552 21.5447 21 21.0082 21H2.9918C2.44405 21 2 20.5551 2 20.0066V3.9934ZM8 5V19H16V5H8ZM4 5V7H6V5H4ZM18 5V7H20V5H18ZM4 9V11H6V9H4ZM18 9V11H20V9H18ZM4 13V15H6V13H4ZM18 13V15H20V13H18ZM4 17V19H6V17H4ZM18 17V19H20V17H18Z"></path></svg>';let o=document.createElement("div");o.className="bn-visual-media-wrapper";let i=document.createElement("video");return i.className="bn-visual-media",n.resolveFileUrl?n.resolveFileUrl(t.props.url).then(e=>{i.src=e}):i.src=t.props.url,i.controls=!0,i.contentEditable="false",i.draggable=!1,i.width=t.props.previewWidth,o.appendChild(i),gv(t,n,{dom:o},o,r.firstElementChild)},toExternalHTML(e){let t;if(!e.props.url){let e=document.createElement("p");return e.textContent="Add video",{dom:e}}return e.props.showPreview?((t=document.createElement("video")).src=e.props.url,e.props.previewWidth&&(t.width=e.props.previewWidth)):((t=document.createElement("a")).href=e.props.url,t.textContent=e.props.name||e.props.url),e.props.caption?e.props.showPreview?ge(t,e.props.caption):gt(t,e.props.caption):{dom:t}},runsBefore:["file"]}));function gq(e,t,n){if(!(t in e.schema.blockSpecs))return!1;if(!n)return!0;for(let[r,o]of Object.entries(n)){if(!(r in e.schema.blockSpecs[t].config.propSchema))return!1;if("string"==typeof o){if(void 0!==e.schema.blockSpecs[t].config.propSchema[r].default&&typeof e.schema.blockSpecs[t].config.propSchema[r].default!==o||void 0!==e.schema.blockSpecs[t].config.propSchema[r].type&&e.schema.blockSpecs[t].config.propSchema[r].type!==o)return!1}else{if(e.schema.blockSpecs[t].config.propSchema[r].default!==o.default||void 0===e.schema.blockSpecs[t].config.propSchema[r].default&&void 0===o.default&&e.schema.blockSpecs[t].config.propSchema[r].type!==o.type||typeof e.schema.blockSpecs[t].config.propSchema[r].values!=typeof o.values)return!1;if("object"==typeof e.schema.blockSpecs[t].config.propSchema[r].values&&"object"==typeof o.values){for(let n of o.values)if(!e.schema.blockSpecs[t].config.propSchema[r].values.includes(n))return!1}}}return!0}function gW(e,t,n,r){return gq(t,n,r)&&e.type===n}function gY(e){return e instanceof aH}let gK=new Map,gZ=su(e=>"blockContainer"===e.type.name);class gX{constructor(e,t,n){var r;mH(this,"state"),mH(this,"emitUpdate"),mH(this,"rootEl"),mH(this,"pluginState"),mH(this,"handleScroll",()=>{var e,t;if(null!=(e=this.state)&&e.show){let e=null==(t=this.rootEl)?void 0:t.querySelector(`[data-decoration-id="${this.pluginState.decorationId}"]`);if(!e)return;this.state.referencePos=e.getBoundingClientRect().toJSON(),this.emitUpdate(this.pluginState.triggerCharacter)}}),mH(this,"closeMenu",()=>{this.editor.transact(e=>e.setMeta(gQ,null))}),mH(this,"clearQuery",()=>{void 0!==this.pluginState&&this.editor._tiptapEditor.chain().focus().deleteRange({from:this.pluginState.queryStartPos()-(this.pluginState.deleteTriggerCharacter?this.pluginState.triggerCharacter.length:0),to:this.editor.transact(e=>e.selection.from)}).run()}),this.editor=e,this.pluginState=void 0,this.emitUpdate=e=>{var n;if(!this.state)throw Error("Attempting to update uninitialized suggestions menu");t(e,{...this.state,ignoreQueryLength:null==(n=this.pluginState)?void 0:n.ignoreQueryLength})},this.rootEl=n.root,null==(r=this.rootEl)||r.addEventListener("scroll",this.handleScroll,!0)}update(e,t){var n;let r=gQ.getState(t),o=gQ.getState(e.state),i=void 0!==r&&void 0===o;if((void 0!==r||void 0===o)&&(void 0===r||void 0===o)&&!i)return;if(this.pluginState=i?r:o,i||!this.editor.isEditable){this.state&&(this.state.show=!1),this.emitUpdate(this.pluginState.triggerCharacter);return}let s=null==(n=this.rootEl)?void 0:n.querySelector(`[data-decoration-id="${this.pluginState.decorationId}"]`);this.editor.isEditable&&s&&(this.state={show:!0,referencePos:s.getBoundingClientRect().toJSON(),query:this.pluginState.query},this.emitUpdate(this.pluginState.triggerCharacter))}destroy(){var e;null==(e=this.rootEl)||e.removeEventListener("scroll",this.handleScroll,!0)}}let gQ=new t8("SuggestionMenuPlugin"),gJ=mm(({editor:e})=>{let t,n=[],r=mg(void 0);return{key:"suggestionMenu",store:r,addTriggerCharacter:e=>{n.push(e)},removeTriggerCharacter:e=>{n.splice(n.indexOf(e),1)},closeMenu:()=>{null==t||t.closeMenu()},clearQuery:()=>{null==t||t.clearQuery()},shown:()=>{var e;return(null==(e=null==t?void 0:t.state)?void 0:e.show)||!1},openSuggestionMenu:(t,n)=>{e.headless||(e.focus(),e.transact(e=>{null!=n&&n.deleteTriggerCharacter&&e.insertText(t),e.scrollIntoView().setMeta(gQ,{triggerCharacter:t,deleteTriggerCharacter:(null==n?void 0:n.deleteTriggerCharacter)||!1,ignoreQueryLength:(null==n?void 0:n.ignoreQueryLength)||!1})}))},prosemirrorPlugins:[new t4({key:gQ,view:n=>t=new gX(e,(e,t)=>{r.setState({...t,triggerCharacter:e})},n),state:{init(){},apply:(n,r,o,i)=>{if(n.selection.$from.parent.type.spec.code)return r;let s=n.getMeta(gQ);if("object"==typeof s&&null!==s){r&&(null==t||t.closeMenu());let n=function(e,t,n="left"){let r=ca.getState(e.prosemirrorState);if(!r){let r=function(e){if(gK.has(e))return gK.get(e);let t=new tr;return e._tiptapEditor.on("transaction",({transaction:e})=>{t.appendMapping(e.mapping)}),e._tiptapEditor.on("destroy",()=>{gK.delete(e)}),gK.set(e,t),t}(e),o=r.maps.length;return()=>r.slice(o).map(t,"left"===n?-1:1)}let o=mr(t+("right"===n?1:-1),r.binding.type,r.binding.mapping);return()=>{let t=ca.getState(e.prosemirrorState),r=mi(t.doc,t.binding.type,o,t.binding.mapping);if(null===r)throw Error("Position not found, cannot track positions");return r+("right"===n?-1:1)}}(e,i.selection.from-s.triggerCharacter.length);return{triggerCharacter:s.triggerCharacter,deleteTriggerCharacter:!1!==s.deleteTriggerCharacter,queryStartPos:()=>n()+s.triggerCharacter.length,query:"",decorationId:`id_${Math.floor(0xffffffff*Math.random())}`,ignoreQueryLength:null==s?void 0:s.ignoreQueryLength}}if(void 0===r)return r;if(i.selection.from!==i.selection.to||null===s||n.getMeta("focus")||n.getMeta("blur")||n.getMeta("pointer")||void 0!==r.triggerCharacter&&i.selection.from<r.queryStartPos()||!i.selection.$from.sameParent(i.doc.resolve(r.queryStartPos())))return;let l={...r};return l.query=i.doc.textBetween(r.queryStartPos(),i.selection.from),l}},props:{handleTextInput(e,t,r,o){if(t===r){let r=e.state.doc;for(let i of n){let n=i.length>1?r.textBetween(t-i.length,t)+o:o;if(i===n)return e.dispatch(e.state.tr.insertText(o)),e.dispatch(e.state.tr.setMeta(gQ,{triggerCharacter:n}).scrollIntoView()),!0}}return!1},decorations(e){let t=this.getState(e);if(void 0===t)return null;if(!t.deleteTriggerCharacter){let n=gZ(e.selection);if(n)return oA.create(e.doc,[ow.node(n.pos,n.pos+n.node.nodeSize,{nodeName:"span",class:"bn-suggestion-decorator","data-decoration-id":t.decorationId})])}return oA.create(e.doc,[ow.inline(t.queryStartPos()-t.triggerCharacter.length,t.queryStartPos(),{nodeName:"span",class:"bn-suggestion-decorator","data-decoration-id":t.decorationId})])}}})]}});function g0(e,t){let n,r=e.getTextCursorPosition().block;if(void 0===r.content)throw Error("Slash Menu open in a block that doesn't contain content.");return Array.isArray(r.content)&&(1===r.content.length&&lK(r.content[0])&&"text"===r.content[0].type&&"/"===r.content[0].text||0===r.content.length)?(n=e.updateBlock(r,t),e.setTextCursorPosition(n)):(n=e.insertBlocks([t],r,"after")[0],e.setTextCursorPosition(e.getTextCursorPosition().nextBlock)),function(e){let t=e.getTextCursorPosition().block,n=e.schema.blockSchema[t.type].content;for(;"none"===n;){if(void 0===(t=e.getTextCursorPosition().nextBlock))return;n=e.schema.blockSchema[t.type].content,e.setTextCursorPosition(t,"end")}}(e),n}let g1={audio:gi(),bulletListItem:gA(),checkListItem:g_(),codeBlock:ga(),divider:gd(),file:gf(),heading:gy(),image:gT(),numberedListItem:gM(),paragraph:gO(),quote:gD(),table:(h={node:gH,type:"table",content:"table"},p=[mm({key:"table-extensions",tiptapExtensions:[gR,gj,gP,gB,gF]}),mm({key:"table-keyboard-delete",keyboardShortcuts:{Backspace:({editor:e})=>{if(!(e.prosemirrorState.selection instanceof aH))return!1;let t=e.getTextCursorPosition().block,n=t.content,r=0;for(let e of n.rows)for(let t of e.cells){if("type"in t&&t.content.length>0||!("type"in t)&&t.length>0)return!1;r++}let o=0;return e.prosemirrorState.selection.forEachCell(()=>{o++}),!(o<r)&&(e.transact(()=>{(e.getPrevBlock(t)||e.getNextBlock(t))&&e.setTextCursorPosition(t),e.removeBlocks([t])}),!0)}}})],{config:{type:h.type,content:h.content,propSchema:gL},implementation:{node:h.node,render:mU,toExternalHTML:mU},extensions:p}),toggleListItem:gI(),video:gG()},g2=mQ({type:"textColor",propSchema:"string"},{render:()=>{let e=document.createElement("span");return{dom:e,contentDOM:e}},toExternalHTML:e=>{let t=document.createElement("span");return e!==m5.textColor.default&&(t.style.color=e in m4?m4[e].text:e),{dom:t,contentDOM:t}},parse:e=>{if("SPAN"===e.tagName&&e.style.color)return e.style.color}}),g4=mQ({type:"backgroundColor",propSchema:"string"},{render:()=>{let e=document.createElement("span");return{dom:e,contentDOM:e}},toExternalHTML:e=>{let t=document.createElement("span");return e!==m5.backgroundColor.default&&(t.style.backgroundColor=e in m4?m4[e].background:e),{dom:t,contentDOM:t}},parse:e=>{if("SPAN"===e.tagName&&e.style.backgroundColor)return e.style.backgroundColor}}),g5={bold:mZ(mC,"boolean"),italic:mZ(mM,"boolean"),underline:mZ(mR,"boolean"),strike:mZ(mD,"boolean"),code:mZ(mx,"boolean"),textColor:g2,backgroundColor:g4},g3=(mX(g5),{text:{config:"text",implementation:{}},link:{config:"link",implementation:{}}}),g8=mW(g3),g6=new t8("blocknote-show-selection"),g9=mm(({editor:e})=>{let t=mg({enabled:!1},{onUpdate(){e.transact(e=>e.setMeta(g6,{}))}});return{key:"showSelection",store:t,prosemirrorPlugins:[new t4({key:g6,props:{decorations:e=>{let{doc:n,selection:r}=e;if(!t.state.enabled)return oA.empty;let o=ow.inline(r.from,r.to,{"data-show-selection":"true"});return oA.create(n,[o])}}})],showSelection(e){t.setState({enabled:e})}}});var g7=Object.defineProperty;class be{constructor(){((e,t,n)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?g7(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n})(this,"callbacks",{})}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),()=>this.off(e,t)}emit(e,...t){let n=this.callbacks[e];n&&n.forEach(e=>e.apply(this,t))}off(e,t){let n=this.callbacks[e];n&&(t?this.callbacks[e]=n.filter(e=>e!==t):delete this.callbacks[e])}removeAllListeners(){this.callbacks={}}}var bt=Object.defineProperty,bn=(e,t,n)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?bt(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n};let br=ll.create({name:"comment",excludes:"",inclusive:!1,keepOnSplit:!0,addAttributes:()=>({orphan:{parseHTML:e=>!!e.getAttribute("data-orphan"),renderHTML:e=>e.orphan?{"data-orphan":"true"}:{},default:!1},threadId:{parseHTML:e=>e.getAttribute("data-bn-thread-id"),renderHTML:e=>({"data-bn-thread-id":e.threadId}),default:""}}),renderHTML:({HTMLAttributes:e})=>["span",sv(e,{class:"bn-thread-mark"})],parseHTML:()=>[{tag:"span.bn-thread-mark"}],extendMarkSchema:e=>"comment"===e.name?{blocknoteIgnore:!0}:{}});class bo extends be{constructor(e){super(),bn(this,"userCache",new Map),bn(this,"loadingUsers",new Set),this.resolveUsers=e}async loadUsers(e){let t=e.filter(e=>!this.userCache.has(e)&&!this.loadingUsers.has(e));if(0!==t.length){for(let e of t)this.loadingUsers.add(e);try{for(let e of(await this.resolveUsers(t)))this.userCache.set(e.id,e);this.emit("update",this.userCache)}finally{for(let e of t)this.loadingUsers.delete(e)}}}getUser(e){return this.userCache.get(e)}subscribe(e){return this.on("update",e)}}let bi=new t8("blocknote-comments"),bs=mm(({editor:e,options:{schema:t,threadStore:n,resolveUsers:r}})=>{if(!r)throw Error("resolveUsers is required to be defined when using comments");if(!n)throw Error("threadStore is required to be defined when using comments");let o=br.name,i=new bo(r),s=mg({pendingComment:!1,selectedThreadId:void 0,threadPositions:new Map},{onUpdate(){s.state.selectedThreadId!==s.prevState.selectedThreadId&&e.transact(e=>e.setMeta(bi,!0))}}),l=t=>{e.transact(e=>{e.doc.descendants((n,r)=>{n.marks.forEach(i=>{if(i.type.name===o){let o=i.type,l=i.attrs.threadId,a=t.get(l),c=!!(!a||a.resolved||a.deletedAt);if(c!==i.attrs.orphan){let t=Math.max(r,0),a=Math.min(r+n.nodeSize,e.doc.content.size-1,e.doc.content.size-1);e.removeMark(t,a,i),e.addMark(t,a,o.create({...i.attrs,orphan:c})),c&&s.state.selectedThreadId===l&&s.setState(e=>({...e,selectedThreadId:void 0}))}}})})})};return{key:"comments",store:s,prosemirrorPlugins:[new t4({key:bi,state:{init:()=>({decorations:oA.empty}),apply(e,t){var n;let r,i=e.getMeta(bi);if(!e.docChanged&&!i)return t;let l=e.docChanged?(n=e.doc,r=new Map,n.descendants((e,t)=>{e.marks.forEach(n=>{if(n.type.name===o){let o=n.attrs.threadId;if(!o)return;let i=t+e.nodeSize,s=r.get(o)??{from:1/0,to:0};r.set(o,{from:Math.min(t,s.from),to:Math.max(i,s.to)})}})}),r):s.state.threadPositions;(l.size>0||s.state.threadPositions.size>0)&&s.setState(e=>({...e,threadPositions:l}));let a=[];if(s.state.selectedThreadId){let e=l.get(s.state.selectedThreadId);e&&a.push(ow.inline(e.from,e.to,{class:"bn-thread-mark-selected"}))}return{decorations:oA.create(e.doc,a)}}},props:{decorations(e){var t;return(null==(t=bi.getState(e))?void 0:t.decorations)??oA.empty},handleClick:(e,t,n)=>{if(0!==n.button)return;let r=e.state.doc.nodeAt(t);if(!r)return void s.setState(e=>({...e,selectedThreadId:void 0}));let i=r.marks.find(e=>e.type.name===o&&!0!==e.attrs.orphan),l=null==i?void 0:i.attrs.threadId;l!==s.state.selectedThreadId&&s.setState(e=>({...e,selectedThreadId:l}))}}})],threadStore:n,mount(){let t=n.subscribe(l);l(n.getThreads());let r=e.onSelectionChange(()=>{s.state.pendingComment&&s.setState(e=>({...e,pendingComment:!1}))});return()=>{t(),r()}},selectThread(t,n=!0){var r,o;if(s.state.selectedThreadId!==t&&(s.setState(e=>({...e,pendingComment:!1,selectedThreadId:t})),t&&n)){let n=s.state.threadPositions.get(t);if(!n)return;null==(o=null==(r=e.prosemirrorView)?void 0:r.domAtPos(n.from).node)||o.scrollIntoView({behavior:"smooth",block:"center"})}},startPendingComment(){var t;s.setState(e=>({...e,selectedThreadId:void 0,pendingComment:!0})),null==(t=e.getExtension(g9))||t.showSelection(!0)},stopPendingComment(){var t;s.setState(e=>({...e,selectedThreadId:void 0,pendingComment:!1})),null==(t=e.getExtension(g9))||t.showSelection(!1)},async createThread(t){let r=await n.createThread(t);if(n.addThreadToDocument){let t=e.prosemirrorView,o=t.state.selection,i=ca.getState(t.state),s={prosemirror:{head:o.head,anchor:o.anchor},yjs:i?fG(i.binding,t.state):void 0};await n.addThreadToDocument({threadId:r.id,selection:s})}else e._tiptapEditor.commands.setMark(o,{orphan:!1,threadId:r.id})},userStore:i,commentEditorSchema:t,tiptapExtensions:[br]}});var bl=e.i(65932);let ba=(e,t,n)=>e!==t,bc=e=>{let t=document.createElement("span");t.classList.add("ProseMirror-yjs-cursor"),t.setAttribute("style",`border-color: ${e.color}`);let n=document.createElement("div");n.setAttribute("style",`background-color: ${e.color}`),n.insertBefore(document.createTextNode(e.name),null);let r=document.createTextNode(""),o=document.createTextNode("");return t.insertBefore(r,null),t.insertBefore(n,null),t.insertBefore(o,null),t},bd=e=>({style:`background-color: ${e.color}70`,class:"ProseMirror-yjs-selection"}),bu=/^#[0-9a-fA-F]{6}$/,bh=(e,t,n,r,o)=>{let i=ca.getState(e),s=i.doc,l=[];return null!=i.snapshot||null!=i.prevSnapshot||0===i.binding.mapping.size?oA.create(e.doc,[]):(t.getStates().forEach((t,a)=>{if(n(s.clientID,a,t)&&null!=t.cursor){let n=t.user||{};null==n.color?n.color="#ffa500":bu.test(n.color)||console.warn("A user uses an unsupported color format",n),null==n.name&&(n.name=`User: ${a}`);let c=mi(s,i.type,hj(t.cursor.anchor),i.binding.mapping),d=mi(s,i.type,hj(t.cursor.head),i.binding.mapping);if(null!==c&&null!==d){let t=cf(e.doc.content.size-1,0);c=cp(c,t),d=cp(d,t),l.push(ow.widget(d,()=>r(n,a),{key:a+"",side:10}));let i=cp(c,d),s=cf(c,d);l.push(ow.inline(i,s,o(n,a),{inclusiveEnd:!0,inclusiveStart:!1}))}}}),oA.create(e.doc,l))},bp=(e,t)=>null==t?cc.getState(e)?.undoManager?.canUndo():cc.getState(e)?.undoManager?.undo()!=null,bf=(e,t)=>null==t?cc.getState(e)?.undoManager?.canRedo():cc.getState(e)?.undoManager?.redo()!=null,bm=new Set(["paragraph"]);function bg(e={}){return new t4({view:t=>new bb(t,e)})}class bb{constructor(e,t){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!=(n=t.width)?n:1,this.color=!1===t.color?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(t=>{let n=e=>{this[t](e)};return e.dom.addEventListener(t,n),{name:t,handler:n}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){null!=this.cursorPos&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e,t,n=this.editorView.state.doc.resolve(this.cursorPos),r=!n.parent.inlineContent,o,i=this.editorView.dom,s=i.getBoundingClientRect(),l=s.width/i.offsetWidth,a=s.height/i.offsetHeight;if(r){let e=n.nodeBefore,t=n.nodeAfter;if(e||t){let n=this.editorView.nodeDOM(this.cursorPos-(e?e.nodeSize:0));if(n){let r=n.getBoundingClientRect(),i=e?r.bottom:r.top;e&&t&&(i=(i+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let s=this.width/2*a;o={left:r.left,right:r.right,top:i-s,bottom:i+s}}}}if(!o){let e=this.editorView.coordsAtPos(this.cursorPos),t=this.width/2*l;o={left:e.left-t,right:e.left+t,top:e.top,bottom:e.bottom}}let c=this.editorView.dom.offsetParent;if(!this.element&&(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",r),this.element.classList.toggle("prosemirror-dropcursor-inline",!r),c&&(c!=document.body||"static"!=getComputedStyle(c).position)){let n=c.getBoundingClientRect(),r=n.width/c.offsetWidth,o=n.height/c.offsetHeight;e=n.left-c.scrollLeft*r,t=n.top-c.scrollTop*o}else e=-pageXOffset,t=-pageYOffset;this.element.style.left=(o.left-e)/l+"px",this.element.style.top=(o.top-t)/a+"px",this.element.style.width=(o.right-o.left)/l+"px",this.element.style.height=(o.bottom-o.top)/a+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),r=n&&n.type.spec.disableDropCursor,o="function"==typeof r?r(this.editorView,t,e):r;if(t&&!o){let e=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let t=tx(this.editorView.state.doc,e,this.editorView.dragging.slice);null!=t&&(e=t)}this.setCursor(e),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}var by=function(){};by.prototype.append=function(e){return e.length?(e=by.from(e),!this.length&&e||e.length<200&&this.leafAppend(e)||this.length<200&&e.leafPrepend(this)||this.appendInner(e)):this},by.prototype.prepend=function(e){return e.length?by.from(e).append(this):this},by.prototype.appendInner=function(e){return new bE(this,e)},by.prototype.slice=function(e,t){return(void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t)?by.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},by.prototype.get=function(e){if(!(e<0)&&!(e>=this.length))return this.getInner(e)},by.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},by.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var r=[];return this.forEach(function(t,n){return r.push(e(t,n))},t,n),r},by.from=function(e){return e instanceof by?e:e&&e.length?new bv(e):by.empty};var bv=function(e){function t(t){e.call(this),this.values=t}t.__proto__=e,t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,r){for(var o=t;o<n;o++)if(!1===e(this.values[o],r+o))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){for(var o=t-1;o>=n;o--)if(!1===e(this.values[o],r+o))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=200)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=200)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(by);by.empty=new bv([]);var bE=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return t.__proto__=e,t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,r){var o=this.left.length;if(t<o&&!1===this.left.forEachInner(e,t,Math.min(n,o),r)||n>o&&!1===this.right.forEachInner(e,Math.max(t-o,0),Math.min(this.length,n)-o,r+o))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){var o=this.left.length;if(t>o&&!1===this.right.forEachInvertedInner(e,t-o,Math.max(n,o)-o,r+o)||n<o&&!1===this.left.forEachInvertedInner(e,Math.min(t,o),n,r))return!1},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(by);class bk{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){let n,r,o,i;if(0==this.eventCount)return null;let s=this.items.length;for(;;s--)if(this.items.get(s-1).selection){--s;break}t&&(r=(n=this.remapping(s,this.items.length)).maps.length);let l=e.tr,a=[],c=[];return this.items.forEach((e,t)=>{if(!e.step){n||(r=(n=this.remapping(s,t+1)).maps.length),r--,c.push(e);return}if(n){c.push(new bC(e.map));let t=e.step.map(n.slice(r)),o;t&&l.maybeStep(t).doc&&(o=l.mapping.maps[l.mapping.maps.length-1],a.push(new bC(o,void 0,void 0,a.length+c.length))),r--,o&&n.appendMap(o,r)}else l.maybeStep(e.step);if(e.selection)return o=n?e.selection.map(n.slice(r)):e.selection,i=new bk(this.items.slice(0,s).append(c.reverse().concat(a)),this.eventCount-1),!1},this.items.length,0),{remaining:i,transform:l,selection:o}}addTransform(e,t,n,r){var o,i;let s,l=[],a=this.eventCount,c=this.items,d=!r&&c.length?c.get(c.length-1):null;for(let n=0;n<e.steps.length;n++){let o=e.steps[n].invert(e.docs[n]),i=new bC(e.mapping.maps[n],o,t),s;(s=d&&d.merge(i))&&(i=s,n?l.pop():c=c.slice(0,c.length-1)),l.push(i),t&&(a++,t=void 0),r||(d=i)}let u=a-n.depth;return u>bw&&(o=c,i=u,o.forEach((e,t)=>{if(e.selection&&0==i--)return s=t,!1}),c=o.slice(s),a-=u),new bk(c.append(l),a)}remapping(e,t){let n=new tr;return this.items.forEach((t,r)=>{let o=null!=t.mirrorOffset&&r-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:void 0;n.appendMap(t.map,o)},e,t),n}addMaps(e){return 0==this.eventCount?this:new bk(this.items.append(e.map(e=>new bC(e))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],r=Math.max(0,this.items.length-t),o=e.mapping,i=e.steps.length,s=this.eventCount;this.items.forEach(e=>{e.selection&&s--},r);let l=t;this.items.forEach(t=>{let r=o.getMirror(--l);if(null==r)return;i=Math.min(i,r);let a=o.maps[r];if(t.step){let i=e.steps[r].invert(e.docs[r]),c=t.selection&&t.selection.map(o.slice(l+1,r));c&&s++,n.push(new bC(a,i,c))}else n.push(new bC(a))},r);let a=[];for(let e=t;e<i;e++)a.push(new bC(o.maps[e]));let c=new bk(this.items.slice(0,r).append(a).append(n),s);return c.emptyItemCount()>500&&(c=c.compress(this.items.length-n.length)),c}emptyItemCount(){let e=0;return this.items.forEach(t=>{!t.step&&e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),n=t.maps.length,r=[],o=0;return this.items.forEach((i,s)=>{if(s>=e)r.push(i),i.selection&&o++;else if(i.step){let e=i.step.map(t.slice(n)),s=e&&e.getMap();if(n--,s&&t.appendMap(s,n),e){let l=i.selection&&i.selection.map(t.slice(n));l&&o++;let a=new bC(s.invert(),e,l),c,d=r.length-1;(c=r.length&&r[d].merge(a))?r[d]=c:r.push(a)}}else i.map&&n--},this.items.length,0),new bk(by.from(r.reverse()),o)}}bk.empty=new bk(by.empty,0);class bC{constructor(e,t,n,r){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new bC(t.getMap().invert(),t,this.selection)}}}class bT{constructor(e,t,n,r,o){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=r,this.prevComposition=o}}let bw=20;function bx(e){let t=[];for(let n=e.length-1;n>=0&&0==t.length;n--)e[n].forEach((e,n,r,o)=>t.push(r,o));return t}function bS(e,t){if(!e)return null;let n=[];for(let r=0;r<e.length;r+=2){let o=t.map(e[r],1),i=t.map(e[r+1],-1);o<=i&&n.push(o,i)}return n}let bA=!1,b_=null;function bN(e){let t=e.plugins;if(b_!=t){bA=!1,b_=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){bA=!0;break}}return bA}let bM=new t8("history"),bI=new t8("closeHistory");function bO(e={}){return new t4({key:bM,state:{init:()=>new bT(bk.empty,bk.empty,null,0,-1),apply:(t,n,r)=>(function(e,t,n,r){let o=n.getMeta(bM),i;if(o)return o.historyState;n.getMeta(bI)&&(e=new bT(e.done,e.undone,null,0,-1));let s=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(s&&s.getMeta(bM))if(s.getMeta(bM).redo)return new bT(e.done.addTransform(n,void 0,r,bN(t)),e.undone,bx(n.mapping.maps),e.prevTime,e.prevComposition);else return new bT(e.done,e.undone.addTransform(n,void 0,r,bN(t)),null,e.prevTime,e.prevComposition);if(!1===n.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))if(i=n.getMeta("rebased"))return new bT(e.done.rebased(n,i),e.undone.rebased(n,i),bS(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);else return new bT(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),bS(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);{let o=n.getMeta("composition"),i=0==e.prevTime||!s&&e.prevComposition!=o&&(e.prevTime<(n.time||0)-r.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((e,r)=>{for(let o=0;o<t.length;o+=2)e<=t[o+1]&&r>=t[o]&&(n=!0)}),n}(n,e.prevRanges)),l=s?bS(e.prevRanges,n.mapping):bx(n.mapping.maps);return new bT(e.done.addTransform(n,i?t.selection.getBookmark():void 0,r,bN(t)),bk.empty,l,n.time,null==o?e.prevComposition:o)}})(n,r,t,e)},config:e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,r="historyUndo"==n?bR:"historyRedo"==n?bL:null;return!!r&&!!e.editable&&(t.preventDefault(),r(e.state,e.dispatch))}}}})}function bD(e,t){return(n,r)=>{let o=bM.getState(n);if(!o||0==(e?o.undone:o.done).eventCount)return!1;if(r){let i=function(e,t,n){let r=bN(t),o=bM.get(t).spec.config,i=(n?e.undone:e.done).popEvent(t,r);if(!i)return null;let s=i.selection.resolve(i.transform.doc),l=(n?e.done:e.undone).addTransform(i.transform,t.selection.getBookmark(),o,r),a=new bT(n?l:i.remaining,n?i.remaining:l,null,0,-1);return i.transform.setSelection(s).setMeta(bM,{redo:n,historyState:a})}(o,n,e);i&&r(t?i.scrollIntoView():i)}return!0}}let bR=bD(!1,!0),bL=bD(!0,!0);function bP(){}bD(!1,!1),bD(!0,!1);class bB{constructor(e,t,n){this.normal=t,this.property=e,n&&(this.space=n)}}function bH(e,t){let n={},r={};for(let t of e)Object.assign(n,t.property),Object.assign(r,t.normal);return new bB(n,r,t)}function bj(e){return e.toLowerCase()}bB.prototype.normal={},bB.prototype.property={},bB.prototype.space=void 0;class bF{constructor(e,t){this.attribute=t,this.property=e}}bF.prototype.attribute="",bF.prototype.booleanish=!1,bF.prototype.boolean=!1,bF.prototype.commaOrSpaceSeparated=!1,bF.prototype.commaSeparated=!1,bF.prototype.defined=!1,bF.prototype.mustUseProperty=!1,bF.prototype.number=!1,bF.prototype.overloadedBoolean=!1,bF.prototype.property="",bF.prototype.spaceSeparated=!1,bF.prototype.space=void 0;let bU=0,bz=bK(),bV=bK(),b$=bK(),bG=bK(),bq=bK(),bW=bK(),bY=bK();function bK(){return 2**++bU}e.s(["boolean",0,bz,"booleanish",0,bV,"commaOrSpaceSeparated",0,bY,"commaSeparated",0,bW,"number",0,bG,"overloadedBoolean",0,b$,"spaceSeparated",0,bq],83954);var bZ=e.i(83954);let bX=Object.keys(bZ);class bQ extends bF{constructor(e,t,n,r){let o=-1;if(super(e,t),function(e,t,n){n&&(e[t]=n)}(this,"space",r),"number"==typeof n)for(;++o<bX.length;){const e=bX[o];!function(e,t,n){n&&(e[t]=n)}(this,bX[o],(n&bZ[e])===bZ[e])}}}function bJ(e){let t={},n={};for(let[r,o]of Object.entries(e.properties)){let i=new bQ(r,e.transform(e.attributes||{},r),o,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(i.mustUseProperty=!0),t[r]=i,n[bj(r)]=r,n[bj(i.attribute)]=r}return new bB(t,n,e.space)}bQ.prototype.defined=!0;let b0=bJ({properties:{ariaActiveDescendant:null,ariaAtomic:bV,ariaAutoComplete:null,ariaBusy:bV,ariaChecked:bV,ariaColCount:bG,ariaColIndex:bG,ariaColSpan:bG,ariaControls:bq,ariaCurrent:null,ariaDescribedBy:bq,ariaDetails:null,ariaDisabled:bV,ariaDropEffect:bq,ariaErrorMessage:null,ariaExpanded:bV,ariaFlowTo:bq,ariaGrabbed:bV,ariaHasPopup:null,ariaHidden:bV,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:bq,ariaLevel:bG,ariaLive:null,ariaModal:bV,ariaMultiLine:bV,ariaMultiSelectable:bV,ariaOrientation:null,ariaOwns:bq,ariaPlaceholder:null,ariaPosInSet:bG,ariaPressed:bV,ariaReadOnly:bV,ariaRelevant:null,ariaRequired:bV,ariaRoleDescription:bq,ariaRowCount:bG,ariaRowIndex:bG,ariaRowSpan:bG,ariaSelected:bV,ariaSetSize:bG,ariaSort:null,ariaValueMax:bG,ariaValueMin:bG,ariaValueNow:bG,ariaValueText:null,role:null},transform:(e,t)=>"role"===t?t:"aria-"+t.slice(4).toLowerCase()});function b1(e,t){return t in e?e[t]:t}function b2(e,t){return b1(e,t.toLowerCase())}let b4=bJ({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:bW,acceptCharset:bq,accessKey:bq,action:null,allow:null,allowFullScreen:bz,allowPaymentRequest:bz,allowUserMedia:bz,alt:null,as:null,async:bz,autoCapitalize:null,autoComplete:bq,autoFocus:bz,autoPlay:bz,blocking:bq,capture:null,charSet:null,checked:bz,cite:null,className:bq,cols:bG,colSpan:null,content:null,contentEditable:bV,controls:bz,controlsList:bq,coords:bG|bW,crossOrigin:null,data:null,dateTime:null,decoding:null,default:bz,defer:bz,dir:null,dirName:null,disabled:bz,download:b$,draggable:bV,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:bz,formTarget:null,headers:bq,height:bG,hidden:b$,high:bG,href:null,hrefLang:null,htmlFor:bq,httpEquiv:bq,id:null,imageSizes:null,imageSrcSet:null,inert:bz,inputMode:null,integrity:null,is:null,isMap:bz,itemId:null,itemProp:bq,itemRef:bq,itemScope:bz,itemType:bq,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:bz,low:bG,manifest:null,max:null,maxLength:bG,media:null,method:null,min:null,minLength:bG,multiple:bz,muted:bz,name:null,nonce:null,noModule:bz,noValidate:bz,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:bz,optimum:bG,pattern:null,ping:bq,placeholder:null,playsInline:bz,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:bz,referrerPolicy:null,rel:bq,required:bz,reversed:bz,rows:bG,rowSpan:bG,sandbox:bq,scope:null,scoped:bz,seamless:bz,selected:bz,shadowRootClonable:bz,shadowRootDelegatesFocus:bz,shadowRootMode:null,shape:null,size:bG,sizes:null,slot:null,span:bG,spellCheck:bV,src:null,srcDoc:null,srcLang:null,srcSet:null,start:bG,step:null,style:null,tabIndex:bG,target:null,title:null,translate:null,type:null,typeMustMatch:bz,useMap:null,value:bV,width:bG,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:bq,axis:null,background:null,bgColor:null,border:bG,borderColor:null,bottomMargin:bG,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:bz,declare:bz,event:null,face:null,frame:null,frameBorder:null,hSpace:bG,leftMargin:bG,link:null,longDesc:null,lowSrc:null,marginHeight:bG,marginWidth:bG,noResize:bz,noHref:bz,noShade:bz,noWrap:bz,object:null,profile:null,prompt:null,rev:null,rightMargin:bG,rules:null,scheme:null,scrolling:bV,standby:null,summary:null,text:null,topMargin:bG,valueType:null,version:null,vAlign:null,vLink:null,vSpace:bG,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:bz,disableRemotePlayback:bz,prefix:null,property:null,results:bG,security:null,unselectable:null},space:"html",transform:b2}),b5=bJ({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:bY,accentHeight:bG,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:bG,amplitude:bG,arabicForm:null,ascent:bG,attributeName:null,attributeType:null,azimuth:bG,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:bG,by:null,calcMode:null,capHeight:bG,className:bq,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:bG,diffuseConstant:bG,direction:null,display:null,dur:null,divisor:bG,dominantBaseline:null,download:bz,dx:null,dy:null,edgeMode:null,editable:null,elevation:bG,enableBackground:null,end:null,event:null,exponent:bG,externalResourcesRequired:null,fill:null,fillOpacity:bG,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:bW,g2:bW,glyphName:bW,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:bG,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:bG,horizOriginX:bG,horizOriginY:bG,id:null,ideographic:bG,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:bG,k:bG,k1:bG,k2:bG,k3:bG,k4:bG,kernelMatrix:bY,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:bG,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:bG,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:bG,overlineThickness:bG,paintOrder:null,panose1:null,path:null,pathLength:bG,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:bq,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:bG,pointsAtY:bG,pointsAtZ:bG,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:bY,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:bY,rev:bY,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:bY,requiredFeatures:bY,requiredFonts:bY,requiredFormats:bY,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:bG,specularExponent:bG,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:bG,strikethroughThickness:bG,string:null,stroke:null,strokeDashArray:bY,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:bG,strokeOpacity:bG,strokeWidth:null,style:null,surfaceScale:bG,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:bY,tabIndex:bG,tableValues:null,target:null,targetX:bG,targetY:bG,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:bY,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:bG,underlineThickness:bG,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:bG,values:null,vAlphabetic:bG,vMathematical:bG,vectorEffect:null,vHanging:bG,vIdeographic:bG,version:null,vertAdvY:bG,vertOriginX:bG,vertOriginY:bG,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:bG,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:b1}),b3=bJ({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform:(e,t)=>"xlink:"+t.slice(5).toLowerCase()}),b8=bJ({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:b2}),b6=bJ({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform:(e,t)=>"xml:"+t.slice(3).toLowerCase()}),b9=bH([b0,b4,b3,b8,b6],"html"),b7=bH([b0,b5,b3,b8,b6],"svg");function ye(e){let t=[],n=String(e||""),r=n.indexOf(","),o=0,i=!1;for(;!i;){-1===r&&(r=n.length,i=!0);let e=n.slice(o,r).trim();(e||!i)&&t.push(e),o=r+1,r=n.indexOf(",",o)}return t}let yt=/[#.]/g,yn=/[A-Z]/g,yr=/-[a-z]/g,yo=/^data[-\w.:]+$/i;function yi(e,t){let n=bj(t),r=t,o=bF;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&"data"===n.slice(0,4)&&yo.test(t)){if("-"===t.charAt(4)){let e=t.slice(5).replace(yr,yl);r="data"+e.charAt(0).toUpperCase()+e.slice(1)}else{let e=t.slice(4);if(!yr.test(e)){let n=e.replace(yn,ys);"-"!==n.charAt(0)&&(n="-"+n),t="data"+n}}o=bQ}return new o(r,t)}function ys(e){return"-"+e.toLowerCase()}function yl(e){return e.charAt(1).toUpperCase()}function ya(e){let t=String(e||"").trim();return t?t.split(/[ \t\n\r\f]+/g):[]}function yc(e,t,n){let r=n?function(e){let t=new Map;for(let n of e)t.set(n.toLowerCase(),n);return t}(n):void 0;return function(n,o,...i){let s;if(null==n)s={type:"root",children:[]},i.unshift(o);else{let l=(s=function(e,t){let n,r,o=e||"",i={},s=0;for(;s<o.length;){yt.lastIndex=s;let e=yt.exec(o),t=o.slice(s,e?e.index:o.length);t&&(n?"#"===n?i.id=t:Array.isArray(i.className)?i.className.push(t):i.className=[t]:r=t,s+=t.length),e&&(n=e[0],s++)}return{type:"element",tagName:r||t||"div",properties:i,children:[]}}(n,t)).tagName.toLowerCase(),a=r?r.get(l):void 0;if(s.tagName=a||l,function(e){if(null===e||"object"!=typeof e||Array.isArray(e))return!0;if("string"!=typeof e.type)return!1;for(let t of Object.keys(e)){let n=e[t];if(n&&"object"==typeof n){if(!Array.isArray(n))return!0;for(let e of n)if("number"!=typeof e&&"string"!=typeof e)return!0}}return!!("children"in e&&Array.isArray(e.children))}(o))i.unshift(o);else for(let[t,n]of Object.entries(o))!function(e,t,n,r){let o,i=yi(e,n);if(null!=r){if("number"==typeof r){if(Number.isNaN(r))return;o=r}else o="boolean"==typeof r?r:"string"==typeof r?i.spaceSeparated?ya(r):i.commaSeparated?ye(r):i.commaOrSpaceSeparated?ya(ye(r).join(" ")):yd(i,i.property,r):Array.isArray(r)?[...r]:"style"===i.property?function(e){let t=[];for(let[n,r]of Object.entries(e))t.push([n,r].join(": "));return t.join("; ")}(r):String(r);if(Array.isArray(o)){let e=[];for(let t of o)e.push(yd(i,i.property,t));o=e}"className"===i.property&&Array.isArray(t.className)&&(o=t.className.concat(o)),t[i.property]=o}}(e,s.properties,t,n)}for(let e of i)!function e(t,n){if(null==n);else if("number"==typeof n||"string"==typeof n)t.push({type:"text",value:String(n)});else if(Array.isArray(n))for(let r of n)e(t,r);else if("object"==typeof n&&"type"in n)"root"===n.type?e(t,n.children):t.push(n);else throw Error("Expected node, nodes, or string, got `"+n+"`")}(s.children,e);return"element"===s.type&&"template"===s.tagName&&(s.content={type:"root",children:s.children},s.children=[]),s}}function yd(e,t,n){if("string"==typeof n){if(e.number&&n&&!Number.isNaN(Number(n)))return Number(n);if((e.boolean||e.overloadedBoolean)&&(""===n||bj(n)===bj(t)))return!0}return n}let yu=yc(b9,"div"),yh=yc(b7,"g",["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"]);function yp(e,t){let n=e.indexOf("\r",t),r=e.indexOf("\n",t);return -1===r?n:-1===n||n+1===r?r:n<r?n:r}let yf="http://www.w3.org/1999/xhtml",ym="http://www.w3.org/2000/svg",yg={}.hasOwnProperty,yb=Object.prototype;function yy(e,t){let n;switch(t.nodeName){case"#comment":return n={type:"comment",value:t.data},yE(e,t,n),n;case"#document":case"#document-fragment":{let r="mode"in t&&("quirks"===t.mode||"limited-quirks"===t.mode);if(n={type:"root",children:yv(e,t.childNodes),data:{quirksMode:r}},e.file&&e.location){let t,r,o=String(e.file),i=(t=String(o),r=[],{toOffset:function(e){if(e&&"number"==typeof e.line&&"number"==typeof e.column&&!Number.isNaN(e.line)&&!Number.isNaN(e.column)){for(;r.length<e.line;){let e=r[r.length-1],n=yp(t,e),o=-1===n?t.length+1:n+1;if(e===o)break;r.push(o)}let n=(e.line>1?r[e.line-2]:0)+e.column-1;if(n<r[e.line-1])return n}},toPoint:function(e){if("number"==typeof e&&e>-1&&e<=t.length){let n=0;for(;;){let o=r[n];if(void 0===o){let e=yp(t,r[n-1]);o=-1===e?t.length+1:e+1,r[n]=o}if(o>e)return{line:n+1,column:e-(n>0?r[n-1]:0)+1,offset:e};n++}}}}),s=i.toPoint(0),l=i.toPoint(o.length);bP(s,"expected `start`"),bP(l,"expected `end`"),n.position={start:s,end:l}}return n}case"#documentType":return yE(e,t,n={type:"doctype"}),n;case"#text":return n={type:"text",value:t.value},yE(e,t,n),n;default:return function(e,t){let n=e.schema;e.schema=t.namespaceURI===ym?b7:b9;let r=-1,o={};for(;++r<t.attrs.length;){let e=t.attrs[r],n=(e.prefix?e.prefix+":":"")+e.name;yg.call(yb,n)||(o[n]=e.value)}let i=("svg"===e.schema.space?yh:yu)(t.tagName,o,yv(e,t.childNodes));if(yE(e,t,i),"template"===i.tagName){let n=t.sourceCodeLocation,r=n&&n.startTag&&yk(n.startTag),o=n&&n.endTag&&yk(n.endTag),s=yy(e,t.content);r&&o&&e.file&&(s.position={start:r.end,end:o.start}),i.content=s}return e.schema=n,i}(e,t)}}function yv(e,t){let n=-1,r=[];for(;++n<t.length;){let o=yy(e,t[n]);r.push(o)}return r}function yE(e,t,n){if("sourceCodeLocation"in t&&t.sourceCodeLocation&&e.file){let r=function(e,t,n){let r=yk(n);if("element"===t.type){let o=t.children[t.children.length-1];if(r&&!n.endTag&&o&&o.position&&o.position.end&&(r.end=Object.assign({},o.position.end)),e.verbose){let r,o={};if(n.attrs)for(r in n.attrs)yg.call(n.attrs,r)&&(o[yi(e.schema,r).property]=yk(n.attrs[r]));bP(n.startTag,"a start tag should exist");let i=yk(n.startTag),s=n.endTag?yk(n.endTag):void 0,l={opening:i};s&&(l.closing=s),l.properties=o,t.data={position:l}}}return r}(e,n,t.sourceCodeLocation);r&&(e.location=!0,n.position=r)}}function yk(e){let t=yC({line:e.startLine,column:e.startCol,offset:e.startOffset}),n=yC({line:e.endLine,column:e.endCol,offset:e.endOffset});return t||n?{start:t,end:n}:void 0}function yC(e){return e.line&&e.column?e:void 0}let yT=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]);(f=I||(I={}))[f.EOF=-1]="EOF",f[f.NULL=0]="NULL",f[f.TABULATION=9]="TABULATION",f[f.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",f[f.LINE_FEED=10]="LINE_FEED",f[f.FORM_FEED=12]="FORM_FEED",f[f.SPACE=32]="SPACE",f[f.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",f[f.QUOTATION_MARK=34]="QUOTATION_MARK",f[f.AMPERSAND=38]="AMPERSAND",f[f.APOSTROPHE=39]="APOSTROPHE",f[f.HYPHEN_MINUS=45]="HYPHEN_MINUS",f[f.SOLIDUS=47]="SOLIDUS",f[f.DIGIT_0=48]="DIGIT_0",f[f.DIGIT_9=57]="DIGIT_9",f[f.SEMICOLON=59]="SEMICOLON",f[f.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",f[f.EQUALS_SIGN=61]="EQUALS_SIGN",f[f.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",f[f.QUESTION_MARK=63]="QUESTION_MARK",f[f.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",f[f.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",f[f.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",f[f.GRAVE_ACCENT=96]="GRAVE_ACCENT",f[f.LATIN_SMALL_A=97]="LATIN_SMALL_A",f[f.LATIN_SMALL_Z=122]="LATIN_SMALL_Z";let yw="[CDATA[",yx="doctype",yS="script";function yA(e){return e>=55296&&e<=57343}function y_(e){return 32!==e&&10!==e&&13!==e&&9!==e&&12!==e&&e>=1&&e<=31||e>=127&&e<=159}function yN(e){return e>=64976&&e<=65007||yT.has(e)}(m=O||(O={})).controlCharacterInInputStream="control-character-in-input-stream",m.noncharacterInInputStream="noncharacter-in-input-stream",m.surrogateInInputStream="surrogate-in-input-stream",m.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",m.endTagWithAttributes="end-tag-with-attributes",m.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",m.unexpectedSolidusInTag="unexpected-solidus-in-tag",m.unexpectedNullCharacter="unexpected-null-character",m.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",m.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",m.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",m.missingEndTagName="missing-end-tag-name",m.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",m.unknownNamedCharacterReference="unknown-named-character-reference",m.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",m.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",m.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",m.eofBeforeTagName="eof-before-tag-name",m.eofInTag="eof-in-tag",m.missingAttributeValue="missing-attribute-value",m.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",m.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",m.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",m.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",m.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",m.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",m.missingDoctypePublicIdentifier="missing-doctype-public-identifier",m.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",m.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",m.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",m.cdataInHtmlContent="cdata-in-html-content",m.incorrectlyOpenedComment="incorrectly-opened-comment",m.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",m.eofInDoctype="eof-in-doctype",m.nestedComment="nested-comment",m.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",m.eofInComment="eof-in-comment",m.incorrectlyClosedComment="incorrectly-closed-comment",m.eofInCdata="eof-in-cdata",m.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",m.nullCharacterReference="null-character-reference",m.surrogateCharacterReference="surrogate-character-reference",m.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",m.controlCharacterReference="control-character-reference",m.noncharacterCharacterReference="noncharacter-character-reference",m.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",m.missingDoctypeName="missing-doctype-name",m.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",m.duplicateAttribute="duplicate-attribute",m.nonConformingDoctype="non-conforming-doctype",m.missingDoctype="missing-doctype",m.misplacedDoctype="misplaced-doctype",m.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",m.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",m.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",m.openElementsLeftAfterEof="open-elements-left-after-eof",m.abandonedHeadElementChild="abandoned-head-element-child",m.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",m.nestedNoscriptInHead="nested-noscript-in-head",m.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text";class yM{constructor(e){this.handler=e,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=65536,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+Number(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(e,t){let{line:n,col:r,offset:o}=this,i=r+t,s=o+t;return{code:e,startLine:n,endLine:n,startCol:i,endCol:i,startOffset:s,endOffset:s}}_err(e){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(e,0)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(e){if(this.pos!==this.html.length-1){let t=this.html.charCodeAt(this.pos+1);if(t>=56320&&t<=57343)return this.pos++,this._addGap(),(e-55296)*1024+9216+t}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,I.EOF;return this._err(O.surrogateInInputStream),e}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(e,t){this.html.length>0?this.html+=e:this.html=e,this.endOfChunkHit=!1,this.lastChunkWritten=t}insertHtmlAtCurrentPos(e){this.html=this.html.substring(0,this.pos+1)+e+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(e,t){if(this.pos+e.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(t)return this.html.startsWith(e,this.pos);for(let t=0;t<e.length;t++)if((32|this.html.charCodeAt(this.pos+t))!==e.charCodeAt(t))return!1;return!0}peek(e){let t=this.pos+e;if(t>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,I.EOF;let n=this.html.charCodeAt(t);return n===I.CARRIAGE_RETURN?I.LINE_FEED:n}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,I.EOF;let e=this.html.charCodeAt(this.pos);return e===I.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,I.LINE_FEED):e===I.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,yA(e)&&(e=this._processSurrogate(e)),null===this.handler.onParseError||e>31&&e<127||e===I.LINE_FEED||e===I.CARRIAGE_RETURN||e>159&&e<64976||this._checkForProblematicCharacters(e),e)}_checkForProblematicCharacters(e){y_(e)?this._err(O.controlCharacterInInputStream):yN(e)&&this._err(O.noncharacterInInputStream)}retreat(e){for(this.pos-=e;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}function yI(e,t){for(let n=e.attrs.length-1;n>=0;n--)if(e.attrs[n].name===t)return e.attrs[n].value;return null}(g=D||(D={}))[g.CHARACTER=0]="CHARACTER",g[g.NULL_CHARACTER=1]="NULL_CHARACTER",g[g.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",g[g.START_TAG=3]="START_TAG",g[g.END_TAG=4]="END_TAG",g[g.COMMENT=5]="COMMENT",g[g.DOCTYPE=6]="DOCTYPE",g[g.EOF=7]="EOF",g[g.HIBERNATION=8]="HIBERNATION";let yO=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(e=>e.charCodeAt(0))),yD=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);function yR(e){return e>=L.ZERO&&e<=L.NINE}R=String.fromCodePoint,(b=L||(L={}))[b.NUM=35]="NUM",b[b.SEMI=59]="SEMI",b[b.EQUALS=61]="EQUALS",b[b.ZERO=48]="ZERO",b[b.NINE=57]="NINE",b[b.LOWER_A=97]="LOWER_A",b[b.LOWER_F=102]="LOWER_F",b[b.LOWER_X=120]="LOWER_X",b[b.LOWER_Z=122]="LOWER_Z",b[b.UPPER_A=65]="UPPER_A",b[b.UPPER_F=70]="UPPER_F",b[b.UPPER_Z=90]="UPPER_Z",(y=P||(P={}))[y.VALUE_LENGTH=49152]="VALUE_LENGTH",y[y.BRANCH_LENGTH=16256]="BRANCH_LENGTH",y[y.JUMP_TABLE=127]="JUMP_TABLE",(v=B||(B={}))[v.EntityStart=0]="EntityStart",v[v.NumericStart=1]="NumericStart",v[v.NumericDecimal=2]="NumericDecimal",v[v.NumericHex=3]="NumericHex",v[v.NamedEntity=4]="NamedEntity",(E=H||(H={}))[E.Legacy=0]="Legacy",E[E.Strict=1]="Strict",E[E.Attribute=2]="Attribute";class yL{constructor(e,t,n){this.decodeTree=e,this.emitCodePoint=t,this.errors=n,this.state=B.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=H.Strict}startEntity(e){this.decodeMode=e,this.state=B.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,t){switch(this.state){case B.EntityStart:if(e.charCodeAt(t)===L.NUM)return this.state=B.NumericStart,this.consumed+=1,this.stateNumericStart(e,t+1);return this.state=B.NamedEntity,this.stateNamedEntity(e,t);case B.NumericStart:return this.stateNumericStart(e,t);case B.NumericDecimal:return this.stateNumericDecimal(e,t);case B.NumericHex:return this.stateNumericHex(e,t);case B.NamedEntity:return this.stateNamedEntity(e,t)}}stateNumericStart(e,t){return t>=e.length?-1:(32|e.charCodeAt(t))===L.LOWER_X?(this.state=B.NumericHex,this.consumed+=1,this.stateNumericHex(e,t+1)):(this.state=B.NumericDecimal,this.stateNumericDecimal(e,t))}addToNumericResult(e,t,n,r){if(t!==n){let o=n-t;this.result=this.result*Math.pow(r,o)+Number.parseInt(e.substr(t,o),r),this.consumed+=o}}stateNumericHex(e,t){let n=t;for(;t<e.length;){var r;let o=e.charCodeAt(t);if(!yR(o)&&(!((r=o)>=L.UPPER_A)||!(r<=L.UPPER_F))&&(!(r>=L.LOWER_A)||!(r<=L.LOWER_F)))return this.addToNumericResult(e,n,t,16),this.emitNumericEntity(o,3);t+=1}return this.addToNumericResult(e,n,t,16),-1}stateNumericDecimal(e,t){let n=t;for(;t<e.length;){let r=e.charCodeAt(t);if(!yR(r))return this.addToNumericResult(e,n,t,10),this.emitNumericEntity(r,2);t+=1}return this.addToNumericResult(e,n,t,10),-1}emitNumericEntity(e,t){var n,r,o;if(this.consumed<=t)return null==(n=this.errors)||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===L.SEMI)this.consumed+=1;else if(this.decodeMode===H.Strict)return 0;return this.emitCodePoint((r=this.result)>=55296&&r<=57343||r>1114111?65533:null!=(o=yD.get(r))?o:r,this.consumed),this.errors&&(e!==L.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,t){let{decodeTree:n}=this,r=n[this.treeIndex],o=(r&P.VALUE_LENGTH)>>14;for(;t<e.length;t++,this.excess++){let i=e.charCodeAt(t);if(this.treeIndex=function(e,t,n,r){let o=(t&P.BRANCH_LENGTH)>>7,i=t&P.JUMP_TABLE;if(0===o)return 0!==i&&r===i?n:-1;if(i){let t=r-i;return t<0||t>=o?-1:e[n+t]-1}let s=n,l=s+o-1;for(;s<=l;){let t=s+l>>>1,n=e[t];if(n<r)s=t+1;else{if(!(n>r))return e[t+o];l=t-1}}return -1}(n,r,this.treeIndex+Math.max(1,o),i),this.treeIndex<0)return 0===this.result||this.decodeMode===H.Attribute&&(0===o||function(e){var t;return e===L.EQUALS||(t=e)>=L.UPPER_A&&t<=L.UPPER_Z||t>=L.LOWER_A&&t<=L.LOWER_Z||yR(t)}(i))?0:this.emitNotTerminatedNamedEntity();if(0!=(o=((r=n[this.treeIndex])&P.VALUE_LENGTH)>>14)){if(i===L.SEMI)return this.emitNamedEntityData(this.treeIndex,o,this.consumed+this.excess);this.decodeMode!==H.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return -1}emitNotTerminatedNamedEntity(){var e;let{result:t,decodeTree:n}=this,r=(n[t]&P.VALUE_LENGTH)>>14;return this.emitNamedEntityData(t,r,this.consumed),null==(e=this.errors)||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,t,n){let{decodeTree:r}=this;return this.emitCodePoint(1===t?r[e]&~P.VALUE_LENGTH:r[e+1],n),3===t&&this.emitCodePoint(r[e+2],n),n}end(){var e;switch(this.state){case B.NamedEntity:return 0!==this.result&&(this.decodeMode!==H.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case B.NumericDecimal:return this.emitNumericEntity(0,2);case B.NumericHex:return this.emitNumericEntity(0,3);case B.NumericStart:return null==(e=this.errors)||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case B.EntityStart:return 0}}}(k=j||(j={})).HTML="http://www.w3.org/1999/xhtml",k.MATHML="http://www.w3.org/1998/Math/MathML",k.SVG="http://www.w3.org/2000/svg",k.XLINK="http://www.w3.org/1999/xlink",k.XML="http://www.w3.org/XML/1998/namespace",k.XMLNS="http://www.w3.org/2000/xmlns/",(C=F||(F={})).TYPE="type",C.ACTION="action",C.ENCODING="encoding",C.PROMPT="prompt",C.NAME="name",C.COLOR="color",C.FACE="face",C.SIZE="size",(T=U||(U={})).NO_QUIRKS="no-quirks",T.QUIRKS="quirks",T.LIMITED_QUIRKS="limited-quirks",(w=z||(z={})).A="a",w.ADDRESS="address",w.ANNOTATION_XML="annotation-xml",w.APPLET="applet",w.AREA="area",w.ARTICLE="article",w.ASIDE="aside",w.B="b",w.BASE="base",w.BASEFONT="basefont",w.BGSOUND="bgsound",w.BIG="big",w.BLOCKQUOTE="blockquote",w.BODY="body",w.BR="br",w.BUTTON="button",w.CAPTION="caption",w.CENTER="center",w.CODE="code",w.COL="col",w.COLGROUP="colgroup",w.DD="dd",w.DESC="desc",w.DETAILS="details",w.DIALOG="dialog",w.DIR="dir",w.DIV="div",w.DL="dl",w.DT="dt",w.EM="em",w.EMBED="embed",w.FIELDSET="fieldset",w.FIGCAPTION="figcaption",w.FIGURE="figure",w.FONT="font",w.FOOTER="footer",w.FOREIGN_OBJECT="foreignObject",w.FORM="form",w.FRAME="frame",w.FRAMESET="frameset",w.H1="h1",w.H2="h2",w.H3="h3",w.H4="h4",w.H5="h5",w.H6="h6",w.HEAD="head",w.HEADER="header",w.HGROUP="hgroup",w.HR="hr",w.HTML="html",w.I="i",w.IMG="img",w.IMAGE="image",w.INPUT="input",w.IFRAME="iframe",w.KEYGEN="keygen",w.LABEL="label",w.LI="li",w.LINK="link",w.LISTING="listing",w.MAIN="main",w.MALIGNMARK="malignmark",w.MARQUEE="marquee",w.MATH="math",w.MENU="menu",w.META="meta",w.MGLYPH="mglyph",w.MI="mi",w.MO="mo",w.MN="mn",w.MS="ms",w.MTEXT="mtext",w.NAV="nav",w.NOBR="nobr",w.NOFRAMES="noframes",w.NOEMBED="noembed",w.NOSCRIPT="noscript",w.OBJECT="object",w.OL="ol",w.OPTGROUP="optgroup",w.OPTION="option",w.P="p",w.PARAM="param",w.PLAINTEXT="plaintext",w.PRE="pre",w.RB="rb",w.RP="rp",w.RT="rt",w.RTC="rtc",w.RUBY="ruby",w.S="s",w.SCRIPT="script",w.SEARCH="search",w.SECTION="section",w.SELECT="select",w.SOURCE="source",w.SMALL="small",w.SPAN="span",w.STRIKE="strike",w.STRONG="strong",w.STYLE="style",w.SUB="sub",w.SUMMARY="summary",w.SUP="sup",w.TABLE="table",w.TBODY="tbody",w.TEMPLATE="template",w.TEXTAREA="textarea",w.TFOOT="tfoot",w.TD="td",w.TH="th",w.THEAD="thead",w.TITLE="title",w.TR="tr",w.TRACK="track",w.TT="tt",w.U="u",w.UL="ul",w.SVG="svg",w.VAR="var",w.WBR="wbr",w.XMP="xmp",(x=V||(V={}))[x.UNKNOWN=0]="UNKNOWN",x[x.A=1]="A",x[x.ADDRESS=2]="ADDRESS",x[x.ANNOTATION_XML=3]="ANNOTATION_XML",x[x.APPLET=4]="APPLET",x[x.AREA=5]="AREA",x[x.ARTICLE=6]="ARTICLE",x[x.ASIDE=7]="ASIDE",x[x.B=8]="B",x[x.BASE=9]="BASE",x[x.BASEFONT=10]="BASEFONT",x[x.BGSOUND=11]="BGSOUND",x[x.BIG=12]="BIG",x[x.BLOCKQUOTE=13]="BLOCKQUOTE",x[x.BODY=14]="BODY",x[x.BR=15]="BR",x[x.BUTTON=16]="BUTTON",x[x.CAPTION=17]="CAPTION",x[x.CENTER=18]="CENTER",x[x.CODE=19]="CODE",x[x.COL=20]="COL",x[x.COLGROUP=21]="COLGROUP",x[x.DD=22]="DD",x[x.DESC=23]="DESC",x[x.DETAILS=24]="DETAILS",x[x.DIALOG=25]="DIALOG",x[x.DIR=26]="DIR",x[x.DIV=27]="DIV",x[x.DL=28]="DL",x[x.DT=29]="DT",x[x.EM=30]="EM",x[x.EMBED=31]="EMBED",x[x.FIELDSET=32]="FIELDSET",x[x.FIGCAPTION=33]="FIGCAPTION",x[x.FIGURE=34]="FIGURE",x[x.FONT=35]="FONT",x[x.FOOTER=36]="FOOTER",x[x.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",x[x.FORM=38]="FORM",x[x.FRAME=39]="FRAME",x[x.FRAMESET=40]="FRAMESET",x[x.H1=41]="H1",x[x.H2=42]="H2",x[x.H3=43]="H3",x[x.H4=44]="H4",x[x.H5=45]="H5",x[x.H6=46]="H6",x[x.HEAD=47]="HEAD",x[x.HEADER=48]="HEADER",x[x.HGROUP=49]="HGROUP",x[x.HR=50]="HR",x[x.HTML=51]="HTML",x[x.I=52]="I",x[x.IMG=53]="IMG",x[x.IMAGE=54]="IMAGE",x[x.INPUT=55]="INPUT",x[x.IFRAME=56]="IFRAME",x[x.KEYGEN=57]="KEYGEN",x[x.LABEL=58]="LABEL",x[x.LI=59]="LI",x[x.LINK=60]="LINK",x[x.LISTING=61]="LISTING",x[x.MAIN=62]="MAIN",x[x.MALIGNMARK=63]="MALIGNMARK",x[x.MARQUEE=64]="MARQUEE",x[x.MATH=65]="MATH",x[x.MENU=66]="MENU",x[x.META=67]="META",x[x.MGLYPH=68]="MGLYPH",x[x.MI=69]="MI",x[x.MO=70]="MO",x[x.MN=71]="MN",x[x.MS=72]="MS",x[x.MTEXT=73]="MTEXT",x[x.NAV=74]="NAV",x[x.NOBR=75]="NOBR",x[x.NOFRAMES=76]="NOFRAMES",x[x.NOEMBED=77]="NOEMBED",x[x.NOSCRIPT=78]="NOSCRIPT",x[x.OBJECT=79]="OBJECT",x[x.OL=80]="OL",x[x.OPTGROUP=81]="OPTGROUP",x[x.OPTION=82]="OPTION",x[x.P=83]="P",x[x.PARAM=84]="PARAM",x[x.PLAINTEXT=85]="PLAINTEXT",x[x.PRE=86]="PRE",x[x.RB=87]="RB",x[x.RP=88]="RP",x[x.RT=89]="RT",x[x.RTC=90]="RTC",x[x.RUBY=91]="RUBY",x[x.S=92]="S",x[x.SCRIPT=93]="SCRIPT",x[x.SEARCH=94]="SEARCH",x[x.SECTION=95]="SECTION",x[x.SELECT=96]="SELECT",x[x.SOURCE=97]="SOURCE",x[x.SMALL=98]="SMALL",x[x.SPAN=99]="SPAN",x[x.STRIKE=100]="STRIKE",x[x.STRONG=101]="STRONG",x[x.STYLE=102]="STYLE",x[x.SUB=103]="SUB",x[x.SUMMARY=104]="SUMMARY",x[x.SUP=105]="SUP",x[x.TABLE=106]="TABLE",x[x.TBODY=107]="TBODY",x[x.TEMPLATE=108]="TEMPLATE",x[x.TEXTAREA=109]="TEXTAREA",x[x.TFOOT=110]="TFOOT",x[x.TD=111]="TD",x[x.TH=112]="TH",x[x.THEAD=113]="THEAD",x[x.TITLE=114]="TITLE",x[x.TR=115]="TR",x[x.TRACK=116]="TRACK",x[x.TT=117]="TT",x[x.U=118]="U",x[x.UL=119]="UL",x[x.SVG=120]="SVG",x[x.VAR=121]="VAR",x[x.WBR=122]="WBR",x[x.XMP=123]="XMP";let yP=new Map([[z.A,V.A],[z.ADDRESS,V.ADDRESS],[z.ANNOTATION_XML,V.ANNOTATION_XML],[z.APPLET,V.APPLET],[z.AREA,V.AREA],[z.ARTICLE,V.ARTICLE],[z.ASIDE,V.ASIDE],[z.B,V.B],[z.BASE,V.BASE],[z.BASEFONT,V.BASEFONT],[z.BGSOUND,V.BGSOUND],[z.BIG,V.BIG],[z.BLOCKQUOTE,V.BLOCKQUOTE],[z.BODY,V.BODY],[z.BR,V.BR],[z.BUTTON,V.BUTTON],[z.CAPTION,V.CAPTION],[z.CENTER,V.CENTER],[z.CODE,V.CODE],[z.COL,V.COL],[z.COLGROUP,V.COLGROUP],[z.DD,V.DD],[z.DESC,V.DESC],[z.DETAILS,V.DETAILS],[z.DIALOG,V.DIALOG],[z.DIR,V.DIR],[z.DIV,V.DIV],[z.DL,V.DL],[z.DT,V.DT],[z.EM,V.EM],[z.EMBED,V.EMBED],[z.FIELDSET,V.FIELDSET],[z.FIGCAPTION,V.FIGCAPTION],[z.FIGURE,V.FIGURE],[z.FONT,V.FONT],[z.FOOTER,V.FOOTER],[z.FOREIGN_OBJECT,V.FOREIGN_OBJECT],[z.FORM,V.FORM],[z.FRAME,V.FRAME],[z.FRAMESET,V.FRAMESET],[z.H1,V.H1],[z.H2,V.H2],[z.H3,V.H3],[z.H4,V.H4],[z.H5,V.H5],[z.H6,V.H6],[z.HEAD,V.HEAD],[z.HEADER,V.HEADER],[z.HGROUP,V.HGROUP],[z.HR,V.HR],[z.HTML,V.HTML],[z.I,V.I],[z.IMG,V.IMG],[z.IMAGE,V.IMAGE],[z.INPUT,V.INPUT],[z.IFRAME,V.IFRAME],[z.KEYGEN,V.KEYGEN],[z.LABEL,V.LABEL],[z.LI,V.LI],[z.LINK,V.LINK],[z.LISTING,V.LISTING],[z.MAIN,V.MAIN],[z.MALIGNMARK,V.MALIGNMARK],[z.MARQUEE,V.MARQUEE],[z.MATH,V.MATH],[z.MENU,V.MENU],[z.META,V.META],[z.MGLYPH,V.MGLYPH],[z.MI,V.MI],[z.MO,V.MO],[z.MN,V.MN],[z.MS,V.MS],[z.MTEXT,V.MTEXT],[z.NAV,V.NAV],[z.NOBR,V.NOBR],[z.NOFRAMES,V.NOFRAMES],[z.NOEMBED,V.NOEMBED],[z.NOSCRIPT,V.NOSCRIPT],[z.OBJECT,V.OBJECT],[z.OL,V.OL],[z.OPTGROUP,V.OPTGROUP],[z.OPTION,V.OPTION],[z.P,V.P],[z.PARAM,V.PARAM],[z.PLAINTEXT,V.PLAINTEXT],[z.PRE,V.PRE],[z.RB,V.RB],[z.RP,V.RP],[z.RT,V.RT],[z.RTC,V.RTC],[z.RUBY,V.RUBY],[z.S,V.S],[z.SCRIPT,V.SCRIPT],[z.SEARCH,V.SEARCH],[z.SECTION,V.SECTION],[z.SELECT,V.SELECT],[z.SOURCE,V.SOURCE],[z.SMALL,V.SMALL],[z.SPAN,V.SPAN],[z.STRIKE,V.STRIKE],[z.STRONG,V.STRONG],[z.STYLE,V.STYLE],[z.SUB,V.SUB],[z.SUMMARY,V.SUMMARY],[z.SUP,V.SUP],[z.TABLE,V.TABLE],[z.TBODY,V.TBODY],[z.TEMPLATE,V.TEMPLATE],[z.TEXTAREA,V.TEXTAREA],[z.TFOOT,V.TFOOT],[z.TD,V.TD],[z.TH,V.TH],[z.THEAD,V.THEAD],[z.TITLE,V.TITLE],[z.TR,V.TR],[z.TRACK,V.TRACK],[z.TT,V.TT],[z.U,V.U],[z.UL,V.UL],[z.SVG,V.SVG],[z.VAR,V.VAR],[z.WBR,V.WBR],[z.XMP,V.XMP]]);function yB(e){var t;return null!=(t=yP.get(e))?t:V.UNKNOWN}let yH=V,yj={[j.HTML]:new Set([yH.ADDRESS,yH.APPLET,yH.AREA,yH.ARTICLE,yH.ASIDE,yH.BASE,yH.BASEFONT,yH.BGSOUND,yH.BLOCKQUOTE,yH.BODY,yH.BR,yH.BUTTON,yH.CAPTION,yH.CENTER,yH.COL,yH.COLGROUP,yH.DD,yH.DETAILS,yH.DIR,yH.DIV,yH.DL,yH.DT,yH.EMBED,yH.FIELDSET,yH.FIGCAPTION,yH.FIGURE,yH.FOOTER,yH.FORM,yH.FRAME,yH.FRAMESET,yH.H1,yH.H2,yH.H3,yH.H4,yH.H5,yH.H6,yH.HEAD,yH.HEADER,yH.HGROUP,yH.HR,yH.HTML,yH.IFRAME,yH.IMG,yH.INPUT,yH.LI,yH.LINK,yH.LISTING,yH.MAIN,yH.MARQUEE,yH.MENU,yH.META,yH.NAV,yH.NOEMBED,yH.NOFRAMES,yH.NOSCRIPT,yH.OBJECT,yH.OL,yH.P,yH.PARAM,yH.PLAINTEXT,yH.PRE,yH.SCRIPT,yH.SECTION,yH.SELECT,yH.SOURCE,yH.STYLE,yH.SUMMARY,yH.TABLE,yH.TBODY,yH.TD,yH.TEMPLATE,yH.TEXTAREA,yH.TFOOT,yH.TH,yH.THEAD,yH.TITLE,yH.TR,yH.TRACK,yH.UL,yH.WBR,yH.XMP]),[j.MATHML]:new Set([yH.MI,yH.MO,yH.MN,yH.MS,yH.MTEXT,yH.ANNOTATION_XML]),[j.SVG]:new Set([yH.TITLE,yH.FOREIGN_OBJECT,yH.DESC]),[j.XLINK]:new Set,[j.XML]:new Set,[j.XMLNS]:new Set},yF=new Set([yH.H1,yH.H2,yH.H3,yH.H4,yH.H5,yH.H6]);z.STYLE,z.SCRIPT,z.XMP,z.IFRAME,z.NOEMBED,z.NOFRAMES,z.PLAINTEXT,(S=$||($={}))[S.DATA=0]="DATA",S[S.RCDATA=1]="RCDATA",S[S.RAWTEXT=2]="RAWTEXT",S[S.SCRIPT_DATA=3]="SCRIPT_DATA",S[S.PLAINTEXT=4]="PLAINTEXT",S[S.TAG_OPEN=5]="TAG_OPEN",S[S.END_TAG_OPEN=6]="END_TAG_OPEN",S[S.TAG_NAME=7]="TAG_NAME",S[S.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",S[S.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",S[S.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",S[S.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",S[S.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",S[S.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",S[S.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",S[S.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",S[S.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",S[S.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",S[S.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",S[S.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",S[S.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",S[S.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",S[S.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",S[S.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",S[S.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",S[S.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",S[S.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",S[S.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",S[S.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",S[S.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",S[S.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",S[S.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",S[S.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",S[S.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",S[S.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",S[S.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",S[S.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",S[S.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",S[S.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",S[S.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",S[S.BOGUS_COMMENT=40]="BOGUS_COMMENT",S[S.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",S[S.COMMENT_START=42]="COMMENT_START",S[S.COMMENT_START_DASH=43]="COMMENT_START_DASH",S[S.COMMENT=44]="COMMENT",S[S.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",S[S.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",S[S.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",S[S.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",S[S.COMMENT_END_DASH=49]="COMMENT_END_DASH",S[S.COMMENT_END=50]="COMMENT_END",S[S.COMMENT_END_BANG=51]="COMMENT_END_BANG",S[S.DOCTYPE=52]="DOCTYPE",S[S.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",S[S.DOCTYPE_NAME=54]="DOCTYPE_NAME",S[S.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",S[S.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",S[S.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",S[S.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",S[S.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",S[S.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",S[S.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",S[S.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",S[S.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",S[S.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",S[S.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",S[S.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",S[S.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",S[S.CDATA_SECTION=68]="CDATA_SECTION",S[S.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",S[S.CDATA_SECTION_END=70]="CDATA_SECTION_END",S[S.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",S[S.AMBIGUOUS_AMPERSAND=72]="AMBIGUOUS_AMPERSAND";let yU={DATA:$.DATA,RCDATA:$.RCDATA,RAWTEXT:$.RAWTEXT,SCRIPT_DATA:$.SCRIPT_DATA,PLAINTEXT:$.PLAINTEXT,CDATA_SECTION:$.CDATA_SECTION};function yz(e){return e>=I.LATIN_CAPITAL_A&&e<=I.LATIN_CAPITAL_Z}function yV(e){return e>=I.LATIN_SMALL_A&&e<=I.LATIN_SMALL_Z||yz(e)}function y$(e){return yV(e)||e>=I.DIGIT_0&&e<=I.DIGIT_9}function yG(e){return e===I.SPACE||e===I.LINE_FEED||e===I.TABULATION||e===I.FORM_FEED}function yq(e){return yG(e)||e===I.SOLIDUS||e===I.GREATER_THAN_SIGN}class yW{constructor(e,t){this.options=e,this.handler=t,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=$.DATA,this.returnState=$.DATA,this.entityStartPos=0,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new yM(t),this.currentLocation=this.getCurrentLocation(-1),this.entityDecoder=new yL(yO,(e,t)=>{this.preprocessor.pos=this.entityStartPos+t-1,this._flushCodePointConsumedAsCharacterReference(e)},t.onParseError?{missingSemicolonAfterCharacterReference:()=>{this._err(O.missingSemicolonAfterCharacterReference,1)},absenceOfDigitsInNumericCharacterReference:e=>{this._err(O.absenceOfDigitsInNumericCharacterReference,this.entityStartPos-this.preprocessor.pos+e)},validateNumericCharacterReference:e=>{let t=function(e){if(e===I.NULL)return O.nullCharacterReference;if(e>1114111)return O.characterReferenceOutsideUnicodeRange;if(yA(e))return O.surrogateCharacterReference;if(yN(e))return O.noncharacterCharacterReference;if(y_(e)||e===I.CARRIAGE_RETURN)return O.controlCharacterReference;return null}(e);t&&this._err(t,1)}}:void 0)}_err(e,t=0){var n,r;null==(r=(n=this.handler).onParseError)||r.call(n,this.preprocessor.getError(e,t))}getCurrentLocation(e){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-e,startOffset:this.preprocessor.offset-e,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;let e=this._consume();this._ensureHibernation()||this._callState(e)}this.inLoop=!1}}pause(){this.paused=!0}resume(e){if(!this.paused)throw Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||null==e||e())}write(e,t,n){this.active=!0,this.preprocessor.write(e,t),this._runParsingLoop(),this.paused||null==n||n()}insertHtmlAtCurrentPos(e){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(e),this._runParsingLoop()}_ensureHibernation(){return!!this.preprocessor.endOfChunkHit&&(this.preprocessor.retreat(this.consumedAfterSnapshot),this.consumedAfterSnapshot=0,this.active=!1,!0)}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_advanceBy(e){this.consumedAfterSnapshot+=e;for(let t=0;t<e;t++)this.preprocessor.advance()}_consumeSequenceIfMatch(e,t){return!!this.preprocessor.startsWith(e,t)&&(this._advanceBy(e.length-1),!0)}_createStartTagToken(){this.currentToken={type:D.START_TAG,tagName:"",tagID:V.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:D.END_TAG,tagName:"",tagID:V.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(e){this.currentToken={type:D.COMMENT,data:"",location:this.getCurrentLocation(e)}}_createDoctypeToken(e){this.currentToken={type:D.DOCTYPE,name:e,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(e,t){this.currentCharacterToken={type:e,chars:t,location:this.currentLocation}}_createAttr(e){this.currentAttr={name:e,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var e,t;let n=this.currentToken;null===yI(n,this.currentAttr.name)?(n.attrs.push(this.currentAttr),n.location&&this.currentLocation&&((null!=(e=(t=n.location).attrs)?e:t.attrs=Object.create(null))[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue())):this._err(O.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(e){this._emitCurrentCharacterToken(e.location),this.currentToken=null,e.location&&(e.location.endLine=this.preprocessor.line,e.location.endCol=this.preprocessor.col+1,e.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){let e=this.currentToken;this.prepareToken(e),e.tagID=yB(e.tagName),e.type===D.START_TAG?(this.lastStartTagName=e.tagName,this.handler.onStartTag(e)):(e.attrs.length>0&&this._err(O.endTagWithAttributes),e.selfClosing&&this._err(O.endTagWithTrailingSolidus),this.handler.onEndTag(e)),this.preprocessor.dropParsedChunk()}emitCurrentComment(e){this.prepareToken(e),this.handler.onComment(e),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(e){this.prepareToken(e),this.handler.onDoctype(e),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(e){if(this.currentCharacterToken){switch(e&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=e.startLine,this.currentCharacterToken.location.endCol=e.startCol,this.currentCharacterToken.location.endOffset=e.startOffset),this.currentCharacterToken.type){case D.CHARACTER:this.handler.onCharacter(this.currentCharacterToken);break;case D.NULL_CHARACTER:this.handler.onNullCharacter(this.currentCharacterToken);break;case D.WHITESPACE_CHARACTER:this.handler.onWhitespaceCharacter(this.currentCharacterToken)}this.currentCharacterToken=null}}_emitEOFToken(){let e=this.getCurrentLocation(0);e&&(e.endLine=e.startLine,e.endCol=e.startCol,e.endOffset=e.startOffset),this._emitCurrentCharacterToken(e),this.handler.onEof({type:D.EOF,location:e}),this.active=!1}_appendCharToCurrentCharacterToken(e,t){if(this.currentCharacterToken)if(this.currentCharacterToken.type===e){this.currentCharacterToken.chars+=t;return}else this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();this._createCharacterToken(e,t)}_emitCodePoint(e){let t=yG(e)?D.WHITESPACE_CHARACTER:e===I.NULL?D.NULL_CHARACTER:D.CHARACTER;this._appendCharToCurrentCharacterToken(t,String.fromCodePoint(e))}_emitChars(e){this._appendCharToCurrentCharacterToken(D.CHARACTER,e)}_startCharacterReference(){this.returnState=this.state,this.state=$.CHARACTER_REFERENCE,this.entityStartPos=this.preprocessor.pos,this.entityDecoder.startEntity(this._isCharacterReferenceInAttribute()?H.Attribute:H.Legacy)}_isCharacterReferenceInAttribute(){return this.returnState===$.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===$.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===$.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(e){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(e):this._emitCodePoint(e)}_callState(e){switch(this.state){case $.DATA:this._stateData(e);break;case $.RCDATA:this._stateRcdata(e);break;case $.RAWTEXT:this._stateRawtext(e);break;case $.SCRIPT_DATA:this._stateScriptData(e);break;case $.PLAINTEXT:this._statePlaintext(e);break;case $.TAG_OPEN:this._stateTagOpen(e);break;case $.END_TAG_OPEN:this._stateEndTagOpen(e);break;case $.TAG_NAME:this._stateTagName(e);break;case $.RCDATA_LESS_THAN_SIGN:this._stateRcdataLessThanSign(e);break;case $.RCDATA_END_TAG_OPEN:this._stateRcdataEndTagOpen(e);break;case $.RCDATA_END_TAG_NAME:this._stateRcdataEndTagName(e);break;case $.RAWTEXT_LESS_THAN_SIGN:this._stateRawtextLessThanSign(e);break;case $.RAWTEXT_END_TAG_OPEN:this._stateRawtextEndTagOpen(e);break;case $.RAWTEXT_END_TAG_NAME:this._stateRawtextEndTagName(e);break;case $.SCRIPT_DATA_LESS_THAN_SIGN:this._stateScriptDataLessThanSign(e);break;case $.SCRIPT_DATA_END_TAG_OPEN:this._stateScriptDataEndTagOpen(e);break;case $.SCRIPT_DATA_END_TAG_NAME:this._stateScriptDataEndTagName(e);break;case $.SCRIPT_DATA_ESCAPE_START:this._stateScriptDataEscapeStart(e);break;case $.SCRIPT_DATA_ESCAPE_START_DASH:this._stateScriptDataEscapeStartDash(e);break;case $.SCRIPT_DATA_ESCAPED:this._stateScriptDataEscaped(e);break;case $.SCRIPT_DATA_ESCAPED_DASH:this._stateScriptDataEscapedDash(e);break;case $.SCRIPT_DATA_ESCAPED_DASH_DASH:this._stateScriptDataEscapedDashDash(e);break;case $.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:this._stateScriptDataEscapedLessThanSign(e);break;case $.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:this._stateScriptDataEscapedEndTagOpen(e);break;case $.SCRIPT_DATA_ESCAPED_END_TAG_NAME:this._stateScriptDataEscapedEndTagName(e);break;case $.SCRIPT_DATA_DOUBLE_ESCAPE_START:this._stateScriptDataDoubleEscapeStart(e);break;case $.SCRIPT_DATA_DOUBLE_ESCAPED:this._stateScriptDataDoubleEscaped(e);break;case $.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:this._stateScriptDataDoubleEscapedDash(e);break;case $.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:this._stateScriptDataDoubleEscapedDashDash(e);break;case $.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:this._stateScriptDataDoubleEscapedLessThanSign(e);break;case $.SCRIPT_DATA_DOUBLE_ESCAPE_END:this._stateScriptDataDoubleEscapeEnd(e);break;case $.BEFORE_ATTRIBUTE_NAME:this._stateBeforeAttributeName(e);break;case $.ATTRIBUTE_NAME:this._stateAttributeName(e);break;case $.AFTER_ATTRIBUTE_NAME:this._stateAfterAttributeName(e);break;case $.BEFORE_ATTRIBUTE_VALUE:this._stateBeforeAttributeValue(e);break;case $.ATTRIBUTE_VALUE_DOUBLE_QUOTED:this._stateAttributeValueDoubleQuoted(e);break;case $.ATTRIBUTE_VALUE_SINGLE_QUOTED:this._stateAttributeValueSingleQuoted(e);break;case $.ATTRIBUTE_VALUE_UNQUOTED:this._stateAttributeValueUnquoted(e);break;case $.AFTER_ATTRIBUTE_VALUE_QUOTED:this._stateAfterAttributeValueQuoted(e);break;case $.SELF_CLOSING_START_TAG:this._stateSelfClosingStartTag(e);break;case $.BOGUS_COMMENT:this._stateBogusComment(e);break;case $.MARKUP_DECLARATION_OPEN:this._stateMarkupDeclarationOpen(e);break;case $.COMMENT_START:this._stateCommentStart(e);break;case $.COMMENT_START_DASH:this._stateCommentStartDash(e);break;case $.COMMENT:this._stateComment(e);break;case $.COMMENT_LESS_THAN_SIGN:this._stateCommentLessThanSign(e);break;case $.COMMENT_LESS_THAN_SIGN_BANG:this._stateCommentLessThanSignBang(e);break;case $.COMMENT_LESS_THAN_SIGN_BANG_DASH:this._stateCommentLessThanSignBangDash(e);break;case $.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:this._stateCommentLessThanSignBangDashDash(e);break;case $.COMMENT_END_DASH:this._stateCommentEndDash(e);break;case $.COMMENT_END:this._stateCommentEnd(e);break;case $.COMMENT_END_BANG:this._stateCommentEndBang(e);break;case $.DOCTYPE:this._stateDoctype(e);break;case $.BEFORE_DOCTYPE_NAME:this._stateBeforeDoctypeName(e);break;case $.DOCTYPE_NAME:this._stateDoctypeName(e);break;case $.AFTER_DOCTYPE_NAME:this._stateAfterDoctypeName(e);break;case $.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._stateAfterDoctypePublicKeyword(e);break;case $.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:this._stateBeforeDoctypePublicIdentifier(e);break;case $.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:this._stateDoctypePublicIdentifierDoubleQuoted(e);break;case $.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:this._stateDoctypePublicIdentifierSingleQuoted(e);break;case $.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:this._stateAfterDoctypePublicIdentifier(e);break;case $.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:this._stateBetweenDoctypePublicAndSystemIdentifiers(e);break;case $.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._stateAfterDoctypeSystemKeyword(e);break;case $.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:this._stateBeforeDoctypeSystemIdentifier(e);break;case $.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:this._stateDoctypeSystemIdentifierDoubleQuoted(e);break;case $.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:this._stateDoctypeSystemIdentifierSingleQuoted(e);break;case $.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:this._stateAfterDoctypeSystemIdentifier(e);break;case $.BOGUS_DOCTYPE:this._stateBogusDoctype(e);break;case $.CDATA_SECTION:this._stateCdataSection(e);break;case $.CDATA_SECTION_BRACKET:this._stateCdataSectionBracket(e);break;case $.CDATA_SECTION_END:this._stateCdataSectionEnd(e);break;case $.CHARACTER_REFERENCE:this._stateCharacterReference();break;case $.AMBIGUOUS_AMPERSAND:this._stateAmbiguousAmpersand(e);break;default:throw Error("Unknown state")}}_stateData(e){switch(e){case I.LESS_THAN_SIGN:this.state=$.TAG_OPEN;break;case I.AMPERSAND:this._startCharacterReference();break;case I.NULL:this._err(O.unexpectedNullCharacter),this._emitCodePoint(e);break;case I.EOF:this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateRcdata(e){switch(e){case I.AMPERSAND:this._startCharacterReference();break;case I.LESS_THAN_SIGN:this.state=$.RCDATA_LESS_THAN_SIGN;break;case I.NULL:this._err(O.unexpectedNullCharacter),this._emitChars("");break;case I.EOF:this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateRawtext(e){switch(e){case I.LESS_THAN_SIGN:this.state=$.RAWTEXT_LESS_THAN_SIGN;break;case I.NULL:this._err(O.unexpectedNullCharacter),this._emitChars("");break;case I.EOF:this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateScriptData(e){switch(e){case I.LESS_THAN_SIGN:this.state=$.SCRIPT_DATA_LESS_THAN_SIGN;break;case I.NULL:this._err(O.unexpectedNullCharacter),this._emitChars("");break;case I.EOF:this._emitEOFToken();break;default:this._emitCodePoint(e)}}_statePlaintext(e){switch(e){case I.NULL:this._err(O.unexpectedNullCharacter),this._emitChars("");break;case I.EOF:this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateTagOpen(e){if(yV(e))this._createStartTagToken(),this.state=$.TAG_NAME,this._stateTagName(e);else switch(e){case I.EXCLAMATION_MARK:this.state=$.MARKUP_DECLARATION_OPEN;break;case I.SOLIDUS:this.state=$.END_TAG_OPEN;break;case I.QUESTION_MARK:this._err(O.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=$.BOGUS_COMMENT,this._stateBogusComment(e);break;case I.EOF:this._err(O.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break;default:this._err(O.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=$.DATA,this._stateData(e)}}_stateEndTagOpen(e){if(yV(e))this._createEndTagToken(),this.state=$.TAG_NAME,this._stateTagName(e);else switch(e){case I.GREATER_THAN_SIGN:this._err(O.missingEndTagName),this.state=$.DATA;break;case I.EOF:this._err(O.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break;default:this._err(O.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=$.BOGUS_COMMENT,this._stateBogusComment(e)}}_stateTagName(e){let t=this.currentToken;switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:this.state=$.BEFORE_ATTRIBUTE_NAME;break;case I.SOLIDUS:this.state=$.SELF_CLOSING_START_TAG;break;case I.GREATER_THAN_SIGN:this.state=$.DATA,this.emitCurrentTagToken();break;case I.NULL:this._err(O.unexpectedNullCharacter),t.tagName+="";break;case I.EOF:this._err(O.eofInTag),this._emitEOFToken();break;default:t.tagName+=String.fromCodePoint(yz(e)?e+32:e)}}_stateRcdataLessThanSign(e){e===I.SOLIDUS?this.state=$.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=$.RCDATA,this._stateRcdata(e))}_stateRcdataEndTagOpen(e){yV(e)?(this.state=$.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(e)):(this._emitChars("</"),this.state=$.RCDATA,this._stateRcdata(e))}handleSpecialEndTag(e){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();switch(this._createEndTagToken(),this.currentToken.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=$.BEFORE_ATTRIBUTE_NAME,!1;case I.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=$.SELF_CLOSING_START_TAG,!1;case I.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=$.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=$.RCDATA,this._stateRcdata(e))}_stateRawtextLessThanSign(e){e===I.SOLIDUS?this.state=$.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=$.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagOpen(e){yV(e)?(this.state=$.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(e)):(this._emitChars("</"),this.state=$.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=$.RAWTEXT,this._stateRawtext(e))}_stateScriptDataLessThanSign(e){switch(e){case I.SOLIDUS:this.state=$.SCRIPT_DATA_END_TAG_OPEN;break;case I.EXCLAMATION_MARK:this.state=$.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break;default:this._emitChars("<"),this.state=$.SCRIPT_DATA,this._stateScriptData(e)}}_stateScriptDataEndTagOpen(e){yV(e)?(this.state=$.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(e)):(this._emitChars("</"),this.state=$.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=$.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStart(e){e===I.HYPHEN_MINUS?(this.state=$.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=$.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStartDash(e){e===I.HYPHEN_MINUS?(this.state=$.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=$.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscaped(e){switch(e){case I.HYPHEN_MINUS:this.state=$.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break;case I.LESS_THAN_SIGN:this.state=$.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break;case I.NULL:this._err(O.unexpectedNullCharacter),this._emitChars("");break;case I.EOF:this._err(O.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateScriptDataEscapedDash(e){switch(e){case I.HYPHEN_MINUS:this.state=$.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break;case I.LESS_THAN_SIGN:this.state=$.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break;case I.NULL:this._err(O.unexpectedNullCharacter),this.state=$.SCRIPT_DATA_ESCAPED,this._emitChars("");break;case I.EOF:this._err(O.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break;default:this.state=$.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedDashDash(e){switch(e){case I.HYPHEN_MINUS:this._emitChars("-");break;case I.LESS_THAN_SIGN:this.state=$.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break;case I.GREATER_THAN_SIGN:this.state=$.SCRIPT_DATA,this._emitChars(">");break;case I.NULL:this._err(O.unexpectedNullCharacter),this.state=$.SCRIPT_DATA_ESCAPED,this._emitChars("");break;case I.EOF:this._err(O.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break;default:this.state=$.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedLessThanSign(e){e===I.SOLIDUS?this.state=$.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:yV(e)?(this._emitChars("<"),this.state=$.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(e)):(this._emitChars("<"),this.state=$.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagOpen(e){yV(e)?(this.state=$.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(e)):(this._emitChars("</"),this.state=$.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=$.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscapeStart(e){if(this.preprocessor.startsWith(yS,!1)&&yq(this.preprocessor.peek(yS.length))){this._emitCodePoint(e);for(let e=0;e<yS.length;e++)this._emitCodePoint(this._consume());this.state=$.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=$.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscaped(e){switch(e){case I.HYPHEN_MINUS:this.state=$.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break;case I.LESS_THAN_SIGN:this.state=$.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break;case I.NULL:this._err(O.unexpectedNullCharacter),this._emitChars("");break;case I.EOF:this._err(O.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDash(e){switch(e){case I.HYPHEN_MINUS:this.state=$.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break;case I.LESS_THAN_SIGN:this.state=$.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break;case I.NULL:this._err(O.unexpectedNullCharacter),this.state=$.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars("");break;case I.EOF:this._err(O.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break;default:this.state=$.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDashDash(e){switch(e){case I.HYPHEN_MINUS:this._emitChars("-");break;case I.LESS_THAN_SIGN:this.state=$.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break;case I.GREATER_THAN_SIGN:this.state=$.SCRIPT_DATA,this._emitChars(">");break;case I.NULL:this._err(O.unexpectedNullCharacter),this.state=$.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars("");break;case I.EOF:this._err(O.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break;default:this.state=$.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedLessThanSign(e){e===I.SOLIDUS?(this.state=$.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=$.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateScriptDataDoubleEscapeEnd(e){if(this.preprocessor.startsWith(yS,!1)&&yq(this.preprocessor.peek(yS.length))){this._emitCodePoint(e);for(let e=0;e<yS.length;e++)this._emitCodePoint(this._consume());this.state=$.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=$.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateBeforeAttributeName(e){switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:break;case I.SOLIDUS:case I.GREATER_THAN_SIGN:case I.EOF:this.state=$.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break;case I.EQUALS_SIGN:this._err(O.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=$.ATTRIBUTE_NAME;break;default:this._createAttr(""),this.state=$.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateAttributeName(e){switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:case I.SOLIDUS:case I.GREATER_THAN_SIGN:case I.EOF:this._leaveAttrName(),this.state=$.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break;case I.EQUALS_SIGN:this._leaveAttrName(),this.state=$.BEFORE_ATTRIBUTE_VALUE;break;case I.QUOTATION_MARK:case I.APOSTROPHE:case I.LESS_THAN_SIGN:this._err(O.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(e);break;case I.NULL:this._err(O.unexpectedNullCharacter),this.currentAttr.name+="";break;default:this.currentAttr.name+=String.fromCodePoint(yz(e)?e+32:e)}}_stateAfterAttributeName(e){switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:break;case I.SOLIDUS:this.state=$.SELF_CLOSING_START_TAG;break;case I.EQUALS_SIGN:this.state=$.BEFORE_ATTRIBUTE_VALUE;break;case I.GREATER_THAN_SIGN:this.state=$.DATA,this.emitCurrentTagToken();break;case I.EOF:this._err(O.eofInTag),this._emitEOFToken();break;default:this._createAttr(""),this.state=$.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateBeforeAttributeValue(e){switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:break;case I.QUOTATION_MARK:this.state=$.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break;case I.APOSTROPHE:this.state=$.ATTRIBUTE_VALUE_SINGLE_QUOTED;break;case I.GREATER_THAN_SIGN:this._err(O.missingAttributeValue),this.state=$.DATA,this.emitCurrentTagToken();break;default:this.state=$.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(e)}}_stateAttributeValueDoubleQuoted(e){switch(e){case I.QUOTATION_MARK:this.state=$.AFTER_ATTRIBUTE_VALUE_QUOTED;break;case I.AMPERSAND:this._startCharacterReference();break;case I.NULL:this._err(O.unexpectedNullCharacter),this.currentAttr.value+="";break;case I.EOF:this._err(O.eofInTag),this._emitEOFToken();break;default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueSingleQuoted(e){switch(e){case I.APOSTROPHE:this.state=$.AFTER_ATTRIBUTE_VALUE_QUOTED;break;case I.AMPERSAND:this._startCharacterReference();break;case I.NULL:this._err(O.unexpectedNullCharacter),this.currentAttr.value+="";break;case I.EOF:this._err(O.eofInTag),this._emitEOFToken();break;default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueUnquoted(e){switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:this._leaveAttrValue(),this.state=$.BEFORE_ATTRIBUTE_NAME;break;case I.AMPERSAND:this._startCharacterReference();break;case I.GREATER_THAN_SIGN:this._leaveAttrValue(),this.state=$.DATA,this.emitCurrentTagToken();break;case I.NULL:this._err(O.unexpectedNullCharacter),this.currentAttr.value+="";break;case I.QUOTATION_MARK:case I.APOSTROPHE:case I.LESS_THAN_SIGN:case I.EQUALS_SIGN:case I.GRAVE_ACCENT:this._err(O.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(e);break;case I.EOF:this._err(O.eofInTag),this._emitEOFToken();break;default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAfterAttributeValueQuoted(e){switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:this._leaveAttrValue(),this.state=$.BEFORE_ATTRIBUTE_NAME;break;case I.SOLIDUS:this._leaveAttrValue(),this.state=$.SELF_CLOSING_START_TAG;break;case I.GREATER_THAN_SIGN:this._leaveAttrValue(),this.state=$.DATA,this.emitCurrentTagToken();break;case I.EOF:this._err(O.eofInTag),this._emitEOFToken();break;default:this._err(O.missingWhitespaceBetweenAttributes),this.state=$.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateSelfClosingStartTag(e){switch(e){case I.GREATER_THAN_SIGN:this.currentToken.selfClosing=!0,this.state=$.DATA,this.emitCurrentTagToken();break;case I.EOF:this._err(O.eofInTag),this._emitEOFToken();break;default:this._err(O.unexpectedSolidusInTag),this.state=$.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateBogusComment(e){let t=this.currentToken;switch(e){case I.GREATER_THAN_SIGN:this.state=$.DATA,this.emitCurrentComment(t);break;case I.EOF:this.emitCurrentComment(t),this._emitEOFToken();break;case I.NULL:this._err(O.unexpectedNullCharacter),t.data+="";break;default:t.data+=String.fromCodePoint(e)}}_stateMarkupDeclarationOpen(e){this._consumeSequenceIfMatch("--",!0)?(this._createCommentToken(3),this.state=$.COMMENT_START):this._consumeSequenceIfMatch(yx,!1)?(this.currentLocation=this.getCurrentLocation(yx.length+1),this.state=$.DOCTYPE):this._consumeSequenceIfMatch(yw,!0)?this.inForeignNode?this.state=$.CDATA_SECTION:(this._err(O.cdataInHtmlContent),this._createCommentToken(yw.length+1),this.currentToken.data="[CDATA[",this.state=$.BOGUS_COMMENT):this._ensureHibernation()||(this._err(O.incorrectlyOpenedComment),this._createCommentToken(2),this.state=$.BOGUS_COMMENT,this._stateBogusComment(e))}_stateCommentStart(e){switch(e){case I.HYPHEN_MINUS:this.state=$.COMMENT_START_DASH;break;case I.GREATER_THAN_SIGN:{this._err(O.abruptClosingOfEmptyComment),this.state=$.DATA;let e=this.currentToken;this.emitCurrentComment(e);break}default:this.state=$.COMMENT,this._stateComment(e)}}_stateCommentStartDash(e){let t=this.currentToken;switch(e){case I.HYPHEN_MINUS:this.state=$.COMMENT_END;break;case I.GREATER_THAN_SIGN:this._err(O.abruptClosingOfEmptyComment),this.state=$.DATA,this.emitCurrentComment(t);break;case I.EOF:this._err(O.eofInComment),this.emitCurrentComment(t),this._emitEOFToken();break;default:t.data+="-",this.state=$.COMMENT,this._stateComment(e)}}_stateComment(e){let t=this.currentToken;switch(e){case I.HYPHEN_MINUS:this.state=$.COMMENT_END_DASH;break;case I.LESS_THAN_SIGN:t.data+="<",this.state=$.COMMENT_LESS_THAN_SIGN;break;case I.NULL:this._err(O.unexpectedNullCharacter),t.data+="";break;case I.EOF:this._err(O.eofInComment),this.emitCurrentComment(t),this._emitEOFToken();break;default:t.data+=String.fromCodePoint(e)}}_stateCommentLessThanSign(e){let t=this.currentToken;switch(e){case I.EXCLAMATION_MARK:t.data+="!",this.state=$.COMMENT_LESS_THAN_SIGN_BANG;break;case I.LESS_THAN_SIGN:t.data+="<";break;default:this.state=$.COMMENT,this._stateComment(e)}}_stateCommentLessThanSignBang(e){e===I.HYPHEN_MINUS?this.state=$.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=$.COMMENT,this._stateComment(e))}_stateCommentLessThanSignBangDash(e){e===I.HYPHEN_MINUS?this.state=$.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=$.COMMENT_END_DASH,this._stateCommentEndDash(e))}_stateCommentLessThanSignBangDashDash(e){e!==I.GREATER_THAN_SIGN&&e!==I.EOF&&this._err(O.nestedComment),this.state=$.COMMENT_END,this._stateCommentEnd(e)}_stateCommentEndDash(e){let t=this.currentToken;switch(e){case I.HYPHEN_MINUS:this.state=$.COMMENT_END;break;case I.EOF:this._err(O.eofInComment),this.emitCurrentComment(t),this._emitEOFToken();break;default:t.data+="-",this.state=$.COMMENT,this._stateComment(e)}}_stateCommentEnd(e){let t=this.currentToken;switch(e){case I.GREATER_THAN_SIGN:this.state=$.DATA,this.emitCurrentComment(t);break;case I.EXCLAMATION_MARK:this.state=$.COMMENT_END_BANG;break;case I.HYPHEN_MINUS:t.data+="-";break;case I.EOF:this._err(O.eofInComment),this.emitCurrentComment(t),this._emitEOFToken();break;default:t.data+="--",this.state=$.COMMENT,this._stateComment(e)}}_stateCommentEndBang(e){let t=this.currentToken;switch(e){case I.HYPHEN_MINUS:t.data+="--!",this.state=$.COMMENT_END_DASH;break;case I.GREATER_THAN_SIGN:this._err(O.incorrectlyClosedComment),this.state=$.DATA,this.emitCurrentComment(t);break;case I.EOF:this._err(O.eofInComment),this.emitCurrentComment(t),this._emitEOFToken();break;default:t.data+="--!",this.state=$.COMMENT,this._stateComment(e)}}_stateDoctype(e){switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:this.state=$.BEFORE_DOCTYPE_NAME;break;case I.GREATER_THAN_SIGN:this.state=$.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e);break;case I.EOF:{this._err(O.eofInDoctype),this._createDoctypeToken(null);let e=this.currentToken;e.forceQuirks=!0,this.emitCurrentDoctype(e),this._emitEOFToken();break}default:this._err(O.missingWhitespaceBeforeDoctypeName),this.state=$.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e)}}_stateBeforeDoctypeName(e){if(yz(e))this._createDoctypeToken(String.fromCharCode(e+32)),this.state=$.DOCTYPE_NAME;else switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:break;case I.NULL:this._err(O.unexpectedNullCharacter),this._createDoctypeToken(""),this.state=$.DOCTYPE_NAME;break;case I.GREATER_THAN_SIGN:{this._err(O.missingDoctypeName),this._createDoctypeToken(null);let e=this.currentToken;e.forceQuirks=!0,this.emitCurrentDoctype(e),this.state=$.DATA;break}case I.EOF:{this._err(O.eofInDoctype),this._createDoctypeToken(null);let e=this.currentToken;e.forceQuirks=!0,this.emitCurrentDoctype(e),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(e)),this.state=$.DOCTYPE_NAME}}_stateDoctypeName(e){let t=this.currentToken;switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:this.state=$.AFTER_DOCTYPE_NAME;break;case I.GREATER_THAN_SIGN:this.state=$.DATA,this.emitCurrentDoctype(t);break;case I.NULL:this._err(O.unexpectedNullCharacter),t.name+="";break;case I.EOF:this._err(O.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:t.name+=String.fromCodePoint(yz(e)?e+32:e)}}_stateAfterDoctypeName(e){let t=this.currentToken;switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:break;case I.GREATER_THAN_SIGN:this.state=$.DATA,this.emitCurrentDoctype(t);break;case I.EOF:this._err(O.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:this._consumeSequenceIfMatch("public",!1)?this.state=$.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch("system",!1)?this.state=$.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(O.invalidCharacterSequenceAfterDoctypeName),t.forceQuirks=!0,this.state=$.BOGUS_DOCTYPE,this._stateBogusDoctype(e))}}_stateAfterDoctypePublicKeyword(e){let t=this.currentToken;switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:this.state=$.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break;case I.QUOTATION_MARK:this._err(O.missingWhitespaceAfterDoctypePublicKeyword),t.publicId="",this.state=$.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break;case I.APOSTROPHE:this._err(O.missingWhitespaceAfterDoctypePublicKeyword),t.publicId="",this.state=$.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break;case I.GREATER_THAN_SIGN:this._err(O.missingDoctypePublicIdentifier),t.forceQuirks=!0,this.state=$.DATA,this.emitCurrentDoctype(t);break;case I.EOF:this._err(O.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:this._err(O.missingQuoteBeforeDoctypePublicIdentifier),t.forceQuirks=!0,this.state=$.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypePublicIdentifier(e){let t=this.currentToken;switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:break;case I.QUOTATION_MARK:t.publicId="",this.state=$.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break;case I.APOSTROPHE:t.publicId="",this.state=$.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break;case I.GREATER_THAN_SIGN:this._err(O.missingDoctypePublicIdentifier),t.forceQuirks=!0,this.state=$.DATA,this.emitCurrentDoctype(t);break;case I.EOF:this._err(O.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:this._err(O.missingQuoteBeforeDoctypePublicIdentifier),t.forceQuirks=!0,this.state=$.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypePublicIdentifierDoubleQuoted(e){let t=this.currentToken;switch(e){case I.QUOTATION_MARK:this.state=$.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break;case I.NULL:this._err(O.unexpectedNullCharacter),t.publicId+="";break;case I.GREATER_THAN_SIGN:this._err(O.abruptDoctypePublicIdentifier),t.forceQuirks=!0,this.emitCurrentDoctype(t),this.state=$.DATA;break;case I.EOF:this._err(O.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:t.publicId+=String.fromCodePoint(e)}}_stateDoctypePublicIdentifierSingleQuoted(e){let t=this.currentToken;switch(e){case I.APOSTROPHE:this.state=$.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break;case I.NULL:this._err(O.unexpectedNullCharacter),t.publicId+="";break;case I.GREATER_THAN_SIGN:this._err(O.abruptDoctypePublicIdentifier),t.forceQuirks=!0,this.emitCurrentDoctype(t),this.state=$.DATA;break;case I.EOF:this._err(O.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:t.publicId+=String.fromCodePoint(e)}}_stateAfterDoctypePublicIdentifier(e){let t=this.currentToken;switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:this.state=$.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break;case I.GREATER_THAN_SIGN:this.state=$.DATA,this.emitCurrentDoctype(t);break;case I.QUOTATION_MARK:this._err(O.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),t.systemId="",this.state=$.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break;case I.APOSTROPHE:this._err(O.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),t.systemId="",this.state=$.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break;case I.EOF:this._err(O.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:this._err(O.missingQuoteBeforeDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=$.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBetweenDoctypePublicAndSystemIdentifiers(e){let t=this.currentToken;switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:break;case I.GREATER_THAN_SIGN:this.emitCurrentDoctype(t),this.state=$.DATA;break;case I.QUOTATION_MARK:t.systemId="",this.state=$.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break;case I.APOSTROPHE:t.systemId="",this.state=$.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break;case I.EOF:this._err(O.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:this._err(O.missingQuoteBeforeDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=$.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateAfterDoctypeSystemKeyword(e){let t=this.currentToken;switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:this.state=$.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break;case I.QUOTATION_MARK:this._err(O.missingWhitespaceAfterDoctypeSystemKeyword),t.systemId="",this.state=$.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break;case I.APOSTROPHE:this._err(O.missingWhitespaceAfterDoctypeSystemKeyword),t.systemId="",this.state=$.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break;case I.GREATER_THAN_SIGN:this._err(O.missingDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=$.DATA,this.emitCurrentDoctype(t);break;case I.EOF:this._err(O.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:this._err(O.missingQuoteBeforeDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=$.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypeSystemIdentifier(e){let t=this.currentToken;switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:break;case I.QUOTATION_MARK:t.systemId="",this.state=$.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break;case I.APOSTROPHE:t.systemId="",this.state=$.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break;case I.GREATER_THAN_SIGN:this._err(O.missingDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=$.DATA,this.emitCurrentDoctype(t);break;case I.EOF:this._err(O.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:this._err(O.missingQuoteBeforeDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=$.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypeSystemIdentifierDoubleQuoted(e){let t=this.currentToken;switch(e){case I.QUOTATION_MARK:this.state=$.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break;case I.NULL:this._err(O.unexpectedNullCharacter),t.systemId+="";break;case I.GREATER_THAN_SIGN:this._err(O.abruptDoctypeSystemIdentifier),t.forceQuirks=!0,this.emitCurrentDoctype(t),this.state=$.DATA;break;case I.EOF:this._err(O.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:t.systemId+=String.fromCodePoint(e)}}_stateDoctypeSystemIdentifierSingleQuoted(e){let t=this.currentToken;switch(e){case I.APOSTROPHE:this.state=$.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break;case I.NULL:this._err(O.unexpectedNullCharacter),t.systemId+="";break;case I.GREATER_THAN_SIGN:this._err(O.abruptDoctypeSystemIdentifier),t.forceQuirks=!0,this.emitCurrentDoctype(t),this.state=$.DATA;break;case I.EOF:this._err(O.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:t.systemId+=String.fromCodePoint(e)}}_stateAfterDoctypeSystemIdentifier(e){let t=this.currentToken;switch(e){case I.SPACE:case I.LINE_FEED:case I.TABULATION:case I.FORM_FEED:break;case I.GREATER_THAN_SIGN:this.emitCurrentDoctype(t),this.state=$.DATA;break;case I.EOF:this._err(O.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:this._err(O.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=$.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBogusDoctype(e){let t=this.currentToken;switch(e){case I.GREATER_THAN_SIGN:this.emitCurrentDoctype(t),this.state=$.DATA;break;case I.NULL:this._err(O.unexpectedNullCharacter);break;case I.EOF:this.emitCurrentDoctype(t),this._emitEOFToken()}}_stateCdataSection(e){switch(e){case I.RIGHT_SQUARE_BRACKET:this.state=$.CDATA_SECTION_BRACKET;break;case I.EOF:this._err(O.eofInCdata),this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateCdataSectionBracket(e){e===I.RIGHT_SQUARE_BRACKET?this.state=$.CDATA_SECTION_END:(this._emitChars("]"),this.state=$.CDATA_SECTION,this._stateCdataSection(e))}_stateCdataSectionEnd(e){switch(e){case I.GREATER_THAN_SIGN:this.state=$.DATA;break;case I.RIGHT_SQUARE_BRACKET:this._emitChars("]");break;default:this._emitChars("]]"),this.state=$.CDATA_SECTION,this._stateCdataSection(e)}}_stateCharacterReference(){let e=this.entityDecoder.write(this.preprocessor.html,this.preprocessor.pos);if(e<0)if(this.preprocessor.lastChunkWritten)e=this.entityDecoder.end();else{this.active=!1,this.preprocessor.pos=this.preprocessor.html.length-1,this.consumedAfterSnapshot=0,this.preprocessor.endOfChunkHit=!0;return}0===e?(this.preprocessor.pos=this.entityStartPos,this._flushCodePointConsumedAsCharacterReference(I.AMPERSAND),this.state=!this._isCharacterReferenceInAttribute()&&y$(this.preprocessor.peek(1))?$.AMBIGUOUS_AMPERSAND:this.returnState):this.state=this.returnState}_stateAmbiguousAmpersand(e){y$(e)?this._flushCodePointConsumedAsCharacterReference(e):(e===I.SEMICOLON&&this._err(O.unknownNamedCharacterReference),this.state=this.returnState,this._callState(e))}}let yY=new Set([V.DD,V.DT,V.LI,V.OPTGROUP,V.OPTION,V.P,V.RB,V.RP,V.RT,V.RTC]),yK=new Set([...yY,V.CAPTION,V.COLGROUP,V.TBODY,V.TD,V.TFOOT,V.TH,V.THEAD,V.TR]),yZ=new Set([V.APPLET,V.CAPTION,V.HTML,V.MARQUEE,V.OBJECT,V.TABLE,V.TD,V.TEMPLATE,V.TH]),yX=new Set([...yZ,V.OL,V.UL]),yQ=new Set([...yZ,V.BUTTON]),yJ=new Set([V.ANNOTATION_XML,V.MI,V.MN,V.MO,V.MS,V.MTEXT]),y0=new Set([V.DESC,V.FOREIGN_OBJECT,V.TITLE]),y1=new Set([V.TR,V.TEMPLATE,V.HTML]),y2=new Set([V.TBODY,V.TFOOT,V.THEAD,V.TEMPLATE,V.HTML]),y4=new Set([V.TABLE,V.TEMPLATE,V.HTML]),y5=new Set([V.TD,V.TH]);class y3{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(e,t,n){this.treeAdapter=t,this.handler=n,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=V.UNKNOWN,this.current=e}_indexOf(e){return this.items.lastIndexOf(e,this.stackTop)}_isInTemplate(){return this.currentTagId===V.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===j.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(e,t){this.stackTop++,this.items[this.stackTop]=e,this.current=e,this.tagIDs[this.stackTop]=t,this.currentTagId=t,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(e,t,!0)}pop(){let e=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!0)}replace(e,t){let n=this._indexOf(e);this.items[n]=t,n===this.stackTop&&(this.current=t)}insertAfter(e,t,n){let r=this._indexOf(e)+1;this.items.splice(r,0,t),this.tagIDs.splice(r,0,n),this.stackTop++,r===this.stackTop&&this._updateCurrentElement(),this.current&&void 0!==this.currentTagId&&this.handler.onItemPush(this.current,this.currentTagId,r===this.stackTop)}popUntilTagNamePopped(e){let t=this.stackTop+1;do t=this.tagIDs.lastIndexOf(e,t-1);while(t>0&&this.treeAdapter.getNamespaceURI(this.items[t])!==j.HTML)this.shortenToLength(Math.max(t,0))}shortenToLength(e){for(;this.stackTop>=e;){let t=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,this.stackTop<e)}}popUntilElementPopped(e){let t=this._indexOf(e);this.shortenToLength(Math.max(t,0))}popUntilPopped(e,t){let n=this._indexOfTagNames(e,t);this.shortenToLength(Math.max(n,0))}popUntilNumberedHeaderPopped(){this.popUntilPopped(yF,j.HTML)}popUntilTableCellPopped(){this.popUntilPopped(y5,j.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(e,t){for(let n=this.stackTop;n>=0;n--)if(e.has(this.tagIDs[n])&&this.treeAdapter.getNamespaceURI(this.items[n])===t)return n;return -1}clearBackTo(e,t){let n=this._indexOfTagNames(e,t);this.shortenToLength(n+1)}clearBackToTableContext(){this.clearBackTo(y4,j.HTML)}clearBackToTableBodyContext(){this.clearBackTo(y2,j.HTML)}clearBackToTableRowContext(){this.clearBackTo(y1,j.HTML)}remove(e){let t=this._indexOf(e);t>=0&&(t===this.stackTop?this.pop():(this.items.splice(t,1),this.tagIDs.splice(t,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===V.BODY?this.items[1]:null}contains(e){return this._indexOf(e)>-1}getCommonAncestor(e){let t=this._indexOf(e)-1;return t>=0?this.items[t]:null}isRootHtmlElementCurrent(){return 0===this.stackTop&&this.tagIDs[0]===V.HTML}hasInDynamicScope(e,t){for(let n=this.stackTop;n>=0;n--){let r=this.tagIDs[n];switch(this.treeAdapter.getNamespaceURI(this.items[n])){case j.HTML:if(r===e)return!0;if(t.has(r))return!1;break;case j.SVG:if(y0.has(r))return!1;break;case j.MATHML:if(yJ.has(r))return!1}}return!0}hasInScope(e){return this.hasInDynamicScope(e,yZ)}hasInListItemScope(e){return this.hasInDynamicScope(e,yX)}hasInButtonScope(e){return this.hasInDynamicScope(e,yQ)}hasNumberedHeaderInScope(){for(let e=this.stackTop;e>=0;e--){let t=this.tagIDs[e];switch(this.treeAdapter.getNamespaceURI(this.items[e])){case j.HTML:if(yF.has(t))return!0;if(yZ.has(t))return!1;break;case j.SVG:if(y0.has(t))return!1;break;case j.MATHML:if(yJ.has(t))return!1}}return!0}hasInTableScope(e){for(let t=this.stackTop;t>=0;t--)if(this.treeAdapter.getNamespaceURI(this.items[t])===j.HTML)switch(this.tagIDs[t]){case e:return!0;case V.TABLE:case V.HTML:return!1}return!0}hasTableBodyContextInTableScope(){for(let e=this.stackTop;e>=0;e--)if(this.treeAdapter.getNamespaceURI(this.items[e])===j.HTML)switch(this.tagIDs[e]){case V.TBODY:case V.THEAD:case V.TFOOT:return!0;case V.TABLE:case V.HTML:return!1}return!0}hasInSelectScope(e){for(let t=this.stackTop;t>=0;t--)if(this.treeAdapter.getNamespaceURI(this.items[t])===j.HTML)switch(this.tagIDs[t]){case e:return!0;case V.OPTION:case V.OPTGROUP:break;default:return!1}return!0}generateImpliedEndTags(){for(;void 0!==this.currentTagId&&yY.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;void 0!==this.currentTagId&&yK.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(e){for(;void 0!==this.currentTagId&&this.currentTagId!==e&&yK.has(this.currentTagId);)this.pop()}}(A=G||(G={}))[A.Marker=0]="Marker",A[A.Element=1]="Element";let y8={type:G.Marker};class y6{constructor(e){this.treeAdapter=e,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(e,t){let n=[],r=t.length,o=this.treeAdapter.getTagName(e),i=this.treeAdapter.getNamespaceURI(e);for(let e=0;e<this.entries.length;e++){let t=this.entries[e];if(t.type===G.Marker)break;let{element:s}=t;if(this.treeAdapter.getTagName(s)===o&&this.treeAdapter.getNamespaceURI(s)===i){let t=this.treeAdapter.getAttrList(s);t.length===r&&n.push({idx:e,attrs:t})}}return n}_ensureNoahArkCondition(e){if(this.entries.length<3)return;let t=this.treeAdapter.getAttrList(e),n=this._getNoahArkConditionCandidates(e,t);if(n.length<3)return;let r=new Map(t.map(e=>[e.name,e.value])),o=0;for(let e=0;e<n.length;e++){let t=n[e];t.attrs.every(e=>r.get(e.name)===e.value)&&(o+=1)>=3&&this.entries.splice(t.idx,1)}}insertMarker(){this.entries.unshift(y8)}pushElement(e,t){this._ensureNoahArkCondition(e),this.entries.unshift({type:G.Element,element:e,token:t})}insertElementAfterBookmark(e,t){let n=this.entries.indexOf(this.bookmark);this.entries.splice(n,0,{type:G.Element,element:e,token:t})}removeEntry(e){let t=this.entries.indexOf(e);-1!==t&&this.entries.splice(t,1)}clearToLastMarker(){let e=this.entries.indexOf(y8);-1===e?this.entries.length=0:this.entries.splice(0,e+1)}getElementEntryInScopeWithTagName(e){let t=this.entries.find(t=>t.type===G.Marker||this.treeAdapter.getTagName(t.element)===e);return t&&t.type===G.Element?t:null}getElementEntry(e){return this.entries.find(t=>t.type===G.Element&&t.element===e)}}let y9={createDocument:()=>({nodeName:"#document",mode:U.NO_QUIRKS,childNodes:[]}),createDocumentFragment:()=>({nodeName:"#document-fragment",childNodes:[]}),createElement:(e,t,n)=>({nodeName:e,tagName:e,attrs:n,namespaceURI:t,childNodes:[],parentNode:null}),createCommentNode:e=>({nodeName:"#comment",data:e,parentNode:null}),createTextNode:e=>({nodeName:"#text",value:e,parentNode:null}),appendChild(e,t){e.childNodes.push(t),t.parentNode=e},insertBefore(e,t,n){let r=e.childNodes.indexOf(n);e.childNodes.splice(r,0,t),t.parentNode=e},setTemplateContent(e,t){e.content=t},getTemplateContent:e=>e.content,setDocumentType(e,t,n,r){let o=e.childNodes.find(e=>"#documentType"===e.nodeName);o?(o.name=t,o.publicId=n,o.systemId=r):y9.appendChild(e,{nodeName:"#documentType",name:t,publicId:n,systemId:r,parentNode:null})},setDocumentMode(e,t){e.mode=t},getDocumentMode:e=>e.mode,detachNode(e){if(e.parentNode){let t=e.parentNode.childNodes.indexOf(e);e.parentNode.childNodes.splice(t,1),e.parentNode=null}},insertText(e,t){if(e.childNodes.length>0){let n=e.childNodes[e.childNodes.length-1];if(y9.isTextNode(n)){n.value+=t;return}}y9.appendChild(e,y9.createTextNode(t))},insertTextBefore(e,t,n){let r=e.childNodes[e.childNodes.indexOf(n)-1];r&&y9.isTextNode(r)?r.value+=t:y9.insertBefore(e,y9.createTextNode(t),n)},adoptAttributes(e,t){let n=new Set(e.attrs.map(e=>e.name));for(let r=0;r<t.length;r++)n.has(t[r].name)||e.attrs.push(t[r])},getFirstChild:e=>e.childNodes[0],getChildNodes:e=>e.childNodes,getParentNode:e=>e.parentNode,getAttrList:e=>e.attrs,getTagName:e=>e.tagName,getNamespaceURI:e=>e.namespaceURI,getTextNodeContent:e=>e.value,getCommentNodeContent:e=>e.data,getDocumentTypeNodeName:e=>e.name,getDocumentTypeNodePublicId:e=>e.publicId,getDocumentTypeNodeSystemId:e=>e.systemId,isTextNode:e=>"#text"===e.nodeName,isCommentNode:e=>"#comment"===e.nodeName,isDocumentTypeNode:e=>"#documentType"===e.nodeName,isElementNode:e=>Object.prototype.hasOwnProperty.call(e,"tagName"),setNodeSourceCodeLocation(e,t){e.sourceCodeLocation=t},getNodeSourceCodeLocation:e=>e.sourceCodeLocation,updateNodeSourceCodeLocation(e,t){e.sourceCodeLocation={...e.sourceCodeLocation,...t}}},y7="html",ve=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],vt=[...ve,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],vn=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),vr=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],vo=[...vr,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function vi(e,t){return t.some(t=>e.startsWith(t))}let vs=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(e=>[e.toLowerCase(),e])),vl=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:j.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:j.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:j.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:j.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:j.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:j.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:j.XLINK}],["xml:lang",{prefix:"xml",name:"lang",namespace:j.XML}],["xml:space",{prefix:"xml",name:"space",namespace:j.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:j.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:j.XMLNS}]]),va=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(e=>[e.toLowerCase(),e])),vc=new Set([V.B,V.BIG,V.BLOCKQUOTE,V.BODY,V.BR,V.CENTER,V.CODE,V.DD,V.DIV,V.DL,V.DT,V.EM,V.EMBED,V.H1,V.H2,V.H3,V.H4,V.H5,V.H6,V.HEAD,V.HR,V.I,V.IMG,V.LI,V.LISTING,V.MENU,V.META,V.NOBR,V.OL,V.P,V.PRE,V.RUBY,V.S,V.SMALL,V.SPAN,V.STRONG,V.STRIKE,V.SUB,V.SUP,V.TABLE,V.TT,V.U,V.UL,V.VAR]);function vd(e){for(let t=0;t<e.attrs.length;t++)if("definitionurl"===e.attrs[t].name){e.attrs[t].name="definitionURL";break}}function vu(e){for(let t=0;t<e.attrs.length;t++){let n=vs.get(e.attrs[t].name);null!=n&&(e.attrs[t].name=n)}}function vh(e){for(let t=0;t<e.attrs.length;t++){let n=vl.get(e.attrs[t].name);n&&(e.attrs[t].prefix=n.prefix,e.attrs[t].name=n.name,e.attrs[t].namespace=n.namespace)}}(_=q||(q={}))[_.INITIAL=0]="INITIAL",_[_.BEFORE_HTML=1]="BEFORE_HTML",_[_.BEFORE_HEAD=2]="BEFORE_HEAD",_[_.IN_HEAD=3]="IN_HEAD",_[_.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",_[_.AFTER_HEAD=5]="AFTER_HEAD",_[_.IN_BODY=6]="IN_BODY",_[_.TEXT=7]="TEXT",_[_.IN_TABLE=8]="IN_TABLE",_[_.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",_[_.IN_CAPTION=10]="IN_CAPTION",_[_.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",_[_.IN_TABLE_BODY=12]="IN_TABLE_BODY",_[_.IN_ROW=13]="IN_ROW",_[_.IN_CELL=14]="IN_CELL",_[_.IN_SELECT=15]="IN_SELECT",_[_.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",_[_.IN_TEMPLATE=17]="IN_TEMPLATE",_[_.AFTER_BODY=18]="AFTER_BODY",_[_.IN_FRAMESET=19]="IN_FRAMESET",_[_.AFTER_FRAMESET=20]="AFTER_FRAMESET",_[_.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",_[_.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET";let vp={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},vf=new Set([V.TABLE,V.TBODY,V.TFOOT,V.THEAD,V.TR]),vm={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:y9,onParseError:null};class vg{constructor(e,t,n=null,r=null){this.fragmentContext=n,this.scriptHandler=r,this.currentToken=null,this.stopped=!1,this.insertionMode=q.INITIAL,this.originalInsertionMode=q.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...vm,...e},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=null!=t?t:this.treeAdapter.createDocument(),this.tokenizer=new yW(this.options,this),this.activeFormattingElements=new y6(this.treeAdapter),this.fragmentContextID=n?yB(this.treeAdapter.getTagName(n)):V.UNKNOWN,this._setContextModes(null!=n?n:this.document,this.fragmentContextID),this.openElements=new y3(this.document,this.treeAdapter,this)}static parse(e,t){let n=new this(t);return n.tokenizer.write(e,!0),n.document}static getFragmentParser(e,t){let n={...vm,...t};null!=e||(e=n.treeAdapter.createElement(z.TEMPLATE,j.HTML,[]));let r=n.treeAdapter.createElement("documentmock",j.HTML,[]),o=new this(n,r,e);return o.fragmentContextID===V.TEMPLATE&&o.tmplInsertionModeStack.unshift(q.IN_TEMPLATE),o._initTokenizerForFragmentParsing(),o._insertFakeRootElement(),o._resetInsertionMode(),o._findFormInFragmentContext(),o}getFragment(){let e=this.treeAdapter.getFirstChild(this.document),t=this.treeAdapter.createDocumentFragment();return this._adoptNodes(e,t),t}_err(e,t,n){var r;if(!this.onParseError)return;let o=null!=(r=e.location)?r:vp,i={code:t,startLine:o.startLine,startCol:o.startCol,startOffset:o.startOffset,endLine:n?o.startLine:o.endLine,endCol:n?o.startCol:o.endCol,endOffset:n?o.startOffset:o.endOffset};this.onParseError(i)}onItemPush(e,t,n){var r,o;null==(o=(r=this.treeAdapter).onItemPush)||o.call(r,e),n&&this.openElements.stackTop>0&&this._setContextModes(e,t)}onItemPop(e,t){var n,r;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(e,this.currentToken),null==(r=(n=this.treeAdapter).onItemPop)||r.call(n,e,this.openElements.current),t){let e,t;0===this.openElements.stackTop&&this.fragmentContext?(e=this.fragmentContext,t=this.fragmentContextID):{current:e,currentTagId:t}=this.openElements,this._setContextModes(e,t)}}_setContextModes(e,t){let n=e===this.document||e&&this.treeAdapter.getNamespaceURI(e)===j.HTML;this.currentNotInHTML=!n,this.tokenizer.inForeignNode=!n&&void 0!==e&&void 0!==t&&!this._isIntegrationPoint(t,e)}_switchToTextParsing(e,t){this._insertElement(e,j.HTML),this.tokenizer.state=t,this.originalInsertionMode=this.insertionMode,this.insertionMode=q.TEXT}switchToPlaintextParsing(){this.insertionMode=q.TEXT,this.originalInsertionMode=q.IN_BODY,this.tokenizer.state=yU.PLAINTEXT}_getAdjustedCurrentElement(){return 0===this.openElements.stackTop&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let e=this.fragmentContext;for(;e;){if(this.treeAdapter.getTagName(e)===z.FORM){this.formElement=e;break}e=this.treeAdapter.getParentNode(e)}}_initTokenizerForFragmentParsing(){if(this.fragmentContext&&this.treeAdapter.getNamespaceURI(this.fragmentContext)===j.HTML)switch(this.fragmentContextID){case V.TITLE:case V.TEXTAREA:this.tokenizer.state=yU.RCDATA;break;case V.STYLE:case V.XMP:case V.IFRAME:case V.NOEMBED:case V.NOFRAMES:case V.NOSCRIPT:this.tokenizer.state=yU.RAWTEXT;break;case V.SCRIPT:this.tokenizer.state=yU.SCRIPT_DATA;break;case V.PLAINTEXT:this.tokenizer.state=yU.PLAINTEXT}}_setDocumentType(e){let t=e.name||"",n=e.publicId||"",r=e.systemId||"";if(this.treeAdapter.setDocumentType(this.document,t,n,r),e.location){let t=this.treeAdapter.getChildNodes(this.document).find(e=>this.treeAdapter.isDocumentTypeNode(e));t&&this.treeAdapter.setNodeSourceCodeLocation(t,e.location)}}_attachElementToTree(e,t){if(this.options.sourceCodeLocationInfo){let n=t&&{...t,startTag:t};this.treeAdapter.setNodeSourceCodeLocation(e,n)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(e);else{let t=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(null!=t?t:this.document,e)}}_appendElement(e,t){let n=this.treeAdapter.createElement(e.tagName,t,e.attrs);this._attachElementToTree(n,e.location)}_insertElement(e,t){let n=this.treeAdapter.createElement(e.tagName,t,e.attrs);this._attachElementToTree(n,e.location),this.openElements.push(n,e.tagID)}_insertFakeElement(e,t){let n=this.treeAdapter.createElement(e,j.HTML,[]);this._attachElementToTree(n,null),this.openElements.push(n,t)}_insertTemplate(e){let t=this.treeAdapter.createElement(e.tagName,j.HTML,e.attrs),n=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(t,n),this._attachElementToTree(t,e.location),this.openElements.push(t,e.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,null)}_insertFakeRootElement(){let e=this.treeAdapter.createElement(z.HTML,j.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(e,null),this.treeAdapter.appendChild(this.openElements.current,e),this.openElements.push(e,V.HTML)}_appendCommentNode(e,t){let n=this.treeAdapter.createCommentNode(e.data);this.treeAdapter.appendChild(t,n),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,e.location)}_insertCharacters(e){let t,n;if(this._shouldFosterParentOnInsertion()?({parent:t,beforeElement:n}=this._findFosterParentingLocation(),n?this.treeAdapter.insertTextBefore(t,e.chars,n):this.treeAdapter.insertText(t,e.chars)):(t=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(t,e.chars)),!e.location)return;let r=this.treeAdapter.getChildNodes(t),o=n?r.lastIndexOf(n):r.length,i=r[o-1];if(this.treeAdapter.getNodeSourceCodeLocation(i)){let{endLine:t,endCol:n,endOffset:r}=e.location;this.treeAdapter.updateNodeSourceCodeLocation(i,{endLine:t,endCol:n,endOffset:r})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(i,e.location)}_adoptNodes(e,t){for(let n=this.treeAdapter.getFirstChild(e);n;n=this.treeAdapter.getFirstChild(e))this.treeAdapter.detachNode(n),this.treeAdapter.appendChild(t,n)}_setEndLocation(e,t){if(this.treeAdapter.getNodeSourceCodeLocation(e)&&t.location){let n=t.location,r=this.treeAdapter.getTagName(e),o=t.type===D.END_TAG&&r===t.tagName?{endTag:{...n},endLine:n.endLine,endCol:n.endCol,endOffset:n.endOffset}:{endLine:n.startLine,endCol:n.startCol,endOffset:n.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(e,o)}}shouldProcessStartTagTokenInForeignContent(e){let t,n;return!!this.currentNotInHTML&&(0===this.openElements.stackTop&&this.fragmentContext?(t=this.fragmentContext,n=this.fragmentContextID):{current:t,currentTagId:n}=this.openElements,(e.tagID!==V.SVG||this.treeAdapter.getTagName(t)!==z.ANNOTATION_XML||this.treeAdapter.getNamespaceURI(t)!==j.MATHML)&&(this.tokenizer.inForeignNode||(e.tagID===V.MGLYPH||e.tagID===V.MALIGNMARK)&&void 0!==n&&!this._isIntegrationPoint(n,t,j.HTML)))}_processToken(e){switch(e.type){case D.CHARACTER:this.onCharacter(e);break;case D.NULL_CHARACTER:this.onNullCharacter(e);break;case D.COMMENT:this.onComment(e);break;case D.DOCTYPE:this.onDoctype(e);break;case D.START_TAG:this._processStartTag(e);break;case D.END_TAG:this.onEndTag(e);break;case D.EOF:this.onEof(e);break;case D.WHITESPACE_CHARACTER:this.onWhitespaceCharacter(e)}}_isIntegrationPoint(e,t,n){let r=this.treeAdapter.getNamespaceURI(t),o=this.treeAdapter.getAttrList(t);return(!n||n===j.HTML)&&function(e,t,n){if(t===j.MATHML&&e===V.ANNOTATION_XML){for(let e=0;e<n.length;e++)if(n[e].name===F.ENCODING){let t=n[e].value.toLowerCase();return"text/html"===t||"application/xhtml+xml"===t}}return t===j.SVG&&(e===V.FOREIGN_OBJECT||e===V.DESC||e===V.TITLE)}(e,r,o)||(!n||n===j.MATHML)&&r===j.MATHML&&(e===V.MI||e===V.MO||e===V.MN||e===V.MS||e===V.MTEXT)}_reconstructActiveFormattingElements(){let e=this.activeFormattingElements.entries.length;if(e){let t=this.activeFormattingElements.entries.findIndex(e=>e.type===G.Marker||this.openElements.contains(e.element)),n=-1===t?e-1:t-1;for(let e=n;e>=0;e--){let t=this.activeFormattingElements.entries[e];this._insertElement(t.token,this.treeAdapter.getNamespaceURI(t.element)),t.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=q.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(V.P),this.openElements.popUntilTagNamePopped(V.P)}_resetInsertionMode(){for(let e=this.openElements.stackTop;e>=0;e--)switch(0===e&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[e]){case V.TR:this.insertionMode=q.IN_ROW;return;case V.TBODY:case V.THEAD:case V.TFOOT:this.insertionMode=q.IN_TABLE_BODY;return;case V.CAPTION:this.insertionMode=q.IN_CAPTION;return;case V.COLGROUP:this.insertionMode=q.IN_COLUMN_GROUP;return;case V.TABLE:this.insertionMode=q.IN_TABLE;return;case V.BODY:this.insertionMode=q.IN_BODY;return;case V.FRAMESET:this.insertionMode=q.IN_FRAMESET;return;case V.SELECT:return void this._resetInsertionModeForSelect(e);case V.TEMPLATE:this.insertionMode=this.tmplInsertionModeStack[0];return;case V.HTML:this.insertionMode=this.headElement?q.AFTER_HEAD:q.BEFORE_HEAD;return;case V.TD:case V.TH:if(e>0){this.insertionMode=q.IN_CELL;return}break;case V.HEAD:if(e>0){this.insertionMode=q.IN_HEAD;return}}this.insertionMode=q.IN_BODY}_resetInsertionModeForSelect(e){if(e>0)for(let t=e-1;t>0;t--){let e=this.openElements.tagIDs[t];if(e===V.TEMPLATE)break;if(e===V.TABLE){this.insertionMode=q.IN_SELECT_IN_TABLE;return}}this.insertionMode=q.IN_SELECT}_isElementCausesFosterParenting(e){return vf.has(e)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&void 0!==this.openElements.currentTagId&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let e=this.openElements.stackTop;e>=0;e--){let t=this.openElements.items[e];switch(this.openElements.tagIDs[e]){case V.TEMPLATE:if(this.treeAdapter.getNamespaceURI(t)===j.HTML)return{parent:this.treeAdapter.getTemplateContent(t),beforeElement:null};break;case V.TABLE:{let n=this.treeAdapter.getParentNode(t);if(n)return{parent:n,beforeElement:t};return{parent:this.openElements.items[e-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(e){let t=this._findFosterParentingLocation();t.beforeElement?this.treeAdapter.insertBefore(t.parent,e,t.beforeElement):this.treeAdapter.appendChild(t.parent,e)}_isSpecialElement(e,t){return yj[this.treeAdapter.getNamespaceURI(e)].has(t)}onCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){var t,n;return void(t=this,n=e,t._insertCharacters(n),t.framesetOk=!1)}switch(this.insertionMode){case q.INITIAL:vE(this,e);break;case q.BEFORE_HTML:vk(this,e);break;case q.BEFORE_HEAD:vC(this,e);break;case q.IN_HEAD:vx(this,e);break;case q.IN_HEAD_NO_SCRIPT:vS(this,e);break;case q.AFTER_HEAD:vA(this,e);break;case q.IN_BODY:case q.IN_CAPTION:case q.IN_CELL:case q.IN_TEMPLATE:vM(this,e);break;case q.TEXT:case q.IN_SELECT:case q.IN_SELECT_IN_TABLE:this._insertCharacters(e);break;case q.IN_TABLE:case q.IN_TABLE_BODY:case q.IN_ROW:vj(this,e);break;case q.IN_TABLE_TEXT:v$(this,e);break;case q.IN_COLUMN_GROUP:vY(this,e);break;case q.AFTER_BODY:v4(this,e);break;case q.AFTER_AFTER_BODY:v5(this,e)}}onNullCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){var t,n;return void(t=this,(n=e).chars="",t._insertCharacters(n))}switch(this.insertionMode){case q.INITIAL:vE(this,e);break;case q.BEFORE_HTML:vk(this,e);break;case q.BEFORE_HEAD:vC(this,e);break;case q.IN_HEAD:vx(this,e);break;case q.IN_HEAD_NO_SCRIPT:vS(this,e);break;case q.AFTER_HEAD:vA(this,e);break;case q.TEXT:this._insertCharacters(e);break;case q.IN_TABLE:case q.IN_TABLE_BODY:case q.IN_ROW:vj(this,e);break;case q.IN_COLUMN_GROUP:vY(this,e);break;case q.AFTER_BODY:v4(this,e);break;case q.AFTER_AFTER_BODY:v5(this,e)}}onComment(e){var t,n,r,o;if(this.skipNextNewLine=!1,this.currentNotInHTML)return void vy(this,e);switch(this.insertionMode){case q.INITIAL:case q.BEFORE_HTML:case q.BEFORE_HEAD:case q.IN_HEAD:case q.IN_HEAD_NO_SCRIPT:case q.AFTER_HEAD:case q.IN_BODY:case q.IN_TABLE:case q.IN_CAPTION:case q.IN_COLUMN_GROUP:case q.IN_TABLE_BODY:case q.IN_ROW:case q.IN_CELL:case q.IN_SELECT:case q.IN_SELECT_IN_TABLE:case q.IN_TEMPLATE:case q.IN_FRAMESET:case q.AFTER_FRAMESET:vy(this,e);break;case q.IN_TABLE_TEXT:vG(this,e);break;case q.AFTER_BODY:t=this,n=e,t._appendCommentNode(n,t.openElements.items[0]);break;case q.AFTER_AFTER_BODY:case q.AFTER_AFTER_FRAMESET:r=this,o=e,r._appendCommentNode(o,r.document)}}onDoctype(e){switch(this.skipNextNewLine=!1,this.insertionMode){case q.INITIAL:!function(e,t){e._setDocumentType(t);let n=t.forceQuirks?U.QUIRKS:function(e){if(e.name!==y7)return U.QUIRKS;let{systemId:t}=e;if(t&&"http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd"===t.toLowerCase())return U.QUIRKS;let{publicId:n}=e;if(null!==n){if(n=n.toLowerCase(),vn.has(n))return U.QUIRKS;let e=null===t?vt:ve;if(vi(n,e))return U.QUIRKS;if(vi(n,e=null===t?vr:vo))return U.LIMITED_QUIRKS}return U.NO_QUIRKS}(t);(t.name!==y7||null!==t.publicId||null!==t.systemId&&"about:legacy-compat"!==t.systemId)&&e._err(t,O.nonConformingDoctype),e.treeAdapter.setDocumentMode(e.document,n),e.insertionMode=q.BEFORE_HTML}(this,e);break;case q.BEFORE_HEAD:case q.IN_HEAD:case q.IN_HEAD_NO_SCRIPT:case q.AFTER_HEAD:this._err(e,O.misplacedDoctype);break;case q.IN_TABLE_TEXT:vG(this,e)}}onStartTag(e){this.skipNextNewLine=!1,this.currentToken=e,this._processStartTag(e),e.selfClosing&&!e.ackSelfClosing&&this._err(e,O.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(e){this.shouldProcessStartTagTokenInForeignContent(e)?function(e,t){let n;if((n=t.tagID)===V.FONT&&t.attrs.some(({name:e})=>e===F.COLOR||e===F.SIZE||e===F.FACE)||vc.has(n))v3(e),e._startTagOutsideForeignContent(t);else{let n=e._getAdjustedCurrentElement(),r=e.treeAdapter.getNamespaceURI(n);if(r===j.MATHML)vd(t);else if(r===j.SVG){let e;null!=(e=va.get(t.tagName))&&(t.tagName=e,t.tagID=yB(t.tagName)),vu(t)}vh(t),t.selfClosing?e._appendElement(t,r):e._insertElement(t,r),t.ackSelfClosing=!0}}(this,e):this._startTagOutsideForeignContent(e)}_startTagOutsideForeignContent(e){switch(this.insertionMode){case q.INITIAL:vE(this,e);break;case q.BEFORE_HTML:t=this,(n=e).tagID===V.HTML?(t._insertElement(n,j.HTML),t.insertionMode=q.BEFORE_HEAD):vk(t,n);break;case q.BEFORE_HEAD:var t,n,r,o,i,s,l,a,c,d,u,h,p=this,f=e;switch(f.tagID){case V.HTML:vL(p,f);break;case V.HEAD:p._insertElement(f,j.HTML),p.headElement=p.openElements.current,p.insertionMode=q.IN_HEAD;break;default:vC(p,f)}break;case q.IN_HEAD:vT(this,e);break;case q.IN_HEAD_NO_SCRIPT:var m=this,g=e;switch(g.tagID){case V.HTML:vL(m,g);break;case V.BASEFONT:case V.BGSOUND:case V.HEAD:case V.LINK:case V.META:case V.NOFRAMES:case V.STYLE:vT(m,g);break;case V.NOSCRIPT:m._err(g,O.nestedNoscriptInHead);break;default:vS(m,g)}break;case q.AFTER_HEAD:var b=this,y=e;switch(y.tagID){case V.HTML:vL(b,y);break;case V.BODY:b._insertElement(y,j.HTML),b.framesetOk=!1,b.insertionMode=q.IN_BODY;break;case V.FRAMESET:b._insertElement(y,j.HTML),b.insertionMode=q.IN_FRAMESET;break;case V.BASE:case V.BASEFONT:case V.BGSOUND:case V.LINK:case V.META:case V.NOFRAMES:case V.SCRIPT:case V.STYLE:case V.TEMPLATE:case V.TITLE:b._err(y,O.abandonedHeadElementChild),b.openElements.push(b.headElement,V.HEAD),vT(b,y),b.openElements.remove(b.headElement);break;case V.HEAD:b._err(y,O.misplacedStartTagForHeadElement);break;default:vA(b,y)}break;case q.IN_BODY:vL(this,e);break;case q.IN_TABLE:vF(this,e);break;case q.IN_TABLE_TEXT:vG(this,e);break;case q.IN_CAPTION:let v;r=this,v=(o=e).tagID,vq.has(v)?r.openElements.hasInTableScope(V.CAPTION)&&(r.openElements.generateImpliedEndTags(),r.openElements.popUntilTagNamePopped(V.CAPTION),r.activeFormattingElements.clearToLastMarker(),r.insertionMode=q.IN_TABLE,vF(r,o)):vL(r,o);break;case q.IN_COLUMN_GROUP:vW(this,e);break;case q.IN_TABLE_BODY:vK(this,e);break;case q.IN_ROW:vX(this,e);break;case q.IN_CELL:let E;i=this,E=(s=e).tagID,vq.has(E)?(i.openElements.hasInTableScope(V.TD)||i.openElements.hasInTableScope(V.TH))&&(i._closeTableCell(),vX(i,s)):vL(i,s);break;case q.IN_SELECT:vJ(this,e);break;case q.IN_SELECT_IN_TABLE:let k;l=this,(k=(a=e).tagID)===V.CAPTION||k===V.TABLE||k===V.TBODY||k===V.TFOOT||k===V.THEAD||k===V.TR||k===V.TD||k===V.TH?(l.openElements.popUntilTagNamePopped(V.SELECT),l._resetInsertionMode(),l._processStartTag(a)):vJ(l,a);break;case q.IN_TEMPLATE:var C=this,T=e;switch(T.tagID){case V.BASE:case V.BASEFONT:case V.BGSOUND:case V.LINK:case V.META:case V.NOFRAMES:case V.SCRIPT:case V.STYLE:case V.TEMPLATE:case V.TITLE:vT(C,T);break;case V.CAPTION:case V.COLGROUP:case V.TBODY:case V.TFOOT:case V.THEAD:C.tmplInsertionModeStack[0]=q.IN_TABLE,C.insertionMode=q.IN_TABLE,vF(C,T);break;case V.COL:C.tmplInsertionModeStack[0]=q.IN_COLUMN_GROUP,C.insertionMode=q.IN_COLUMN_GROUP,vW(C,T);break;case V.TR:C.tmplInsertionModeStack[0]=q.IN_TABLE_BODY,C.insertionMode=q.IN_TABLE_BODY,vK(C,T);break;case V.TD:case V.TH:C.tmplInsertionModeStack[0]=q.IN_ROW,C.insertionMode=q.IN_ROW,vX(C,T);break;default:C.tmplInsertionModeStack[0]=q.IN_BODY,C.insertionMode=q.IN_BODY,vL(C,T)}break;case q.AFTER_BODY:c=this,(d=e).tagID===V.HTML?vL(c,d):v4(c,d);break;case q.IN_FRAMESET:var w=this,x=e;switch(x.tagID){case V.HTML:vL(w,x);break;case V.FRAMESET:w._insertElement(x,j.HTML);break;case V.FRAME:w._appendElement(x,j.HTML),x.ackSelfClosing=!0;break;case V.NOFRAMES:vT(w,x)}break;case q.AFTER_FRAMESET:var S=this,A=e;switch(A.tagID){case V.HTML:vL(S,A);break;case V.NOFRAMES:vT(S,A)}break;case q.AFTER_AFTER_BODY:u=this,(h=e).tagID===V.HTML?vL(u,h):v5(u,h);break;case q.AFTER_AFTER_FRAMESET:var _=this,N=e;switch(N.tagID){case V.HTML:vL(_,N);break;case V.NOFRAMES:vT(_,N)}}}onEndTag(e){this.skipNextNewLine=!1,this.currentToken=e,this.currentNotInHTML?function(e,t){if(t.tagID===V.P||t.tagID===V.BR){v3(e),e._endTagOutsideForeignContent(t);return}for(let n=e.openElements.stackTop;n>0;n--){let r=e.openElements.items[n];if(e.treeAdapter.getNamespaceURI(r)===j.HTML){e._endTagOutsideForeignContent(t);break}let o=e.treeAdapter.getTagName(r);if(o.toLowerCase()===t.tagName){t.tagName=o,e.openElements.shortenToLength(n);break}}}(this,e):this._endTagOutsideForeignContent(e)}_endTagOutsideForeignContent(e){switch(this.insertionMode){case q.INITIAL:vE(this,e);break;case q.BEFORE_HTML:let t;r=this,((t=(o=e).tagID)===V.HTML||t===V.HEAD||t===V.BODY||t===V.BR)&&vk(r,o);break;case q.BEFORE_HEAD:let n;i=this,(n=(s=e).tagID)===V.HEAD||n===V.BODY||n===V.HTML||n===V.BR?vC(i,s):i._err(s,O.endTagWithoutMatchingOpenElement);break;case q.IN_HEAD:var r,o,i,s,l,a,c,d,u,h,p,f,m=this,g=e;switch(g.tagID){case V.HEAD:m.openElements.pop(),m.insertionMode=q.AFTER_HEAD;break;case V.BODY:case V.BR:case V.HTML:vx(m,g);break;case V.TEMPLATE:vw(m,g);break;default:m._err(g,O.endTagWithoutMatchingOpenElement)}break;case q.IN_HEAD_NO_SCRIPT:var b=this,y=e;switch(y.tagID){case V.NOSCRIPT:b.openElements.pop(),b.insertionMode=q.IN_HEAD;break;case V.BR:vS(b,y);break;default:b._err(y,O.endTagWithoutMatchingOpenElement)}break;case q.AFTER_HEAD:var v=this,E=e;switch(E.tagID){case V.BODY:case V.HTML:case V.BR:vA(v,E);break;case V.TEMPLATE:vw(v,E);break;default:v._err(E,O.endTagWithoutMatchingOpenElement)}break;case q.IN_BODY:vB(this,e);break;case q.TEXT:l=this,e.tagID===V.SCRIPT&&(null==(a=l.scriptHandler)||a.call(l,l.openElements.current)),l.openElements.pop(),l.insertionMode=l.originalInsertionMode;break;case q.IN_TABLE:vU(this,e);break;case q.IN_TABLE_TEXT:vG(this,e);break;case q.IN_CAPTION:var k=this,C=e;let T=C.tagID;switch(T){case V.CAPTION:case V.TABLE:k.openElements.hasInTableScope(V.CAPTION)&&(k.openElements.generateImpliedEndTags(),k.openElements.popUntilTagNamePopped(V.CAPTION),k.activeFormattingElements.clearToLastMarker(),k.insertionMode=q.IN_TABLE,T===V.TABLE&&vU(k,C));break;case V.BODY:case V.COL:case V.COLGROUP:case V.HTML:case V.TBODY:case V.TD:case V.TFOOT:case V.TH:case V.THEAD:case V.TR:break;default:vB(k,C)}break;case q.IN_COLUMN_GROUP:var w=this,x=e;switch(x.tagID){case V.COLGROUP:w.openElements.currentTagId===V.COLGROUP&&(w.openElements.pop(),w.insertionMode=q.IN_TABLE);break;case V.TEMPLATE:vw(w,x);break;case V.COL:break;default:vY(w,x)}break;case q.IN_TABLE_BODY:vZ(this,e);break;case q.IN_ROW:vQ(this,e);break;case q.IN_CELL:var S=this,A=e;let _=A.tagID;switch(_){case V.TD:case V.TH:S.openElements.hasInTableScope(_)&&(S.openElements.generateImpliedEndTags(),S.openElements.popUntilTagNamePopped(_),S.activeFormattingElements.clearToLastMarker(),S.insertionMode=q.IN_ROW);break;case V.TABLE:case V.TBODY:case V.TFOOT:case V.THEAD:case V.TR:S.openElements.hasInTableScope(_)&&(S._closeTableCell(),vQ(S,A));break;case V.BODY:case V.CAPTION:case V.COL:case V.COLGROUP:case V.HTML:break;default:vB(S,A)}break;case q.IN_SELECT:v0(this,e);break;case q.IN_SELECT_IN_TABLE:let N;c=this,(N=(d=e).tagID)===V.CAPTION||N===V.TABLE||N===V.TBODY||N===V.TFOOT||N===V.THEAD||N===V.TR||N===V.TD||N===V.TH?c.openElements.hasInTableScope(N)&&(c.openElements.popUntilTagNamePopped(V.SELECT),c._resetInsertionMode(),c.onEndTag(d)):v0(c,d);break;case q.IN_TEMPLATE:u=this,(h=e).tagID===V.TEMPLATE&&vw(u,h);break;case q.AFTER_BODY:v2(this,e);break;case q.IN_FRAMESET:p=this,e.tagID===V.FRAMESET&&!p.openElements.isRootHtmlElementCurrent()&&(p.openElements.pop(),p.fragmentContext||p.openElements.currentTagId===V.FRAMESET||(p.insertionMode=q.AFTER_FRAMESET));break;case q.AFTER_FRAMESET:f=this,e.tagID===V.HTML&&(f.insertionMode=q.AFTER_AFTER_FRAMESET);break;case q.AFTER_AFTER_BODY:v5(this,e)}}onEof(e){switch(this.insertionMode){case q.INITIAL:vE(this,e);break;case q.BEFORE_HTML:vk(this,e);break;case q.BEFORE_HEAD:vC(this,e);break;case q.IN_HEAD:vx(this,e);break;case q.IN_HEAD_NO_SCRIPT:vS(this,e);break;case q.AFTER_HEAD:vA(this,e);break;case q.IN_BODY:case q.IN_TABLE:case q.IN_CAPTION:case q.IN_COLUMN_GROUP:case q.IN_TABLE_BODY:case q.IN_ROW:case q.IN_CELL:case q.IN_SELECT:case q.IN_SELECT_IN_TABLE:vH(this,e);break;case q.TEXT:var t,n;t=this,n=e,t._err(n,O.eofInElementThatCanContainOnlyText),t.openElements.pop(),t.insertionMode=t.originalInsertionMode,t.onEof(n);break;case q.IN_TABLE_TEXT:vG(this,e);break;case q.IN_TEMPLATE:v1(this,e);break;case q.AFTER_BODY:case q.IN_FRAMESET:case q.AFTER_FRAMESET:case q.AFTER_AFTER_BODY:case q.AFTER_AFTER_FRAMESET:vv(this,e)}}onWhitespaceCharacter(e){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,e.chars.charCodeAt(0)===I.LINE_FEED)){if(1===e.chars.length)return;e.chars=e.chars.substr(1)}if(this.tokenizer.inForeignNode)return void this._insertCharacters(e);switch(this.insertionMode){case q.IN_HEAD:case q.IN_HEAD_NO_SCRIPT:case q.AFTER_HEAD:case q.TEXT:case q.IN_COLUMN_GROUP:case q.IN_SELECT:case q.IN_SELECT_IN_TABLE:case q.IN_FRAMESET:case q.AFTER_FRAMESET:this._insertCharacters(e);break;case q.IN_BODY:case q.IN_CAPTION:case q.IN_CELL:case q.IN_TEMPLATE:case q.AFTER_BODY:case q.AFTER_AFTER_BODY:case q.AFTER_AFTER_FRAMESET:vN(this,e);break;case q.IN_TABLE:case q.IN_TABLE_BODY:case q.IN_ROW:vj(this,e);break;case q.IN_TABLE_TEXT:vV(this,e)}}}function vb(e,t){for(let n=0;n<8;n++){let n=function(e,t){let n=e.activeFormattingElements.getElementEntryInScopeWithTagName(t.tagName);return n?e.openElements.contains(n.element)?e.openElements.hasInScope(t.tagID)||(n=null):(e.activeFormattingElements.removeEntry(n),n=null):vP(e,t),n}(e,t);if(!n)break;let r=function(e,t){let n=null,r=e.openElements.stackTop;for(;r>=0;r--){let o=e.openElements.items[r];if(o===t.element)break;e._isSpecialElement(o,e.openElements.tagIDs[r])&&(n=o)}return n||(e.openElements.shortenToLength(Math.max(r,0)),e.activeFormattingElements.removeEntry(t)),n}(e,n);if(!r)break;e.activeFormattingElements.bookmark=n;let o=function(e,t,n){let r=t,o=e.openElements.getCommonAncestor(t);for(let i=0,s=o;s!==n;i++,s=o){o=e.openElements.getCommonAncestor(s);let n=e.activeFormattingElements.getElementEntry(s),l=n&&i>=3;!n||l?(l&&e.activeFormattingElements.removeEntry(n),e.openElements.remove(s)):(s=function(e,t){let n=e.treeAdapter.getNamespaceURI(t.element),r=e.treeAdapter.createElement(t.token.tagName,n,t.token.attrs);return e.openElements.replace(t.element,r),t.element=r,r}(e,n),r===t&&(e.activeFormattingElements.bookmark=n),e.treeAdapter.detachNode(r),e.treeAdapter.appendChild(s,r),r=s)}return r}(e,r,n.element),i=e.openElements.getCommonAncestor(n.element);e.treeAdapter.detachNode(o),i&&function(e,t,n){let r=yB(e.treeAdapter.getTagName(t));if(e._isElementCausesFosterParenting(r))e._fosterParentElement(n);else{let o=e.treeAdapter.getNamespaceURI(t);r===V.TEMPLATE&&o===j.HTML&&(t=e.treeAdapter.getTemplateContent(t)),e.treeAdapter.appendChild(t,n)}}(e,i,o),function(e,t,n){let r=e.treeAdapter.getNamespaceURI(n.element),{token:o}=n,i=e.treeAdapter.createElement(o.tagName,r,o.attrs);e._adoptNodes(t,i),e.treeAdapter.appendChild(t,i),e.activeFormattingElements.insertElementAfterBookmark(i,o),e.activeFormattingElements.removeEntry(n),e.openElements.remove(n.element),e.openElements.insertAfter(t,i,o.tagID)}(e,r,n)}}function vy(e,t){e._appendCommentNode(t,e.openElements.currentTmplContentOrNode)}function vv(e,t){if(e.stopped=!0,t.location){let n=2*!e.fragmentContext;for(let r=e.openElements.stackTop;r>=n;r--)e._setEndLocation(e.openElements.items[r],t);if(!e.fragmentContext&&e.openElements.stackTop>=0){let n=e.openElements.items[0],r=e.treeAdapter.getNodeSourceCodeLocation(n);if(r&&!r.endTag&&(e._setEndLocation(n,t),e.openElements.stackTop>=1)){let n=e.openElements.items[1],r=e.treeAdapter.getNodeSourceCodeLocation(n);r&&!r.endTag&&e._setEndLocation(n,t)}}}}function vE(e,t){e._err(t,O.missingDoctype,!0),e.treeAdapter.setDocumentMode(e.document,U.QUIRKS),e.insertionMode=q.BEFORE_HTML,e._processToken(t)}function vk(e,t){e._insertFakeRootElement(),e.insertionMode=q.BEFORE_HEAD,e._processToken(t)}function vC(e,t){e._insertFakeElement(z.HEAD,V.HEAD),e.headElement=e.openElements.current,e.insertionMode=q.IN_HEAD,e._processToken(t)}function vT(e,t){switch(t.tagID){case V.HTML:vL(e,t);break;case V.BASE:case V.BASEFONT:case V.BGSOUND:case V.LINK:case V.META:e._appendElement(t,j.HTML),t.ackSelfClosing=!0;break;case V.TITLE:e._switchToTextParsing(t,yU.RCDATA);break;case V.NOSCRIPT:e.options.scriptingEnabled?e._switchToTextParsing(t,yU.RAWTEXT):(e._insertElement(t,j.HTML),e.insertionMode=q.IN_HEAD_NO_SCRIPT);break;case V.NOFRAMES:case V.STYLE:e._switchToTextParsing(t,yU.RAWTEXT);break;case V.SCRIPT:e._switchToTextParsing(t,yU.SCRIPT_DATA);break;case V.TEMPLATE:e._insertTemplate(t),e.activeFormattingElements.insertMarker(),e.framesetOk=!1,e.insertionMode=q.IN_TEMPLATE,e.tmplInsertionModeStack.unshift(q.IN_TEMPLATE);break;case V.HEAD:e._err(t,O.misplacedStartTagForHeadElement);break;default:vx(e,t)}}function vw(e,t){e.openElements.tmplCount>0?(e.openElements.generateImpliedEndTagsThoroughly(),e.openElements.currentTagId!==V.TEMPLATE&&e._err(t,O.closingOfElementWithOpenChildElements),e.openElements.popUntilTagNamePopped(V.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode()):e._err(t,O.endTagWithoutMatchingOpenElement)}function vx(e,t){e.openElements.pop(),e.insertionMode=q.AFTER_HEAD,e._processToken(t)}function vS(e,t){let n=t.type===D.EOF?O.openElementsLeftAfterEof:O.disallowedContentInNoscriptInHead;e._err(t,n),e.openElements.pop(),e.insertionMode=q.IN_HEAD,e._processToken(t)}function vA(e,t){e._insertFakeElement(z.BODY,V.BODY),e.insertionMode=q.IN_BODY,v_(e,t)}function v_(e,t){switch(t.type){case D.CHARACTER:vM(e,t);break;case D.WHITESPACE_CHARACTER:vN(e,t);break;case D.COMMENT:vy(e,t);break;case D.START_TAG:vL(e,t);break;case D.END_TAG:vB(e,t);break;case D.EOF:vH(e,t)}}function vN(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t)}function vM(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t),e.framesetOk=!1}function vI(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,j.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function vO(e){let t=yI(e,F.TYPE);return null!=t&&"hidden"===t.toLowerCase()}function vD(e,t){e._switchToTextParsing(t,yU.RAWTEXT)}function vR(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,j.HTML)}function vL(e,t){switch(t.tagID){case V.I:case V.S:case V.B:case V.U:case V.EM:case V.TT:case V.BIG:case V.CODE:case V.FONT:case V.SMALL:case V.STRIKE:case V.STRONG:e._reconstructActiveFormattingElements(),e._insertElement(t,j.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t);break;case V.A:let n;(n=e.activeFormattingElements.getElementEntryInScopeWithTagName(z.A))&&(vb(e,t),e.openElements.remove(n.element),e.activeFormattingElements.removeEntry(n)),e._reconstructActiveFormattingElements(),e._insertElement(t,j.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t);break;case V.H1:case V.H2:case V.H3:case V.H4:case V.H5:case V.H6:e.openElements.hasInButtonScope(V.P)&&e._closePElement(),void 0!==e.openElements.currentTagId&&yF.has(e.openElements.currentTagId)&&e.openElements.pop(),e._insertElement(t,j.HTML);break;case V.P:case V.DL:case V.OL:case V.UL:case V.DIV:case V.DIR:case V.NAV:case V.MAIN:case V.MENU:case V.ASIDE:case V.CENTER:case V.FIGURE:case V.FOOTER:case V.HEADER:case V.HGROUP:case V.DIALOG:case V.DETAILS:case V.ADDRESS:case V.ARTICLE:case V.SEARCH:case V.SECTION:case V.SUMMARY:case V.FIELDSET:case V.BLOCKQUOTE:case V.FIGCAPTION:e.openElements.hasInButtonScope(V.P)&&e._closePElement(),e._insertElement(t,j.HTML);break;case V.LI:case V.DD:case V.DT:e.framesetOk=!1;let r=t.tagID;for(let t=e.openElements.stackTop;t>=0;t--){let n=e.openElements.tagIDs[t];if(r===V.LI&&n===V.LI||(r===V.DD||r===V.DT)&&(n===V.DD||n===V.DT)){e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.popUntilTagNamePopped(n);break}if(n!==V.ADDRESS&&n!==V.DIV&&n!==V.P&&e._isSpecialElement(e.openElements.items[t],n))break}e.openElements.hasInButtonScope(V.P)&&e._closePElement(),e._insertElement(t,j.HTML);break;case V.BR:case V.IMG:case V.WBR:case V.AREA:case V.EMBED:case V.KEYGEN:vI(e,t);break;case V.HR:e.openElements.hasInButtonScope(V.P)&&e._closePElement(),e._appendElement(t,j.HTML),e.framesetOk=!1,t.ackSelfClosing=!0;break;case V.RB:case V.RTC:e.openElements.hasInScope(V.RUBY)&&e.openElements.generateImpliedEndTags(),e._insertElement(t,j.HTML);break;case V.RT:case V.RP:e.openElements.hasInScope(V.RUBY)&&e.openElements.generateImpliedEndTagsWithExclusion(V.RTC),e._insertElement(t,j.HTML);break;case V.PRE:case V.LISTING:e.openElements.hasInButtonScope(V.P)&&e._closePElement(),e._insertElement(t,j.HTML),e.skipNextNewLine=!0,e.framesetOk=!1;break;case V.XMP:e.openElements.hasInButtonScope(V.P)&&e._closePElement(),e._reconstructActiveFormattingElements(),e.framesetOk=!1,e._switchToTextParsing(t,yU.RAWTEXT);break;case V.SVG:e._reconstructActiveFormattingElements(),vu(t),vh(t),t.selfClosing?e._appendElement(t,j.SVG):e._insertElement(t,j.SVG),t.ackSelfClosing=!0;break;case V.HTML:0===e.openElements.tmplCount&&e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs);break;case V.BASE:case V.LINK:case V.META:case V.STYLE:case V.TITLE:case V.SCRIPT:case V.BGSOUND:case V.BASEFONT:case V.TEMPLATE:vT(e,t);break;case V.BODY:let o;(o=e.openElements.tryPeekProperlyNestedBodyElement())&&0===e.openElements.tmplCount&&(e.framesetOk=!1,e.treeAdapter.adoptAttributes(o,t.attrs));break;case V.FORM:let i;i=e.openElements.tmplCount>0,(!e.formElement||i)&&(e.openElements.hasInButtonScope(V.P)&&e._closePElement(),e._insertElement(t,j.HTML),i||(e.formElement=e.openElements.current));break;case V.NOBR:e._reconstructActiveFormattingElements(),e.openElements.hasInScope(V.NOBR)&&(vb(e,t),e._reconstructActiveFormattingElements()),e._insertElement(t,j.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t);break;case V.MATH:e._reconstructActiveFormattingElements(),vd(t),vh(t),t.selfClosing?e._appendElement(t,j.MATHML):e._insertElement(t,j.MATHML),t.ackSelfClosing=!0;break;case V.TABLE:e.treeAdapter.getDocumentMode(e.document)!==U.QUIRKS&&e.openElements.hasInButtonScope(V.P)&&e._closePElement(),e._insertElement(t,j.HTML),e.framesetOk=!1,e.insertionMode=q.IN_TABLE;break;case V.INPUT:e._reconstructActiveFormattingElements(),e._appendElement(t,j.HTML),vO(t)||(e.framesetOk=!1),t.ackSelfClosing=!0;break;case V.PARAM:case V.TRACK:case V.SOURCE:e._appendElement(t,j.HTML),t.ackSelfClosing=!0;break;case V.IMAGE:t.tagName=z.IMG,t.tagID=V.IMG,vI(e,t);break;case V.BUTTON:e.openElements.hasInScope(V.BUTTON)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(V.BUTTON)),e._reconstructActiveFormattingElements(),e._insertElement(t,j.HTML),e.framesetOk=!1;break;case V.APPLET:case V.OBJECT:case V.MARQUEE:e._reconstructActiveFormattingElements(),e._insertElement(t,j.HTML),e.activeFormattingElements.insertMarker(),e.framesetOk=!1;break;case V.IFRAME:e.framesetOk=!1,e._switchToTextParsing(t,yU.RAWTEXT);break;case V.SELECT:e._reconstructActiveFormattingElements(),e._insertElement(t,j.HTML),e.framesetOk=!1,e.insertionMode=e.insertionMode===q.IN_TABLE||e.insertionMode===q.IN_CAPTION||e.insertionMode===q.IN_TABLE_BODY||e.insertionMode===q.IN_ROW||e.insertionMode===q.IN_CELL?q.IN_SELECT_IN_TABLE:q.IN_SELECT;break;case V.OPTION:case V.OPTGROUP:e.openElements.currentTagId===V.OPTION&&e.openElements.pop(),e._reconstructActiveFormattingElements(),e._insertElement(t,j.HTML);break;case V.NOEMBED:case V.NOFRAMES:vD(e,t);break;case V.FRAMESET:let s;s=e.openElements.tryPeekProperlyNestedBodyElement(),e.framesetOk&&s&&(e.treeAdapter.detachNode(s),e.openElements.popAllUpToHtmlElement(),e._insertElement(t,j.HTML),e.insertionMode=q.IN_FRAMESET);break;case V.TEXTAREA:e._insertElement(t,j.HTML),e.skipNextNewLine=!0,e.tokenizer.state=yU.RCDATA,e.originalInsertionMode=e.insertionMode,e.framesetOk=!1,e.insertionMode=q.TEXT;break;case V.NOSCRIPT:e.options.scriptingEnabled?vD(e,t):vR(e,t);break;case V.PLAINTEXT:e.openElements.hasInButtonScope(V.P)&&e._closePElement(),e._insertElement(t,j.HTML),e.tokenizer.state=yU.PLAINTEXT;break;case V.COL:case V.TH:case V.TD:case V.TR:case V.HEAD:case V.FRAME:case V.TBODY:case V.TFOOT:case V.THEAD:case V.CAPTION:case V.COLGROUP:break;default:vR(e,t)}}function vP(e,t){let n=t.tagName,r=t.tagID;for(let t=e.openElements.stackTop;t>0;t--){let o=e.openElements.items[t],i=e.openElements.tagIDs[t];if(r===i&&(r!==V.UNKNOWN||e.treeAdapter.getTagName(o)===n)){e.openElements.generateImpliedEndTagsWithExclusion(r),e.openElements.stackTop>=t&&e.openElements.shortenToLength(t);break}if(e._isSpecialElement(o,i))break}}function vB(e,t){switch(t.tagID){case V.A:case V.B:case V.I:case V.S:case V.U:case V.EM:case V.TT:case V.BIG:case V.CODE:case V.FONT:case V.NOBR:case V.SMALL:case V.STRIKE:case V.STRONG:vb(e,t);break;case V.P:e.openElements.hasInButtonScope(V.P)||e._insertFakeElement(z.P,V.P),e._closePElement();break;case V.DL:case V.UL:case V.OL:case V.DIR:case V.DIV:case V.NAV:case V.PRE:case V.MAIN:case V.MENU:case V.ASIDE:case V.BUTTON:case V.CENTER:case V.FIGURE:case V.FOOTER:case V.HEADER:case V.HGROUP:case V.DIALOG:case V.ADDRESS:case V.ARTICLE:case V.DETAILS:case V.SEARCH:case V.SECTION:case V.SUMMARY:case V.LISTING:case V.FIELDSET:case V.BLOCKQUOTE:case V.FIGCAPTION:let n;n=t.tagID,e.openElements.hasInScope(n)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(n));break;case V.LI:e.openElements.hasInListItemScope(V.LI)&&(e.openElements.generateImpliedEndTagsWithExclusion(V.LI),e.openElements.popUntilTagNamePopped(V.LI));break;case V.DD:case V.DT:let r;r=t.tagID,e.openElements.hasInScope(r)&&(e.openElements.generateImpliedEndTagsWithExclusion(r),e.openElements.popUntilTagNamePopped(r));break;case V.H1:case V.H2:case V.H3:case V.H4:case V.H5:case V.H6:e.openElements.hasNumberedHeaderInScope()&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilNumberedHeaderPopped());break;case V.BR:e._reconstructActiveFormattingElements(),e._insertFakeElement(z.BR,V.BR),e.openElements.pop(),e.framesetOk=!1;break;case V.BODY:if(e.openElements.hasInScope(V.BODY)&&(e.insertionMode=q.AFTER_BODY,e.options.sourceCodeLocationInfo)){let n=e.openElements.tryPeekProperlyNestedBodyElement();n&&e._setEndLocation(n,t)}break;case V.HTML:e.openElements.hasInScope(V.BODY)&&(e.insertionMode=q.AFTER_BODY,v2(e,t));break;case V.FORM:!function(e){let t=e.openElements.tmplCount>0,{formElement:n}=e;t||(e.formElement=null),(n||t)&&e.openElements.hasInScope(V.FORM)&&(e.openElements.generateImpliedEndTags(),t?e.openElements.popUntilTagNamePopped(V.FORM):n&&e.openElements.remove(n))}(e);break;case V.APPLET:case V.OBJECT:case V.MARQUEE:let o;o=t.tagID,e.openElements.hasInScope(o)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(o),e.activeFormattingElements.clearToLastMarker());break;case V.TEMPLATE:vw(e,t);break;default:vP(e,t)}}function vH(e,t){e.tmplInsertionModeStack.length>0?v1(e,t):vv(e,t)}function vj(e,t){if(void 0!==e.openElements.currentTagId&&vf.has(e.openElements.currentTagId))switch(e.pendingCharacterTokens.length=0,e.hasNonWhitespacePendingCharacterToken=!1,e.originalInsertionMode=e.insertionMode,e.insertionMode=q.IN_TABLE_TEXT,t.type){case D.CHARACTER:v$(e,t);break;case D.WHITESPACE_CHARACTER:vV(e,t)}else vz(e,t)}function vF(e,t){switch(t.tagID){case V.TD:case V.TH:case V.TR:e.openElements.clearBackToTableContext(),e._insertFakeElement(z.TBODY,V.TBODY),e.insertionMode=q.IN_TABLE_BODY,vK(e,t);break;case V.STYLE:case V.SCRIPT:case V.TEMPLATE:vT(e,t);break;case V.COL:e.openElements.clearBackToTableContext(),e._insertFakeElement(z.COLGROUP,V.COLGROUP),e.insertionMode=q.IN_COLUMN_GROUP,vW(e,t);break;case V.FORM:e.formElement||0!==e.openElements.tmplCount||(e._insertElement(t,j.HTML),e.formElement=e.openElements.current,e.openElements.pop());break;case V.TABLE:e.openElements.hasInTableScope(V.TABLE)&&(e.openElements.popUntilTagNamePopped(V.TABLE),e._resetInsertionMode(),e._processStartTag(t));break;case V.TBODY:case V.TFOOT:case V.THEAD:e.openElements.clearBackToTableContext(),e._insertElement(t,j.HTML),e.insertionMode=q.IN_TABLE_BODY;break;case V.INPUT:vO(t)?e._appendElement(t,j.HTML):vz(e,t),t.ackSelfClosing=!0;break;case V.CAPTION:e.openElements.clearBackToTableContext(),e.activeFormattingElements.insertMarker(),e._insertElement(t,j.HTML),e.insertionMode=q.IN_CAPTION;break;case V.COLGROUP:e.openElements.clearBackToTableContext(),e._insertElement(t,j.HTML),e.insertionMode=q.IN_COLUMN_GROUP;break;default:vz(e,t)}}function vU(e,t){switch(t.tagID){case V.TABLE:e.openElements.hasInTableScope(V.TABLE)&&(e.openElements.popUntilTagNamePopped(V.TABLE),e._resetInsertionMode());break;case V.TEMPLATE:vw(e,t);break;case V.BODY:case V.CAPTION:case V.COL:case V.COLGROUP:case V.HTML:case V.TBODY:case V.TD:case V.TFOOT:case V.TH:case V.THEAD:case V.TR:break;default:vz(e,t)}}function vz(e,t){let n=e.fosterParentingEnabled;e.fosterParentingEnabled=!0,v_(e,t),e.fosterParentingEnabled=n}function vV(e,t){e.pendingCharacterTokens.push(t)}function v$(e,t){e.pendingCharacterTokens.push(t),e.hasNonWhitespacePendingCharacterToken=!0}function vG(e,t){let n=0;if(e.hasNonWhitespacePendingCharacterToken)for(;n<e.pendingCharacterTokens.length;n++)vz(e,e.pendingCharacterTokens[n]);else for(;n<e.pendingCharacterTokens.length;n++)e._insertCharacters(e.pendingCharacterTokens[n]);e.insertionMode=e.originalInsertionMode,e._processToken(t)}let vq=new Set([V.CAPTION,V.COL,V.COLGROUP,V.TBODY,V.TD,V.TFOOT,V.TH,V.THEAD,V.TR]);function vW(e,t){switch(t.tagID){case V.HTML:vL(e,t);break;case V.COL:e._appendElement(t,j.HTML),t.ackSelfClosing=!0;break;case V.TEMPLATE:vT(e,t);break;default:vY(e,t)}}function vY(e,t){e.openElements.currentTagId===V.COLGROUP&&(e.openElements.pop(),e.insertionMode=q.IN_TABLE,e._processToken(t))}function vK(e,t){switch(t.tagID){case V.TR:e.openElements.clearBackToTableBodyContext(),e._insertElement(t,j.HTML),e.insertionMode=q.IN_ROW;break;case V.TH:case V.TD:e.openElements.clearBackToTableBodyContext(),e._insertFakeElement(z.TR,V.TR),e.insertionMode=q.IN_ROW,vX(e,t);break;case V.CAPTION:case V.COL:case V.COLGROUP:case V.TBODY:case V.TFOOT:case V.THEAD:e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=q.IN_TABLE,vF(e,t));break;default:vF(e,t)}}function vZ(e,t){let n=t.tagID;switch(t.tagID){case V.TBODY:case V.TFOOT:case V.THEAD:e.openElements.hasInTableScope(n)&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=q.IN_TABLE);break;case V.TABLE:e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=q.IN_TABLE,vU(e,t));break;case V.BODY:case V.CAPTION:case V.COL:case V.COLGROUP:case V.HTML:case V.TD:case V.TH:case V.TR:break;default:vU(e,t)}}function vX(e,t){switch(t.tagID){case V.TH:case V.TD:e.openElements.clearBackToTableRowContext(),e._insertElement(t,j.HTML),e.insertionMode=q.IN_CELL,e.activeFormattingElements.insertMarker();break;case V.CAPTION:case V.COL:case V.COLGROUP:case V.TBODY:case V.TFOOT:case V.THEAD:case V.TR:e.openElements.hasInTableScope(V.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=q.IN_TABLE_BODY,vK(e,t));break;default:vF(e,t)}}function vQ(e,t){switch(t.tagID){case V.TR:e.openElements.hasInTableScope(V.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=q.IN_TABLE_BODY);break;case V.TABLE:e.openElements.hasInTableScope(V.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=q.IN_TABLE_BODY,vZ(e,t));break;case V.TBODY:case V.TFOOT:case V.THEAD:(e.openElements.hasInTableScope(t.tagID)||e.openElements.hasInTableScope(V.TR))&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=q.IN_TABLE_BODY,vZ(e,t));break;case V.BODY:case V.CAPTION:case V.COL:case V.COLGROUP:case V.HTML:case V.TD:case V.TH:break;default:vU(e,t)}}function vJ(e,t){switch(t.tagID){case V.HTML:vL(e,t);break;case V.OPTION:e.openElements.currentTagId===V.OPTION&&e.openElements.pop(),e._insertElement(t,j.HTML);break;case V.OPTGROUP:e.openElements.currentTagId===V.OPTION&&e.openElements.pop(),e.openElements.currentTagId===V.OPTGROUP&&e.openElements.pop(),e._insertElement(t,j.HTML);break;case V.HR:e.openElements.currentTagId===V.OPTION&&e.openElements.pop(),e.openElements.currentTagId===V.OPTGROUP&&e.openElements.pop(),e._appendElement(t,j.HTML),t.ackSelfClosing=!0;break;case V.INPUT:case V.KEYGEN:case V.TEXTAREA:case V.SELECT:e.openElements.hasInSelectScope(V.SELECT)&&(e.openElements.popUntilTagNamePopped(V.SELECT),e._resetInsertionMode(),t.tagID!==V.SELECT&&e._processStartTag(t));break;case V.SCRIPT:case V.TEMPLATE:vT(e,t)}}function v0(e,t){switch(t.tagID){case V.OPTGROUP:e.openElements.stackTop>0&&e.openElements.currentTagId===V.OPTION&&e.openElements.tagIDs[e.openElements.stackTop-1]===V.OPTGROUP&&e.openElements.pop(),e.openElements.currentTagId===V.OPTGROUP&&e.openElements.pop();break;case V.OPTION:e.openElements.currentTagId===V.OPTION&&e.openElements.pop();break;case V.SELECT:e.openElements.hasInSelectScope(V.SELECT)&&(e.openElements.popUntilTagNamePopped(V.SELECT),e._resetInsertionMode());break;case V.TEMPLATE:vw(e,t)}}function v1(e,t){e.openElements.tmplCount>0?(e.openElements.popUntilTagNamePopped(V.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode(),e.onEof(t)):vv(e,t)}function v2(e,t){var n;if(t.tagID===V.HTML){if(e.fragmentContext||(e.insertionMode=q.AFTER_AFTER_BODY),e.options.sourceCodeLocationInfo&&e.openElements.tagIDs[0]===V.HTML){e._setEndLocation(e.openElements.items[0],t);let r=e.openElements.items[1];!r||(null==(n=e.treeAdapter.getNodeSourceCodeLocation(r))?void 0:n.endTag)||e._setEndLocation(r,t)}}else v4(e,t)}function v4(e,t){e.insertionMode=q.IN_BODY,v_(e,t)}function v5(e,t){e.insertionMode=q.IN_BODY,v_(e,t)}function v3(e){for(;e.treeAdapter.getNamespaceURI(e.openElements.current)!==j.HTML&&void 0!==e.openElements.currentTagId&&!e._isIntegrationPoint(e.openElements.currentTagId,e.openElements.current);)e.openElements.pop()}function v8(e,t){return vg.parse(e,t)}function v6(e,t,n){"string"==typeof e&&(n=t,t=e,e=null);let r=vg.getFragmentParser(e,n);return r.tokenizer.write(t,!0),r.getFragment()}function v9(e){return e&&"object"==typeof e?"position"in e||"type"in e?Ee(e.position):"start"in e||"end"in e?Ee(e):"line"in e||"column"in e?v7(e):"":""}function v7(e){return Et(e&&e.line)+":"+Et(e&&e.column)}function Ee(e){return v7(e&&e.start)+"-"+v7(e&&e.end)}function Et(e){return e&&"number"==typeof e?e:1}String.prototype.codePointAt,z.AREA,z.BASE,z.BASEFONT,z.BGSOUND,z.BR,z.COL,z.EMBED,z.FRAME,z.HR,z.IMG,z.INPUT,z.KEYGEN,z.LINK,z.META,z.PARAM,z.SOURCE,z.TRACK,z.WBR;class En extends Error{constructor(e,t,n){super(),"string"==typeof t&&(n=t,t=void 0);let r="",o={},i=!1;if(t&&(o="line"in t&&"column"in t||"start"in t&&"end"in t?{place:t}:"type"in t?{ancestors:[t],place:t.position}:{...t}),"string"==typeof e?r=e:!o.cause&&e&&(i=!0,r=e.message,o.cause=e),!o.ruleId&&!o.source&&"string"==typeof n){const e=n.indexOf(":");-1===e?o.ruleId=n:(o.source=n.slice(0,e),o.ruleId=n.slice(e+1))}if(!o.place&&o.ancestors&&o.ancestors){const e=o.ancestors[o.ancestors.length-1];e&&(o.place=e.position)}const s=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=s?s.column:void 0,this.fatal=void 0,this.file="",this.message=r,this.line=s?s.line:void 0,this.name=v9(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=i&&o.cause&&"string"==typeof o.cause.stack?o.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}En.prototype.file="",En.prototype.name="",En.prototype.reason="",En.prototype.message="",En.prototype.stack="",En.prototype.column=void 0,En.prototype.line=void 0,En.prototype.ancestors=void 0,En.prototype.cause=void 0,En.prototype.fatal=void 0,En.prototype.place=void 0,En.prototype.ruleId=void 0,En.prototype.source=void 0;let Er=function(e,t){let n;if(void 0!==t&&"string"!=typeof t)throw TypeError('"ext" argument must be a string');El(e);let r=0,o=-1,i=e.length;if(void 0===t||0===t.length||t.length>e.length){for(;i--;)if(47===e.codePointAt(i)){if(n){r=i+1;break}}else o<0&&(n=!0,o=i+1);return o<0?"":e.slice(r,o)}if(t===e)return"";let s=-1,l=t.length-1;for(;i--;)if(47===e.codePointAt(i)){if(n){r=i+1;break}}else s<0&&(n=!0,s=i+1),l>-1&&(e.codePointAt(i)===t.codePointAt(l--)?l<0&&(o=i):(l=-1,o=s));return r===o?o=s:o<0&&(o=e.length),e.slice(r,o)},Eo=function(e){let t;if(El(e),0===e.length)return".";let n=-1,r=e.length;for(;--r;)if(47===e.codePointAt(r)){if(t){n=r;break}}else t||(t=!0);return n<0?47===e.codePointAt(0)?"/":".":1===n&&47===e.codePointAt(0)?"//":e.slice(0,n)},Ei=function(e){let t;El(e);let n=e.length,r=-1,o=0,i=-1,s=0;for(;n--;){let l=e.codePointAt(n);if(47===l){if(t){o=n+1;break}continue}r<0&&(t=!0,r=n+1),46===l?i<0?i=n:1!==s&&(s=1):i>-1&&(s=-1)}return i<0||r<0||0===s||1===s&&i===r-1&&i===o+1?"":e.slice(i,r)},Es=function(...e){var t;let n,r,o,i=-1;for(;++i<e.length;)El(e[i]),e[i]&&(o=void 0===o?e[i]:o+"/"+e[i]);return void 0===o?".":(El(t=o),n=47===t.codePointAt(0),0!==(r=function(e,t){let n,r,o="",i=0,s=-1,l=0,a=-1;for(;++a<=e.length;){if(a<e.length)n=e.codePointAt(a);else if(47===n)break;else n=47;if(47===n){if(s===a-1||1===l);else if(s!==a-1&&2===l){if(o.length<2||2!==i||46!==o.codePointAt(o.length-1)||46!==o.codePointAt(o.length-2)){if(o.length>2){if((r=o.lastIndexOf("/"))!==o.length-1){r<0?(o="",i=0):i=(o=o.slice(0,r)).length-1-o.lastIndexOf("/"),s=a,l=0;continue}}else if(o.length>0){o="",i=0,s=a,l=0;continue}}t&&(o=o.length>0?o+"/..":"..",i=2)}else o.length>0?o+="/"+e.slice(s+1,a):o=e.slice(s+1,a),i=a-s-1;s=a,l=0}else 46===n&&l>-1?l++:l=-1}return o}(t,!n)).length||n||(r="."),r.length>0&&47===t.codePointAt(t.length-1)&&(r+="/"),n?"/"+r:r)};function El(e){if("string"!=typeof e)throw TypeError("Path must be a string. Received "+JSON.stringify(e))}function Ea(e){return!!(null!==e&&"object"==typeof e&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&void 0===e.auth)}let Ec=["history","path","basename","stem","extname","dirname"];class Ed{constructor(e){let t,n;t=e?Ea(e)?{path:e}:"string"==typeof e||function(e){return!!(e&&"object"==typeof e&&"byteLength"in e&&"byteOffset"in e)}(e)?{value:e}:e:{},this.cwd="cwd"in t?"":"/",this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<Ec.length;){const e=Ec[r];e in t&&void 0!==t[e]&&null!==t[e]&&(this[e]="history"===e?[...t[e]]:t[e])}for(n in t)Ec.includes(n)||(this[n]=t[n])}get basename(){return"string"==typeof this.path?Er(this.path):void 0}set basename(e){Eh(e,"basename"),Eu(e,"basename"),this.path=Es(this.dirname||"",e)}get dirname(){return"string"==typeof this.path?Eo(this.path):void 0}set dirname(e){Ep(this.basename,"dirname"),this.path=Es(e||"",this.basename)}get extname(){return"string"==typeof this.path?Ei(this.path):void 0}set extname(e){if(Eu(e,"extname"),Ep(this.dirname,"extname"),e){if(46!==e.codePointAt(0))throw Error("`extname` must start with `.`");if(e.includes(".",1))throw Error("`extname` cannot contain multiple dots")}this.path=Es(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){Ea(e)&&(e=function(e){if("string"==typeof e)e=new URL(e);else if(!Ea(e)){let t=TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if("file:"!==e.protocol){let e=TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return function(e){if(""!==e.hostname){let e=TypeError('File URL host must be "localhost" or empty on darwin');throw e.code="ERR_INVALID_FILE_URL_HOST",e}let t=e.pathname,n=-1;for(;++n<t.length;)if(37===t.codePointAt(n)&&50===t.codePointAt(n+1)){let e=t.codePointAt(n+2);if(70===e||102===e){let e=TypeError("File URL path must not include encoded / characters");throw e.code="ERR_INVALID_FILE_URL_PATH",e}}return decodeURIComponent(t)}(e)}(e)),Eh(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return"string"==typeof this.path?Er(this.path,this.extname):void 0}set stem(e){Eh(e,"stem"),Eu(e,"stem"),this.path=Es(this.dirname||"",e+(this.extname||""))}fail(e,t,n){let r=this.message(e,t,n);throw r.fatal=!0,r}info(e,t,n){let r=this.message(e,t,n);return r.fatal=void 0,r}message(e,t,n){let r=new En(e,t,n);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r}toString(e){return void 0===this.value?"":"string"==typeof this.value?this.value:new TextDecoder(e||void 0).decode(this.value)}}function Eu(e,t){if(e&&e.includes("/"))throw Error("`"+t+"` cannot be a path: did not expect `/`")}function Eh(e,t){if(!e)throw Error("`"+t+"` cannot be empty")}function Ep(e,t){if(!e)throw Error("Setting `"+t+"` requires `path` to be set too")}let Ef={abandonedHeadElementChild:{reason:"Unexpected metadata element after head",description:"Unexpected element after head. Expected the element before `</head>`",url:!1},abruptClosingOfEmptyComment:{reason:"Unexpected abruptly closed empty comment",description:"Unexpected `>` or `->`. Expected `-->` to close comments"},abruptDoctypePublicIdentifier:{reason:"Unexpected abruptly closed public identifier",description:"Unexpected `>`. Expected a closing `\"` or `'` after the public identifier"},abruptDoctypeSystemIdentifier:{reason:"Unexpected abruptly closed system identifier",description:"Unexpected `>`. Expected a closing `\"` or `'` after the identifier identifier"},absenceOfDigitsInNumericCharacterReference:{reason:"Unexpected non-digit at start of numeric character reference",description:"Unexpected `%c`. Expected `[0-9]` for decimal references or `[0-9a-fA-F]` for hexadecimal references"},cdataInHtmlContent:{reason:"Unexpected CDATA section in HTML",description:"Unexpected `<![CDATA[` in HTML. Remove it, use a comment, or encode special characters instead"},characterReferenceOutsideUnicodeRange:{reason:"Unexpected too big numeric character reference",description:"Unexpectedly high character reference. Expected character references to be at most hexadecimal 10ffff (or decimal 1114111)"},closingOfElementWithOpenChildElements:{reason:"Unexpected closing tag with open child elements",description:"Unexpectedly closing tag. Expected other tags to be closed first",url:!1},controlCharacterInInputStream:{reason:"Unexpected control character",description:"Unexpected control character `%x`. Expected a non-control code point, 0x00, or ASCII whitespace"},controlCharacterReference:{reason:"Unexpected control character reference",description:"Unexpectedly control character in reference. Expected a non-control code point, 0x00, or ASCII whitespace"},disallowedContentInNoscriptInHead:{reason:"Disallowed content inside `<noscript>` in `<head>`",description:"Unexpected text character `%c`. Only use text in `<noscript>`s in `<body>`",url:!1},duplicateAttribute:{reason:"Unexpected duplicate attribute",description:"Unexpectedly double attribute. Expected attributes to occur only once"},endTagWithAttributes:{reason:"Unexpected attribute on closing tag",description:"Unexpected attribute. Expected `>` instead"},endTagWithTrailingSolidus:{reason:"Unexpected slash at end of closing tag",description:"Unexpected `%c-1`. Expected `>` instead"},endTagWithoutMatchingOpenElement:{reason:"Unexpected unopened end tag",description:"Unexpected end tag. Expected no end tag or another end tag",url:!1},eofBeforeTagName:{reason:"Unexpected end of file",description:"Unexpected end of file. Expected tag name instead"},eofInCdata:{reason:"Unexpected end of file in CDATA",description:"Unexpected end of file. Expected `]]>` to close the CDATA"},eofInComment:{reason:"Unexpected end of file in comment",description:"Unexpected end of file. Expected `-->` to close the comment"},eofInDoctype:{reason:"Unexpected end of file in doctype",description:"Unexpected end of file. Expected a valid doctype (such as `<!doctype html>`)"},eofInElementThatCanContainOnlyText:{reason:"Unexpected end of file in element that can only contain text",description:"Unexpected end of file. Expected text or a closing tag",url:!1},eofInScriptHtmlCommentLikeText:{reason:"Unexpected end of file in comment inside script",description:"Unexpected end of file. Expected `-->` to close the comment"},eofInTag:{reason:"Unexpected end of file in tag",description:"Unexpected end of file. Expected `>` to close the tag"},incorrectlyClosedComment:{reason:"Incorrectly closed comment",description:"Unexpected `%c-1`. Expected `-->` to close the comment"},incorrectlyOpenedComment:{reason:"Incorrectly opened comment",description:"Unexpected `%c`. Expected `<!--` to open the comment"},invalidCharacterSequenceAfterDoctypeName:{reason:"Invalid sequence after doctype name",description:"Unexpected sequence at `%c`. Expected `public` or `system`"},invalidFirstCharacterOfTagName:{reason:"Invalid first character in tag name",description:"Unexpected `%c`. Expected an ASCII letter instead"},misplacedDoctype:{reason:"Misplaced doctype",description:"Unexpected doctype. Expected doctype before head",url:!1},misplacedStartTagForHeadElement:{reason:"Misplaced `<head>` start tag",description:"Unexpected start tag `<head>`. Expected `<head>` directly after doctype",url:!1},missingAttributeValue:{reason:"Missing attribute value",description:"Unexpected `%c-1`. Expected an attribute value or no `%c-1` instead"},missingDoctype:{reason:"Missing doctype before other content",description:"Expected a `<!doctype html>` before anything else",url:!1},missingDoctypeName:{reason:"Missing doctype name",description:"Unexpected doctype end at `%c`. Expected `html` instead"},missingDoctypePublicIdentifier:{reason:"Missing public identifier in doctype",description:"Unexpected `%c`. Expected identifier for `public` instead"},missingDoctypeSystemIdentifier:{reason:"Missing system identifier in doctype",description:'Unexpected `%c`. Expected identifier for `system` instead (suggested: `"about:legacy-compat"`)'},missingEndTagName:{reason:"Missing name in end tag",description:"Unexpected `%c`. Expected an ASCII letter instead"},missingQuoteBeforeDoctypePublicIdentifier:{reason:"Missing quote before public identifier in doctype",description:"Unexpected `%c`. Expected `\"` or `'` instead"},missingQuoteBeforeDoctypeSystemIdentifier:{reason:"Missing quote before system identifier in doctype",description:"Unexpected `%c`. Expected `\"` or `'` instead"},missingSemicolonAfterCharacterReference:{reason:"Missing semicolon after character reference",description:"Unexpected `%c`. Expected `;` instead"},missingWhitespaceAfterDoctypePublicKeyword:{reason:"Missing whitespace after public identifier in doctype",description:"Unexpected `%c`. Expected ASCII whitespace instead"},missingWhitespaceAfterDoctypeSystemKeyword:{reason:"Missing whitespace after system identifier in doctype",description:"Unexpected `%c`. Expected ASCII whitespace instead"},missingWhitespaceBeforeDoctypeName:{reason:"Missing whitespace before doctype name",description:"Unexpected `%c`. Expected ASCII whitespace instead"},missingWhitespaceBetweenAttributes:{reason:"Missing whitespace between attributes",description:"Unexpected `%c`. Expected ASCII whitespace instead"},missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers:{reason:"Missing whitespace between public and system identifiers in doctype",description:"Unexpected `%c`. Expected ASCII whitespace instead"},nestedComment:{reason:"Unexpected nested comment",description:"Unexpected `<!--`. Expected `-->`"},nestedNoscriptInHead:{reason:"Unexpected nested `<noscript>` in `<head>`",description:"Unexpected `<noscript>`. Expected a closing tag or a meta element",url:!1},nonConformingDoctype:{reason:"Unexpected non-conforming doctype declaration",description:'Expected `<!doctype html>` or `<!doctype html system "about:legacy-compat">`',url:!1},nonVoidHtmlElementStartTagWithTrailingSolidus:{reason:"Unexpected trailing slash on start tag of non-void element",description:"Unexpected `/`. Expected `>` instead"},noncharacterCharacterReference:{reason:"Unexpected noncharacter code point referenced by character reference",description:"Unexpected code point. Do not use noncharacters in HTML"},noncharacterInInputStream:{reason:"Unexpected noncharacter character",description:"Unexpected code point `%x`. Do not use noncharacters in HTML"},nullCharacterReference:{reason:"Unexpected NULL character referenced by character reference",description:"Unexpected code point. Do not use NULL characters in HTML"},openElementsLeftAfterEof:{reason:"Unexpected end of file",description:"Unexpected end of file. Expected closing tag instead",url:!1},surrogateCharacterReference:{reason:"Unexpected surrogate character referenced by character reference",description:"Unexpected code point. Do not use lone surrogate characters in HTML"},surrogateInInputStream:{reason:"Unexpected surrogate character",description:"Unexpected code point `%x`. Do not use lone surrogate characters in HTML"},unexpectedCharacterAfterDoctypeSystemIdentifier:{reason:"Invalid character after system identifier in doctype",description:"Unexpected character at `%c`. Expected `>`"},unexpectedCharacterInAttributeName:{reason:"Unexpected character in attribute name",description:"Unexpected `%c`. Expected whitespace, `/`, `>`, `=`, or probably an ASCII letter"},unexpectedCharacterInUnquotedAttributeValue:{reason:"Unexpected character in unquoted attribute value",description:"Unexpected `%c`. Quote the attribute value to include it"},unexpectedEqualsSignBeforeAttributeName:{reason:"Unexpected equals sign before attribute name",description:"Unexpected `%c`. Add an attribute name before it"},unexpectedNullCharacter:{reason:"Unexpected NULL character",description:"Unexpected code point `%x`. Do not use NULL characters in HTML"},unexpectedQuestionMarkInsteadOfTagName:{reason:"Unexpected question mark instead of tag name",description:"Unexpected `%c`. Expected an ASCII letter instead"},unexpectedSolidusInTag:{reason:"Unexpected slash in tag",description:"Unexpected `%c-1`. Expected it followed by `>` or in a quoted attribute value"},unknownNamedCharacterReference:{reason:"Unexpected unknown named character reference",description:"Unexpected character reference. Expected known named character references"}},Em=/-[a-z]/g,Eg=/%c(?:([-+])(\d+))?/g,Eb=/%x/g,Ey={2:!0,1:!1,0:null};function Ev(e){return e.charAt(1).toUpperCase()}function EE(e){let{emitParseErrors:t,...n}={...this.data("settings"),...e};this.parser=function(e,r){var o;let i,s,l,a,c,d;return s=(i={...n,onerror:t?function(e){r.path&&(e.name=r.path+":"+e.name,e.file=r.path),r.messages.push(e)}:void 0}).onerror,l=e instanceof Ed?e:new Ed(e),a=i.fragment?v6:v8,o=a(c=String(l),{sourceCodeLocationInfo:!0,onParseError:i.onerror?function(e){let t=e.code,n=t.replace(Em,Ev),r=i[n],o=null==r||r,a="number"==typeof o?o:+!!o;if(a){let r=Ef[n];bP(r,"expected known error from `parse5`");let o=new En(d(r.reason),{place:{start:{line:e.startLine,column:e.startCol,offset:e.startOffset},end:{line:e.endLine,column:e.endCol,offset:e.endOffset}},ruleId:t,source:"hast-util-from-html"});l.path&&(o.file=l.path,o.name=l.path+":"+o.name),o.fatal=Ey[a],o.note=d(r.description),o.url=!1===r.url?void 0:"https://html.spec.whatwg.org/multipage/parsing.html#parse-error-"+t,bP(s,"`internalOnerror` is not passed if `onerror` is not set"),s(o)}function d(t){return t.replace(Eg,function(t,n,r){var o;let i=(r?Number.parseInt(r,10):0)*("-"===n?-1:1);return"`"===(o=c.charAt(e.startOffset+i))?"` ` `":o}).replace(Eb,function(){return"0x"+c.charCodeAt(e.startOffset).toString(16).toUpperCase()})}}:null,scriptingEnabled:!1}),yy({file:(d={file:l,space:i.space,verbose:i.verbose}).file||void 0,location:!1,schema:"svg"===d.space?b7:b9,verbose:d.verbose||!1},o)}}let Ek="object"==typeof self?self:globalThis,EC=e=>{var t;let n,r;return(t=new Map,n=(e,n)=>(t.set(n,e),e),r=o=>{if(t.has(o))return t.get(o);let[i,s]=e[o];switch(i){case 0:case -1:return n(s,o);case 1:{let e=n([],o);for(let t of s)e.push(r(t));return e}case 2:{let e=n({},o);for(let[t,n]of s)e[r(t)]=r(n);return e}case 3:return n(new Date(s),o);case 4:{let{source:e,flags:t}=s;return n(new RegExp(e,t),o)}case 5:{let e=n(new Map,o);for(let[t,n]of s)e.set(r(t),r(n));return e}case 6:{let e=n(new Set,o);for(let t of s)e.add(r(t));return e}case 7:{let{name:e,message:t}=s;return n(new Ek[e](t),o)}case 8:return n(BigInt(s),o);case"BigInt":return n(Object(BigInt(s)),o);case"ArrayBuffer":return n(new Uint8Array(s).buffer,s);case"DataView":{let{buffer:e}=new Uint8Array(s);return n(new DataView(e),s)}}return n(new Ek[i](s),o)})(0)},{toString:ET}={},{keys:Ew}=Object,Ex=e=>{let t=typeof e;if("object"!==t||!e)return[0,t];let n=ET.call(e).slice(8,-1);switch(n){case"Array":return[1,""];case"Object":return[2,""];case"Date":return[3,""];case"RegExp":return[4,""];case"Map":return[5,""];case"Set":return[6,""];case"DataView":return[1,n]}return n.includes("Array")?[1,n]:n.includes("Error")?[7,n]:[2,n]},ES=([e,t])=>0===e&&("function"===t||"symbol"===t),EA=(e,{json:t,lossy:n}={})=>{var r,o,i;let s,l,a=[];return(r=!(t||n),o=!!t,i=new Map,s=(e,t)=>{let n=a.push(e)-1;return i.set(t,n),n},l=e=>{if(i.has(e))return i.get(e);let[t,n]=Ex(e);switch(t){case 0:{let o=e;switch(n){case"bigint":t=8,o=e.toString();break;case"function":case"symbol":if(r)throw TypeError("unable to serialize "+n);o=null;break;case"undefined":return s([-1],e)}return s([t,o],e)}case 1:{if(n){let t=e;return"DataView"===n?t=new Uint8Array(e.buffer):"ArrayBuffer"===n&&(t=new Uint8Array(e)),s([n,[...t]],e)}let r=[],o=s([t,r],e);for(let t of e)r.push(l(t));return o}case 2:{if(n)switch(n){case"BigInt":return s([n,e.toString()],e);case"Boolean":case"Number":case"String":return s([n,e.valueOf()],e)}if(o&&"toJSON"in e)return l(e.toJSON());let i=[],a=s([t,i],e);for(let t of Ew(e))(r||!ES(Ex(e[t])))&&i.push([l(t),l(e[t])]);return a}case 3:return s([t,e.toISOString()],e);case 4:{let{source:n,flags:r}=e;return s([t,{source:n,flags:r}],e)}case 5:{let n=[],o=s([t,n],e);for(let[t,o]of e)(r||!(ES(Ex(t))||ES(Ex(o))))&&n.push([l(t),l(o)]);return o}case 6:{let n=[],o=s([t,n],e);for(let t of e)(r||!ES(Ex(t)))&&n.push(l(t));return o}}let{message:a}=e;return s([t,{name:n,message:a}],e)})(e),a},E_="function"==typeof structuredClone?(e,t)=>t&&("json"in t||"lossy"in t)?EC(EA(e,t)):structuredClone(e):(e,t)=>EC(EA(e,t)),EN=function(e,t,n,r,o){let i=EM(t);if(null!=n&&("number"!=typeof n||n<0||n===1/0))throw Error("Expected positive finite `index`");if(null!=r&&(!r.type||!r.children))throw Error("Expected valid `parent`");if(null==n!=(null==r))throw Error("Expected both `index` and `parent`");return!!ED(e)&&i.call(o,e,n,r)},EM=function(e){if(null==e)return EO;if("string"==typeof e){var t;return t=e,EI(function(e){return e.tagName===t})}if("object"==typeof e){var n=e;let t=[],r=-1;for(;++r<n.length;)t[r]=EM(n[r]);return EI(function(...e){let n=-1;for(;++n<t.length;)if(t[n].apply(this,e))return!0;return!1})}if("function"==typeof e)return EI(e);throw Error("Expected function, string, or array as `test`")};function EI(e){return function(t,n,r){return!!(ED(t)&&e.call(this,t,"number"==typeof n?n:void 0,r||void 0))}}function EO(e){return!!(e&&"object"==typeof e&&"type"in e&&"element"===e.type&&"tagName"in e&&"string"==typeof e.tagName)}function ED(e){return null!==e&&"object"==typeof e&&"type"in e&&"tagName"in e}let ER=EM(function(e){return"audio"===e.tagName||"canvas"===e.tagName||"embed"===e.tagName||"iframe"===e.tagName||"img"===e.tagName||"math"===e.tagName||"object"===e.tagName||"picture"===e.tagName||"svg"===e.tagName||"video"===e.tagName}),EL=/[ \t\n\f\r]/g;function EP(e){return"object"==typeof e?"text"===e.type&&EB(e.value):EB(e)}function EB(e){return""===e.replace(EL,"")}let EH=function(e){var t,n;if(null==e)return EF;if("function"==typeof e)return Ej(e);if("object"==typeof e){return Array.isArray(e)?function(e){let t=[],n=-1;for(;++n<e.length;)t[n]=EH(e[n]);return Ej(function(...e){let n=-1;for(;++n<t.length;)if(t[n].apply(this,e))return!0;return!1})}(e):(t=e,Ej(function(e){let n;for(n in t)if(e[n]!==t[n])return!1;return!0}))}if("string"==typeof e){return n=e,Ej(function(e){return e&&e.type===n})}throw Error("Expected function, string, or object as test")};function Ej(e){return function(t,n,r){return!!(function(e){return null!==e&&"object"==typeof e&&"type"in e}(t)&&e.call(this,t,"number"==typeof n?n:void 0,r||void 0))}}function EF(){return!0}let EU=["address","article","aside","blockquote","body","br","caption","center","col","colgroup","dd","dialog","dir","div","dl","dt","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","legend","li","li","listing","main","menu","nav","ol","optgroup","option","p","plaintext","pre","section","summary","table","tbody","td","td","tfoot","th","th","thead","tr","ul","wbr","xmp"],Ez=["button","input","select","textarea"],EV=["area","base","basefont","dialog","datalist","head","link","meta","noembed","noframes","param","rp","script","source","style","template","track","title"],E$={},EG=EH(["comment","doctype"]);function Eq(e){return ER(e)||EN(e,Ez)}function EW(e){return" "===e||"\n"===e}function EY(e){let t=/\r?\n|\r/.exec(e);return t?t[0]:" "}function EK(){return" "}let EZ=[],EX="skip";function EQ(e,t,n,r){let o;"function"==typeof t&&"function"!=typeof n?(r=n,n=t):o=t;let i=EH(o),s=r?-1:1;(function e(o,l,a){let c=o&&"object"==typeof o?o:{};if("string"==typeof c.type){let e="string"==typeof c.tagName?c.tagName:"string"==typeof c.name?c.name:void 0;Object.defineProperty(d,"name",{value:"node ("+o.type+(e?"<"+e+">":"")+")"})}return d;function d(){var c;let d,u,h,p=EZ;if((!t||i(o,l,a[a.length-1]||void 0))&&!1===(p=Array.isArray(c=n(o,a))?c:"number"==typeof c?[!0,c]:null==c?EZ:[c])[0])return p;if("children"in o&&o.children&&o.children&&p[0]!==EX)for(u=(r?o.children.length:-1)+s,h=a.concat(o);u>-1&&u<o.children.length;){if(!1===(d=e(o.children[u],u,h)())[0])return d;u="number"==typeof d[1]?d[1]:u+s}return p}})(e,void 0,[])()}function EJ(e,t,n,r){let o,i,s;"function"==typeof t&&"function"!=typeof n?(i=void 0,s=t,o=n):(i=t,s=n,o=r),EQ(e,i,function(e,t){let n=t[t.length-1],r=n?n.children.indexOf(e):void 0;return s(e,r,n)},o)}let E0=E2("end"),E1=E2("start");function E2(e){return function(t){let n=t&&t.position&&t.position[e]||{};if("number"==typeof n.line&&n.line>0&&"number"==typeof n.column&&n.column>0)return{line:n.line,column:n.column,offset:"number"==typeof n.offset&&n.offset>-1?n.offset:void 0}}}function E4(e){let t=E1(e),n=E0(e);if(t&&n)return{start:t,end:n}}let E5=function(e,t,n){let r=EH(n);if(!e||!e.type||!e.children)throw Error("Expected parent node");if("number"==typeof t){if(t<0||t===1/0)throw Error("Expected positive finite number as index")}else if((t=e.children.indexOf(t))<0)throw Error("Expected child node or index");for(;++t<e.children.length;)if(r(e.children[t],t,e))return e.children[t]},E3=/\n/g,E8=/[\t ]+/g,E6=EM("br"),E9=EM(function(e){return"td"===e.tagName||"th"===e.tagName}),E7=EM("p"),ke=EM("tr"),kt=EM(["datalist","head","noembed","noframes","noscript","rp","script","style","template","title",function(e){return!!(e.properties||{}).hidden},function(e){return"dialog"===e.tagName&&!(e.properties||{}).open}]),kn=EM(["address","article","aside","blockquote","body","caption","center","dd","dialog","dir","dl","dt","div","figure","figcaption","footer","form,","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","legend","li","listing","main","menu","nav","ol","p","plaintext","pre","section","ul","xmp"]);function kr(e,t){let n,r="children"in e?e.children:[],o=kn(e),i=ki(e,{whitespace:(t||{}).whitespace||"normal",breakBefore:!1,breakAfter:!1}),s=[];("text"===e.type||"comment"===e.type)&&s.push(...ko(e,{whitespace:i,breakBefore:!0,breakAfter:!0}));let l=-1;for(;++l<r.length;)s.push(...function e(t,n,r){return"element"===t.type?function(t,n,r){let o,i,s=ki(t,r),l=t.children||[],a=-1,c=[];if(kt(t))return c;for(E6(t)||ke(t)&&E5(n,t,ke)?i="\n":E7(t)?(o=2,i=2):kn(t)&&(o=1,i=1);++a<l.length;)c=c.concat(e(l[a],t,{whitespace:s,breakBefore:a?void 0:o,breakAfter:a<l.length-1?E6(l[a+1]):i}));return E9(t)&&E5(n,t,E9)&&c.push("	"),o&&c.unshift(o),i&&c.push(i),c}(t,n,r):"text"===t.type?"normal"===r.whitespace?ko(t,r):[String(t.value)]:[]}(r[l],e,{whitespace:i,breakBefore:l?void 0:o,breakAfter:l<r.length-1?E6(r[l+1]):o}));let a=[];for(l=-1;++l<s.length;){let e=s[l];"number"==typeof e?void 0!==n&&e>n&&(n=e):e&&(void 0!==n&&n>-1&&a.push("\n".repeat(n)||" "),n=-1,a.push(e))}return a.join("")}function ko(e,t){let n,r=String(e.value),o=[],i=[],s=0;for(;s<=r.length;){E3.lastIndex=s;let e=E3.exec(r),n=e&&"index"in e?e.index:r.length;o.push(function(e,t,n){let r,o=[],i=0;for(;i<e.length;){E8.lastIndex=i;let n=E8.exec(e);r=n?n.index:e.length,i||r||!n||t||o.push(""),i!==r&&o.push(e.slice(i,r)),i=n?r+n[0].length:r}return i===r||n||o.push(""),o.join(" ")}(r.slice(s,n).replace(/[\u061C\u200E\u200F\u202A-\u202E\u2066-\u2069]/g,""),0!==s||t.breakBefore,n!==r.length||t.breakAfter)),s=n+1}let l=-1;for(;++l<o.length;)8203===o[l].charCodeAt(o[l].length-1)||l<o.length-1&&8203===o[l+1].charCodeAt(0)?(i.push(o[l]),n=void 0):o[l]?("number"==typeof n&&i.push(n),i.push(o[l]),n=0):(0===l||l===o.length-1)&&i.push(0);return i}function ki(e,t){if("element"===e.type){let n=e.properties||{};switch(e.tagName){case"listing":case"plaintext":case"xmp":return"pre";case"nobr":return"nowrap";case"pre":return n.wrap?"pre-wrap":"pre";case"td":case"th":return n.noWrap?"nowrap":t.whitespace;case"textarea":return"pre-wrap"}}return t.whitespace}let ks="language-";function kl(e,t){let n,r,o=t.children,i=-1;if("pre"===t.tagName)for(;++i<o.length;){let e=o[i];if("element"===e.type&&"code"===e.tagName&&e.properties&&e.properties.className&&Array.isArray(e.properties.className)){n=e.properties.className;break}}if(n){for(i=-1;++i<n.length;)if(String(n[i]).slice(0,ks.length)===ks){r=String(n[i]).slice(ks.length);break}}let s={type:"code",lang:r||null,meta:null,value:function(e){let t=String(e),n=t.length;for(;n>0;){let e=t.codePointAt(n-1);if(void 0!==e&&(10===e||13===e))n--;else break}return t.slice(0,n)}(kr(t))};return e.patch(t,s),s}function ka(e,t){let n={type:"delete",children:e.all(t)};return e.patch(t,n),n}function kc(e){let t=-1;if(e.length>1){for(;++t<e.length;)if(e[t].spread)return!0}return!1}function kd(e,t){let n=e.all({type:"root",children:t}),r=e.toSpecificContent(n,ku);return 0===r.length?[]:1===r.length?r[0].children:[{type:"list",ordered:!1,start:null,spread:kc(r),children:r}]}function ku(){return{type:"listItem",spread:!1,checked:null,children:[]}}function kh(e,t){let n={type:"emphasis",children:e.all(t)};return e.patch(t,n),n}function kp(e){let t=0,n=e.length;for(;t<n&&"break"===e[t].type;)t++;for(;n>t&&"break"===e[n-1].type;)n--;return 0===t&&n===e.length?e:e.slice(t,n)}function kf(e,t){let n={type:"heading",depth:Number(t.tagName.charAt(1))||1,children:kp(e.all(t))};return e.patch(t,n),n}function km(e,t){let n=t.properties||{},r={type:"image",url:e.resolve(String(n.src||"")||null),title:n.title?String(n.title):null,alt:n.alt?String(n.alt):""};return e.patch(t,r),r}function kg(e,t){let n={type:"inlineCode",value:kr(t)};return e.patch(t,n),n}function kb(e,t){let n=[],r=[],o=t||e.properties||{},i=function e(t){let n=[],r=-1;for(;++r<t.children.length;){let o=t.children[r];"children"in o&&Array.isArray(o.children)&&n.push(...e(o)),"element"!==o.type||"option"!==o.tagName||o.properties&&o.properties.disabled||n.push(o)}return n}(e),s=Math.min(Number.parseInt(String(o.size),10),0)||(o.multiple?4:1),l=-1;for(;++l<i.length;){let e=i[l];e&&e.properties&&e.properties.selected&&n.push(e)}let a=n.length>0?n:i,c=Math.min(a.length,s);for(l=-1;++l<c;){let e=a[l],t=e.properties||{},n=kr(e),o=n||String(t.label||""),i=String(t.value||"")||n;r.push([i,o===i?void 0:o])}return r}let ky={}.hasOwnProperty,kv=new Set(["pingback","prefetch","stylesheet"]),kE=EM(["a","abbr","area","b","bdi","bdo","br","button","cite","code","data","datalist","del","dfn","em","i","input","ins","kbd","keygen","label","map","mark","meter","noscript","output","progress","q","ruby","s","samp","script","select","small","span","strong","sub","sup","template","textarea","time","u","var","wbr"]),kk=EM("meta");function kC(e){var t;let n;return!!("text"===e.type||kE(e)||ER(e)||function(e){if("element"!==e.type||"link"!==e.tagName)return!1;if(e.properties.itemProp)return!0;let t=e.properties.rel,n=-1;if(!Array.isArray(t)||0===t.length)return!1;for(;++n<t.length;)if(!kv.has(String(t[n])))return!1;return!0}(e)||kk(e)&&(t="itemProp",null!=(n="element"===e.type&&ky.call(e.properties,t)&&e.properties[t])&&!1!==n))}function kT(e,t){let{rest:n,checkbox:r}=function e(t){let n=t.children[0];if(n&&"element"===n.type&&"input"===n.tagName&&n.properties&&("checkbox"===n.properties.type||"radio"===n.properties.type))return{checkbox:n,rest:{...t,children:t.children.slice(1)}};if(n&&"element"===n.type&&"p"===n.tagName){let{checkbox:r,rest:o}=e(n);if(r)return{checkbox:r,rest:{...t,children:[o,...t.children.slice(1)]}}}return{checkbox:void 0,rest:t}}(t),o=r?!!r.properties.checked:null,i={type:"listItem",spread:function e(t){let n=-1,r=!1;for(;++n<t.children.length;){let o=t.children[n];if("element"===o.type){if(kC(o))continue;if("p"===o.tagName||r||e(o))return!0;r=!0}}return!1}(n),checked:o,children:e.toFlow(e.all(n))};return e.patch(t,i),i}function kw(e,t){let n="ol"===t.tagName,r=e.toSpecificContent(e.all(t),kx),o=null;n&&(o=t.properties&&t.properties.start?Number.parseInt(String(t.properties.start),10):1);let i={type:"list",ordered:n,start:o,spread:kc(r),children:r};return e.patch(t,i),i}function kx(){return{type:"listItem",spread:!1,checked:null,children:[]}}let kS={};function kA(e,t){let n=t||kS;return k_(e,"boolean"!=typeof n.includeImageAlt||n.includeImageAlt,"boolean"!=typeof n.includeHtml||n.includeHtml)}function k_(e,t,n){var r;if((r=e)&&"object"==typeof r){if("value"in e)return"html"!==e.type||n?e.value:"";if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return kN(e.children,t,n)}return Array.isArray(e)?kN(e,t,n):""}function kN(e,t,n){let r=[],o=-1;for(;++o<e.length;)r[o]=k_(e[o],t,n);return r.join("")}let kM=EH(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function kI(e){let t=-1;for(;++t<e.length;){let n=e[t];if(!kD(n)||"children"in n&&kI(n.children))return!0}return!1}function kO(e){return function e(t,n,r){let o=function(t){let n=[],r=-1;for(;++r<t.length;){let o=t[r];("delete"===o.type||"link"===o.type)&&kI(o.children)?n.push(...function(t){return e(t.children,function(e){let n=kR(t);return n.children=e,[n]},function(e){if("children"in e&&"children"in t){let n=kR(t),r=kR(e);return n.children=e.children,r.children.push(n),r}return{...e}})}(o)):n.push(o)}return n}(t),i=[],s=[],l=-1;for(;++l<o.length;){let e=o[l];kD(e)?s.push(e):(s.length>0&&(i.push(...n(s)),s=[]),i.push(r(e)))}return s.length>0&&(i.push(...n(s)),s=[]),i}(e,function(e){return e.every(function(e){return"text"===e.type&&EP(e.value)})?[]:[{type:"paragraph",children:kp(e)}]},function(e){return e})}function kD(e){let t=e.data&&e.data.hName;return t?kC({type:"element",tagName:t,properties:{},children:[]}):kM(e)}function kR(e){return E_({...e,children:[]})}function kL(e,t){let n=t.properties||{},r="video"===t.tagName?String(n.poster||""):"",o=String(n.src||""),i=-1,s=!1,l=e.all(t);if(EJ({type:"root",children:l},function(e){if("link"===e.type)return s=!0,!1}),s||kI(l))return l;for(;!o&&++i<t.children.length;){let e=t.children[i];"element"===e.type&&"source"===e.tagName&&e.properties&&(o=String(e.properties.src||""))}if(r){let n={type:"image",title:null,url:e.resolve(r),alt:kA(l)};e.patch(t,n),l=[n]}let a=l,c={type:"link",title:n.title?String(n.title):null,url:e.resolve(o),children:a};return e.patch(t,c),c}function kP(e,t){let n=kp(e.all(t));if(n.length>0){let r={type:"paragraph",children:n};return e.patch(t,r),r}}let kB=['"'];function kH(e,t){let n={type:"strong",children:e.all(t)};return e.patch(t,n),n}function kj(e,t){let n={type:"tableCell",children:e.all(t)};if(e.patch(t,n),t.properties){let e=t.properties.rowSpan,r=t.properties.colSpan;if(e||r){let t=n.data||(n.data={});e&&(t.hastUtilToMdastTemporaryRowSpan=e),r&&(t.hastUtilToMdastTemporaryColSpan=r)}}return n}function kF(){return{type:"tableCell",children:[]}}function kU(){return{type:"tableCell",children:[]}}function kz(){return{type:"tableRow",children:[]}}let kV={comment:function(e,t){let n={type:"html",value:"<!--"+t.value+"-->"};return e.patch(t,n),n},doctype:kW,root:function(e,t){let n=e.all(t);(e.options.document||kI(n))&&(n=kO(n));let r={type:"root",children:n};return e.patch(t,r),r},text:function(e,t){let n={type:"text",value:t.value};return e.patch(t,n),n}},k$={applet:kW,area:kW,basefont:kW,bgsound:kW,caption:kW,col:kW,colgroup:kW,command:kW,content:kW,datalist:kW,dialog:kW,element:kW,embed:kW,frame:kW,frameset:kW,isindex:kW,keygen:kW,link:kW,math:kW,menu:kW,menuitem:kW,meta:kW,nextid:kW,noembed:kW,noframes:kW,optgroup:kW,option:kW,param:kW,script:kW,shadow:kW,source:kW,spacer:kW,style:kW,svg:kW,template:kW,title:kW,track:kW,abbr:kG,acronym:kG,bdi:kG,bdo:kG,big:kG,blink:kG,button:kG,canvas:kG,cite:kG,data:kG,details:kG,dfn:kG,font:kG,ins:kG,label:kG,map:kG,marquee:kG,meter:kG,nobr:kG,noscript:kG,object:kG,output:kG,progress:kG,rb:kG,rbc:kG,rp:kG,rt:kG,rtc:kG,ruby:kG,slot:kG,small:kG,span:kG,sup:kG,sub:kG,tbody:kG,tfoot:kG,thead:kG,time:kG,address:kq,article:kq,aside:kq,body:kq,center:kq,div:kq,fieldset:kq,figcaption:kq,figure:kq,form:kq,footer:kq,header:kq,hgroup:kq,html:kq,legend:kq,main:kq,multicol:kq,nav:kq,picture:kq,section:kq,a:function(e,t){let n=t.properties||{},r=e.all(t),o={type:"link",url:e.resolve(String(n.href||"")||null),title:n.title?String(n.title):null,children:r};return e.patch(t,o),o},audio:kL,b:kH,base:function(e,t){e.baseFound||(e.frozenBaseUrl=String(t.properties&&t.properties.href||"")||void 0,e.baseFound=!0)},blockquote:function(e,t){let n={type:"blockquote",children:e.toFlow(e.all(t))};return e.patch(t,n),n},br:function(e,t){let n={type:"break"};return e.patch(t,n),n},code:kg,dir:kw,dl:function(e,t){let n=[],r=[],o=-1;for(;++o<t.children.length;){let e=t.children[o];"element"===e.type&&"div"===e.tagName?n.push(...e.children):n.push(e)}let i={definitions:[],titles:[]};for(o=-1;++o<n.length;){let e=n[o];if("element"===e.type&&"dt"===e.tagName){let t=n[o-1];t&&"element"===t.type&&"dd"===t.tagName&&(r.push(i),i={definitions:[],titles:[]}),i.titles.push(e)}else i.definitions.push(e)}r.push(i),o=-1;let s=[];for(;++o<r.length;){let t=[...kd(e,r[o].titles),...kd(e,r[o].definitions)];t.length>0&&s.push({type:"listItem",spread:t.length>1,checked:null,children:t})}if(s.length>0){let n={type:"list",ordered:!1,start:null,spread:kc(s),children:s};return e.patch(t,n),n}},dt:kT,dd:kT,del:ka,em:kh,h1:kf,h2:kf,h3:kf,h4:kf,h5:kf,h6:kf,hr:function(e,t){let n={type:"thematicBreak"};return e.patch(t,n),n},i:kh,iframe:function(e,t){let n=t.properties||{},r=String(n.src||""),o=String(n.title||"");if(r&&o){let n={type:"link",title:null,url:e.resolve(r),children:[{type:"text",value:o}]};return e.patch(t,n),n}},img:km,image:km,input:function(e,t){let n=t.properties||{},r=String(n.value||n.placeholder||"");if(n.disabled||"hidden"===n.type||"file"===n.type)return;if("checkbox"===n.type||"radio"===n.type){let r={type:"text",value:n.checked?e.options.checked||"[x]":e.options.unchecked||"[ ]"};return e.patch(t,r),r}if("image"===n.type){let o=n.alt||r;if(o){let r={type:"image",url:e.resolve(String(n.src||"")||null),title:String(n.title||"")||null,alt:String(o)};return e.patch(t,r),r}return}let o=[];if(r)o=[[r,void 0]];else if("button"!==n.type&&"file"!==n.type&&"password"!==n.type&&"reset"!==n.type&&"submit"!==n.type&&n.list){let t=String(n.list),r=e.elementById.get(t);r&&"datalist"===r.tagName&&(o=kb(r,n))}if(0===o.length)return;if("password"===n.type&&(o[0]=["".repeat(o[0][0].length),void 0]),"email"===n.type||"url"===n.type){let t=[],r=-1;for(;++r<o.length;){let i=e.resolve(o[r][0]),s={type:"link",title:null,url:"email"===n.type?"mailto:"+i:i,children:[{type:"text",value:o[r][1]||i}]};t.push(s),r!==o.length-1&&t.push({type:"text",value:", "})}return t}let i=[],s=-1;for(;++s<o.length;)i.push(o[s][1]?o[s][1]+" ("+o[s][0]+")":o[s][0]);let l={type:"text",value:i.join(", ")};return e.patch(t,l),l},kbd:kg,li:kT,listing:kl,mark:kh,ol:kw,p:kP,plaintext:kl,pre:kl,q:function(e,t){let n=e.options.quotes||kB;e.qNesting++;let r=e.all(t);e.qNesting--;let o=n[e.qNesting%n.length],i=r[0],s=r[r.length-1],l=o.charAt(0),a=o.length>1?o.charAt(1):o;return i&&"text"===i.type?i.value=l+i.value:r.unshift({type:"text",value:l}),s&&"text"===s.type?s.value+=a:r.push({type:"text",value:a}),r},s:ka,samp:kg,select:function(e,t){let n=kb(t),r=-1,o=[];for(;++r<n.length;){let e=n[r];o.push(e[1]?e[1]+" ("+e[0]+")":e[0])}if(o.length>0){let n={type:"text",value:o.join(", ")};return e.patch(t,n),n}},strike:ka,strong:kH,summary:kP,table:function(e,t){var n;let r,o,i;if(e.inTable){let n={type:"text",value:kr(t)};return e.patch(t,n),n}e.inTable=!0;let{align:s,headless:l}=(r={align:[null],headless:!0},o=0,i=0,EJ(n=t,function(e){if("element"===e.type){if("table"===e.tagName&&n!==e)return EX;if(("th"===e.tagName||"td"===e.tagName)&&e.properties){if(!r.align[i]){let t=String(e.properties.align||"")||null;("center"===t||"left"===t||"right"===t||null===t)&&(r.align[i]=t)}r.headless&&o<2&&"th"===e.tagName&&(r.headless=!1),i++}else"thead"===e.tagName?r.headless=!1:"tr"===e.tagName&&(o++,i=0)}}),r),a=e.toSpecificContent(e.all(t),kz);l&&a.unshift(kz());let c=-1;for(;++c<a.length;){let t=a[c],n=e.toSpecificContent(t.children,kU);t.children=n}let d=1;for(c=-1;++c<a.length;){let e=a[c].children,t=-1;for(;++t<e.length;){let n=e[t];if(n.data){let e=n.data,r=Number.parseInt(String(e.hastUtilToMdastTemporaryColSpan),10)||1,o=Number.parseInt(String(e.hastUtilToMdastTemporaryRowSpan),10)||1;if(r>1||o>1){let e=c-1;for(;++e<c+o;){let n=t-1;for(;++n<t+r&&a[e];){let r=[];(e!==c||n!==t)&&r.push({type:"tableCell",children:[]}),a[e].children.splice(n,0,...r)}}}"hastUtilToMdastTemporaryColSpan"in n.data&&delete n.data.hastUtilToMdastTemporaryColSpan,"hastUtilToMdastTemporaryRowSpan"in n.data&&delete n.data.hastUtilToMdastTemporaryRowSpan,0===Object.keys(n.data).length&&delete n.data}}e.length>d&&(d=e.length)}for(c=-1;++c<a.length;){let e=a[c].children,t=e.length-1;for(;++t<d;)e.push({type:"tableCell",children:[]})}let u=s.length-1;for(;++u<d;)s.push(null);e.inTable=!1;let h={type:"table",align:s,children:a};return e.patch(t,h),h},td:kj,textarea:function(e,t){let n={type:"text",value:kr(t)};return e.patch(t,n),n},th:kj,tr:function(e,t){let n={type:"tableRow",children:e.toSpecificContent(e.all(t),kF)};return e.patch(t,n),n},tt:kg,u:kh,ul:kw,var:kg,video:kL,wbr:function(e,t){let n={type:"text",value:""};return e.patch(t,n),n},xmp:kl};function kG(e,t){return e.all(t)}function kq(e,t){return e.toFlow(e.all(t))}function kW(){}let kY={}.hasOwnProperty;function kK(e){let t=e.children||[],n=[],r=-1;for(;++r<t.length;){let o=t[r],i=this.one(o,e);Array.isArray(i)?n.push(...i):i&&n.push(i)}return n}function kZ(e,t){if("element"===e.type){if(e.properties&&"ignore"===e.properties.dataMdast)return;if(kY.call(this.handlers,e.tagName))return this.handlers[e.tagName](this,e,t)||void 0}else if(kY.call(this.nodeHandlers,e.type))return this.nodeHandlers[e.type](this,e,t)||void 0;if("value"in e&&"string"==typeof e.value){let t={type:"text",value:e.value};return this.patch(e,t),t}if("children"in e)return this.all(e)}function kX(e,t){e.position&&(t.position=E4(e))}function kQ(e){let t=this.frozenBaseUrl;return null==e?"":t?String(new URL(e,t)):e}function kJ(e){return kO(e)}function k0(e,t){let n=t(),r=[],o=[],i=-1;for(;++i<e.length;){let t=e[i];t.type===n.type?(o.length>0&&(t.children.unshift(...o),o=[]),r.push(t)):o.push(t)}if(o.length>0){let e=r[r.length-1];e||(e=t(),r.push(e)),e.children.push(...o),o=[]}return r}let k1={};function k2(e,t){var n;let r,o=E_(e),i=t||k1,s=(n={newlines:!0===i.newlines},function(e){var t;!function e(t,n){if("children"in t){let r={...n};return("root"===t.type||EN(t,EU))&&(r.before=!0,r.after=!0),r.whitespace=function(e,t){if("tagName"in e&&e.properties)switch(e.tagName){case"listing":case"plaintext":case"script":case"style":case"xmp":return"pre";case"nobr":return"nowrap";case"pre":return e.properties.wrap?"pre-wrap":"pre";case"td":case"th":return e.properties.noWrap?"nowrap":t.whitespace;case"textarea":return"pre-wrap"}return t.whitespace}(t,n),function(t,n){let r=n.before,o=n.after,i=t.children,s=i.length,l=-1;for(;++l<s;){let t=e(i[l],{...n,after:function e(t,n,r){for(;++n<t.length;){var o;let r=t[n],i=function(e){if("element"===e.type){if(Eq(e))return!1;if(function(e){return EN(e,EU)}(e))return!0}else if("text"===e.type){if(!EP(e))return!1}else if(!EG(e))return!1}(r);if(void 0===i&&"children"in r&&!("element"===(o=r).type&&o.properties.hidden||EG(o)||EN(o,EV))&&(i=e(r.children,-1)),"boolean"==typeof i)return i}return r}(i,l,o),before:r});t.remove?(i.splice(l,1),l--,s--):t.ignore||(r=t.stripAtStart),Eq(i[l])&&(r=!1)}return{ignore:!1,stripAtStart:!!(r||o),remove:!1}}(t,r)}if("text"===t.type){if("normal"===n.whitespace){var r,o;let e,i,s,l;return r=t,e=(o=n).collapse(r.value),i={ignore:!1,stripAtStart:!1,remove:!1},s=0,l=e.length,o.before&&EW(e.charAt(0))&&s++,s!==l&&EW(e.charAt(l-1))&&(o.after?l--:i.stripAtStart=!0),s===l?i.remove=!0:r.value=e.slice(s,l),i}"nowrap"===n.whitespace&&(t.value=n.collapse(t.value))}return{ignore:EG(t),stripAtStart:!1,remove:!1}}(e,{collapse:(t=(n||E$).newlines?EY:EK,function(e){return String(e).replace(/[\t\n\v\f\r ]+/g,t)}),whitespace:"normal"})}),l={all:kK,baseFound:!1,elementById:new Map,frozenBaseUrl:void 0,handlers:{...k$,...i.handlers},inTable:!1,nodeHandlers:{...kV,...i.nodeHandlers},one:kZ,options:i,patch:kX,qNesting:0,resolve:kQ,toFlow:kJ,toSpecificContent:k0};s(o),EJ(o,function(e){if(e&&"element"===e.type&&e.properties){let t=String(e.properties.id||"")||void 0;t&&!l.elementById.has(t)&&l.elementById.set(t,e)}});let a=l.one(o,void 0);return EJ(r=a?Array.isArray(a)?{type:"root",children:a}:a:{type:"root",children:[]},function(e,t,n){if("text"===e.type&&void 0!==t&&n){let r=n.children[t-1];if(r&&r.type===e.type)return r.value+=e.value,n.children.splice(t,1),r.position&&e.position&&(r.position.end=e.position.end),t-1;if(e.value=e.value.replace(/[\t ]*(\r?\n|\r)[\t ]*/,"$1"),n&&("heading"===n.type||"paragraph"===n.type||"root"===n.type)&&(t||(e.value=e.value.replace(/^[\t ]+/,"")),t===n.children.length-1&&(e.value=e.value.replace(/[\t ]+$/,""))),!e.value)return n.children.splice(t,1),t}}),r}let k4={document:!0};function k5(e,t){return e&&"run"in e?async function(n,r){let o=k2(n,{...k4,...t});await e.run(o,r)}:function(t){return k2(t,{...k4,...e})}}function k3(e,t){let n=String(e);if("string"!=typeof t)throw TypeError("Expected character");let r=0,o=n.indexOf(t);for(;-1!==o;)r++,o=n.indexOf(t,o+t.length);return r}let k8=Ca(/[A-Za-z]/),k6=Ca(/[\dA-Za-z]/),k9=Ca(/[#-'*+\--9=?A-Z^-~]/);function k7(e){return null!==e&&(e<32||127===e)}let Ce=Ca(/\d/),Ct=Ca(/[\dA-Fa-f]/),Cn=Ca(/[!-/:-@[-`{-~]/);function Cr(e){return null!==e&&e<-2}function Co(e){return null!==e&&(e<0||32===e)}function Ci(e){return -2===e||-1===e||32===e}let Cs=Ca(/\p{P}|\p{S}/u),Cl=Ca(/\s/);function Ca(e){return function(t){return null!==t&&t>-1&&e.test(String.fromCharCode(t))}}let Cc="phrasing",Cd=["autolink","link","image","label"];function Cu(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function Ch(e){this.config.enter.autolinkProtocol.call(this,e)}function Cp(e){this.config.exit.autolinkProtocol.call(this,e)}function Cf(e){this.config.exit.data.call(this,e);let t=this.stack[this.stack.length-1];bP("link"===t.type),t.url="http://"+this.sliceSerialize(e)}function Cm(e){this.config.exit.autolinkEmail.call(this,e)}function Cg(e){this.exit(e)}function Cb(e){!function(e,t,n){let r=EH((n||{}).ignore||[]),o=function(e){let t=[];if(!Array.isArray(e))throw TypeError("Expected find and replace tuple or list of tuples");let n=!e[0]||Array.isArray(e[0])?e:[e],r=-1;for(;++r<n.length;){var o;let e=n[r];t.push(["string"==typeof(o=e[0])?RegExp(function(e){if("string"!=typeof e)throw TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}(o),"g"):o,function(e){return"function"==typeof e?e:function(){return e}}(e[1])])}return t}(t),i=-1;for(;++i<o.length;)EQ(e,"text",s);function s(e,t){let n,s=-1;for(;++s<t.length;){let e=t[s],o=n?n.children:void 0;if(r(e,o?o.indexOf(e):void 0,n))return;n=e}if(n)return function(e,t){let n=t[t.length-1],r=o[i][0],s=o[i][1],l=0,a=n.children.indexOf(e),c=!1,d=[];r.lastIndex=0;let u=r.exec(e.value);for(;u;){let n=u.index,o={index:u.index,input:u.input,stack:[...t,e]},i=s(...u,o);if("string"==typeof i&&(i=i.length>0?{type:"text",value:i}:void 0),!1===i?r.lastIndex=n+1:(l!==n&&d.push({type:"text",value:e.value.slice(l,n)}),Array.isArray(i)?d.push(...i):i&&d.push(i),l=n+u[0].length,c=!0),!r.global)break;u=r.exec(e.value)}return c?(l<e.value.length&&d.push({type:"text",value:e.value.slice(l)}),n.children.splice(a,1,...d)):d=[e],a+d.length}(e,t)}}(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,Cy],[/(?<=^|\s|\p{P}|\p{S})([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/gu,Cv]],{ignore:["link","linkReference"]})}function Cy(e,t,n,r,o){let i,s="";if(!CE(o))return!1;if(/^w/i.test(t)&&(n=t+n,t="",s="http://"),(i=n.split(".")).length<2||i[i.length-1]&&(/_/.test(i[i.length-1])||!/[a-zA-Z\d]/.test(i[i.length-1]))||i[i.length-2]&&(/_/.test(i[i.length-2])||!/[a-zA-Z\d]/.test(i[i.length-2])))return!1;let l=function(e){let t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let n=t[0],r=n.indexOf(")"),o=k3(e,"("),i=k3(e,")");for(;-1!==r&&o>i;)e+=n.slice(0,r+1),r=(n=n.slice(r+1)).indexOf(")"),i++;return[e,n]}(n+r);if(!l[0])return!1;let a={type:"link",title:null,url:s+t+l[0],children:[{type:"text",value:t+l[0]}]};return l[1]?[a,{type:"text",value:l[1]}]:a}function Cv(e,t,n,r){return!(!CE(r,!0)||/[-\d_]$/.test(n))&&{type:"link",title:null,url:"mailto:"+t+"@"+n,children:[{type:"text",value:t+"@"+n}]}}function CE(e,t){let n=e.input.charCodeAt(e.index-1);return(0===e.index||Cl(n)||Cs(n))&&(!t||47!==n)}function Ck(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}function CC(){this.buffer()}function CT(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function Cw(){this.buffer()}function Cx(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function CS(e){let t=this.resume(),n=this.stack[this.stack.length-1];bP("footnoteReference"===n.type),n.identifier=Ck(this.sliceSerialize(e)).toLowerCase(),n.label=t}function CA(e){this.exit(e)}function C_(e){let t=this.resume(),n=this.stack[this.stack.length-1];bP("footnoteDefinition"===n.type),n.identifier=Ck(this.sliceSerialize(e)).toLowerCase(),n.label=t}function CN(e){this.exit(e)}function CM(e,t,n,r){let o=n.createTracker(r),i=o.move("[^"),s=n.enter("footnoteReference"),l=n.enter("reference");return i+=o.move(n.safe(n.associationId(e),{after:"]",before:i})),l(),s(),i+=o.move("]")}function CI(e,t,n){return 0===t?e:CO(e,t,n)}function CO(e,t,n){return(n?"":"    ")+e}CM.peek=function(){return"["};let CD=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];function CR(e){this.enter({type:"delete",children:[]},e)}function CL(e){this.exit(e)}function CP(e,t,n,r){let o=n.createTracker(r),i=n.enter("strikethrough"),s=o.move("~~");return s+=n.containerPhrasing(e,{...o.current(),before:s,after:"~"}),s+=o.move("~~"),i(),s}function CB(e){return e.length}function CH(e){let t="string"==typeof e?e.codePointAt(0):0;return 67===t||99===t?99:76===t||108===t?108:114*(82===t||114===t)}function Cj(e,t,n){return">"+(n?"":" ")+e}function CF(e,t){return CU(e,t.inConstruct,!0)&&!CU(e,t.notInConstruct,!1)}function CU(e,t,n){if("string"==typeof t&&(t=[t]),!t||0===t.length)return n;let r=-1;for(;++r<t.length;)if(e.includes(t[r]))return!0;return!1}function Cz(e,t,n,r){let o=-1;for(;++o<n.unsafe.length;)if("\n"===n.unsafe[o].character&&CF(n.stack,n.unsafe[o]))return/[ \t]/.test(r.before)?"":" ";return"\\\n"}function CV(e,t){return!!(!1===t.options.fences&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function C$(e,t,n){return(n?"":"    ")+e}function CG(e){let t=e.options.quote||'"';if('"'!==t&&"'"!==t)throw Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function Cq(e){return"&#x"+e.toString(16).toUpperCase()+";"}function CW(e){return null===e||Co(e)||Cl(e)?1:Cs(e)?2:void 0}function CY(e,t,n){let r=CW(e),o=CW(t);return void 0===r?void 0===o?"_"===n?{inside:!0,outside:!0}:{inside:!1,outside:!1}:1===o?{inside:!0,outside:!0}:{inside:!1,outside:!0}:1===r?void 0===o?{inside:!1,outside:!1}:1===o?{inside:!0,outside:!0}:{inside:!1,outside:!1}:void 0===o?{inside:!1,outside:!1}:1===o?{inside:!0,outside:!1}:{inside:!1,outside:!1}}function CK(e,t,n,r){let o=function(e){let t=e.options.emphasis||"*";if("*"!==t&&"_"!==t)throw Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}(n),i=n.enter("emphasis"),s=n.createTracker(r),l=s.move(o),a=s.move(n.containerPhrasing(e,{after:o,before:l,...s.current()})),c=a.charCodeAt(0),d=CY(r.before.charCodeAt(r.before.length-1),c,o);d.inside&&(a=Cq(c)+a.slice(1));let u=a.charCodeAt(a.length-1),h=CY(r.after.charCodeAt(0),u,o);h.inside&&(a=a.slice(0,-1)+Cq(u));let p=s.move(o);return i(),n.attentionEncodeSurroundingInfo={after:h.outside,before:d.outside},l+a+p}function CZ(e,t){let n=!1;return EJ(e,function(e){if("value"in e&&/\r?\n|\r/.test(e.value)||"break"===e.type)return n=!0,!1}),!!((!e.depth||e.depth<3)&&kA(e)&&(t.options.setext||n))}function CX(e){return e.value||""}function CQ(e,t,n,r){let o=CG(n),i='"'===o?"Quote":"Apostrophe",s=n.enter("image"),l=n.enter("label"),a=n.createTracker(r),c=a.move("![");return c+=a.move(n.safe(e.alt,{before:c,after:"]",...a.current()})),c+=a.move("]("),l(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(l=n.enter("destinationLiteral"),c+=a.move("<"),c+=a.move(n.safe(e.url,{before:c,after:">",...a.current()})),c+=a.move(">")):(l=n.enter("destinationRaw"),c+=a.move(n.safe(e.url,{before:c,after:e.title?" ":")",...a.current()}))),l(),e.title&&(l=n.enter(`title${i}`),c+=a.move(" "+o),c+=a.move(n.safe(e.title,{before:c,after:o,...a.current()})),c+=a.move(o),l()),c+=a.move(")"),s(),c}function CJ(e,t,n,r){let o=e.referenceType,i=n.enter("imageReference"),s=n.enter("label"),l=n.createTracker(r),a=l.move("!["),c=n.safe(e.alt,{before:a,after:"]",...l.current()});a+=l.move(c+"]["),s();let d=n.stack;n.stack=[],s=n.enter("reference");let u=n.safe(n.associationId(e),{before:a,after:"]",...l.current()});return s(),n.stack=d,i(),"full"!==o&&c&&c===u?"shortcut"===o?a=a.slice(0,-1):a+=l.move("]"):a+=l.move(u+"]"),a}function C0(e,t,n){let r=e.value||"",o="`",i=-1;for(;RegExp("(^|[^`])"+o+"([^`]|$)").test(r);)o+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++i<n.unsafe.length;){let e,t=n.unsafe[i],o=n.compilePattern(t);if(t.atBreak)for(;e=o.exec(r);){let t=e.index;10===r.charCodeAt(t)&&13===r.charCodeAt(t-1)&&t--,r=r.slice(0,t)+" "+r.slice(e.index+1)}}return o+r+o}function C1(e,t){let n=kA(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&1===e.children.length&&"text"===e.children[0].type&&(n===e.url||"mailto:"+n===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}function C2(e,t,n,r){let o,i,s=CG(n),l='"'===s?"Quote":"Apostrophe",a=n.createTracker(r);if(C1(e,n)){let t=n.stack;n.stack=[],o=n.enter("autolink");let r=a.move("<");return r+=a.move(n.containerPhrasing(e,{before:r,after:">",...a.current()})),r+=a.move(">"),o(),n.stack=t,r}o=n.enter("link"),i=n.enter("label");let c=a.move("[");return c+=a.move(n.containerPhrasing(e,{before:c,after:"](",...a.current()})),c+=a.move("]("),i(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(i=n.enter("destinationLiteral"),c+=a.move("<"),c+=a.move(n.safe(e.url,{before:c,after:">",...a.current()})),c+=a.move(">")):(i=n.enter("destinationRaw"),c+=a.move(n.safe(e.url,{before:c,after:e.title?" ":")",...a.current()}))),i(),e.title&&(i=n.enter(`title${l}`),c+=a.move(" "+s),c+=a.move(n.safe(e.title,{before:c,after:s,...a.current()})),c+=a.move(s),i()),c+=a.move(")"),o(),c}function C4(e,t,n,r){let o=e.referenceType,i=n.enter("linkReference"),s=n.enter("label"),l=n.createTracker(r),a=l.move("["),c=n.containerPhrasing(e,{before:a,after:"]",...l.current()});a+=l.move(c+"]["),s();let d=n.stack;n.stack=[],s=n.enter("reference");let u=n.safe(n.associationId(e),{before:a,after:"]",...l.current()});return s(),n.stack=d,i(),"full"!==o&&c&&c===u?"shortcut"===o?a=a.slice(0,-1):a+=l.move("]"):a+=l.move(u+"]"),a}function C5(e){let t=e.options.bullet||"*";if("*"!==t&&"+"!==t&&"-"!==t)throw Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function C3(e){let t=e.options.rule||"*";if("*"!==t&&"-"!==t&&"_"!==t)throw Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function C8(e,t,n,r){let o=function(e){let t=e.options.strong||"*";if("*"!==t&&"_"!==t)throw Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}(n),i=n.enter("strong"),s=n.createTracker(r),l=s.move(o+o),a=s.move(n.containerPhrasing(e,{after:o,before:l,...s.current()})),c=a.charCodeAt(0),d=CY(r.before.charCodeAt(r.before.length-1),c,o);d.inside&&(a=Cq(c)+a.slice(1));let u=a.charCodeAt(a.length-1),h=CY(r.after.charCodeAt(0),u,o);h.inside&&(a=a.slice(0,-1)+Cq(u));let p=s.move(o+o);return i(),n.attentionEncodeSurroundingInfo={after:h.outside,before:d.outside},l+a+p}CP.peek=function(){return"~"},CK.peek=function(e,t,n){return n.options.emphasis||"*"},CX.peek=function(){return"<"},CQ.peek=function(){return"!"},CJ.peek=function(){return"!"},C0.peek=function(){return"`"},C2.peek=function(e,t,n){return C1(e,n)?"<":"["},C4.peek=function(){return"["},C8.peek=function(e,t,n){return n.options.strong||"*"};let C6={blockquote:function(e,t,n,r){let o=n.enter("blockquote"),i=n.createTracker(r);i.move("> "),i.shift(2);let s=n.indentLines(n.containerFlow(e,i.current()),Cj);return o(),s},break:Cz,code:function(e,t,n,r){let o=function(e){let t=e.options.fence||"`";if("`"!==t&&"~"!==t)throw Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}(n),i=e.value||"",s="`"===o?"GraveAccent":"Tilde";if(CV(e,n)){let e=n.enter("codeIndented"),t=n.indentLines(i,C$);return e(),t}let l=n.createTracker(r),a=o.repeat(Math.max(function(e,t){let n=String(e),r=n.indexOf(t),o=r,i=0,s=0;if("string"!=typeof t)throw TypeError("Expected substring");for(;-1!==r;)r===o?++i>s&&(s=i):i=1,o=r+t.length,r=n.indexOf(t,o);return s}(i,o)+1,3)),c=n.enter("codeFenced"),d=l.move(a);if(e.lang){let t=n.enter(`codeFencedLang${s}`);d+=l.move(n.safe(e.lang,{before:d,after:" ",encode:["`"],...l.current()})),t()}if(e.lang&&e.meta){let t=n.enter(`codeFencedMeta${s}`);d+=l.move(" "),d+=l.move(n.safe(e.meta,{before:d,after:"\n",encode:["`"],...l.current()})),t()}return d+=l.move("\n"),i&&(d+=l.move(i+"\n")),d+=l.move(a),c(),d},definition:function(e,t,n,r){let o=CG(n),i='"'===o?"Quote":"Apostrophe",s=n.enter("definition"),l=n.enter("label"),a=n.createTracker(r),c=a.move("[");return c+=a.move(n.safe(n.associationId(e),{before:c,after:"]",...a.current()})),c+=a.move("]: "),l(),!e.url||/[\0- \u007F]/.test(e.url)?(l=n.enter("destinationLiteral"),c+=a.move("<"),c+=a.move(n.safe(e.url,{before:c,after:">",...a.current()})),c+=a.move(">")):(l=n.enter("destinationRaw"),c+=a.move(n.safe(e.url,{before:c,after:e.title?" ":"\n",...a.current()}))),l(),e.title&&(l=n.enter(`title${i}`),c+=a.move(" "+o),c+=a.move(n.safe(e.title,{before:c,after:o,...a.current()})),c+=a.move(o),l()),s(),c},emphasis:CK,hardBreak:Cz,heading:function(e,t,n,r){let o=Math.max(Math.min(6,e.depth||1),1),i=n.createTracker(r);if(CZ(e,n)){let t=n.enter("headingSetext"),r=n.enter("phrasing"),s=n.containerPhrasing(e,{...i.current(),before:"\n",after:"\n"});return r(),t(),s+"\n"+(1===o?"=":"-").repeat(s.length-(Math.max(s.lastIndexOf("\r"),s.lastIndexOf("\n"))+1))}let s="#".repeat(o),l=n.enter("headingAtx"),a=n.enter("phrasing");i.move(s+" ");let c=n.containerPhrasing(e,{before:"# ",after:"\n",...i.current()});return/^[\t ]/.test(c)&&(c=Cq(c.charCodeAt(0))+c.slice(1)),c=c?s+" "+c:s,n.options.closeAtx&&(c+=" "+s),a(),l(),c},html:CX,image:CQ,imageReference:CJ,inlineCode:C0,link:C2,linkReference:C4,list:function(e,t,n,r){let o=n.enter("list"),i=n.bulletCurrent,s=e.ordered?function(e){let t=e.options.bulletOrdered||".";if("."!==t&&")"!==t)throw Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}(n):C5(n),l=e.ordered?"."===s?")":".":function(e){let t=C5(e),n=e.options.bulletOther;if(!n)return"*"===t?"-":"*";if("*"!==n&&"+"!==n&&"-"!==n)throw Error("Cannot serialize items with `"+n+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(n===t)throw Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+n+"`) to be different");return n}(n),a=!!t&&!!n.bulletLastUsed&&s===n.bulletLastUsed;if(!e.ordered){let t=e.children?e.children[0]:void 0;if("*"!==s&&"-"!==s||!t||t.children&&t.children[0]||"list"!==n.stack[n.stack.length-1]||"listItem"!==n.stack[n.stack.length-2]||"list"!==n.stack[n.stack.length-3]||"listItem"!==n.stack[n.stack.length-4]||0!==n.indexStack[n.indexStack.length-1]||0!==n.indexStack[n.indexStack.length-2]||0!==n.indexStack[n.indexStack.length-3]||(a=!0),C3(n)===s&&t){let t=-1;for(;++t<e.children.length;){let n=e.children[t];if(n&&"listItem"===n.type&&n.children&&n.children[0]&&"thematicBreak"===n.children[0].type){a=!0;break}}}}a&&(s=l),n.bulletCurrent=s;let c=n.containerFlow(e,r);return n.bulletLastUsed=s,n.bulletCurrent=i,o(),c},listItem:function(e,t,n,r){let o=function(e){let t=e.options.listItemIndent||"one";if("tab"!==t&&"one"!==t&&"mixed"!==t)throw Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}(n),i=n.bulletCurrent||C5(n);t&&"list"===t.type&&t.ordered&&(i=("number"==typeof t.start&&t.start>-1?t.start:1)+(!1===n.options.incrementListMarker?0:t.children.indexOf(e))+i);let s=i.length+1;("tab"===o||"mixed"===o&&(t&&"list"===t.type&&t.spread||e.spread))&&(s=4*Math.ceil(s/4));let l=n.createTracker(r);l.move(i+" ".repeat(s-i.length)),l.shift(s);let a=n.enter("listItem"),c=n.indentLines(n.containerFlow(e,l.current()),function(e,t,n){return t?(n?"":" ".repeat(s))+e:(n?i:i+" ".repeat(s-i.length))+e});return a(),c},paragraph:function(e,t,n,r){let o=n.enter("paragraph"),i=n.enter("phrasing"),s=n.containerPhrasing(e,r);return i(),o(),s},root:function(e,t,n,r){return(e.children.some(function(e){return kM(e)})?n.containerPhrasing:n.containerFlow).call(n,e,r)},strong:C8,text:function(e,t,n,r){return n.safe(e.value,r)},thematicBreak:function(e,t,n){let r=(C3(n)+(n.options.ruleSpaces?" ":"")).repeat(function(e){let t=e.options.ruleRepetition||3;if(t<3)throw Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}(n));return n.options.ruleSpaces?r.slice(0,-1):r}};function C9(e){let t=e._align;bP(t,"expected `_align` on table"),this.enter({type:"table",align:t.map(function(e){return"none"===e?null:e}),children:[]},e),this.data.inTable=!0}function C7(e){this.exit(e),this.data.inTable=void 0}function Te(e){this.enter({type:"tableRow",children:[]},e)}function Tt(e){this.exit(e)}function Tn(e){this.enter({type:"tableCell",children:[]},e)}function Tr(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,To));let n=this.stack[this.stack.length-1];bP("inlineCode"===n.type),n.value=t,this.exit(e)}function To(e,t){return"|"===t?t:e}function Ti(e){let t=this.stack[this.stack.length-2];bP("listItem"===t.type),t.checked="taskListCheckValueChecked"===e.type}function Ts(e){let t=this.stack[this.stack.length-2];if(t&&"listItem"===t.type&&"boolean"==typeof t.checked){let e=this.stack[this.stack.length-1];bP("paragraph"===e.type);let n=e.children[0];if(n&&"text"===n.type){let r,o=t.children,i=-1;for(;++i<o.length;){let e=o[i];if("paragraph"===e.type){r=e;break}}r===e&&(n.value=n.value.slice(1),0===n.value.length?e.children.shift():e.position&&n.position&&"number"==typeof n.position.start.offset&&(n.position.start.column++,n.position.start.offset++,e.position.start=Object.assign({},n.position.start)))}}this.exit(e)}function Tl(e,t,n,r){let o=e.children[0],i="boolean"==typeof e.checked&&o&&"paragraph"===o.type,s="["+(e.checked?"x":" ")+"] ",l=n.createTracker(r);i&&l.move(s);let a=C6.listItem(e,t,n,{...r,...l.current()});return i&&(a=a.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,function(e){return e+s})),a}function Ta(e,t,n,r){let o,i=e.length,s=0;if(t=t<0?-t>i?0:i+t:t>i?i:t,n=n>0?n:0,r.length<1e4)(o=Array.from(r)).unshift(t,n),e.splice(...o);else for(n&&e.splice(t,n);s<r.length;)(o=r.slice(s,s+1e4)).unshift(t,0),e.splice(...o),s+=1e4,t+=1e4}function Tc(e,t){return e.length>0?(Ta(e,e.length,0,t),e):t}let Td={}.hasOwnProperty;function Tu(e){let t={},n=-1;for(;++n<e.length;)!function(e,t){let n;for(n in t){let r,o=(Td.call(e,n)?e[n]:void 0)||(e[n]={}),i=t[n];if(i)for(r in i){Td.call(o,r)||(o[r]=[]);let e=i[r];!function(e,t){let n=-1,r=[];for(;++n<t.length;)("after"===t[n].add?e:r).push(t[n]);Ta(e,0,0,r)}(o[r],Array.isArray(e)?e:e?[e]:[])}}}(t,e[n]);return t}let Th={tokenize:function(e,t,n){let r=0;return function t(i){return(87===i||119===i)&&r<3?(r++,e.consume(i),t):46===i&&3===r?(e.consume(i),o):n(i)};function o(e){return null===e?n(e):t(e)}},partial:!0},Tp={tokenize:function(e,t,n){let r,o,i;return s;function s(t){return 46===t||95===t?e.check(Tm,a,l)(t):null===t||Co(t)||Cl(t)||45!==t&&Cs(t)?a(t):(i=!0,e.consume(t),s)}function l(t){return 95===t?r=!0:(o=r,r=void 0),e.consume(t),s}function a(e){return o||r||!i?n(e):t(e)}},partial:!0},Tf={tokenize:function(e,t){let n=0,r=0;return o;function o(s){return 40===s?(n++,e.consume(s),o):41===s&&r<n?i(s):33===s||34===s||38===s||39===s||41===s||42===s||44===s||46===s||58===s||59===s||60===s||63===s||93===s||95===s||126===s?e.check(Tm,t,i)(s):null===s||Co(s)||Cl(s)?t(s):(e.consume(s),o)}function i(t){return 41===t&&r++,e.consume(t),o}},partial:!0},Tm={tokenize:function(e,t,n){return r;function r(s){return 33===s||34===s||39===s||41===s||42===s||44===s||46===s||58===s||59===s||63===s||95===s||126===s?(e.consume(s),r):38===s?(e.consume(s),i):93===s?(e.consume(s),o):60===s||null===s||Co(s)||Cl(s)?t(s):n(s)}function o(e){return null===e||40===e||91===e||Co(e)||Cl(e)?t(e):r(e)}function i(t){return k8(t)?function t(o){return 59===o?(e.consume(o),r):k8(o)?(e.consume(o),t):n(o)}(t):n(t)}},partial:!0},Tg={tokenize:function(e,t,n){return function(t){return e.consume(t),r};function r(e){return k6(e)?n(e):t(e)}},partial:!0},Tb={name:"wwwAutolink",tokenize:function(e,t,n){let r=this;return function(t){return 87!==t&&119!==t||!TC.call(r,r.previous)||TS(r.events)?n(t):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(Th,e.attempt(Tp,e.attempt(Tf,o),n),n)(t))};function o(n){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(n)}},previous:TC},Ty={name:"protocolAutolink",tokenize:function(e,t,n){let r=this,o="",i=!1;return function(t){return(72===t||104===t)&&TT.call(r,r.previous)&&!TS(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),o+=String.fromCodePoint(t),e.consume(t),s):n(t)};function s(t){if(k8(t)&&o.length<5)return o+=String.fromCodePoint(t),e.consume(t),s;if(58===t){let n=o.toLowerCase();if("http"===n||"https"===n)return e.consume(t),l}return n(t)}function l(t){return 47===t?(e.consume(t),i)?a:(i=!0,l):n(t)}function a(t){return null===t||k7(t)||Co(t)||Cl(t)||Cs(t)?n(t):e.attempt(Tp,e.attempt(Tf,c),n)(t)}function c(n){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(n)}},previous:TT},Tv={name:"emailAutolink",tokenize:function(e,t,n){let r,o,i=this;return function(t){return!Tx(t)||!Tw.call(i,i.previous)||TS(i.events)?n(t):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),function t(r){return Tx(r)?(e.consume(r),t):64===r?(e.consume(r),s):n(r)}(t))};function s(t){return 46===t?e.check(Tg,a,l)(t):45===t||95===t||k6(t)?(o=!0,e.consume(t),s):a(t)}function l(t){return e.consume(t),r=!0,s}function a(s){return o&&r&&k8(i.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(s)):n(s)}},previous:Tw},TE={},Tk=48;for(;Tk<123;)TE[Tk]=Tv,58==++Tk?Tk=65:91===Tk&&(Tk=97);function TC(e){return null===e||40===e||42===e||95===e||91===e||93===e||126===e||Co(e)}function TT(e){return!k8(e)}function Tw(e){return!(47===e||Tx(e))}function Tx(e){return 43===e||45===e||46===e||95===e||k6(e)}function TS(e){let t=e.length,n=!1;for(;t--;){let r=e[t][1];if(("labelLink"===r.type||"labelImage"===r.type)&&!r._balanced){n=!0;break}if(r._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}function TA(e,t,n,r){let o=r?r-1:1/0,i=0;return function(r){return Ci(r)?(e.enter(n),function r(s){return Ci(s)&&i++<o?(e.consume(s),r):(e.exit(n),t(s))}(r)):t(r)}}TE[43]=Tv,TE[45]=Tv,TE[46]=Tv,TE[95]=Tv,TE[72]=[Tv,Ty],TE[104]=[Tv,Ty],TE[87]=[Tv,Tb],TE[119]=[Tv,Tb];let T_={partial:!0,tokenize:function(e,t,n){return function(t){return Ci(t)?TA(e,r,"linePrefix")(t):r(t)};function r(e){return null===e||Cr(e)?t(e):n(e)}}},TN={tokenize:function(e,t,n){let r=this;return TA(e,function(e){let o=r.events[r.events.length-1];return o&&"gfmFootnoteDefinitionIndent"===o[1].type&&4===o[2].sliceSerialize(o[1],!0).length?t(e):n(e)},"gfmFootnoteDefinitionIndent",5)},partial:!0};function TM(e,t,n){let r,o=this,i=o.events.length,s=o.parser.gfmFootnotes||(o.parser.gfmFootnotes=[]);for(;i--;){let e=o.events[i][1];if("labelImage"===e.type){r=e;break}if("gfmFootnoteCall"===e.type||"labelLink"===e.type||"label"===e.type||"image"===e.type||"link"===e.type)break}return function(i){if(!r||!r._balanced)return n(i);let l=Ck(o.sliceSerialize({start:r.end,end:o.now()}));return 94===l.codePointAt(0)&&s.includes(l.slice(1))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(i),e.exit("gfmFootnoteCallLabelMarker"),t(i)):n(i)}}function TI(e,t){let n=e.length;for(;n--;)if("labelImage"===e[n][1].type&&"enter"===e[n][0]){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";let r={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},o={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};o.end.column++,o.end.offset++,o.end._bufferIndex++;let i={type:"gfmFootnoteCallString",start:Object.assign({},o.end),end:Object.assign({},e[e.length-1][1].start)},s={type:"chunkString",contentType:"string",start:Object.assign({},i.start),end:Object.assign({},i.end)},l=[e[n+1],e[n+2],["enter",r,t],e[n+3],e[n+4],["enter",o,t],["exit",o,t],["enter",i,t],["enter",s,t],["exit",s,t],["exit",i,t],e[e.length-2],e[e.length-1],["exit",r,t]];return e.splice(n,e.length-n+1,...l),e}function TO(e,t,n){let r,o=this,i=o.parser.gfmFootnotes||(o.parser.gfmFootnotes=[]),s=0;return function(t){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(t),e.exit("gfmFootnoteCallLabelMarker"),l};function l(t){return 94!==t?n(t):(e.enter("gfmFootnoteCallMarker"),e.consume(t),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",a)}function a(l){if(s>999||93===l&&!r||null===l||91===l||Co(l))return n(l);if(93===l){e.exit("chunkString");let r=e.exit("gfmFootnoteCallString");return i.includes(Ck(o.sliceSerialize(r)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(l),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):n(l)}return Co(l)||(r=!0),s++,e.consume(l),92===l?c:a}function c(t){return 91===t||92===t||93===t?(e.consume(t),s++,a):a(t)}}function TD(e,t,n){let r,o,i=this,s=i.parser.gfmFootnotes||(i.parser.gfmFootnotes=[]),l=0;return function(t){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionLabelMarker"),a};function a(t){return 94===t?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",c):n(t)}function c(t){if(l>999||93===t&&!o||null===t||91===t||Co(t))return n(t);if(93===t){e.exit("chunkString");let n=e.exit("gfmFootnoteDefinitionLabelString");return r=Ck(i.sliceSerialize(n)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(t),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),u}return Co(t)||(o=!0),l++,e.consume(t),92===t?d:c}function d(t){return 91===t||92===t||93===t?(e.consume(t),l++,c):c(t)}function u(t){return 58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),s.includes(r)||s.push(r),TA(e,h,"gfmFootnoteDefinitionWhitespace")):n(t)}function h(e){return t(e)}}function TR(e,t,n){return e.check(T_,t,e.attempt(TN,t,n))}function TL(e){e.exit("gfmFootnoteDefinition")}function TP(e,t,n){let r=[],o=-1;for(;++o<e.length;){let i=e[o].resolveAll;i&&!r.includes(i)&&(t=i(t,n),r.push(i))}return t}class TB{constructor(){this.map=[]}add(e,t,n){!function(e,t,n,r){let o=0;if(0!==n||0!==r.length){for(;o<e.map.length;){if(e.map[o][0]===t){e.map[o][1]+=n,e.map[o][2].push(...r);return}o+=1}e.map.push([t,n,r])}}(this,e,t,n)}consume(e){if(this.map.sort(function(e,t){return e[0]-t[0]}),0===this.map.length)return;let t=this.map.length,n=[];for(;t>0;)t-=1,n.push(e.slice(this.map[t][0]+this.map[t][1]),this.map[t][2]),e.length=this.map[t][0];n.push(e.slice()),e.length=0;let r=n.pop();for(;r;){for(let t of r)e.push(t);r=n.pop()}this.map.length=0}}function TH(e,t,n){let r,o=this,i=0,s=0;return function(e){let t=o.events.length-1;for(;t>-1;){let e=o.events[t][1].type;if("lineEnding"===e||"linePrefix"===e)t--;else break}let r=t>-1?o.events[t][1].type:null,i="tableHead"===r||"tableRow"===r?y:l;return i===y&&o.parser.lazy[o.now().line]?n(e):i(e)};function l(t){var n;return e.enter("tableHead"),e.enter("tableRow"),124===(n=t)||(r=!0,s+=1),a(n)}function a(t){return null===t?n(t):Cr(t)?s>1?(s=0,o.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),u):n(t):Ci(t)?TA(e,a,"whitespace")(t):(s+=1,r&&(r=!1,i+=1),124===t)?(e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),r=!0,a):(e.enter("data"),c(t))}function c(t){return null===t||124===t||Co(t)?(e.exit("data"),a(t)):(e.consume(t),92===t?d:c)}function d(t){return 92===t||124===t?(e.consume(t),c):c(t)}function u(t){return(o.interrupt=!1,o.parser.lazy[o.now().line])?n(t):(e.enter("tableDelimiterRow"),r=!1,Ci(t))?TA(e,h,"linePrefix",o.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):h(t)}function h(t){return 45===t||58===t?f(t):124===t?(r=!0,e.enter("tableCellDivider"),e.consume(t),e.exit("tableCellDivider"),p):n(t)}function p(t){return Ci(t)?TA(e,f,"whitespace")(t):f(t)}function f(t){return 58===t?(s+=1,r=!0,e.enter("tableDelimiterMarker"),e.consume(t),e.exit("tableDelimiterMarker"),m):45===t?(s+=1,m(t)):null===t||Cr(t)?b(t):n(t)}function m(t){return 45===t?(e.enter("tableDelimiterFiller"),function t(n){return 45===n?(e.consume(n),t):58===n?(r=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(n),e.exit("tableDelimiterMarker"),g):(e.exit("tableDelimiterFiller"),g(n))}(t)):n(t)}function g(t){return Ci(t)?TA(e,b,"whitespace")(t):b(t)}function b(o){if(124===o)return h(o);if(null===o||Cr(o))return r&&i===s?(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(o)):n(o);return n(o)}function y(t){return e.enter("tableRow"),v(t)}function v(n){return 124===n?(e.enter("tableCellDivider"),e.consume(n),e.exit("tableCellDivider"),v):null===n||Cr(n)?(e.exit("tableRow"),t(n)):Ci(n)?TA(e,v,"whitespace")(n):(e.enter("data"),E(n))}function E(t){return null===t||124===t||Co(t)?(e.exit("data"),v(t)):(e.consume(t),92===t?k:E)}function k(t){return 92===t||124===t?(e.consume(t),E):E(t)}}function Tj(e,t){let n,r,o,i=-1,s=!0,l=0,a=[0,0,0,0],c=[0,0,0,0],d=!1,u=0,h=new TB;for(;++i<e.length;){let p=e[i],f=p[1];"enter"===p[0]?"tableHead"===f.type?(d=!1,0!==u&&(TU(h,t,u,n,r),r=void 0,u=0),n={type:"table",start:Object.assign({},f.start),end:Object.assign({},f.end)},h.add(i,0,[["enter",n,t]])):"tableRow"===f.type||"tableDelimiterRow"===f.type?(s=!0,o=void 0,a=[0,0,0,0],c=[0,i+1,0,0],d&&(d=!1,r={type:"tableBody",start:Object.assign({},f.start),end:Object.assign({},f.end)},h.add(i,0,[["enter",r,t]])),l="tableDelimiterRow"===f.type?2:r?3:1):l&&("data"===f.type||"tableDelimiterMarker"===f.type||"tableDelimiterFiller"===f.type)?(s=!1,0===c[2]&&(0!==a[1]&&(c[0]=c[1],o=TF(h,t,a,l,void 0,o),a=[0,0,0,0]),c[2]=i)):"tableCellDivider"===f.type&&(s?s=!1:(0!==a[1]&&(c[0]=c[1],o=TF(h,t,a,l,void 0,o)),c=[(a=c)[1],i,0,0])):"tableHead"===f.type?(d=!0,u=i):"tableRow"===f.type||"tableDelimiterRow"===f.type?(u=i,0!==a[1]?(c[0]=c[1],o=TF(h,t,a,l,i,o)):0!==c[1]&&(o=TF(h,t,c,l,i,o)),l=0):l&&("data"===f.type||"tableDelimiterMarker"===f.type||"tableDelimiterFiller"===f.type)&&(c[3]=i)}for(0!==u&&TU(h,t,u,n,r),h.consume(t.events),i=-1;++i<t.events.length;){let e=t.events[i];"enter"===e[0]&&"table"===e[1].type&&(e[1]._align=function(e,t){let n=!1,r=[];for(;t<e.length;){let o=e[t];if(n){if("enter"===o[0])"tableContent"===o[1].type&&r.push("tableDelimiterMarker"===e[t+1][1].type?"left":"none");else if("tableContent"===o[1].type){if("tableDelimiterMarker"===e[t-1][1].type){let e=r.length-1;r[e]="left"===r[e]?"center":"right"}}else if("tableDelimiterRow"===o[1].type)break}else"enter"===o[0]&&"tableDelimiterRow"===o[1].type&&(n=!0);t+=1}return r}(t.events,i))}return e}function TF(e,t,n,r,o,i){0!==n[0]&&(i.end=Object.assign({},Tz(t.events,n[0])),e.add(n[0],0,[["exit",i,t]]));let s=Tz(t.events,n[1]);if(i={type:1===r?"tableHeader":2===r?"tableDelimiter":"tableData",start:Object.assign({},s),end:Object.assign({},s)},e.add(n[1],0,[["enter",i,t]]),0!==n[2]){let o=Tz(t.events,n[2]),i=Tz(t.events,n[3]),s={type:"tableContent",start:Object.assign({},o),end:Object.assign({},i)};if(e.add(n[2],0,[["enter",s,t]]),2!==r){let r=t.events[n[2]],o=t.events[n[3]];if(r[1].end=Object.assign({},o[1].end),r[1].type="chunkText",r[1].contentType="text",n[3]>n[2]+1){let t=n[2]+1,r=n[3]-n[2]-1;e.add(t,r,[])}}e.add(n[3]+1,0,[["exit",s,t]])}return void 0!==o&&(i.end=Object.assign({},Tz(t.events,o)),e.add(o,0,[["exit",i,t]]),i=void 0),i}function TU(e,t,n,r,o){let i=[],s=Tz(t.events,n);o&&(o.end=Object.assign({},s),i.push(["exit",o,t])),r.end=Object.assign({},s),i.push(["exit",r,t]),e.add(n+1,0,i)}function Tz(e,t){let n=e[t],r="enter"===n[0]?"start":"end";return n[1][r]}let TV={name:"tasklistCheck",tokenize:function(e,t,n){let r=this;return function(t){return null===r.previous&&r._gfmTasklistFirstContentOfListItem?(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(t),e.exit("taskListCheckMarker"),o):n(t)};function o(t){return Co(t)?(e.enter("taskListCheckValueUnchecked"),e.consume(t),e.exit("taskListCheckValueUnchecked"),i):88===t||120===t?(e.enter("taskListCheckValueChecked"),e.consume(t),e.exit("taskListCheckValueChecked"),i):n(t)}function i(t){return 93===t?(e.enter("taskListCheckMarker"),e.consume(t),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),s):n(t)}function s(r){return Cr(r)?t(r):Ci(r)?e.check({tokenize:T$},t,n)(r):n(r)}}};function T$(e,t,n){return TA(e,function(e){return null===e?n(e):t(e)},"whitespace")}let TG={};function Tq(e){let t,n,r,o=e||TG,i=this.data(),s=i.micromarkExtensions||(i.micromarkExtensions=[]),l=i.fromMarkdownExtensions||(i.fromMarkdownExtensions=[]),a=i.toMarkdownExtensions||(i.toMarkdownExtensions=[]);s.push(Tu([{text:TE},{document:{91:{name:"gfmFootnoteDefinition",tokenize:TD,continuation:{tokenize:TR},exit:TL}},text:{91:{name:"gfmFootnoteCall",tokenize:TO},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:TM,resolveTo:TI}}},(t=(o||{}).singleTilde,n={name:"strikethrough",tokenize:function(e,n,r){let o=this.previous,i=this.events,s=0;return function(l){return 126===o&&"characterEscape"!==i[i.length-1][1].type?r(l):(e.enter("strikethroughSequenceTemporary"),function i(l){let a=CW(o);if(126===l)return s>1?r(l):(e.consume(l),s++,i);if(s<2&&!t)return r(l);let c=e.exit("strikethroughSequenceTemporary"),d=CW(l);return c._open=!d||2===d&&!!a,c._close=!a||2===a&&!!d,n(l)}(l))}},resolveAll:function(e,t){let n=-1;for(;++n<e.length;)if("enter"===e[n][0]&&"strikethroughSequenceTemporary"===e[n][1].type&&e[n][1]._close){let r=n;for(;r--;)if("exit"===e[r][0]&&"strikethroughSequenceTemporary"===e[r][1].type&&e[r][1]._open&&e[n][1].end.offset-e[n][1].start.offset==e[r][1].end.offset-e[r][1].start.offset){e[n][1].type="strikethroughSequence",e[r][1].type="strikethroughSequence";let o={type:"strikethrough",start:Object.assign({},e[r][1].start),end:Object.assign({},e[n][1].end)},i={type:"strikethroughText",start:Object.assign({},e[r][1].end),end:Object.assign({},e[n][1].start)},s=[["enter",o,t],["enter",e[r][1],t],["exit",e[r][1],t],["enter",i,t]],l=t.parser.constructs.insideSpan.null;l&&Ta(s,s.length,0,TP(l,e.slice(r+1,n),t)),Ta(s,s.length,0,[["exit",i,t],["enter",e[n][1],t],["exit",e[n][1],t],["exit",o,t]]),Ta(e,r-1,n-r+3,s),n=r+s.length-2;break}}for(n=-1;++n<e.length;)"strikethroughSequenceTemporary"===e[n][1].type&&(e[n][1].type="data");return e}},null==t&&(t=!0),{text:{126:n},insideSpan:{null:[n]},attentionMarkers:{null:[126]}}),{flow:{null:{name:"table",tokenize:TH,resolveAll:Tj}}},{text:{91:TV}}])),l.push([{transforms:[Cb],enter:{literalAutolink:Cu,literalAutolinkEmail:Ch,literalAutolinkHttp:Ch,literalAutolinkWww:Ch},exit:{literalAutolink:Cg,literalAutolinkEmail:Cm,literalAutolinkHttp:Cp,literalAutolinkWww:Cf}},{enter:{gfmFootnoteCallString:CC,gfmFootnoteCall:CT,gfmFootnoteDefinitionLabelString:Cw,gfmFootnoteDefinition:Cx},exit:{gfmFootnoteCallString:CS,gfmFootnoteCall:CA,gfmFootnoteDefinitionLabelString:C_,gfmFootnoteDefinition:CN}},{canContainEols:["delete"],enter:{strikethrough:CR},exit:{strikethrough:CL}},{enter:{table:C9,tableData:Tn,tableHeader:Tn,tableRow:Te},exit:{codeText:Tr,table:C7,tableData:Tt,tableHeader:Tt,tableRow:Tt}},{exit:{taskListCheckValueChecked:Ti,taskListCheckValueUnchecked:Ti,paragraph:Ts}}]),a.push({extensions:[{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:Cc,notInConstruct:Cd},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:Cc,notInConstruct:Cd},{character:":",before:"[ps]",after:"\\/",inConstruct:Cc,notInConstruct:Cd}]},(r=!1,o&&o.firstLineBlank&&(r=!0),{handlers:{footnoteDefinition:function(e,t,n,o){let i=n.createTracker(o),s=i.move("[^"),l=n.enter("footnoteDefinition"),a=n.enter("label");return s+=i.move(n.safe(n.associationId(e),{before:s,after:"]"})),a(),s+=i.move("]:"),e.children&&e.children.length>0&&(i.shift(4),s+=i.move((r?"\n":" ")+n.indentLines(n.containerFlow(e,i.current()),r?CO:CI))),l(),s},footnoteReference:CM},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]}),{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:CD}],handlers:{delete:CP}},function(e){let t=e||{},n=t.tableCellPadding,r=t.tablePipeAlign,o=t.stringLength,i=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:"\n",inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:function(e,t,n){let r=C6.inlineCode(e,t,n);return n.stack.includes("tableCell")&&(r=r.replace(/\|/g,"\\$&")),r},table:function(e,t,n,r){return l(function(e,t,n){let r=e.children,o=-1,i=[],s=t.enter("table");for(;++o<r.length;)i[o]=a(r[o],t,n);return s(),i}(e,n,r),e.align)},tableCell:s,tableRow:function(e,t,n,r){let o=l([a(e,n,r)]);return o.slice(0,o.indexOf("\n"))}}};function s(e,t,n,r){let o=n.enter("tableCell"),s=n.enter("phrasing"),l=n.containerPhrasing(e,{...r,before:i,after:i});return s(),o(),l}function l(e,t){return function(e,t){let n=t||{},r=(n.align||[]).concat(),o=n.stringLength||CB,i=[],s=[],l=[],a=[],c=0,d=-1;for(;++d<e.length;){let t=[],r=[],i=-1;for(e[d].length>c&&(c=e[d].length);++i<e[d].length;){var u;let s=null==(u=e[d][i])?"":String(u);if(!1!==n.alignDelimiters){let e=o(s);r[i]=e,(void 0===a[i]||e>a[i])&&(a[i]=e)}t.push(s)}s[d]=t,l[d]=r}let h=-1;if("object"==typeof r&&"length"in r)for(;++h<c;)i[h]=CH(r[h]);else{let e=CH(r);for(;++h<c;)i[h]=e}h=-1;let p=[],f=[];for(;++h<c;){let e=i[h],t="",r="";99===e?(t=":",r=":"):108===e?t=":":114===e&&(r=":");let o=!1===n.alignDelimiters?1:Math.max(1,a[h]-t.length-r.length),s=t+"-".repeat(o)+r;!1!==n.alignDelimiters&&((o=t.length+o+r.length)>a[h]&&(a[h]=o),f[h]=o),p[h]=s}s.splice(1,0,p),l.splice(1,0,f),d=-1;let m=[];for(;++d<s.length;){let e=s[d],t=l[d];h=-1;let r=[];for(;++h<c;){let o=e[h]||"",s="",l="";if(!1!==n.alignDelimiters){let e=a[h]-(t[h]||0),n=i[h];114===n?s=" ".repeat(e):99===n?e%2?(s=" ".repeat(e/2+.5),l=" ".repeat(e/2-.5)):l=s=" ".repeat(e/2):l=" ".repeat(e)}!1===n.delimiterStart||h||r.push("|"),!1!==n.padding&&(!1!==n.alignDelimiters||""!==o)&&(!1!==n.delimiterStart||h)&&r.push(" "),!1!==n.alignDelimiters&&r.push(s),r.push(o),!1!==n.alignDelimiters&&r.push(l),!1!==n.padding&&r.push(" "),(!1!==n.delimiterEnd||h!==c-1)&&r.push("|")}m.push(!1===n.delimiterEnd?r.join("").replace(/ +$/,""):r.join(""))}return m.join("\n")}(e,{align:t,alignDelimiters:r,padding:n,stringLength:o})}function a(e,t,n){let r=e.children,o=-1,i=[],l=t.enter("tableRow");for(;++o<r.length;)i[o]=s(r[o],e,t,n);return l(),i}}(o),{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:Tl}}]})}let TW={}.hasOwnProperty;function TY(e,t){let n=t||{};function r(t,...n){let o=r.invalid,i=r.handlers;if(t&&TW.call(t,e)){let n=String(t[e]);o=TW.call(i,n)?i[n]:r.unknown}if(o)return o.call(this,t,...n)}return r.handlers=n.handlers||{},r.invalid=n.invalid,r.unknown=n.unknown,r}let TK={}.hasOwnProperty,TZ=[function(e,t,n,r){if("code"===t.type&&CV(t,r)&&("list"===e.type||e.type===t.type&&CV(e,r)))return!1;if("spread"in n&&"boolean"==typeof n.spread){if("paragraph"===e.type&&(e.type===t.type||"definition"===t.type||"heading"===t.type&&CZ(t,r)))return;return+!!n.spread}}],TX=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],TQ=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:"\n",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:TX},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:"(?:[\r\n]|$)"},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:TX},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:"(?:[ 	\r\n*])"},{character:"*",inConstruct:"phrasing",notInConstruct:TX},{atBreak:!0,character:"+",after:"(?:[ 	\r\n])"},{atBreak:!0,character:"-",after:"(?:[ 	\r\n-])"},{atBreak:!0,before:"\\d+",character:".",after:"(?:[ 	\r\n]|$)"},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:TX},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:TX},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:TX},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:TX},{atBreak:!0,character:"~"}],TJ=document.createElement("i");function T0(e){let t="&"+e+";";TJ.innerHTML=t;let n=TJ.textContent;return(59!==n.charCodeAt(n.length-1)||"semi"===e)&&n!==t&&n}function T1(e,t){let n=Number.parseInt(e,t);return n<9||11===n||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(65535&n)==65535||(65535&n)==65534||n>1114111?"":String.fromCodePoint(n)}let T2=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function T4(e){return e.replace(T2,T5)}function T5(e,t,n){if(t)return t;if(35===n.charCodeAt(0)){let e=n.charCodeAt(1),t=120===e||88===e;return T1(n.slice(t?2:1),t?16:10)}return T0(n)||e}function T3(e){return e.label||!e.identifier?e.label||"":T4(e.identifier)}function T8(e){if(!e._compiled){let t=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=RegExp((t?"("+t+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}let T6=/\r?\n|\r/g;function T9(e,t){let n,r=[],o=0,i=0;for(;n=T6.exec(e);)s(e.slice(o,n.index)),r.push(n[0]),o=n.index+n[0].length,i++;return s(e.slice(o)),r.join("");function s(e){r.push(t(e,i,!e))}}function T7(e,t){return e-t}function we(e,t){let n,r=/\\(?=[!-/:-@[-`{-~])/g,o=[],i=[],s=e+t,l=-1,a=0;for(;n=r.exec(s);)o.push(n.index);for(;++l<o.length;)a!==o[l]&&i.push(e.slice(a,o[l])),i.push("\\"),a=o[l];return i.push(e.slice(a)),i.join("")}function wt(e){let t=e||{},n=t.now||{},r=t.lineShift||0,o=n.line||1,i=n.column||1;return{move:function(e){let t=e||"",n=t.split(/\r?\n|\r/g),s=n[n.length-1];return o+=n.length-1,i=1===n.length?i+s.length:1+s.length+r,t},current:function(){return{now:{line:o,column:i},lineShift:r}},shift:function(e){r+=e}}}function wn(e){throw Error("Cannot handle value `"+e+"`, expected node")}function wr(e){throw Error("Cannot handle unknown node `"+e.type+"`")}function wo(e,t){if("definition"===e.type&&e.type===t.type)return 0}function wi(e,t){return function(e,t,n){let r,o=t.indexStack,i=e.children||[],s=[],l=-1,a=n.before;o.push(-1);let c=t.createTracker(n);for(;++l<i.length;){let d,u=i[l];if(o[o.length-1]=l,l+1<i.length){let n=t.handle.handlers[i[l+1].type];n&&n.peek&&(n=n.peek),d=n?n(i[l+1],e,t,{before:"",after:"",...c.current()}).charAt(0):""}else d=n.after;s.length>0&&("\r"===a||"\n"===a)&&"html"===u.type&&(s[s.length-1]=s[s.length-1].replace(/(\r?\n|\r)$/," "),a=" ",(c=t.createTracker(n)).move(s.join("")));let h=t.handle(u,e,t,{...c.current(),after:d,before:a});r&&r===h.slice(0,1)&&(h=Cq(r.charCodeAt(0))+h.slice(1));let p=t.attentionEncodeSurroundingInfo;t.attentionEncodeSurroundingInfo=void 0,r=void 0,p&&(s.length>0&&p.before&&a===s[s.length-1].slice(-1)&&(s[s.length-1]=s[s.length-1].slice(0,-1)+Cq(a.charCodeAt(0))),p.after&&(r=d)),c.move(h),s.push(h),a=h.slice(-1)}return o.pop(),s.join("")}(e,this,t)}function ws(e,t){return function(e,t,n){let r=t.indexStack,o=e.children||[],i=t.createTracker(n),s=[],l=-1;for(r.push(-1);++l<o.length;){let n=o[l];r[r.length-1]=l,s.push(i.move(t.handle(n,e,t,{before:"\n",after:"\n",...i.current()}))),"list"!==n.type&&(t.bulletLastUsed=void 0),l<o.length-1&&s.push(i.move(function(e,t,n,r){let o=r.join.length;for(;o--;){let i=r.join[o](e,t,n,r);if(!0===i||1===i)break;if("number"==typeof i)return"\n".repeat(1+i);if(!1===i)return"\n\n<!---->\n\n"}return"\n\n"}(n,o[l+1],e,t)))}return r.pop(),s.join("")}(e,this,t)}function wl(e,t){return function(e,t,n){let r=(n.before||"")+(t||"")+(n.after||""),o=[],i=[],s={},l=-1;for(;++l<e.unsafe.length;){let t,n=e.unsafe[l];if(!CF(e.stack,n))continue;let i=e.compilePattern(n);for(;t=i.exec(r);){let e="before"in n||!!n.atBreak,r="after"in n,i=t.index+(e?t[1].length:0);o.includes(i)?(s[i].before&&!e&&(s[i].before=!1),s[i].after&&!r&&(s[i].after=!1)):(o.push(i),s[i]={before:e,after:r})}}o.sort(T7);let a=n.before?n.before.length:0,c=r.length-(n.after?n.after.length:0);for(l=-1;++l<o.length;){let e=o[l];!(e<a)&&!(e>=c)&&(!(e+1<c)||o[l+1]!==e+1||!s[e].after||s[e+1].before||s[e+1].after)&&(o[l-1]!==e-1||!s[e].before||s[e-1].before||s[e-1].after)&&(a!==e&&i.push(we(r.slice(a,e),"\\")),a=e,!/[!-/:-@[-`{-~]/.test(r.charAt(e))||n.encode&&n.encode.includes(r.charAt(e))?(i.push(Cq(r.charCodeAt(e))),a++):i.push("\\"))}return i.push(we(r.slice(a,c),n.after)),i.join("")}(this,e,t)}function wa(e){let t=this;t.compiler=function(n){var r;let o,i;return r={...t.data("settings"),...e,extensions:t.data("toMarkdownExtensions")||[]},!function e(t,n){var r,o,i,s;let l,a=-1;if(n.extensions)for(;++a<n.extensions.length;)e(t,n.extensions[a]);for(l in n)if(TK.call(n,l))switch(l){case"extensions":break;case"unsafe":case"join":r=t[l],(o=n[l])&&r.push(...o);break;case"handlers":i=t[l],(s=n[l])&&Object.assign(i,s);break;default:t.options[l]=n[l]}return t}(o={associationId:T3,containerPhrasing:wi,containerFlow:ws,createTracker:wt,compilePattern:T8,enter:function(e){return o.stack.push(e),function(){o.stack.pop()}},handlers:{...C6},handle:void 0,indentLines:T9,indexStack:[],join:[...TZ],options:{},safe:wl,stack:[],unsafe:[...TQ]},r||{}),o.options.tightDefinitions&&o.join.push(wo),o.handle=TY("type",{invalid:wn,unknown:wr,handlers:o.handlers}),(i=o.handle(n,void 0,o,{before:"\n",after:"\n",now:{line:1,column:1},lineShift:0}))&&10!==i.charCodeAt(i.length-1)&&13!==i.charCodeAt(i.length-1)&&(i+="\n"),i}}function wc(e){if(e)throw e}var wd=e.i(75609);function wu(e){if("object"!=typeof e||null===e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}let wh=function(e){let t=this.constructor.prototype,n=t[e],r=function(){return n.apply(r,arguments)};return Object.setPrototypeOf(r,t),r},wp={}.hasOwnProperty;class wf extends wh{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=function(){let e=[],t={run:function(...t){let n=-1,r=t.pop();if("function"!=typeof r)throw TypeError("Expected function as last argument, not "+r);!function o(i,...s){let l=e[++n],a=-1;if(i)return void r(i);for(;++a<t.length;)(null===s[a]||void 0===s[a])&&(s[a]=t[a]);t=s,l?(function(e,t){let n;return function(...t){let i,s=e.length>t.length;s&&t.push(r);try{i=e.apply(this,t)}catch(e){if(s&&n)throw e;return r(e)}s||(i&&i.then&&"function"==typeof i.then?i.then(o,r):i instanceof Error?r(i):o(i))};function r(e,...o){n||(n=!0,t(e,...o))}function o(e){r(null,e)}})(l,o)(...s):r(null,...s)}(null,...t)},use:function(n){if("function"!=typeof n)throw TypeError("Expected `middelware` to be a function, not "+n);return e.push(n),t}};return t}()}copy(){let e=new wf,t=-1;for(;++t<this.attachers.length;){let n=this.attachers[t];e.use(...n)}return e.data((0,wd.default)(!0,{},this.namespace)),e}data(e,t){return"string"==typeof e?2==arguments.length?(wy("data",this.frozen),this.namespace[e]=t,this):wp.call(this.namespace,e)&&this.namespace[e]||void 0:e?(wy("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;for(;++this.freezeIndex<this.attachers.length;){let[e,...t]=this.attachers[this.freezeIndex];if(!1===t[0])continue;!0===t[0]&&(t[0]=void 0);let n=e.call(this,...t);"function"==typeof n&&this.transformers.use(n)}return this.frozen=!0,this.freezeIndex=1/0,this}parse(e){this.freeze();let t=wk(e),n=this.parser||this.Parser;return wg("parse",n),n(String(t),t)}process(e,t){let n=this;return this.freeze(),wg("process",this.parser||this.Parser),wb("process",this.compiler||this.Compiler),t?r(void 0,t):new Promise(r);function r(r,o){let i=wk(e),s=n.parse(i);function l(e,n){e||!n?o(e):r?r(n):(bP(t,"`done` is defined if `resolve` is not"),t(void 0,n))}n.run(s,i,function(e,t,r){var o,i;if(e||!t||!r)return l(e);let s=n.stringify(t,r);"string"==typeof(o=s)||(i=o)&&"object"==typeof i&&"byteLength"in i&&"byteOffset"in i?r.value=s:r.result=s,l(e,r)})}}processSync(e){let t,n=!1;return this.freeze(),wg("processSync",this.parser||this.Parser),wb("processSync",this.compiler||this.Compiler),this.process(e,function(e,r){n=!0,wc(e),t=r}),wE("processSync","process",n),bP(t,"we either bailed on an error or have a tree"),t}run(e,t,n){wv(e),this.freeze();let r=this.transformers;return n||"function"!=typeof t||(n=t,t=void 0),n?o(void 0,n):new Promise(o);function o(o,i){bP("function"!=typeof t,"`file` cant be a `done` anymore, we checked");let s=wk(t);r.run(e,s,function(t,r,s){let l=r||e;t?i(t):o?o(l):(bP(n,"`done` is defined if `resolve` is not"),n(void 0,l,s))})}}runSync(e,t){let n,r=!1;return this.run(e,t,function(e,t){wc(e),n=t,r=!0}),wE("runSync","run",r),bP(n,"we either bailed on an error or have a tree"),n}stringify(e,t){this.freeze();let n=wk(t),r=this.compiler||this.Compiler;return wb("stringify",r),wv(e),r(e,n)}use(e,...t){let n=this.attachers,r=this.namespace;if(wy("use",this.frozen),null==e);else if("function"==typeof e)s(e,t);else if("object"==typeof e)Array.isArray(e)?i(e):o(e);else throw TypeError("Expected usable value, not `"+e+"`");return this;function o(e){if(!("plugins"in e)&&!("settings"in e))throw Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");i(e.plugins),e.settings&&(r.settings=(0,wd.default)(!0,r.settings,e.settings))}function i(e){let t=-1;if(null==e);else if(Array.isArray(e))for(;++t<e.length;)!function(e){if("function"==typeof e)s(e,[]);else if("object"==typeof e)if(Array.isArray(e)){let[t,...n]=e;s(t,n)}else o(e);else throw TypeError("Expected usable value, not `"+e+"`")}(e[t]);else throw TypeError("Expected a list of plugins, not `"+e+"`")}function s(e,t){let r=-1,o=-1;for(;++r<n.length;)if(n[r][0]===e){o=r;break}if(-1===o)n.push([e,...t]);else if(t.length>0){let[r,...i]=t,s=n[o][1];wu(s)&&wu(r)&&(r=(0,wd.default)(!0,s,r)),n[o]=[e,r,...i]}}}}let wm=new wf().freeze();function wg(e,t){if("function"!=typeof t)throw TypeError("Cannot `"+e+"` without `parser`")}function wb(e,t){if("function"!=typeof t)throw TypeError("Cannot `"+e+"` without `compiler`")}function wy(e,t){if(t)throw Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function wv(e){if(!wu(e)||"string"!=typeof e.type)throw TypeError("Expected node, got `"+e+"`")}function wE(e,t,n){if(!n)throw Error("`"+e+"` finished async. Use `"+t+"` instead")}function wk(e){var t;return(t=e)&&"object"==typeof t&&"message"in t&&"messages"in t?e:new Ed(e)}function wC(e,t){let n=function(e,t){switch(e.nodeType){case 1:return function(e,t){let n=e.namespaceURI,r=n===yf?e.tagName.toLowerCase():e.tagName,o=n===yf&&"template"===r?e.content:e,i=e.getAttributeNames(),s={},l=-1;for(;++l<i.length;)s[i[l]]=e.getAttribute(i[l])||"";return(n===ym?yh:yu)(r,s,wT(o,t))}(e,t);case 3:return{type:"text",value:e.nodeValue||""};case 8:return{type:"comment",value:e.nodeValue||""};case 9:case 11:return function(e,t){return{type:"root",children:wT(e,t)}}(e,t);case 10:return{type:"doctype"};default:return}}(e,t);return n&&t.afterTransform&&t.afterTransform(e,n),n}function wT(e,t){let n=e.childNodes,r=[],o=-1;for(;++o<n.length;){let e=wC(n[o],t);void 0!==e&&r.push(e)}return r}var ww=Object.defineProperty,wx=(e,t,n)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?ww(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n};function wS(e){let t=Array.from(e.classList).filter(e=>!e.startsWith("bn-"))||[];t.length>0?e.className=t.join(" "):e.removeAttribute("class")}function wA(e,t,n,r){var o;let i;if(t)if("string"==typeof t)i=aC([t],e.pmSchema);else if(Array.isArray(t))i=aC(t,e.pmSchema);else if("tableContent"===t.type)i=aT(t,e.pmSchema);else throw new l1(t.type);else throw Error("blockContent is required");let s=((null==r?void 0:r.document)??document).createDocumentFragment();for(let t of i)if("text"!==t.type.name&&e.schema.inlineContentSchema[t.type.name]){let o=e.schema.inlineContentSpecs[t.type.name].implementation;if(o){let i=aa(t,e.schema.inlineContentSchema,e.schema.styleSchema),l=o.toExternalHTML?o.toExternalHTML(i,e):o.render.call({renderType:"dom",props:void 0},i,()=>{},e);if(l){if(s.appendChild(l.dom),l.contentDOM){let e=n.serializeFragment(t.content,r);l.contentDOM.dataset.editable="",l.contentDOM.appendChild(e)}continue}}}else if("text"===t.type.name){let n=document.createTextNode(t.textContent);for(let r of t.marks.toReversed())if(r.type.name in e.schema.styleSpecs){let t=(e.schema.styleSpecs[r.type.name].implementation.toExternalHTML??e.schema.styleSpecs[r.type.name].implementation.render)(r.attrs.stringValue,e);t.contentDOM.appendChild(n),n=t.dom}else{let e=r.type.spec.toDOM(r,!0),t=e8.renderSpec(document,e);t.contentDOM.appendChild(n),n=t.dom}s.appendChild(n)}else{let e=n.serializeFragment(em.from([t]),r);s.appendChild(e)}return 1===s.childNodes.length&&(null==(o=s.firstChild)?void 0:o.nodeType)===1&&wS(s.firstChild),s}let w_=(e,t,n,r,o,i,s)=>{for(let l of n)!function(e,t,n,r,o,i,s){var l,a,c,d,u,h,p,f,m;let g,b=(null==s?void 0:s.document)??document,y=t.pmSchema.nodes.blockContainer,v=n.props||{};for(let[e,r]of Object.entries(t.schema.blockSchema[n.type].propSchema))e in v||void 0===r.default||(v[e]=r.default);let E=Array.from((null==(a=null==(l=y.spec)?void 0:l.toDOM)?void 0:a.call(l,y.create({id:n.id,...v}))).dom.attributes),k=t.blockImplementations[n.type].implementation,C=(null==(c=k.toExternalHTML)?void 0:c.call({},{...n,props:v},t))||k.render.call({},{...n,props:v},t),T=b.createDocumentFragment();if(C.dom.classList.contains("bn-block-content")){for(let e of[...E,...Array.from(C.dom.attributes)].filter(e=>e.name.startsWith("data")&&"data-content-type"!==e.name&&"data-file-block"!==e.name&&"data-node-view-wrapper"!==e.name&&"data-node-type"!==e.name&&"data-id"!==e.name&&"data-editable"!==e.name))C.dom.firstChild.setAttribute(e.name,e.value);wS(C.dom.firstChild),T.append(...Array.from(C.dom.childNodes))}else T.append(C.dom);if(C.contentDOM&&n.content){let e=wA(t,n.content,r,s);C.contentDOM.appendChild(e)}if(o.has(n.type)?g="OL":i.has(n.type)&&(g="UL"),g){if((null==(d=e.lastChild)?void 0:d.nodeName)!==g){let t=b.createElement(g);"OL"===g&&"start"in v&&v.start&&(null==v?void 0:v.start)!==1&&t.setAttribute("start",v.start+""),e.append(t)}e.lastChild.appendChild(T)}else e.append(T);if(n.children&&n.children.length>0){let l=b.createDocumentFragment();if(w_(l,t,n.children,r,o,i,s),(null==(u=e.lastChild)?void 0:u.nodeName)==="UL"||(null==(h=e.lastChild)?void 0:h.nodeName)==="OL")for(;(null==(p=l.firstChild)?void 0:p.nodeName)==="UL"||(null==(f=l.firstChild)?void 0:f.nodeName)==="OL";)e.lastChild.lastChild.appendChild(l.firstChild);t.pmSchema.nodes[n.type].isInGroup("blockContent")?e.append(l):null==(m=C.contentDOM)||m.append(l)}}(e,t,l,r,o,i,s)},wN=(e,t)=>{let n=e8.fromSchema(e);return{exportBlocks:(e,r)=>{var o,i;let s,l=(o=new Set(["numberedListItem"]),i=new Set(["bulletListItem","checkListItem","toggleListItem"]),w_(s=((null==r?void 0:r.document)??document).createDocumentFragment(),t,e,n,o,i,r),s),a=document.createElement("div");return a.append(l),a.innerHTML},exportInlineContent:(e,r)=>{let o=wA(t,e,n,r),i=document.createElement("div");return i.append(o.cloneNode(!0)),i.innerHTML}}};function wM(e){let t={},n={},r=l7(e);return e.descendants((o,i)=>{if(!m0(o))return!0;let s=function(e,t){if(0===t)return;let n=e.resolve(t);for(let e=n.depth;e>0;e--){let t=n.node(e);if(m0(t))return t.attrs.id}}(e,i),l=s??"__root__";n[l]||(n[l]=[]);let a=ac(o,r);return t[o.attrs.id]={block:a,parentId:s},n[l].push(o.attrs.id),!0}),{byId:t,childrenByParent:n}}function wI(e,t=[]){let n=e.getMeta("paste")?{type:"paste"}:"drop"===e.getMeta("uiEvent")?{type:"drop"}:e.getMeta("history$")?{type:e.getMeta("history$").redo?"redo":"undo"}:e.getMeta("y-sync$")?e.getMeta("y-sync$").isUndoRedoOperation?{type:"undo-redo"}:{type:"yjs-remote"}:{type:"local"},r=sa(e.before,[e,...t]),o=wM(r.before),i=wM(r.doc),s=[],l=new Set;Object.keys(i.byId).filter(e=>!(e in o.byId)).forEach(e=>{s.push({type:"insert",block:i.byId[e].block,source:n,prevBlock:void 0}),l.add(e)}),Object.keys(o.byId).filter(e=>!(e in i.byId)).forEach(e=>{s.push({type:"delete",block:o.byId[e].block,source:n,prevBlock:void 0}),l.add(e)}),Object.keys(i.byId).filter(e=>e in o.byId).forEach(e=>{var t,r;let a=o.byId[e],c=i.byId[e];a.parentId!==c.parentId?(s.push({type:"move",block:c.block,prevBlock:a.block,source:n,prevParent:a.parentId?null==(t=o.byId[a.parentId])?void 0:t.block:void 0,currentParent:c.parentId?null==(r=i.byId[c.parentId])?void 0:r.block:void 0}),l.add(e)):(0,bl.default)({...a.block,children:void 0},{...c.block,children:void 0})||(s.push({type:"update",block:c.block,prevBlock:a.block,source:n}),l.add(e))});let a=o.childrenByParent,c=i.childrenByParent,d=new Set([...Object.keys(a),...Object.keys(c)]),u=new Set;return d.forEach(e=>{let t=function(e,t){let n=new Set;if(!e||!t)return n;let r=new Set(e),o=t.filter(e=>r.has(e)),i=e.filter(e=>o.includes(e));if(i.length<=1||o.length<=1)return n;let s={};for(let e=0;e<i.length;e++)s[i[e]]=e;let l=o.map(e=>s[e]),a=l.length,c=[],d=[],u=Array(a).fill(-1),h=(e,t)=>{let n=0,r=e.length;for(;n<r;){let o=n+r>>>1;e[o]<t?n=o+1:r=o}return n};for(let e=0;e<a;e++){let t=l[e],n=h(c,t);n>0&&(u[e]=d[n-1]),n===c.length?(c.push(t),d.push(e)):(c[n]=t,d[n]=e)}let p=new Set,f=d[d.length-1]??-1;for(;-1!==f;)p.add(f),f=u[f];for(let e=0;e<o.length;e++)p.has(e)||n.add(o[e]);return n}(a[e],c[e]);0!==t.size&&t.forEach(t=>{var r,a;let c=o.byId[t],d=i.byId[t];!c||!d||c.parentId!==d.parentId||l.has(t)||(c.parentId??"__root__")!==e||u.has(t)||(u.add(t),s.push({type:"move",block:d.block,prevBlock:c.block,source:n,prevParent:c.parentId?null==(r=o.byId[c.parentId])?void 0:r.block:void 0,currentParent:d.parentId?null==(a=i.byId[d.parentId])?void 0:a.block:void 0}),l.add(t))})}),s}let wO=mm(()=>{let e=[];return{key:"blockChange",prosemirrorPlugins:[new t4({key:new t8("blockChange"),filterTransaction:t=>{let n;return e.reduce((e,r)=>!1===e?e:!1!==r({getChanges:()=>n||(n=wI(t)),tr:t}),!0)}})],subscribe:t=>(e.push(t),()=>{e.splice(e.indexOf(t),1)})}});function wD(e){let t="#"===e.charAt(0)?e.substring(1,7):e,n=[parseInt(t.substring(0,2),16)/255,parseInt(t.substring(2,4),16)/255,parseInt(t.substring(4,6),16)/255].map(e=>e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4));return .2126*n[0]+.7152*n[1]+.0722*n[2]<=.179}let wR=mm(({options:e})=>{let t=new Map,n=e.provider&&"awareness"in e.provider&&"object"==typeof e.provider.awareness?e.provider.awareness:void 0;return n&&("setLocalStateField"in n&&"function"==typeof n.setLocalStateField&&n.setLocalStateField("user",e.user),"on"in n&&"function"==typeof n.on&&"always"!==e.showCursorLabels&&n.on("change",({updated:e})=>{for(let n of e){let e=t.get(n);e&&(e.element.setAttribute("data-active",""),e.hideTimeout&&clearTimeout(e.hideTimeout),t.set(n,{element:e.element,hideTimeout:setTimeout(()=>{e.element.removeAttribute("data-active")},2e3)}))}})),{key:"yCursor",prosemirrorPlugins:[n?((e,{awarenessStateFilter:t=ba,cursorBuilder:n=bc,selectionBuilder:r=bd,getSelection:o=e=>e.selection}={},i="cursor")=>new t4({key:cd,state:{init:(o,i)=>bh(i,e,t,n,r),apply(o,i,s,l){let a=ca.getState(l),c=o.getMeta(cd);return a&&a.isChangeOrigin||c&&c.awarenessUpdated?bh(l,e,t,n,r):i.map(o.mapping,o.doc)}},props:{decorations:e=>cd.getState(e)},view:t=>{let n=()=>{t.docView&&(mt||(mt=new Map,uZ(0,mn)),cF(mt,t,cH).set(cd,{awarenessUpdated:!0}))},r=()=>{let n=ca.getState(t.state),r=e.getLocalState()||{};if(t.hasFocus()){let s=o(t.state),l=mr(s.anchor,n.type,n.binding.mapping),a=mr(s.head,n.type,n.binding.mapping);null!=r.cursor&&hV(hj(r.cursor.anchor),l)&&hV(hj(r.cursor.head),a)||e.setLocalStateField(i,{anchor:l,head:a})}else null!=r.cursor&&null!==mi(n.doc,n.type,hj(r.cursor.anchor),n.binding.mapping)&&e.setLocalStateField(i,null)};return e.on("change",n),t.dom.addEventListener("focusin",r),t.dom.addEventListener("focusout",r),{update:r,destroy:()=>{t.dom.removeEventListener("focusin",r),t.dom.removeEventListener("focusout",r),e.off("change",n),e.setLocalStateField(i,null)}}}}))(n,{selectionBuilder:bd,cursorBuilder(n,r){let o=t.get(r);if(!o){let i=(e.renderCursor??function(e){let t=document.createElement("span");t.classList.add("bn-collaboration-cursor__base");let n=document.createElement("span");n.setAttribute("contentedEditable","false"),n.classList.add("bn-collaboration-cursor__caret"),n.setAttribute("style",`background-color: ${e.color}; color: ${wD(e.color)?"white":"black"}`);let r=document.createElement("span");return r.classList.add("bn-collaboration-cursor__label"),r.setAttribute("style",`background-color: ${e.color}; color: ${wD(e.color)?"white":"black"}`),r.insertBefore(document.createTextNode(e.name),null),n.insertBefore(r,null),t.insertBefore(document.createTextNode(""),null),t.insertBefore(n,null),t.insertBefore(document.createTextNode(""),null),t})(n);"always"!==e.showCursorLabels&&(i.addEventListener("mouseenter",()=>{let e=t.get(r);e.element.setAttribute("data-active",""),e.hideTimeout&&(clearTimeout(e.hideTimeout),t.set(r,{element:e.element,hideTimeout:void 0}))}),i.addEventListener("mouseleave",()=>{let e=t.get(r);t.set(r,{element:e.element,hideTimeout:setTimeout(()=>{e.element.removeAttribute("data-active")},2e3)})})),o={element:i,hideTimeout:void 0},t.set(r,o)}return o.element}}):void 0].filter(Boolean),dependsOn:["ySync"],updateUser(e){null==n||n.setLocalStateField("user",e)}}}),wL=mm(({options:e})=>({key:"ySync",prosemirrorPlugins:[((e,{colors:t=f$,colorMapping:n=new Map,permanentUserData:r=null,onFirstRender:o=()=>{},mapping:i}={})=>{let s=!1,l=new fq(e,i),a=new t4({props:{editable:e=>{let t=ca.getState(e);return null==t.snapshot&&null==t.prevSnapshot}},key:ca,state:{init:(o,i)=>({type:e,doc:e.doc,binding:l,snapshot:null,prevSnapshot:null,isChangeOrigin:!1,isUndoRedoOperation:!1,addToHistory:!0,colors:t,colorMapping:n,permanentUserData:r}),apply:(e,t)=>{let n=e.getMeta(ca);if(void 0!==n)for(let e in t=Object.assign({},t),n)t[e]=n[e];return t.addToHistory=!1!==e.getMeta("addToHistory"),t.isChangeOrigin=void 0!==n&&!!n.isChangeOrigin,t.isUndoRedoOperation=void 0!==n&&!!n.isChangeOrigin&&!!n.isUndoRedoOperation,null!==l.prosemirrorView&&void 0!==n&&(null!=n.snapshot||null!=n.prevSnapshot)&&uZ(0,()=>{null!=l.prosemirrorView&&(null==n.restore?l._renderSnapshot(n.snapshot,n.prevSnapshot,t):(l._renderSnapshot(n.snapshot,n.snapshot,t),delete t.restore,delete t.snapshot,delete t.prevSnapshot,l.mux(()=>{l._prosemirrorChanged(l.prosemirrorView.state.doc)})))}),t}},view:e=>(l.initView(e),null==i&&l._forceRerender(),o(),{update:()=>{let t=a.getState(e.state);if(null==t.snapshot&&null==t.prevSnapshot&&(s||null!==e.state.doc.content.findDiffStart(e.state.doc.type.createAndFill().content))){if(s=!0,!1===t.addToHistory&&!t.isChangeOrigin){let t=cc.getState(e.state),n=t&&t.undoManager;n&&n.stopCapturing()}l.mux(()=>{t.doc.transact(n=>{n.meta.set("addToHistory",t.addToHistory),l._prosemirrorChanged(e.state.doc)},ca)})}},destroy:()=>{l.destroy()}})});return a})(e.fragment)],runsBefore:["default"]})),wP=mm(()=>({key:"yUndo",prosemirrorPlugins:[(({protectedNodes:e=bm,trackedOrigins:t=[],undoManager:n=null}={})=>new t4({key:cc,state:{init:(r,o)=>{let i=ca.getState(o),s=n||new po(i.type,{trackedOrigins:new Set([ca].concat(t)),deleteFilter:t=>!(t instanceof fN)||!(t.content instanceof fT)||!(t.content.type instanceof p8||t.content.type instanceof p7&&e.has(t.content.type.nodeName))||0===t.content.type._length,captureTransaction:e=>!1!==e.meta.get("addToHistory")});return{undoManager:s,prevSel:null,hasUndoOps:s.undoStack.length>0,hasRedoOps:s.redoStack.length>0}},apply:(e,t,n,r)=>{let o=ca.getState(r).binding,i=t.undoManager,s=i.undoStack.length>0,l=i.redoStack.length>0;return o?{undoManager:i,prevSel:fG(o,n),hasUndoOps:s,hasRedoOps:l}:s!==t.hasUndoOps||l!==t.hasRedoOps?Object.assign({},t,{hasUndoOps:i.undoStack.length>0,hasRedoOps:i.redoStack.length>0}):t}},view:e=>{let t=ca.getState(e.state),n=cc.getState(e.state).undoManager;return n.on("stack-item-added",({stackItem:n})=>{let r=t.binding;r&&n.meta.set(r,cc.getState(e.state).prevSel)}),n.on("stack-item-popped",({stackItem:e})=>{let n=t.binding;n&&(n.beforeTransactionSelection=e.meta.get(n)||n.beforeTransactionSelection)}),{destroy:()=>{n.destroy()}}}}))()],dependsOn:["yCursor","ySync"],undoCommand:bp,redoCommand:bf})),wB=mm(({editor:e,options:t})=>{let n,r=mg({isForked:!1});return{key:"yForkDoc",store:r,fork(){let o;if(n)return;let i=t.fragment;if(!i)throw Error("No fragment to fork from");let s=new hm;hx(s,hS(i.doc),o,hb);let l=function(e,t){let n=e.doc;if(null===e._item){let r=Array.from(n.share.keys()).find(t=>n.share.get(t)===e);if(null==r)throw Error("type does not exist in other ydoc");return t.get(r,e.constructor)}{let n=e._item,r=t.store.clients.get(n.id.client)??[],o=hJ(r,n.id.clock);return r[o].content.type}}(i,s);n={undoStack:cc.getState(e.prosemirrorState).undoManager.undoStack,originalFragment:i,forkedFragment:l},e.unregisterExtension([wP,wR,wL]);let a={...t,fragment:l};e.registerExtension([wL(a),wP()]),r.setState({isForked:!0})},merge({keepChanges:o}){if(!n)return;e.unregisterExtension(["ySync","yCursor","yUndo"]);let{originalFragment:i,forkedFragment:s,undoStack:l}=n;if(e.registerExtension([wL(t),wR(t),wP()]),cc.getState(e.prosemirrorState).undoManager.undoStack=l,o){let t=hS(s.doc,((e,t=new hC)=>(e instanceof Map?h_(t,e):h_(t,hZ(e.store)),t.toUint8Array()))(i.doc,new hE));hx(i.doc,t,e,hb)}n=void 0,r.setState({isForked:!1})}}}),wH=(e,t)=>{t(e),e.forEach(e=>{e instanceof p7&&wH(e,t)})},wj=[(e,t)=>{let n=new Map;return e.forEach(e=>{e instanceof p7&&wH(e,e=>{if("blockContainer"===e.nodeName&&e.hasAttribute("id")){let t=e.getAttribute("textColor"),r=e.getAttribute("backgroundColor"),o={textColor:t===m5.textColor.default?void 0:t,backgroundColor:r===m5.backgroundColor.default?void 0:r};(o.textColor||o.backgroundColor)&&n.set(e.getAttribute("id"),o)}})}),0!==n.size&&(t.doc.descendants((e,r)=>{if("blockContainer"===e.type.name&&n.has(e.attrs.id)){let o=t.doc.nodeAt(r+1);if(!o)throw Error("No element found");t.setNodeMarkup(r+1,void 0,{...o.attrs,...n.get(e.attrs.id)})}}),!0)}],wF=mm(({options:e})=>{let t=!1;return{key:"schemaMigration",prosemirrorPlugins:[new t4({key:new t8("schemaMigration"),appendTransaction:(n,r,o)=>{if(t||!n.some(e=>e.getMeta("y-sync$"))||n.every(e=>!e.docChanged)||!e.fragment.firstChild)return;let i=o.tr;for(let t of wj)t(e.fragment,i);if(t=!0,i.docChanged)return i}})]}}),wU=mm(({editor:e,options:t})=>({key:"dropCursor",prosemirrorPlugins:[(t.dropCursor??bg)({width:5,color:"#ddeeff",editor:e})]})),wz=mm(({editor:e})=>{let t=mg(!1),n=()=>e.transact(e=>{var t;if(e.selection.empty||e.selection instanceof tG&&("inline*"===e.selection.node.type.spec.content||(null==(t=e.selection.node.firstChild)?void 0:t.type.spec.content)==="inline*")||e.selection instanceof tV&&0===e.doc.textBetween(e.selection.from,e.selection.to).length)return!1;let n=!1;return e.selection.content().content.descendants(e=>(e.type.spec.code&&(n=!0),!n)),!n});return{key:"formattingToolbar",store:t,mount({dom:r,signal:o}){let i=!1,s=e.onChange(()=>{i||t.setState(n())}),l=e.onSelectionChange(()=>{i||t.setState(n())});r.addEventListener("pointerdown",()=>{i=!0,t.setState(!1)},{signal:o}),e.prosemirrorView.root.addEventListener("pointerup",()=>{i=!1,e.isFocused()&&t.setState(n())},{signal:o,capture:!0}),r.addEventListener("pointercancel",()=>{i=!1},{signal:o,capture:!0}),o.addEventListener("abort",()=>{s(),l()})}}}),wV=mm(()=>({key:"history",prosemirrorPlugins:[bO()],undoCommand:bR,redoCommand:bL})),w$=mm(({editor:e})=>{function t(t,n){return e.transact(r=>{let o=r.doc.resolve(t),i=o.marks().find(e=>e.type.name===n);if(!i)return;let s=iA(o,i.type);if(s)return{range:s,mark:i,get text(){return r.doc.textBetween(s.from,s.to)},get position(){return sz(e.prosemirrorView,s.from,s.to).toJSON()}}})}return{key:"linkToolbar",getLinkAtSelection:function(){return e.transact(e=>{let n=e.selection;if(n.empty)return t(n.anchor,"link")})},getLinkElementAtPos:function(t){let n=e.prosemirrorView.nodeDOM(t);for(;n&&n.parentElement;){if("A"===n.nodeName)return n;n=n.parentElement}return null},getMarkAtPos:t,getLinkAtElement:n=>e.transact(()=>t(e.prosemirrorView.posAtDOM(n,0)+1,"link")),editLink(n,r,o=e.transact(e=>e.selection.anchor)){e.transact(e=>{let i=l7(e),{range:s}=t(o+1,"link")||{range:{from:e.selection.from,to:e.selection.to}};s&&(e.insertText(r,s.from,s.to),e.addMark(s.from,s.from+r.length,i.mark("link",{href:n})))}),e.prosemirrorView.focus()},deleteLink(n=e.transact(e=>e.selection.anchor)){e.transact(e=>{let r=l7(e),{range:o}=t(n+1,"link")||{range:{from:e.selection.from,to:e.selection.to}};o&&e.removeMark(o.from,o.to,r.marks.link).setMeta("preventAutolink",!0)}),e.prosemirrorView.focus()}}}),wG=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"],wq="https",wW=new t8("node-selection-keyboard"),wY=mm(()=>({key:"nodeSelectionKeyboard",prosemirrorPlugins:[new t4({key:wW,props:{handleKeyDown:(e,t)=>{if("node"in e.state.selection){if(t.ctrlKey||t.metaKey)return!1;if(1===t.key.length)return t.preventDefault(),!0;if("Enter"===t.key&&!t.shiftKey&&!t.altKey&&!t.ctrlKey&&!t.metaKey){let t=e.state.tr;return e.dispatch(t.insert(e.state.tr.selection.$to.after(),e.state.schema.nodes.paragraph.createChecked()).setSelection(new tV(t.doc.resolve(e.state.tr.selection.$to.after()+1)))),!0}}return!1}}})]})),wK=new t8("blocknote-placeholder"),wZ=mm(({editor:e,options:t})=>{let n=t.placeholders;return{key:"placeholder",prosemirrorPlugins:[new t4({key:wK,view:t=>{let r=`placeholder-selector-${lG()}`;t.dom.classList.add(r);let o=document.createElement("style"),i=e._tiptapEditor.options.injectNonce;i&&o.setAttribute("nonce",i),t.root instanceof window.ShadowRoot?t.root.append(o):t.root.head.appendChild(o);let s=o.sheet,l=(e="")=>`.${r} .bn-block-content${e} .bn-inline-content:has(> .ProseMirror-trailingBreak:only-child):before`;try{let{default:e,emptyDocument:t,...r}=n||{};for(let[e,t]of Object.entries(r)){let n=`[data-content-type="${e}"]`;s.insertRule(`${l(n)} { content: ${JSON.stringify(t)}; }`)}s.insertRule(`${l("[data-is-only-empty-block]")} { content: ${JSON.stringify(t)}; }`),s.insertRule(`${l("[data-is-empty-and-focused]")} { content: ${JSON.stringify(e)}; }`)}catch(e){console.warn("Failed to insert placeholder CSS rule - this is likely due to the browser not supporting certain CSS pseudo-element selectors (:has, :only-child:, or :before)",e)}return{destroy:()=>{t.root instanceof window.ShadowRoot?t.root.removeChild(o):t.root.head.removeChild(o)}}},props:{decorations:t=>{let{doc:n,selection:r}=t;if(!e.isEditable||!r.empty||r.$from.parent.type.spec.code)return;let o=[];6===t.doc.content.size&&o.push(ow.node(2,4,{"data-is-only-empty-block":"true"}));let i=r.$anchor,s=i.parent;if(0===s.content.size){let e=i.before();o.push(ow.node(e,e+s.nodeSize,{"data-is-empty-and-focused":"true"}))}return oA.create(n,o)}}})]}}),wX=new t8("previous-blocks"),wQ={index:"index",level:"level",type:"type",depth:"depth","depth-change":"depth-change"},wJ=mm(()=>{let e;return{key:"previousBlockType",prosemirrorPlugins:[new t4({key:wX,view(t){return{update:async(t,n)=>{var r;(null==(r=this.key)?void 0:r.getState(t.state).updatedBlocks.size)>0&&(e=setTimeout(()=>{t.dispatch(t.state.tr.setMeta(wX,{clearUpdate:!0}))},0))},destroy:()=>{e&&clearTimeout(e)}}},state:{init:()=>({prevTransactionOldBlockAttrs:{},currentTransactionOldBlockAttrs:{},updatedBlocks:new Set}),apply(e,t,n,r){if(t.currentTransactionOldBlockAttrs={},t.updatedBlocks.clear(),!e.docChanged||n.doc.eq(r.doc))return t;let o={},i=new Map(sc(n.doc,e=>e.attrs.id).map(e=>[e.node.attrs.id,e]));for(let e of sc(r.doc,e=>e.attrs.id)){let s=i.get(e.node.attrs.id),l=null==s?void 0:s.node.firstChild,a=e.node.firstChild;if(s&&l&&a){let i={index:a.attrs.index,level:a.attrs.level,type:a.type.name,depth:r.doc.resolve(e.pos).depth},c={index:l.attrs.index,level:l.attrs.level,type:l.type.name,depth:n.doc.resolve(s.pos).depth};o[e.node.attrs.id]=c,t.currentTransactionOldBlockAttrs[e.node.attrs.id]=c,JSON.stringify(c)!==JSON.stringify(i)&&(c["depth-change"]=c.depth-i.depth,t.updatedBlocks.add(e.node.attrs.id))}}return t.prevTransactionOldBlockAttrs=o,t}},props:{decorations(e){let t=this.getState(e);if(0===t.updatedBlocks.size)return;let n=[];return e.doc.descendants((e,r)=>{if(!e.attrs.id||!t.updatedBlocks.has(e.attrs.id))return;let o=t.currentTransactionOldBlockAttrs[e.attrs.id],i={};for(let[e,t]of Object.entries(o))i["data-prev-"+wQ[e]]=t||"none";let s=ow.node(r,r+e.nodeSize,{...i});n.push(s)}),oA.create(e.doc,n)}}})]}});function w0(e,t){for(var n,r;e&&e.parentElement&&e.parentElement!==t.dom&&(null==(n=e.getAttribute)?void 0:n.call(e,"data-node-type"))!=="blockContainer";)e=e.parentElement;if((null==(r=e.getAttribute)?void 0:r.call(e,"data-node-type"))==="blockContainer")return{node:e,id:e.getAttribute("data-id")}}function w1(){let e=t=>{let n=t.children.length;for(let r=0;r<n;r++){let o=t.children[r];if("element"===o.type&&(e(o),"u"===o.tagName))if(o.children.length>0){t.children.splice(r,1,...o.children);let e=o.children.length-1;n+=e,r+=e}else t.children.splice(r,1),n--,r--}};return e}function w2(){let e=t=>{var n;if(t.children&&"length"in t.children&&t.children.length)for(let r=t.children.length-1;r>=0;r--){let o=t.children[r],i=r+1<t.children.length?t.children[r+1]:void 0;"element"===o.type&&"input"===o.tagName&&(null==(n=o.properties)?void 0:n.type)==="checkbox"&&(null==i?void 0:i.type)==="element"&&"p"===i.tagName?(i.tagName="span",i.children.splice(0,0,wC(document.createTextNode(" "),{})||{type:"root",children:[]})):e(o)}};return e}function w4(){return e=>{EJ(e,"element",(e,t,n)=>{var r,o,i,s;if(n&&"video"===e.tagName){let l=(null==(r=e.properties)?void 0:r.src)||(null==(o=e.properties)?void 0:o["data-url"])||"",a=(null==(i=e.properties)?void 0:i.title)||(null==(s=e.properties)?void 0:s["data-name"])||"";n.children[t]={type:"text",value:`![${a}](${l})`}}})}}function w5(e){return wm().use(EE,{fragment:!0}).use(w4).use(w1).use(w2).use(k5).use(Tq).use(wa,{handlers:{text:e=>e.value}}).processSync(e).value}function w3(e){let t=[];return e.descendants(e=>{var n,r;let o=l7(e);return"blockContainer"===e.type.name&&(null==(n=e.firstChild)?void 0:n.type.name)==="blockGroup"||("columnList"===e.type.name&&1===e.childCount?(null==(r=e.firstChild)||r.forEach(e=>{t.push(ac(e,o))}),!1):!e.type.isInGroup("bnBlock")||(t.push(ac(e,o)),!1))}),t}class w8 extends tj{constructor(e,t){super(e,t),wx(this,"nodes");const n=e.node();this.nodes=[],e.doc.nodesBetween(e.pos,t.pos,(e,t,r)=>{if(null!==r&&r.eq(n))return this.nodes.push(e),!1})}static create(e,t,n=t){return new w8(e.resolve(t),e.resolve(n))}content(){return new ek(em.from(this.nodes),0,0)}eq(e){if(!(e instanceof w8)||this.nodes.length!==e.nodes.length||this.from!==e.from||this.to!==e.to)return!1;for(let t=0;t<this.nodes.length;t++)if(!this.nodes[t].eq(e.nodes[t]))return!1;return!0}map(e,t){let n=t.mapResult(this.from),r=t.mapResult(this.to);return r.deleted?tj.near(e.resolve(n.pos)):n.deleted?tj.near(e.resolve(r.pos)):new w8(e.resolve(n.pos),e.resolve(r.pos))}toJSON(){return{type:"multiple-node",anchor:this.anchor,head:this.head}}}function w6(e,t,n=t){t===n&&(n+=e.state.doc.resolve(t+1).node().nodeSize);let r=e.domAtPos(t).node.cloneNode(!0),i=e.domAtPos(t).node,s=(e,t)=>Array.prototype.indexOf.call(e.children,t),l=s(i,e.domAtPos(t+1).node.parentElement),a=s(i,e.domAtPos(n-1).node.parentElement);for(let e=i.childElementCount-1;e>=0;e--)(e>a||e<l)&&r.removeChild(r.children[e]);w9(e.root);let c=(o=r).getElementsByTagName("iframe");for(let e=0;e<c.length;e++){let t=c[e],n=t.parentElement;n&&n.removeChild(t)}let d=e.dom.className.split(" ").filter(e=>"ProseMirror"!==e&&"bn-root"!==e&&"bn-editor"!==e).join(" ");o.className=o.className+" bn-drag-preview "+d,e.root instanceof ShadowRoot?e.root.appendChild(o):e.root.body.appendChild(o)}function w9(e){void 0!==o&&(e instanceof ShadowRoot?e.removeChild(o):e.body.removeChild(o),o=void 0)}function w7(e,t,n=!0){for(let r of e.root.elementsFromPoint(t.left,t.top))if(e.dom.contains(r))return n&&r.closest("[data-node-type=columnList]")?w7(e,{left:t.left+50,top:t.top},!1):w0(r,e)}tj.jsonID("multiple-node",w8);class xe{constructor(e,t,n){wx(this,"state"),wx(this,"emitUpdate"),wx(this,"mousePos"),wx(this,"hoveredBlock"),wx(this,"menuFrozen",!1),wx(this,"isDragOrigin",!1),wx(this,"updateState",e=>{this.state=e,this.emitUpdate(this.state)}),wx(this,"updateStateFromMousePos",()=>{var e,t,n,r,o;if(this.menuFrozen||!this.mousePos)return;let i=this.findClosestEditorElement({clientX:this.mousePos.x,clientY:this.mousePos.y});if((null==i?void 0:i.element)!==this.pmView.dom||i.distance>250){null!=(e=this.state)&&e.show&&(this.state.show=!1,this.updateState(this.state));return}let s=function(e,t){if(!t.dom.firstChild)return;let n=t.dom.firstChild.getBoundingClientRect(),r=w7(t,{left:Math.min(Math.max(n.left+10,e.x),n.right-10),top:e.y});if(r)return w7(t,{left:r.node.getBoundingClientRect().right-10,top:e.y},!1)}(this.mousePos,this.pmView);if(!s||!this.editor.isEditable){null!=(t=this.state)&&t.show&&(this.state.show=!1,this.updateState(this.state));return}if(!(null!=(n=this.state)&&n.show&&null!=(r=this.hoveredBlock)&&r.hasAttribute("data-id")&&(null==(o=this.hoveredBlock)?void 0:o.getAttribute("data-id"))===s.id)&&(this.hoveredBlock=s.node,this.editor.isEditable)){let e=s.node.getBoundingClientRect(),t=s.node.closest("[data-node-type=column]");this.state={show:!0,referencePos:new DOMRect(t?t.firstElementChild.getBoundingClientRect().x:this.pmView.dom.firstChild.getBoundingClientRect().x,e.y,e.width,e.height),block:this.editor.getBlock(this.hoveredBlock.getAttribute("data-id"))},this.updateState(this.state)}}),wx(this,"onDragStart",e=>{var t;let n=null==(t=e.dataTransfer)?void 0:t.getData("blocknote/html");if(!n||this.pmView.dragging)return;let r=document.createElement("div");r.innerHTML=n;let o=eX.fromSchema(this.pmView.state.schema).parse(r,{topNode:this.pmView.state.schema.nodes.blockGroup.create()});this.pmView.dragging={slice:new ek(o.content,0,0),move:!0}}),wx(this,"findClosestEditorElement",e=>{let t=Array.from(this.pmView.root.querySelectorAll(".bn-editor"));if(0===t.length)return null;let n=t[0],r=Number.MAX_VALUE;return t.forEach(t=>{let o=t.querySelector(".bn-block-group").getBoundingClientRect(),i=Math.sqrt(Math.pow(e.clientX<o.left?o.left-e.clientX:e.clientX>o.right?e.clientX-o.right:0,2)+Math.pow(e.clientY<o.top?o.top-e.clientY:e.clientY>o.bottom?e.clientY-o.bottom:0,2));i<r&&(r=i,n=t)}),{element:n,distance:r}}),wx(this,"onDragOver",e=>{if(e.synthetic)return;let t=this.getDragEventContext(e);t&&t.isDropPoint?t.isDropPoint&&!t.isDropWithinEditorBounds&&this.dispatchSyntheticEvent(e):this.closeDropCursor()}),wx(this,"closeDropCursor",()=>{let e=new Event("dragleave",{bubbles:!1});e.synthetic=!0,this.pmView.dom.dispatchEvent(e)}),wx(this,"getDragEventContext",e=>{var t;let n=!(null!=(t=e.dataTransfer)&&t.types.includes("blocknote/html"))&&!!this.pmView.dragging,r=!!this.isDragOrigin,o=n||r,i=this.findClosestEditorElement(e);if(!i||i.distance>250)return;let s=i.element===this.pmView.dom,l=s&&0===i.distance;if(!(!s&&!o))return{isDropPoint:s,isDropWithinEditorBounds:l,isDragOrigin:o}}),wx(this,"onDrop",e=>{if(e.synthetic)return;let t=this.getDragEventContext(e);if(!t)return void this.closeDropCursor();let{isDropPoint:n,isDropWithinEditorBounds:r,isDragOrigin:o}=t;if(!r&&n&&this.dispatchSyntheticEvent(e),n){if(this.pmView.dragging)return;this.pmView.dispatch(this.pmView.state.tr.setSelection(tV.create(this.pmView.state.tr.doc,this.pmView.state.tr.selection.anchor)));return}if(o)return void setTimeout(()=>this.pmView.dispatch(this.pmView.state.tr.deleteSelection()),0)}),wx(this,"onDragEnd",e=>{e.synthetic||(this.pmView.dragging=null)}),wx(this,"onKeyDown",e=>{var t;null!=(t=this.state)&&t.show&&this.editor.isFocused()&&(this.state.show=!1,this.emitUpdate(this.state))}),wx(this,"onMouseMove",e=>{var t;if(this.menuFrozen)return;this.mousePos={x:e.clientX,y:e.clientY};let n=this.pmView.dom.getBoundingClientRect(),r=this.mousePos.x>n.left&&this.mousePos.x<n.right&&this.mousePos.y>n.top&&this.mousePos.y<n.bottom,o=this.pmView.dom.parentElement;if(r&&e&&e.target&&!(o===e.target||o.contains(e.target))){null!=(t=this.state)&&t.show&&(this.state.show=!1,this.emitUpdate(this.state));return}this.updateStateFromMousePos()}),this.editor=e,this.pmView=t,this.emitUpdate=()=>{if(!this.state)throw Error("Attempting to update uninitialized side menu");n(this.state)},this.pmView.root.addEventListener("dragstart",this.onDragStart),this.pmView.root.addEventListener("dragover",this.onDragOver),this.pmView.root.addEventListener("drop",this.onDrop,!0),this.pmView.root.addEventListener("dragend",this.onDragEnd,!0),this.pmView.root.addEventListener("mousemove",this.onMouseMove,!0),this.pmView.root.addEventListener("keydown",this.onKeyDown,!0)}dispatchSyntheticEvent(e){let t=new Event(e.type,e),n=this.pmView.dom.firstChild.getBoundingClientRect();t.clientX=e.clientX,t.clientY=e.clientY,t.clientX=Math.min(Math.max(e.clientX,n.left),n.left+n.width),t.clientY=Math.min(Math.max(e.clientY,n.top),n.top+n.height),t.dataTransfer=e.dataTransfer,t.preventDefault=()=>e.preventDefault(),t.synthetic=!0,this.pmView.dom.dispatchEvent(t)}update(e,t){var n;!t.doc.eq(this.pmView.state.doc)&&null!=(n=this.state)&&n.show&&this.updateStateFromMousePos()}destroy(){var e;null!=(e=this.state)&&e.show&&(this.state.show=!1,this.emitUpdate(this.state)),this.pmView.root.removeEventListener("mousemove",this.onMouseMove,!0),this.pmView.root.removeEventListener("dragstart",this.onDragStart),this.pmView.root.removeEventListener("dragover",this.onDragOver),this.pmView.root.removeEventListener("drop",this.onDrop,!0),this.pmView.root.removeEventListener("dragend",this.onDragEnd,!0),this.pmView.root.removeEventListener("keydown",this.onKeyDown,!0)}}let xt=new t8("SideMenuPlugin"),xn=mm(({editor:e})=>{let t,n=mg(void 0);return{key:"sideMenu",store:n,prosemirrorPlugins:[new t4({key:xt,view:r=>t=new xe(e,r,e=>{n.setState({...e})})})],blockDragStart(n,r){t&&(t.isDragOrigin=!0),function(e,t,n){if(!e.dataTransfer||n.headless)return;let r=n.prosemirrorView,i=mJ(t.id,r.state.doc);if(!i)throw Error(`Block with ID ${t.id} not found`);let s=i.posBeforeNode;if(null!=s){let t=r.state.selection,i=r.state.doc,{from:l,to:a}=function(e,t){let n,r,o="blockContent"===t.resolve(e.from).node().type.spec.group,i="blockContent"===t.resolve(e.to).node().type.spec.group,s=Math.min(e.$anchor.depth,e.$head.depth);if(o&&i){let o=e.$from.start(s-1),i=e.$to.end(s-1);n=t.resolve(o-1).pos,r=t.resolve(i+1).pos}else n=e.from,r=e.to;return{from:n,to:r}}(t,i),c=l<=s&&s<a,d=t.$anchor.node()!==t.$head.node()||t instanceof w8;c&&d?(r.dispatch(r.state.tr.setSelection(w8.create(i,l,a))),w6(r,l,a)):(r.dispatch(r.state.tr.setSelection(tG.create(r.state.doc,s))),w6(r,s));let u=r.state.selection.content(),h=n.pmSchema,p=r.serializeForClipboard(u).dom.innerHTML,f=wN(h,n),m=w3(u.content),g=f.exportBlocks(m,{}),b=w5(g);e.dataTransfer.clearData(),e.dataTransfer.setData("blocknote/html",p),e.dataTransfer.setData("text/html",g),e.dataTransfer.setData("text/plain",b),e.dataTransfer.effectAllowed="move",e.dataTransfer.setDragImage(o,0,0)}}(n,r,e)},blockDragEnd(){w9(e.prosemirrorView.root),t&&(t.isDragOrigin=!1),e.blur()},freezeMenu(){t.menuFrozen=!0,t.state.show=!0,t.emitUpdate(t.state)},unfreezeMenu(){t.menuFrozen=!1,t.state.show=!1,t.emitUpdate(t.state)}}});function xr(e){i||((i=document.createElement("div")).innerHTML="_",i.style.opacity="0",i.style.height="1px",i.style.width="1px",e instanceof Document?e.body.appendChild(i):e.appendChild(i))}function xo(e){return Array.prototype.indexOf.call(e.parentElement.childNodes,e)}class xi{constructor(e,t,n){wx(this,"state"),wx(this,"emitUpdate"),wx(this,"tableId"),wx(this,"tablePos"),wx(this,"tableElement"),wx(this,"menuFrozen",!1),wx(this,"mouseState","up"),wx(this,"prevWasEditable",null),wx(this,"viewMousedownHandler",()=>{this.mouseState="down"}),wx(this,"mouseUpHandler",e=>{this.mouseState="up",this.mouseMoveHandler(e)}),wx(this,"mouseMoveHandler",e=>{var t,n,r,o,i,s,l;let a;if(this.menuFrozen||"selecting"===this.mouseState||!(e.target instanceof Element)||!this.pmView.dom.contains(e.target))return;let c=function(e){let t=e;for(;t&&"TD"!==t.nodeName&&"TH"!==t.nodeName&&!t.classList.contains("tableWrapper");){if(t.classList.contains("ProseMirror"))return;let e=t.parentNode;if(!e||!(e instanceof Element))return;t=e}return"TD"===t.nodeName||"TH"===t.nodeName?{type:"cell",domNode:t,tbodyNode:t.closest("tbody")}:{type:"wrapper",domNode:t,tbodyNode:t.querySelector("tbody")}}(e.target);if((null==c?void 0:c.type)==="cell"&&"down"===this.mouseState&&!(null!=(t=this.state)&&t.draggingState)){this.mouseState="selecting",null!=(n=this.state)&&n.show&&(this.state.show=!1,this.state.showAddOrRemoveRowsButton=!1,this.state.showAddOrRemoveColumnsButton=!1,this.emitUpdate());return}if(!c||!this.editor.isEditable){null!=(r=this.state)&&r.show&&(this.state.show=!1,this.state.showAddOrRemoveRowsButton=!1,this.state.showAddOrRemoveColumnsButton=!1,this.emitUpdate());return}if(!c.tbodyNode)return;let d=c.tbodyNode.getBoundingClientRect(),u=w0(c.domNode,this.pmView);if(!u)return;this.tableElement=u.node;let h=this.editor.transact(e=>mJ(u.id,e.doc));if(!h)throw Error(`Block with ID ${u.id} not found`);let p=ac(h.node,this.editor.pmSchema,this.editor.schema.blockSchema,this.editor.schema.inlineContentSchema,this.editor.schema.styleSchema);if(gq(this.editor,"table")&&(this.tablePos=h.posBeforeNode+1,a=p),!a)return;this.tableId=u.id;let f=null==(o=c.domNode.closest(".tableWrapper"))?void 0:o.querySelector(".table-widgets-container");if((null==c?void 0:c.type)==="wrapper"){let t=e.clientY>=d.bottom-1&&e.clientY<d.bottom+20,n=e.clientX>=d.right-1&&e.clientX<d.right+20,r=e.clientX>d.right||e.clientY>d.bottom;this.state={...this.state,show:!0,showAddOrRemoveRowsButton:t,showAddOrRemoveColumnsButton:n,referencePosTable:d,block:a,widgetContainer:f,colIndex:r||null==(i=this.state)?void 0:i.colIndex,rowIndex:r||null==(s=this.state)?void 0:s.rowIndex,referencePosCell:r||null==(l=this.state)?void 0:l.referencePosCell}}else{let e=xo(c.domNode),t=xo(c.domNode.parentElement),n=c.domNode.getBoundingClientRect();if(void 0!==this.state&&this.state.show&&this.tableId===u.id&&this.state.rowIndex===t&&this.state.colIndex===e)return;this.state={show:!0,showAddOrRemoveColumnsButton:e===a.content.rows[0].cells.length-1,showAddOrRemoveRowsButton:t===a.content.rows.length-1,referencePosTable:d,block:a,draggingState:void 0,referencePosCell:n,colIndex:e,rowIndex:t,widgetContainer:f}}return this.emitUpdate(),!1}),wx(this,"dragOverHandler",e=>{var t;if((null==(t=this.state)?void 0:t.draggingState)===void 0)return;e.preventDefault(),e.dataTransfer.dropEffect="move",function(e,t){let n=t.querySelectorAll(e);for(let e=0;e<n.length;e++)n[e].style.visibility="hidden"}(".prosemirror-dropcursor-block, .prosemirror-dropcursor-inline",this.pmView.root);let n={left:Math.min(Math.max(e.clientX,this.state.referencePosTable.left+1),this.state.referencePosTable.right-1),top:Math.min(Math.max(e.clientY,this.state.referencePosTable.top+1),this.state.referencePosTable.bottom-1)},r=this.pmView.root.elementsFromPoint(n.left,n.top).filter(e=>"TD"===e.tagName||"TH"===e.tagName);if(0===r.length)return;let o=r[0],i=!1,s=xo(o.parentElement),l=xo(o),a="row"===this.state.draggingState.draggedCellOrientation?this.state.rowIndex:this.state.colIndex,c=("row"===this.state.draggingState.draggedCellOrientation?s:l)!==a;(this.state.rowIndex!==s||this.state.colIndex!==l)&&(this.state.rowIndex=s,this.state.colIndex=l,this.state.referencePosCell=o.getBoundingClientRect(),i=!0);let d="row"===this.state.draggingState.draggedCellOrientation?n.top:n.left;this.state.draggingState.mousePos!==d&&(this.state.draggingState.mousePos=d,i=!0),i&&this.emitUpdate(),c&&this.editor.transact(e=>e.setMeta(xs,!0))}),wx(this,"dropHandler",e=>{if(this.mouseState="up",void 0===this.state||void 0===this.state.draggingState)return!1;if(void 0===this.state.rowIndex||void 0===this.state.colIndex)throw Error("Attempted to drop table row or column, but no table block was hovered prior.");e.preventDefault();let{draggingState:t,colIndex:n,rowIndex:r}=this.state,o=this.state.block.content.columnWidths;if("row"===t.draggedCellOrientation){if(!ay(this.state.block,t.originalIndex,r))return!1;let e=function(e,t,n,r=ad(e)){let{row:o}=ah({row:t,col:0},e,r),{row:i}=ah({row:n,col:0},e,r),[s]=r.splice(o,1);return r.splice(i,0,s),au(r)}(this.state.block,t.originalIndex,r);this.editor.updateBlock(this.state.block,{type:"table",content:{...this.state.block.content,rows:e}})}else{if(!av(this.state.block,t.originalIndex,n))return!1;let e=function(e,t,n,r=ad(e)){let{col:o}=ah({row:0,col:t},e,r),{col:i}=ah({row:0,col:n},e,r);return r.forEach(e=>{let[t]=e.splice(o,1);e.splice(i,0,t)}),au(r)}(this.state.block,t.originalIndex,n),[r]=o.splice(t.originalIndex,1);o.splice(n,0,r),this.editor.updateBlock(this.state.block,{type:"table",content:{...this.state.block.content,columnWidths:o,rows:e}})}return this.editor.setTextCursorPosition(this.state.block.id),!0}),this.editor=e,this.pmView=t,this.emitUpdate=()=>{if(!this.state)throw Error("Attempting to update uninitialized image toolbar");n(this.state)},t.dom.addEventListener("mousemove",this.mouseMoveHandler),t.dom.addEventListener("mousedown",this.viewMousedownHandler),window.addEventListener("mouseup",this.mouseUpHandler),t.root.addEventListener("dragover",this.dragOverHandler),t.root.addEventListener("drop",this.dropHandler)}update(){var e;if(!this.state||!this.state.show)return;if(this.state.block=this.editor.getBlock(this.state.block.id),!this.state.block||"table"!==this.state.block.type||!(null!=(e=this.tableElement)&&e.isConnected)){this.state.show=!1,this.state.showAddOrRemoveRowsButton=!1,this.state.showAddOrRemoveColumnsButton=!1,this.emitUpdate();return}let{height:t,width:n}=ap(this.state.block);void 0!==this.state.rowIndex&&void 0!==this.state.colIndex&&(this.state.rowIndex>=t&&(this.state.rowIndex=t-1),this.state.colIndex>=n&&(this.state.colIndex=n-1));let r=this.tableElement.querySelector("tbody");if(!r)throw Error("Table block does not contain a 'tbody' HTML element. This should never happen.");if(void 0!==this.state.rowIndex&&void 0!==this.state.colIndex){let e=r.children[this.state.rowIndex].children[this.state.colIndex];e?this.state.referencePosCell=e.getBoundingClientRect():(this.state.rowIndex=void 0,this.state.colIndex=void 0)}this.state.referencePosTable=r.getBoundingClientRect(),this.emitUpdate()}destroy(){this.pmView.dom.removeEventListener("mousemove",this.mouseMoveHandler),window.removeEventListener("mouseup",this.mouseUpHandler),this.pmView.dom.removeEventListener("mousedown",this.viewMousedownHandler),this.pmView.root.removeEventListener("dragover",this.dragOverHandler),this.pmView.root.removeEventListener("drop",this.dropHandler)}}let xs=new t8("TableHandlesPlugin"),xl=mm(({editor:e})=>{let t,n=mg(void 0);return{key:"tableHandles",store:n,prosemirrorPlugins:[new t4({key:xs,view:r=>t=new xi(e,r,e=>{n.setState(e.block?{...e,draggingState:e.draggingState?{...e.draggingState}:void 0}:void 0)}),props:{decorations:e=>{if(void 0===t||void 0===t.state||void 0===t.state.draggingState||void 0===t.tablePos)return;let n="row"===t.state.draggingState.draggedCellOrientation?t.state.rowIndex:t.state.colIndex;if(void 0===n)return;let r=[],{block:o,draggingState:i}=t.state,{originalIndex:s,draggedCellOrientation:l}=i;if(n===s||!o||"row"===l&&!ay(o,s,n)||"col"===l&&!av(o,s,n))return oA.create(e.doc,r);let a=e.doc.resolve(t.tablePos+1);return"row"===t.state.draggingState.draggedCellOrientation?am(t.state.block,n).forEach(({row:t,col:o})=>{let i=e.doc.resolve(a.posAtIndex(t)+1),l=e.doc.resolve(i.posAtIndex(o)+1),c=l.node(),d=l.pos+(n>s?c.nodeSize-2:0);r.push(ow.widget(d,()=>{let e=document.createElement("div");return e.className="bn-table-drop-cursor",e.style.left="0",e.style.right="0",n>s?e.style.bottom="-2px":e.style.top="-3px",e.style.height="4px",e}))}):ag(t.state.block,n).forEach(({row:t,col:o})=>{let i=e.doc.resolve(a.posAtIndex(t)+1),l=e.doc.resolve(i.posAtIndex(o)+1),c=l.node(),d=l.pos+(n>s?c.nodeSize-2:0);r.push(ow.widget(d,()=>{let e=document.createElement("div");return e.className="bn-table-drop-cursor",e.style.top="0",e.style.bottom="0",n>s?e.style.right="-2px":e.style.left="-3px",e.style.width="4px",e}))}),oA.create(e.doc,r)}}})],colDragStart(n){if(void 0===t||void 0===t.state||void 0===t.state.colIndex)throw Error("Attempted to drag table column, but no table block was hovered prior.");t.state.draggingState={draggedCellOrientation:"col",originalIndex:t.state.colIndex,mousePos:n.clientX},t.emitUpdate(),e.transact(e=>e.setMeta(xs,{draggedCellOrientation:t.state.draggingState.draggedCellOrientation,originalIndex:t.state.colIndex,newIndex:t.state.colIndex,tablePos:t.tablePos})),e.headless||(xr(e.prosemirrorView.root),n.dataTransfer.setDragImage(i,0,0),n.dataTransfer.effectAllowed="move")},rowDragStart(n){if(void 0===t.state||void 0===t.state.rowIndex)throw Error("Attempted to drag table row, but no table block was hovered prior.");t.state.draggingState={draggedCellOrientation:"row",originalIndex:t.state.rowIndex,mousePos:n.clientY},t.emitUpdate(),e.transact(e=>e.setMeta(xs,{draggedCellOrientation:t.state.draggingState.draggedCellOrientation,originalIndex:t.state.rowIndex,newIndex:t.state.rowIndex,tablePos:t.tablePos})),e.headless||(xr(e.prosemirrorView.root),n.dataTransfer.setDragImage(i,0,0),n.dataTransfer.effectAllowed="copyMove")},dragEnd(){var n;if(void 0===t.state)throw Error("Attempted to drag table row, but no table block was hovered prior.");t.state.draggingState=void 0,t.emitUpdate(),e.transact(e=>e.setMeta(xs,null)),e.headless||(n=e.prosemirrorView.root,i&&(n instanceof Document?n.body.removeChild(i):n.removeChild(i),i=void 0))},freezeHandles(){t.menuFrozen=!0},unfreezeHandles(){t.menuFrozen=!1},getCellsAtRowHandle:(e,t)=>am(e,t),getCellsAtColumnHandle:(e,t)=>ag(e,t),setCellSelection(e,n,r=n){if(!t)throw Error("Table handles view not initialized");let o=e.doc.resolve(t.tablePos+1),i=e.doc.resolve(o.posAtIndex(n.row)+1),s=e.doc.resolve(i.posAtIndex(n.col)),l=e.doc.resolve(o.posAtIndex(r.row)+1),a=e.doc.resolve(l.posAtIndex(r.col)),c=e.tr;return c.setSelection(new aH(s,a)),e.apply(c)},addRowOrColumn(t,n){e.exec((e,r)=>{let o=this.setCellSelection(e,"row"===n.orientation?{row:t,col:0}:{row:0,col:t});return"row"===n.orientation?"above"===n.side?function(e,t){if(!aI(e))return!1;if(t){let n=az(e);t(a$(e.tr,n,n.top))}return!0}(o,r):function(e,t){if(!aI(e))return!1;if(t){let n=az(e);t(a$(e.tr,n,n.bottom))}return!0}(o,r):"left"===n.side?function(e,t){if(!aI(e))return!1;if(t){let n=az(e);t(aV(e.tr,n,n.left))}return!0}(o,r):function(e,t){if(!aI(e))return!1;if(t){let n=az(e);t(aV(e.tr,n,n.right))}return!0}(o,r)})},removeRowOrColumn(t,n){return"row"===n?e.exec((e,n)=>{var r=this.setCellSelection(e,{row:t,col:0});if(!aI(r))return!1;if(n){let e=az(r),t=r.tr;if(0==e.top&&e.bottom==e.map.height)return!1;for(let n=e.bottom-1;!function(e,{map:t,table:n,tableStart:r},o){let i=0;for(let e=0;e<o;e++)i+=n.child(e).nodeSize;let s=i+n.child(o).nodeSize,l=e.mapping.maps.length;e.delete(i+r,s+r);let a=new Set;for(let i=0,s=o*t.width;i<t.width;i++,s++){let c=t.map[s];if(!a.has(c)){if(a.add(c),o>0&&c==t.map[s-t.width]){let t=n.nodeAt(c).attrs;e.setNodeMarkup(e.mapping.slice(l).map(c+r),null,{...t,rowspan:t.rowspan-1}),i+=t.colspan-1}else if(o<t.height&&c==t.map[s+t.width]){let s=n.nodeAt(c),a=s.attrs,d=s.type.create({...a,rowspan:s.attrs.rowspan-1},s.content),u=t.positionAt(o+1,i,n);e.insert(e.mapping.slice(l).map(r+u),d),i+=a.colspan-1}}}}(t,e,n),n!=e.top;n--){let n=e.tableStart?t.doc.nodeAt(e.tableStart-1):t.doc;if(!n)throw RangeError("No table found");e.table=n,e.map=aA.get(e.table)}n(t)}return!0}):e.exec((e,n)=>{var r=this.setCellSelection(e,{row:0,col:t});if(!aI(r))return!1;if(n){let e=az(r),t=r.tr;if(0==e.left&&e.right==e.map.width)return!1;for(let n=e.right-1;!function(e,{map:t,table:n,tableStart:r},o){let i=e.mapping.maps.length;for(let s=0;s<t.height;){let l=s*t.width+o,a=t.map[l],c=n.nodeAt(a),d=c.attrs;if(o>0&&t.map[l-1]==a||o<t.width-1&&t.map[l+1]==a)e.setNodeMarkup(e.mapping.slice(i).map(r+a),null,aP(d,o-t.colCount(a)));else{let t=e.mapping.slice(i).map(r+a);e.delete(t,t+c.nodeSize)}s+=d.rowspan}}(t,e,n),n!=e.left;n--){let n=e.tableStart?t.doc.nodeAt(e.tableStart-1):t.doc;if(!n)throw RangeError("No table found");e.table=n,e.map=aA.get(n)}n(t)}return!0})},mergeCells(t){return e.exec((e,n)=>(function(e,t){let n=e.selection;if(!(n instanceof aH)||n.$anchorCell.pos==n.$headCell.pos)return!1;let r=az(e),{map:o}=r;if(function({width:e,height:t,map:n},r){let o=r.top*e+r.left,i=o,s=(r.bottom-1)*e+r.left,l=o+(r.right-r.left-1);for(let t=r.top;t<r.bottom;t++){if(r.left>0&&n[i]==n[i-1]||r.right<e&&n[l]==n[l+1])return!0;i+=e,l+=e}for(let i=r.left;i<r.right;i++){if(r.top>0&&n[o]==n[o-e]||r.bottom<t&&n[s]==n[s+e])return!0;o++,s++}return!1}(o,r))return!1;if(t){let n,i,s=e.tr,l={},a=em.empty;for(let e=r.top;e<r.bottom;e++)for(let t=r.left;t<r.right;t++){let c=o.map[e*o.width+t],d=r.table.nodeAt(c);if(!l[c]&&d)if(l[c]=!0,null==n)n=c,i=d;else{aG(d)||(a=a.append(d.content));let e=s.mapping.map(c+r.tableStart);s.delete(e,e+d.nodeSize)}}if(null==n||null==i)return!0;if(s.setNodeMarkup(n+r.tableStart,null,{...aB(i.attrs,i.attrs.colspan,r.right-r.left-i.attrs.colspan),rowspan:r.bottom-r.top}),a.size>0){let e=n+1+i.content.size,t=aG(i)?n+1:e;s.replaceWith(t+r.tableStart,e+r.tableStart,a)}s.setSelection(new aH(s.doc.resolve(n+r.tableStart))),t(s)}return!0})(t?this.setCellSelection(e,t.relativeStartCell,t.relativeEndCell):e,n))},splitCell(t){return e.exec((e,n)=>{var r,o;let i;return r=t?this.setCellSelection(e,t):e,i=a_(r.schema),(o=({node:e})=>i[e.type.spec.tableRole],(e,t)=>{let n,r,i=e.selection;if(i instanceof aH){if(i.$anchorCell.pos!=i.$headCell.pos)return!1;n=i.$anchorCell.nodeAfter,r=i.$anchorCell.pos}else{var s;if(!(n=function(e){for(let t=e.depth;t>0;t--){let n=e.node(t).type.spec.tableRole;if("cell"===n||"header_cell"===n)return e.node(t)}return null}(i.$from)))return!1;r=null==(s=aM(i.$from))?void 0:s.pos}if(null==n||null==r||1==n.attrs.colspan&&1==n.attrs.rowspan)return!1;if(t){let s,l=n.attrs,a=[],c=l.colwidth;l.rowspan>1&&(l={...l,rowspan:1}),l.colspan>1&&(l={...l,colspan:1});let d=az(e),u=e.tr;for(let e=0;e<d.right-d.left;e++)a.push(c?{...l,colwidth:c&&c[e]?[c[e]]:null}:l);for(let e=d.top;e<d.bottom;e++){let t=d.map.positionAt(e,d.left,d.table);e==d.top&&(t+=n.nodeSize);for(let r=d.left,i=0;r<d.right;r++,i++)(r!=d.left||e!=d.top)&&u.insert(s=u.mapping.map(t+d.tableStart,1),o({node:n,row:e,col:r}).createAndFill(a[i]))}u.setNodeMarkup(r,o({node:n,row:d.top,col:d.left}),a[0]),i instanceof aH&&u.setSelection(new aH(u.doc.resolve(i.$anchorCell.pos),s?u.doc.resolve(s):void 0)),t(u)}return!0})(r,n)})},getCellSelection:()=>e.transact(e=>{let t=e.selection,n=t.$from,r=t.$to;if(gY(t)){let{ranges:e}=t;e.forEach(e=>{n=e.$from.min(n??e.$from),r=e.$to.max(r??e.$to)})}else if(n=e.doc.resolve(t.$from.pos-t.$from.parentOffset-1),r=e.doc.resolve(t.$to.pos-t.$to.parentOffset-1),0===n.pos||0===r.pos)return;let o=e.doc.resolve(n.pos-n.parentOffset-1),i=e.doc.resolve(r.pos-r.parentOffset-1),s=e.doc.resolve(o.pos-o.parentOffset-1),l=n.index(o.depth),a=o.index(s.depth),c=r.index(i.depth),d=i.index(s.depth),u=[];for(let e=a;e<=d;e++)for(let t=l;t<=c;t++)u.push({row:e,col:t});return{from:{row:a,col:l},to:{row:d,col:c},cells:u}}),getMergeDirection(t){return e.transact(e=>{let n=gY(e.selection)?e.selection:void 0;if(!n||!t||n.ranges.length<=1)return;let r=this.getCellSelection();if(r){var o,i;let e,n;return(o=r.from,i=r.to,e=ah(o,t),n=ah(i,t),e.col===n.col)?"vertical":"horizontal"}})},cropEmptyRowsOrColumns:(e,t)=>(function(e,t,n=ad(e)){if("columns"===t){let e=0;for(let t=n[0].length-1;t>=0&&n.every(e=>ab(e[t].cell)&&1===e[t].colspan);t--)e++;for(let t=n.length-1;t>=0;t--){let r=Math.max(n[t].length-e,1);n[t]=n[t].slice(0,r)}return au(n)}let r=0;for(let e=n.length-1;e>=0&&n[e].every(e=>ab(e.cell)&&1===e.rowspan);e--)r++;let o=Math.min(r,n.length-1);return n.splice(n.length-o,o),au(n)})(e,t),addRowsOrColumns:(e,t,n)=>(function(e,t,n,r=ad(e)){let{width:o,height:i}=ap(e);if("columns"===t)r.forEach((e,t)=>{if(n>=0)for(let r=0;r<n;r++)e.push({row:t,col:Math.max(...e.map(e=>e.col))+1,rowspan:1,colspan:1,cell:lZ("")});else e.splice(o+n,-1*n)});else if(n>0)for(let e=0;e<n;e++){let t=Array(o).fill(null).map((t,n)=>({row:i+e,col:n,rowspan:1,colspan:1,cell:lZ("")}));r.push(t)}else n<0&&r.splice(i+n,-1*n);return au(r)})(e,t,n)}}),xa=new t8("trailingNode"),xc=mm(()=>({key:"trailingNode",prosemirrorPlugins:[new t4({key:xa,appendTransaction:(e,t,n)=>{let{doc:r,tr:o,schema:i}=n,s=xa.getState(n),l=r.content.size-2,a=i.nodes.blockContainer,c=i.nodes.paragraph;if(s)return o.insert(l,a.create(void 0,c.create()))},state:{init:(e,t)=>{},apply:(e,t)=>{if(!e.docChanged)return t;let n=e.doc.lastChild;if(!n||"blockGroup"!==n.type.name)throw Error("Expected blockGroup");if(!(n=n.lastChild)||"blockContainer"!==n.type.name)return!0;let r=n.firstChild;if(!r)throw Error("Expected blockContent");return n.nodeSize>4||"inline*"!==r.type.spec.content}}})]}));async function xd(){return s||(s=(async()=>{let[t,n]=await Promise.all([e.A(86535),e.A(27305)]),r="default"in t?t.default:t,o="default"in n?n.default:n;return await r.init({data:o}),{emojiMart:r,emojiData:o}})())}async function xu(e,t){if(!("text"in e.schema.inlineContentSchema)||e.schema.inlineContentSchema.text!==g8.text)return[];let{emojiData:n,emojiMart:r}=await xd();return(""===t.trim()?Object.values(n.emojis):await r.SearchIndex.search(t)).map(t=>({id:t.skins[0].native,onItemClick:()=>e.insertInlineContent(t.skins[0].native+" ")}))}var xh=e.i(88659),xp=(e.i(25017),"undefined"==typeof Element);xp||Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,xp||Element.prototype.getRootNode;let xf="data-floating-ui-focusable";function xm(e){let t=e.activeElement;for(;(null==(n=t)||null==(n=n.shadowRoot)?void 0:n.activeElement)!=null;){var n;t=t.shadowRoot.activeElement}return t}function xg(e,t){if(!e||!t)return!1;let n=null==t.getRootNode?void 0:t.getRootNode();if(e.contains(t))return!0;if(n&&(0,xh.isShadowRoot)(n)){let n=t;for(;n;){if(e===n)return!0;n=n.parentNode||n.host}}return!1}function xb(e){return"composedPath"in e?e.composedPath()[0]:e.target}function xy(e,t){return null!=t&&("composedPath"in e?e.composedPath().includes(t):null!=e.target&&t.contains(e.target))}function xv(e){return(null==e?void 0:e.ownerDocument)||document}function xE(e,t,n){return void 0===n&&(n=!0),e.filter(e=>{var r;return e.parentId===t&&(!n||(null==(r=e.context)?void 0:r.open))}).flatMap(t=>[t,...xE(e,t.id,n)])}function xk(e,t){let n=["mouse","pen"];return t||n.push("",void 0),n.includes(e)}var xC="undefined"!=typeof document?X.useLayoutEffect:function(){};function xT(e){let t=X.useRef(e);return xC(()=>{t.current=e}),t}let xw={...X}.useInsertionEffect||(e=>e());function xx(e){let t=X.useRef(()=>{});return xw(()=>{t.current=e}),X.useCallback(function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return null==t.current?void 0:t.current(...n)},[])}var xS=e.i(23222),xA=e.i(97445),x_=e.i(22957);let xN="active",xM="selected",xI={...X},xO=!1,xD=0,xR=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+xD++,xL=xI.useId||function(){let[e,t]=X.useState(()=>xO?xR():void 0);return xC(()=>{null==e&&t(xR())},[]),X.useEffect(()=>{xO=!0},[]),e},xP=X.createContext(null),xB=X.createContext(null),xH=()=>{var e;return(null==(e=X.useContext(xP))?void 0:e.id)||null};function xj(e){return"data-floating-ui-"+e}function xF(e){-1!==e.current&&(clearTimeout(e.current),e.current=-1)}let xU=xj("safe-polygon");function xz(e,t,n){if(n&&!xk(n))return 0;if("number"==typeof e)return e;if("function"==typeof e){let n=e();return"number"==typeof n?n:null==n?void 0:n[t]}return null==e?void 0:e[t]}function xV(e){return"function"==typeof e?e():e}function x$(e,t){void 0===t&&(t={});let{open:n,onOpenChange:r,dataRef:o,events:i,elements:s}=e,{enabled:l=!0,delay:a=0,handleClose:c=null,mouseOnly:d=!1,restMs:u=0,move:h=!0}=t,p=X.useContext(xB),f=xH(),m=xT(c),g=xT(a),b=xT(n),y=xT(u),v=X.useRef(),E=X.useRef(-1),k=X.useRef(),C=X.useRef(-1),T=X.useRef(!0),w=X.useRef(!1),x=X.useRef(()=>{}),S=X.useRef(!1),A=xx(()=>{var e;let t=null==(e=o.current.openEvent)?void 0:e.type;return(null==t?void 0:t.includes("mouse"))&&"mousedown"!==t});X.useEffect(()=>{if(l)return i.on("openchange",e),()=>{i.off("openchange",e)};function e(e){let{open:t}=e;t||(xF(E),xF(C),T.current=!0,S.current=!1)}},[l,i]),X.useEffect(()=>{if(!l||!m.current||!n)return;function e(e){A()&&r(!1,e,"hover")}let t=xv(s.floating).documentElement;return t.addEventListener("mouseleave",e),()=>{t.removeEventListener("mouseleave",e)}},[s.floating,n,r,l,m,A]);let _=X.useCallback(function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n="hover");let o=xz(g.current,"close",v.current);o&&!k.current?(xF(E),E.current=window.setTimeout(()=>r(!1,e,n),o)):t&&(xF(E),r(!1,e,n))},[g,r]),N=xx(()=>{x.current(),k.current=void 0}),M=xx(()=>{if(w.current){let e=xv(s.floating).body;e.style.pointerEvents="",e.removeAttribute(xU),w.current=!1}}),I=xx(()=>!!o.current.openEvent&&["click","mousedown"].includes(o.current.openEvent.type));X.useEffect(()=>{if(l&&(0,xh.isElement)(s.domReference)){let r=s.domReference,o=s.floating;return n&&r.addEventListener("mouseleave",i),h&&r.addEventListener("mousemove",e,{once:!0}),r.addEventListener("mouseenter",e),r.addEventListener("mouseleave",t),o&&(o.addEventListener("mouseleave",i),o.addEventListener("mouseenter",a),o.addEventListener("mouseleave",c)),()=>{n&&r.removeEventListener("mouseleave",i),h&&r.removeEventListener("mousemove",e),r.removeEventListener("mouseenter",e),r.removeEventListener("mouseleave",t),o&&(o.removeEventListener("mouseleave",i),o.removeEventListener("mouseenter",a),o.removeEventListener("mouseleave",c))}}function e(e){if(xF(E),T.current=!1,d&&!xk(v.current)||xV(y.current)>0&&!xz(g.current,"open"))return;let t=xz(g.current,"open",v.current);t?E.current=window.setTimeout(()=>{b.current||r(!0,e,"hover")},t):n||r(!0,e,"hover")}function t(e){if(I())return void M();x.current();let t=xv(s.floating);if(xF(C),S.current=!1,m.current&&o.current.floatingContext){n||xF(E),k.current=m.current({...o.current.floatingContext,tree:p,x:e.clientX,y:e.clientY,onClose(){M(),N(),I()||_(e,!0,"safe-polygon")}});let r=k.current;t.addEventListener("mousemove",r),x.current=()=>{t.removeEventListener("mousemove",r)};return}"touch"===v.current&&xg(s.floating,e.relatedTarget)||_(e)}function i(e){I()||o.current.floatingContext&&(null==m.current||m.current({...o.current.floatingContext,tree:p,x:e.clientX,y:e.clientY,onClose(){M(),N(),I()||_(e)}})(e))}function a(){xF(E)}function c(e){I()||_(e,!1)}},[s,l,e,d,h,_,N,M,r,n,b,p,g,m,o,I,y]),xC(()=>{var e,t;if(l&&n&&null!=(e=m.current)&&null!=(e=e.__options)&&e.blockPointerEvents&&A()){w.current=!0;let e=s.floating;if((0,xh.isElement)(s.domReference)&&e){let n=xv(s.floating).body;n.setAttribute(xU,"");let r=s.domReference,o=null==p||null==(t=p.nodesRef.current.find(e=>e.id===f))||null==(t=t.context)?void 0:t.elements.floating;return o&&(o.style.pointerEvents=""),n.style.pointerEvents="none",r.style.pointerEvents="auto",e.style.pointerEvents="auto",()=>{n.style.pointerEvents="",r.style.pointerEvents="",e.style.pointerEvents=""}}}},[l,n,f,s,p,m,A]),xC(()=>{n||(v.current=void 0,S.current=!1,N(),M())},[n,N,M]),X.useEffect(()=>()=>{N(),xF(E),xF(C),M()},[l,s.domReference,N,M]);let O=X.useMemo(()=>{function e(e){v.current=e.pointerType}return{onPointerDown:e,onPointerEnter:e,onMouseMove(e){let{nativeEvent:t}=e;function o(){T.current||b.current||r(!0,t,"hover")}d&&!xk(v.current)||n||0===xV(y.current)||S.current&&e.movementX**2+e.movementY**2<2||(xF(C),"touch"===v.current?o():(S.current=!0,C.current=window.setTimeout(o,xV(y.current))))}}},[d,r,n,b,y]);return X.useMemo(()=>l?{reference:O}:{},[l,O])}let xG=()=>{},xq=X.createContext({delay:0,initialDelay:0,timeoutMs:0,currentId:null,setCurrentId:xG,setState:xG,isInstantPhase:!1});function xW(e){let{children:t,delay:n,timeoutMs:r=0}=e,[o,i]=X.useReducer((e,t)=>({...e,...t}),{delay:n,timeoutMs:r,initialDelay:n,currentId:null,isInstantPhase:!1}),s=X.useRef(null),l=X.useCallback(e=>{i({currentId:e})},[]);return xC(()=>{o.currentId?null===s.current?s.current=o.currentId:o.isInstantPhase||i({isInstantPhase:!0}):(o.isInstantPhase&&i({isInstantPhase:!1}),s.current=null)},[o.currentId,o.isInstantPhase]),(0,Z.jsx)(xq.Provider,{value:X.useMemo(()=>({...o,setState:i,setCurrentId:l}),[o,l]),children:t})}function xY(e,t){if(!e||!t)return!1;let n=null==t.getRootNode?void 0:t.getRootNode();if(e.contains(t))return!0;if(n&&(0,xh.isShadowRoot)(n)){let n=t;for(;n;){if(e===n)return!0;n=n.parentNode||n.host}}return!1}let xK={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},xZ={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},xX=e=>{var t,n;return{escapeKey:"boolean"==typeof e?e:null!=(t=null==e?void 0:e.escapeKey)&&t,outsidePress:"boolean"==typeof e?e:null==(n=null==e?void 0:e.outsidePress)||n}};function xQ(e,t){void 0===t&&(t={});let{open:n,onOpenChange:r,elements:o,dataRef:i}=e,{enabled:s=!0,escapeKey:l=!0,outsidePress:a=!0,outsidePressEvent:c="pointerdown",referencePress:d=!1,referencePressEvent:u="pointerdown",ancestorScroll:h=!1,bubbles:p,capture:f}=t,m=X.useContext(xB),g=xx("function"==typeof a?a:()=>!1),b="function"==typeof a?g:a,y=X.useRef(!1),{escapeKey:v,outsidePress:E}=xX(p),{escapeKey:k,outsidePress:C}=xX(f),T=X.useRef(!1),w=xx(e=>{var t;if(!n||!s||!l||"Escape"!==e.key||T.current)return;let o=null==(t=i.current.floatingContext)?void 0:t.nodeId,a=m?xE(m.nodesRef.current,o):[];if(!v&&(e.stopPropagation(),a.length>0)){let e=!0;if(a.forEach(t=>{var n;if(null!=(n=t.context)&&n.open&&!t.context.dataRef.current.__escapeKeyBubbles){e=!1;return}}),!e)return}r(!1,"nativeEvent"in e?e.nativeEvent:e,"escape-key")}),x=xx(e=>{var t;let n=()=>{var t;w(e),null==(t=xb(e))||t.removeEventListener("keydown",n)};null==(t=xb(e))||t.addEventListener("keydown",n)}),S=xx(e=>{var t;let n=i.current.insideReactTree;i.current.insideReactTree=!1;let s=y.current;if(y.current=!1,"click"===c&&s||n||"function"==typeof b&&!b(e))return;let l=xb(e),a="["+xj("inert")+"]",d=xv(o.floating).querySelectorAll(a),u=(0,xh.isElement)(l)?l:null;for(;u&&!(0,xh.isLastTraversableNode)(u);){let e=(0,xh.getParentNode)(u);if((0,xh.isLastTraversableNode)(e)||!(0,xh.isElement)(e))break;u=e}if(d.length&&(0,xh.isElement)(l)&&!l.matches("html,body")&&!xg(l,o.floating)&&Array.from(d).every(e=>!xg(u,e)))return;if((0,xh.isHTMLElement)(l)&&N){let t=(0,xh.isLastTraversableNode)(l),n=(0,xh.getComputedStyle)(l),r=/auto|scroll/,o=t||r.test(n.overflowX),i=t||r.test(n.overflowY),s=o&&l.clientWidth>0&&l.scrollWidth>l.clientWidth,a=i&&l.clientHeight>0&&l.scrollHeight>l.clientHeight,c="rtl"===n.direction,d=a&&(c?e.offsetX<=l.offsetWidth-l.clientWidth:e.offsetX>l.clientWidth),u=s&&e.offsetY>l.clientHeight;if(d||u)return}let h=null==(t=i.current.floatingContext)?void 0:t.nodeId,p=m&&xE(m.nodesRef.current,h).some(t=>{var n;return xy(e,null==(n=t.context)?void 0:n.elements.floating)});if(xy(e,o.floating)||xy(e,o.domReference)||p)return;let f=m?xE(m.nodesRef.current,h):[];if(f.length>0){let e=!0;if(f.forEach(t=>{var n;if(null!=(n=t.context)&&n.open&&!t.context.dataRef.current.__outsidePressBubbles){e=!1;return}}),!e)return}r(!1,e,"outside-press")}),A=xx(e=>{var t;let n=()=>{var t;S(e),null==(t=xb(e))||t.removeEventListener(c,n)};null==(t=xb(e))||t.addEventListener(c,n)});X.useEffect(()=>{if(!n||!s)return;i.current.__escapeKeyBubbles=v,i.current.__outsidePressBubbles=E;let e=-1;function t(e){r(!1,e,"ancestor-scroll")}function a(){window.clearTimeout(e),T.current=!0}function d(){e=window.setTimeout(()=>{T.current=!1},5*!!(0,xh.isWebKit)())}let u=xv(o.floating);l&&(u.addEventListener("keydown",k?x:w,k),u.addEventListener("compositionstart",a),u.addEventListener("compositionend",d)),b&&u.addEventListener(c,C?A:S,C);let p=[];return h&&((0,xh.isElement)(o.domReference)&&(p=(0,xh.getOverflowAncestors)(o.domReference)),(0,xh.isElement)(o.floating)&&(p=p.concat((0,xh.getOverflowAncestors)(o.floating))),!(0,xh.isElement)(o.reference)&&o.reference&&o.reference.contextElement&&(p=p.concat((0,xh.getOverflowAncestors)(o.reference.contextElement)))),(p=p.filter(e=>{var t;return e!==(null==(t=u.defaultView)?void 0:t.visualViewport)})).forEach(e=>{e.addEventListener("scroll",t,{passive:!0})}),()=>{l&&(u.removeEventListener("keydown",k?x:w,k),u.removeEventListener("compositionstart",a),u.removeEventListener("compositionend",d)),b&&u.removeEventListener(c,C?A:S,C),p.forEach(e=>{e.removeEventListener("scroll",t)}),window.clearTimeout(e)}},[i,o,l,b,c,n,r,h,s,v,E,w,k,x,S,C,A]),X.useEffect(()=>{i.current.insideReactTree=!1},[i,b,c]);let _=X.useMemo(()=>({onKeyDown:w,...d&&{[xK[u]]:e=>{r(!1,e.nativeEvent,"reference-press")},..."click"!==u&&{onClick(e){r(!1,e.nativeEvent,"reference-press")}}}}),[w,r,d,u]),N=X.useMemo(()=>({onKeyDown:w,onMouseDown(){y.current=!0},onMouseUp(){y.current=!0},[xZ[c]]:()=>{i.current.insideReactTree=!0}}),[w,c,i]);return X.useMemo(()=>s?{reference:_,floating:N}:{},[s,_,N])}function xJ(e){void 0===e&&(e={});let{nodeId:t}=e,n=function(e){let{open:t=!1,onOpenChange:n,elements:r}=e,o=xL(),i=X.useRef({}),[s]=X.useState(()=>{let e;return e=new Map,{emit(t,n){var r;null==(r=e.get(t))||r.forEach(e=>e(n))},on(t,n){e.has(t)||e.set(t,new Set),e.get(t).add(n)},off(t,n){var r;null==(r=e.get(t))||r.delete(n)}}}),l=null!=xH(),[a,c]=X.useState(r.reference),d=xx((e,t,r)=>{i.current.openEvent=e?t:void 0,s.emit("openchange",{open:e,event:t,reason:r,nested:l}),null==n||n(e,t,r)}),u=X.useMemo(()=>({setPositionReference:c}),[]),h=X.useMemo(()=>({reference:a||r.reference||null,floating:r.floating||null,domReference:r.reference}),[a,r.reference,r.floating]);return X.useMemo(()=>({dataRef:i,open:t,onOpenChange:d,elements:h,events:s,floatingId:o,refs:u}),[t,d,h,s,o,u])}({...e,elements:{reference:null,floating:null,...e.elements}}),r=e.rootContext||n,o=r.elements,[i,s]=X.useState(null),[l,a]=X.useState(null),c=(null==o?void 0:o.domReference)||i,d=X.useRef(null),u=X.useContext(xB);xC(()=>{c&&(d.current=c)},[c]);let h=(0,xA.useFloating)({...e,elements:{...o,...l&&{reference:l}}}),p=X.useCallback(e=>{let t=(0,xh.isElement)(e)?{getBoundingClientRect:()=>e.getBoundingClientRect(),getClientRects:()=>e.getClientRects(),contextElement:e}:e;a(t),h.refs.setReference(t)},[h.refs]),f=X.useCallback(e=>{((0,xh.isElement)(e)||null===e)&&(d.current=e,s(e)),((0,xh.isElement)(h.refs.reference.current)||null===h.refs.reference.current||null!==e&&!(0,xh.isElement)(e))&&h.refs.setReference(e)},[h.refs]),m=X.useMemo(()=>({...h.refs,setReference:f,setPositionReference:p,domReference:d}),[h.refs,f,p]),g=X.useMemo(()=>({...h.elements,domReference:c}),[h.elements,c]),b=X.useMemo(()=>({...h,...r,refs:m,elements:g,nodeId:t}),[h,m,g,t,r]);return xC(()=>{r.dataRef.current.floatingContext=b;let e=null==u?void 0:u.nodesRef.current.find(e=>e.id===t);e&&(e.context=b)}),X.useMemo(()=>({...h,context:b,refs:m,elements:g}),[h,m,g,b])}function x0(){let e;return(null!=(e=navigator.userAgentData)&&e.platform?e.platform:navigator.platform).toLowerCase().startsWith("mac")&&!navigator.maxTouchPoints&&/apple/i.test(navigator.vendor)}function x1(e,t,n){let r=new Map,o="item"===n,i=e;if(o&&e){let{[xN]:t,[xM]:n,...r}=e;i=r}return{..."floating"===n&&{tabIndex:-1,"data-floating-ui-focusable":""},...i,...t.map(t=>{let r=t?t[n]:null;return"function"==typeof r?e?r(e):null:r}).concat(e).reduce((e,t)=>(t&&Object.entries(t).forEach(t=>{let[n,i]=t;if(!(o&&[xN,xM].includes(n)))if(0===n.indexOf("on")){if(r.has(n)||r.set(n,[]),"function"==typeof i){var s;null==(s=r.get(n))||s.push(i),e[n]=function(){for(var e,t=arguments.length,o=Array(t),i=0;i<t;i++)o[i]=arguments[i];return null==(e=r.get(n))?void 0:e.map(e=>e(...o)).find(e=>void 0!==e)}}}else e[n]=i}),e),{})}}function x2(e){void 0===e&&(e=[]);let t=e.map(e=>null==e?void 0:e.reference),n=e.map(e=>null==e?void 0:e.floating),r=e.map(e=>null==e?void 0:e.item),o=X.useCallback(t=>x1(t,e,"reference"),t),i=X.useCallback(t=>x1(t,e,"floating"),n),s=X.useCallback(t=>x1(t,e,"item"),r);return X.useMemo(()=>({getReferenceProps:o,getFloatingProps:i,getItemProps:s}),[o,i,s])}let x4=new Map([["select","listbox"],["combobox","listbox"],["label",!1]]),x5=e=>e.replace(/[A-Z]+(?![a-z])|[A-Z]/g,(e,t)=>(t?"-":"")+e.toLowerCase());function x3(e,t){return"function"==typeof e?e(t):e}function x8(e,t){void 0===t&&(t={});let{open:n,elements:{floating:r}}=e,{duration:o=250}=t,i=("number"==typeof o?o:o.close)||0,[s,l]=X.useState("unmounted"),a=function(e,t){let[n,r]=X.useState(e);return e&&!n&&r(!0),X.useEffect(()=>{if(!e&&n){let e=setTimeout(()=>r(!1),t);return()=>clearTimeout(e)}},[e,n,t]),n}(n,i);return a||"close"!==s||l("unmounted"),xC(()=>{if(r){if(n){l("initial");let e=requestAnimationFrame(()=>{xS.flushSync(()=>{l("open")})});return()=>{cancelAnimationFrame(e)}}l("close")}},[n,r]),{isMounted:a,status:s}}function x6(e,t){let[n,r]=e,o=!1,i=t.length;for(let e=0,s=i-1;e<i;s=e++){let[i,l]=t[e]||[0,0],[a,c]=t[s]||[0,0];l>=r!=c>=r&&n<=(a-i)*(r-l)/(c-l)+i&&(o=!o)}return o}var x9=Object.defineProperty,x7=(e,t,n)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?x9(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n};function Se(e){let t=new Set,n=new Set;for(let[r,o]of e.entries())0===o?t.add(r):n.add(r);return{roots:t,nonRoots:n}}function St(e,t,n){return e.has(t)||e.set(t,new Set),e.get(t).add(n),e}function Sn(e){let t=new Map;for(let n of e)Array.isArray(n.runsBefore)&&n.runsBefore.length>0?n.runsBefore.forEach(e=>{St(t,n.key,e)}):St(t,"default",n.key);let n=function(e){let t=function(e){let t=new Map;for(let[n,r]of e.entries())for(let e of(t.has(n)||t.set(n,0),r)){let n=t.get(e)??0;t.set(e,n+1)}return t}(e),{roots:n,nonRoots:r}=Se(t),o=[];for(;n.size;){o.push(n);let r=new Set;for(let o of n){let n=e.get(o);if(n)for(let e of n){let n=t.get(e);if(void 0===n)continue;let o=n-1;t.set(e,o),0===o&&r.add(e)}}n=r}if((r=Se(t).nonRoots).size)throw Error(`Cycle(s) detected; toposort only works on acyclic graphs. Cyclic nodes: ${Array.from(r).join(", ")}`);return o}(function(e){let t=new Map;for(let[n,r]of e.entries())for(let e of(t.has(n)||t.set(n,new Set),r))t.has(e)||t.set(e,new Set),t.get(e).add(n);return t}(t)),r=n.findIndex(e=>e.has("default"));return e=>91+(n.findIndex(t=>t.has(e))+r)*10}function Sr(e){return e&&Object.fromEntries(Object.entries(e).filter(([,e])=>void 0!==e))}class So{constructor(e){x7(this,"BlockNoteEditor","only for types"),x7(this,"Block","only for types"),x7(this,"PartialBlock","only for types"),x7(this,"inlineContentSpecs"),x7(this,"styleSpecs"),x7(this,"blockSpecs"),x7(this,"blockSchema"),x7(this,"inlineContentSchema"),x7(this,"styleSchema"),this.opts=e;const{blockSpecs:t,inlineContentSpecs:n,styleSpecs:r,blockSchema:o,inlineContentSchema:i,styleSchema:s}=this.init();this.blockSpecs=t,this.styleSpecs=r,this.styleSchema=s,this.inlineContentSpecs=n,this.blockSchema=o,this.inlineContentSchema=i}init(){let e=Sn(Object.entries({...this.opts.blockSpecs,...this.opts.inlineContentSpecs,...this.opts.styleSpecs}).map(([e,t])=>{var n;return{key:e,runsBefore:(null==(n=t.implementation)?void 0:n.runsBefore)??[]}})),t=Object.fromEntries(Object.entries(this.opts.blockSpecs).map(([t,n])=>[t,function(e,t,n,r){var o,i,s,l;let a=t.node||lB.create({name:e.type,content:"inline"===e.content?"inline*":"none"===e.content?"":e.content,group:"blockContent",selectable:(null==(o=t.meta)?void 0:o.selectable)??!0,isolating:(null==(i=t.meta)?void 0:i.isolating)??!0,code:(null==(s=t.meta)?void 0:s.code)??!1,defining:(null==(l=t.meta)?void 0:l.defining)??!0,priority:r,addAttributes:()=>{var t;let n;return t=e.propSchema,n={},Object.entries(t).forEach(([e,t])=>{n[e]={default:t.default,keepOnSplit:!0,parseHTML:n=>{let r=n.getAttribute(mz(e));if(null===r)return null;if(void 0===t.default&&"boolean"===t.type||void 0!==t.default&&"boolean"==typeof t.default)return"true"===r||"false"!==r&&null;if(void 0===t.default&&"number"===t.type||void 0!==t.default&&"number"==typeof t.default){let e=parseFloat(r);return!Number.isNaN(e)&&Number.isFinite(e)?e:null}return r},renderHTML:n=>n[e]!==t.default?{[mz(e)]:n[e]}:{}}}),n},parseHTML:()=>{let n;return n=[{tag:"[data-content-type="+e.type+"]",contentElement:".bn-inline-content"}],t.parse&&n.push({tag:"*",getAttrs(e){var n;if("string"==typeof e)return!1;let r=null==(n=t.parse)?void 0:n.call(t,e);return void 0!==r&&r},preserveWhitespace:!0,getContent:"inline"===e.content||"none"===e.content?(n,r)=>{var o;if(t.parseContent)return t.parseContent({el:n,schema:r});if("inline"===e.content){let e=n.cloneNode(!0);return function(e,t="<br>"){let n=e.querySelectorAll("p");if(n.length>1){let e=n[0];for(let r=1;r<n.length;r++){let o=n[r];e.innerHTML+=t+o.innerHTML,o.remove()}}}(e,null!=(o=t.meta)&&o.code?`
`:"<br>"),eX.fromSchema(r).parse(e,{topNode:r.nodes.paragraph.create(),preserveWhitespace:!0}).content}return em.empty}:void 0}),n},renderHTML({HTMLAttributes:n}){var r;let o=document.createElement("div");return mG({dom:o,contentDOM:"inline"===e.content?o:void 0},e.type,{},e.propSchema,(null==(r=t.meta)?void 0:r.fileBlockAccept)!==void 0,n)},addNodeView(){return n=>{var r,o,i;let s=this.options.editor,l=m$(n.getPos,s,this.editor,e.type),a=(null==(r=this.options.domAttributes)?void 0:r.blockContent)||{},c=t.render.call({blockContentDOMAttributes:a,props:n,renderType:"nodeView"},l,s);return(null==(o=t.meta)?void 0:o.selectable)===!1&&(i=this.editor,c.stopEvent=e=>("mousedown"===e.type&&setTimeout(()=>{i.view.dom.blur()},10),!0)),c}}});if(a.name!==e.type)throw Error("Node name does not match block type. This is a bug in BlockNote.");return{config:e,implementation:{...t,node:a,render(e,n){var r;let o=(null==(r=a.options.domAttributes)?void 0:r.blockContent)||{};return t.render.call({blockContentDOMAttributes:o,props:void 0,renderType:"dom"},e,n)},toExternalHTML:(e,n)=>{var r,o;let i=(null==(r=a.options.domAttributes)?void 0:r.blockContent)||{};return(null==(o=t.toExternalHTML)?void 0:o.call({blockContentDOMAttributes:i},e,n))??t.render.call({blockContentDOMAttributes:i,renderType:"dom",props:void 0},e,n)}},extensions:n}}(n.config,n.implementation,n.extensions,e(t))])),n=Object.fromEntries(Object.entries(this.opts.inlineContentSpecs).map(([t,n])=>{var r;return"object"!=typeof n.config?[t,n]:[t,{...n,implementation:{...n.implementation,node:null==(r=n.implementation)?void 0:r.node.extend({priority:e(t)})}}]})),r=Object.fromEntries(Object.entries(this.opts.styleSpecs).map(([t,n])=>{var r;return[t,{...n,implementation:{...n.implementation,mark:null==(r=n.implementation)?void 0:r.mark.extend({priority:e(t)})}}]}));return{blockSpecs:t,blockSchema:Object.fromEntries(Object.entries(t).map(([e,t])=>[e,t.config])),inlineContentSpecs:Sr(n),styleSpecs:Sr(r),inlineContentSchema:mW(n),styleSchema:mX(r)}}extend(e){Object.assign(this.opts.blockSpecs,e.blockSpecs),Object.assign(this.opts.inlineContentSpecs,e.inlineContentSpecs),Object.assign(this.opts.styleSpecs,e.styleSpecs);let{blockSpecs:t,inlineContentSpecs:n,styleSpecs:r,blockSchema:o,inlineContentSchema:i,styleSchema:s}=this.init();return this.blockSpecs=t,this.styleSpecs=r,this.styleSchema=s,this.inlineContentSpecs=n,this.blockSchema=o,this.inlineContentSchema=i,this}}mq(()=>({type:"pageBreak",propSchema:{},content:"none"}),{parse(e){if("DIV"===e.tagName&&e.hasAttribute("data-page-break"))return{}},render(){let e=document.createElement("div");return e.setAttribute("data-page-break",""),{dom:e}},toExternalHTML(){let e=document.createElement("div");return e.setAttribute("data-page-break",""),{dom:e}}});class Si extends So{static create(e){return new Si({blockSpecs:(null==e?void 0:e.blockSpecs)??g1,inlineContentSpecs:(null==e?void 0:e.inlineContentSpecs)??g3,styleSpecs:(null==e?void 0:e.styleSpecs)??g5})}}let Ss={slash_menu:{heading:{title:"Heading 1",subtext:"Top-level heading",aliases:["h","heading1","h1"],group:"Headings"},heading_2:{title:"Heading 2",subtext:"Key section heading",aliases:["h2","heading2","subheading"],group:"Headings"},heading_3:{title:"Heading 3",subtext:"Subsection and group heading",aliases:["h3","heading3","subheading"],group:"Headings"},heading_4:{title:"Heading 4",subtext:"Minor subsection heading",aliases:["h4","heading4","subheading4"],group:"Subheadings"},heading_5:{title:"Heading 5",subtext:"Small subsection heading",aliases:["h5","heading5","subheading5"],group:"Subheadings"},heading_6:{title:"Heading 6",subtext:"Lowest-level heading",aliases:["h6","heading6","subheading6"],group:"Subheadings"},toggle_heading:{title:"Toggle Heading 1",subtext:"Toggleable top-level heading",aliases:["h","heading1","h1","collapsable"],group:"Subheadings"},toggle_heading_2:{title:"Toggle Heading 2",subtext:"Toggleable key section heading",aliases:["h2","heading2","subheading","collapsable"],group:"Subheadings"},toggle_heading_3:{title:"Toggle Heading 3",subtext:"Toggleable subsection and group heading",aliases:["h3","heading3","subheading","collapsable"],group:"Subheadings"},quote:{title:"Quote",subtext:"Quote or excerpt",aliases:["quotation","blockquote","bq"],group:"Basic blocks"},toggle_list:{title:"Toggle List",subtext:"List with hideable sub-items",aliases:["li","list","toggleList","toggle list","collapsable list"],group:"Basic blocks"},numbered_list:{title:"Numbered List",subtext:"List with ordered items",aliases:["ol","li","list","numberedlist","numbered list"],group:"Basic blocks"},bullet_list:{title:"Bullet List",subtext:"List with unordered items",aliases:["ul","li","list","bulletlist","bullet list"],group:"Basic blocks"},check_list:{title:"Check List",subtext:"List with checkboxes",aliases:["ul","li","list","checklist","check list","checked list","checkbox"],group:"Basic blocks"},paragraph:{title:"Paragraph",subtext:"The body of your document",aliases:["p","paragraph"],group:"Basic blocks"},code_block:{title:"Code Block",subtext:"Code block with syntax highlighting",aliases:["code","pre"],group:"Basic blocks"},page_break:{title:"Page Break",subtext:"Page separator",aliases:["page","break","separator"],group:"Basic blocks"},table:{title:"Table",subtext:"Table with editable cells",aliases:["table"],group:"Advanced"},image:{title:"Image",subtext:"Resizable image with caption",aliases:["image","imageUpload","upload","img","picture","media","url"],group:"Media"},video:{title:"Video",subtext:"Resizable video with caption",aliases:["video","videoUpload","upload","mp4","film","media","url"],group:"Media"},audio:{title:"Audio",subtext:"Embedded audio with caption",aliases:["audio","audioUpload","upload","mp3","sound","media","url"],group:"Media"},file:{title:"File",subtext:"Embedded file",aliases:["file","upload","embed","media","url"],group:"Media"},emoji:{title:"Emoji",subtext:"Search for and insert an emoji",aliases:["emoji","emote","emotion","face"],group:"Others"},divider:{title:"Divider",subtext:"Visually divide blocks",aliases:["divider","hr","line","horizontal rule"],group:"Basic blocks"}},placeholders:{default:"Enter text or type '/' for commands",heading:"Heading",toggleListItem:"Toggle",bulletListItem:"List",numberedListItem:"List",checkListItem:"List",emptyDocument:void 0,new_comment:"Write a comment...",edit_comment:"Edit comment...",comment_reply:"Add comment..."},file_blocks:{add_button_text:{image:"Add image",video:"Add video",audio:"Add audio",file:"Add file"}},toggle_blocks:{add_block_button:"Empty toggle. Click to add a block."},side_menu:{add_block_label:"Add block",drag_handle_label:"Open block menu"},drag_handle:{delete_menuitem:"Delete",colors_menuitem:"Colors",header_row_menuitem:"Header row",header_column_menuitem:"Header column"},table_handle:{delete_column_menuitem:"Delete column",delete_row_menuitem:"Delete row",add_left_menuitem:"Add column left",add_right_menuitem:"Add column right",add_above_menuitem:"Add row above",add_below_menuitem:"Add row below",split_cell_menuitem:"Split cell",merge_cells_menuitem:"Merge cells",background_color_menuitem:"Background color"},suggestion_menu:{no_items_title:"No items found"},color_picker:{text_title:"Text",background_title:"Background",colors:{default:"Default",gray:"Gray",brown:"Brown",red:"Red",orange:"Orange",yellow:"Yellow",green:"Green",blue:"Blue",purple:"Purple",pink:"Pink"}},formatting_toolbar:{bold:{tooltip:"Bold",secondary_tooltip:"Mod+B"},italic:{tooltip:"Italic",secondary_tooltip:"Mod+I"},underline:{tooltip:"Underline",secondary_tooltip:"Mod+U"},strike:{tooltip:"Strike",secondary_tooltip:"Mod+Shift+S"},code:{tooltip:"Code",secondary_tooltip:""},colors:{tooltip:"Colors"},link:{tooltip:"Create link",secondary_tooltip:"Mod+K"},file_caption:{tooltip:"Edit caption",input_placeholder:"Edit caption"},file_replace:{tooltip:{image:"Replace image",video:"Replace video",audio:"Replace audio",file:"Replace file"}},file_rename:{tooltip:{image:"Rename image",video:"Rename video",audio:"Rename audio",file:"Rename file"},input_placeholder:{image:"Rename image",video:"Rename video",audio:"Rename audio",file:"Rename file"}},file_download:{tooltip:{image:"Download image",video:"Download video",audio:"Download audio",file:"Download file"}},file_delete:{tooltip:{image:"Delete image",video:"Delete video",audio:"Delete audio",file:"Delete file"}},file_preview_toggle:{tooltip:"Toggle preview"},nest:{tooltip:"Nest block",secondary_tooltip:"Tab"},unnest:{tooltip:"Unnest block",secondary_tooltip:"Shift+Tab"},align_left:{tooltip:"Align text left"},align_center:{tooltip:"Align text center"},align_right:{tooltip:"Align text right"},align_justify:{tooltip:"Justify text"},table_cell_merge:{tooltip:"Merge cells"},comment:{tooltip:"Add comment"}},file_panel:{upload:{title:"Upload",file_placeholder:{image:"Upload image",video:"Upload video",audio:"Upload audio",file:"Upload file"},upload_error:"Error: Upload failed"},embed:{title:"Embed",embed_button:{image:"Embed image",video:"Embed video",audio:"Embed audio",file:"Embed file"},url_placeholder:"Enter URL"}},link_toolbar:{delete:{tooltip:"Remove link"},edit:{text:"Edit link",tooltip:"Edit"},open:{tooltip:"Open in new tab"},form:{title_placeholder:"Edit title",url_placeholder:"Edit URL"}},comments:{edited:"edited",save_button_text:"Save",cancel_button_text:"Cancel",actions:{add_reaction:"Add reaction",resolve:"Resolve",edit_comment:"Edit comment",delete_comment:"Delete comment",more_actions:"More actions"},reactions:{reacted_by:"Reacted by"},sidebar:{marked_as_resolved:"Marked as resolved",more_replies:e=>`${e} more replies`}},generic:{ctrl_shortcut:"Ctrl"}};class Sl{match;handler;undoable;inCode;inCodeMark;constructor(e,t,n={}){var r;this.match=e,this.match=e,this.handler="string"==typeof t?(r=t,function(e,t,n,o){let i=r;if(t[1]){let e=t[0].lastIndexOf(t[1]);i+=t[0].slice(e+t[1].length);let r=(n+=e)-o;r>0&&(i=t[0].slice(e-r,e)+i,n=o)}return e.tr.insertText(i,n,o)}):t,this.undoable=!1!==n.undoable,this.inCode=n.inCode||!1,this.inCodeMark=!1!==n.inCodeMark}}function Sa(e,t,n,r,o,i){if(e.composing)return!1;let s=e.state.tr.insertText(r,t,n),l=s.mapping.map(t),a=s.mapping.map(n),c=null,d=s.doc.resolve(l),u=d.parent.textBetween(Math.max(0,d.parentOffset-500),d.parentOffset,null,"");for(let t=0;t<o.length;t++){let n=o[t];if(!n.inCodeMark&&d.marks().some(e=>e.type.spec.code))continue;if(d.parent.type.spec.code){if(!n.inCode)continue}else if("only"===n.inCode)continue;let h=n.match.exec(u);if(!h||h[0].length<r.length)continue;c??=e.state.apply(s);let p=n.handler(c,h,l-h[0].length,a);if(p)return e.dispatch(s),e.dispatch(e.state.tr.setMeta(bI,!0)),n.undoable&&p.setMeta(i,{transform:p,from:l,to:a,text:r}),e.dispatch(p),!0}return!1}new Sl(/--$/,"",{inCodeMark:!1}),new Sl(/\.\.\.$/,"",{inCodeMark:!1}),new Sl(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"",{inCodeMark:!1}),new Sl(/"$/,"",{inCodeMark:!1}),new Sl(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"",{inCodeMark:!1}),new Sl(/'$/,"",{inCodeMark:!1});class Sc extends tj{constructor(e){super(e,e)}map(e,t){let n=e.resolve(t.map(this.head));return Sc.valid(n)?new Sc(n):tj.near(n)}content(){return ek.empty}eq(e){return e instanceof Sc&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for GapCursor.fromJSON");return new Sc(e.resolve(t.pos))}getBookmark(){return new Sd(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!function(e){for(let t=e.depth;t>=0;t--){let n=e.index(t),r=e.node(t);if(0==n){if(r.type.spec.isolating)return!0;continue}for(let e=r.child(n-1);;e=e.lastChild){if(0==e.childCount&&!e.inlineContent||Su(e.type))return!0;if(e.inlineContent)return!1}}return!0}(e)||!function(e){for(let t=e.depth;t>=0;t--){let n=e.indexAfter(t),r=e.node(t);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let e=r.child(n);;e=e.firstChild){if(0==e.childCount&&!e.inlineContent||Su(e.type))return!0;if(e.inlineContent)return!1}}return!0}(e))return!1;let n=t.type.spec.allowGapCursor;if(null!=n)return n;let r=t.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(e,t,n=!1){r:for(;;){if(!n&&Sc.valid(e))return e;let r=e.pos,o=null;for(let n=e.depth;;n--){let i=e.node(n);if(t>0?e.indexAfter(n)<i.childCount:e.index(n)>0){o=i.child(t>0?e.indexAfter(n):e.index(n)-1);break}if(0==n)return null;r+=t;let s=e.doc.resolve(r);if(Sc.valid(s))return s}for(;;){let i=t>0?o.firstChild:o.lastChild;if(!i){if(o.isAtom&&!o.isText&&!tG.isSelectable(o)){e=e.doc.resolve(r+o.nodeSize*t),n=!1;continue r}break}o=i,r+=t;let s=e.doc.resolve(r);if(Sc.valid(s))return s}return null}}}Sc.prototype.visible=!1,Sc.findFrom=Sc.findGapCursorFrom,tj.jsonID("gapcursor",Sc);class Sd{constructor(e){this.pos=e}map(e){return new Sd(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return Sc.valid(t)?new Sc(t):tj.near(t)}}function Su(e){return e.isAtom||e.spec.isolating||e.spec.createGapCursor}let Sh=ir({ArrowLeft:Sp("horiz",-1),ArrowRight:Sp("horiz",1),ArrowUp:Sp("vert",-1),ArrowDown:Sp("vert",1)});function Sp(e,t){let n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,r,o){let i=e.selection,s=t>0?i.$to:i.$from,l=i.empty;if(i instanceof tV){if(!o.endOfTextblock(n)||0==s.depth)return!1;l=!1,s=e.doc.resolve(t>0?s.after():s.before())}let a=Sc.findGapCursorFrom(s,t,l);return!!a&&(r&&r(e.tr.setSelection(new Sc(a))),!0)}}function Sf(e,t,n){if(!e||!e.editable)return!1;let r=e.state.doc.resolve(t);if(!Sc.valid(r))return!1;let o=e.posAtCoords({left:n.clientX,top:n.clientY});return!(o&&o.inside>-1&&tG.isSelectable(e.state.doc.nodeAt(o.inside)))&&(e.dispatch(e.state.tr.setSelection(new Sc(r))),!0)}function Sm(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof Sc))return!1;let{$from:n}=e.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(e.state.schema.nodes.text);if(!r)return!1;let o=em.empty;for(let e=r.length-1;e>=0;e--)o=em.from(r[e].createAndFill(null,o));let i=e.state.tr.replace(n.pos,n.pos,new ek(o,0,0));return i.setSelection(tV.near(i.doc.resolve(n.pos+1))),e.dispatch(i),!1}function Sg(e){if(!(e.selection instanceof Sc))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",oA.create(e.doc,[ow.widget(e.selection.head,t,{key:"gapcursor"})])}lh.create({name:"characterCount",addOptions:()=>({limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(e=>""!==e).length}),addStorage:()=>({characters:()=>0,words:()=>0}),onBeforeCreate(){this.storage.characters=e=>{let t=(null==e?void 0:e.node)||this.editor.state.doc;if("textSize"===((null==e?void 0:e.mode)||this.options.mode)){let e=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(e)}return t.nodeSize},this.storage.words=e=>{let t=(null==e?void 0:e.node)||this.editor.state.doc,n=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let e=!1;return[new t4({key:new t8("characterCount"),appendTransaction:(t,n,r)=>{if(e)return;let o=this.options.limit;if(null==o||0===o){e=!0;return}let i=this.storage.characters({node:r.doc});if(i>o){console.warn(`[CharacterCount] Initial content exceeded limit of ${o} characters. Content was automatically trimmed.`);let t=r.tr.deleteRange(0,i-o);return e=!0,t}e=!0},filterTransaction:(e,t)=>{let n=this.options.limit;if(!e.docChanged||0===n||null==n)return!0;let r=this.storage.characters({node:t.doc}),o=this.storage.characters({node:e.doc});if(o<=n||r>n&&o>n&&o<=r)return!0;if(r>n&&o>n&&o>r||!e.getMeta("paste"))return!1;let i=e.selection.$head.pos;return e.deleteRange(i-(o-n),i),!(this.storage.characters({node:e.doc})>n)}})]}}),lh.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[bg(this.options)]}}),lh.create({name:"focus",addOptions:()=>({className:"has-focus",mode:"all"}),addProseMirrorPlugins(){return[new t4({key:new t8("focus"),props:{decorations:({doc:e,selection:t})=>{let{isEditable:n,isFocused:r}=this.editor,{anchor:o}=t,i=[];if(!n||!r)return oA.create(e,[]);let s=0;"deepest"===this.options.mode&&e.descendants((e,t)=>{if(!e.isText){if(!(o>=t&&o<=t+e.nodeSize-1))return!1;s+=1}});let l=0;return e.descendants((e,t)=>!e.isText&&!!(o>=t&&o<=t+e.nodeSize-1)&&((l+=1,"deepest"===this.options.mode&&s-l>0||"shallowest"===this.options.mode&&l>1)?"deepest"===this.options.mode:void i.push(ow.node(t,t+e.nodeSize,{class:this.options.className})))),oA.create(e,i)}}})]}});var Sb=lh.create({name:"gapCursor",addProseMirrorPlugins:()=>[new t4({props:{decorations:Sg,createSelectionBetween:(e,t,n)=>t.pos==n.pos&&Sc.valid(n)?new Sc(n):null,handleClick:Sf,handleKeyDown:Sh,handleDOMEvents:{beforeinput:Sm}}})],extendNodeSchema(e){var t;let n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:null!=(t=sg(sh(e,"allowGapCursor",n)))?t:null}}});function Sy({types:e,node:t}){return t&&Array.isArray(e)&&e.includes(t.type)||(null==t?void 0:t.type)===e}lh.create({name:"placeholder",addOptions:()=>({emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}),addProseMirrorPlugins(){return[new t4({key:new t8("placeholder"),props:{decorations:({doc:e,selection:t})=>{let n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=t,o=[];if(!n)return null;let i=this.editor.isEmpty;return e.descendants((e,t)=>{let n=r>=t&&r<=t+e.nodeSize,s=!e.isLeaf&&sB(e);if((n||!this.options.showOnlyCurrent)&&s){let r=[this.options.emptyNodeClass];i&&r.push(this.options.emptyEditorClass);let s=ow.node(t,t+e.nodeSize,{class:r.join(" "),"data-placeholder":"function"==typeof this.options.placeholder?this.options.placeholder({editor:this.editor,node:e,pos:t,hasAnchor:n}):this.options.placeholder});o.push(s)}return this.options.includeChildren}),oA.create(e,o)}}})]}}),lh.create({name:"selection",addOptions:()=>({className:"selection"}),addProseMirrorPlugins(){let{editor:e,options:t}=this;return[new t4({key:new t8("selection"),props:{decorations:n=>n.selection.empty||e.isFocused||!e.isEditable||sH(n.selection)||e.view.dragging?null:oA.create(n.doc,[ow.inline(n.selection.from,n.selection.to,{class:t.className})])}})]}}),lh.create({name:"trailingNode",addOptions:()=>({node:void 0,notAfter:[]}),addProseMirrorPlugins(){var e;let t=new t8(this.name),n=this.options.node||(null==(e=this.editor.schema.topNodeType.contentMatch.defaultType)?void 0:e.name)||"paragraph",r=Object.entries(this.editor.schema.nodes).map(([,e])=>e).filter(e=>(this.options.notAfter||[]).concat(n).includes(e.name));return[new t4({key:t,appendTransaction:(e,r,o)=>{let{doc:i,tr:s,schema:l}=o,a=t.getState(o),c=i.content.size,d=l.nodes[n];if(a)return s.insert(c,d.create())},state:{init:(e,t)=>!Sy({node:t.tr.doc.lastChild,types:r}),apply:(e,t)=>!e.docChanged||e.getMeta("__uniqueIDTransaction")?t:!Sy({node:e.doc.lastChild,types:r})}})]}}),lh.create({name:"undoRedo",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>({state:e,dispatch:t})=>bR(e,t),redo:()=>({state:e,dispatch:t})=>bL(e,t)}),addProseMirrorPlugins(){return[bO(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}});let Sv="numeric",SE="ascii",Sk="alpha",SC="asciinumeric",ST="alphanumeric",Sw="domain",Sx="emoji",SS="whitespace";function SA(e,t,n){for(let r in t[Sv]&&(t[SC]=!0,t[ST]=!0),t[SE]&&(t[SC]=!0,t[Sk]=!0),t[SC]&&(t[ST]=!0),t[Sk]&&(t[ST]=!0),t[ST]&&(t[Sw]=!0),t[Sx]&&(t[Sw]=!0),t){let t=(r in n||(n[r]=[]),n[r]);0>t.indexOf(e)&&t.push(e)}}function S_(e=null){this.j={},this.jr=[],this.jd=null,this.t=e}S_.groups={},S_.prototype={accepts(){return!!this.t},go(e){let t=this.j[e];if(t)return t;for(let t=0;t<this.jr.length;t++){let n=this.jr[t][0],r=this.jr[t][1];if(r&&n.test(e))return r}return this.jd},has(e,t=!1){return t?e in this.j:!!this.go(e)},ta(e,t,n,r){for(let o=0;o<e.length;o++)this.tt(e[o],t,n,r)},tr(e,t,n,r){let o;return r=r||S_.groups,t&&t.j?o=t:(o=new S_(t),n&&r&&SA(t,n,r)),this.jr.push([e,o]),o},ts(e,t,n,r){let o=this,i=e.length;if(!i)return o;for(let t=0;t<i-1;t++)o=o.tt(e[t]);return o.tt(e[i-1],t,n,r)},tt(e,t,n,r){if(r=r||S_.groups,t&&t.j)return this.j[e]=t,t;let o,i=this.go(e);return i?(Object.assign((o=new S_).j,i.j),o.jr.push.apply(o.jr,i.jr),o.jd=i.jd,o.t=i.t):o=new S_,t&&(r&&(o.t&&"string"==typeof o.t?SA(t,Object.assign(function(e,t){let n={};for(let r in t)t[r].indexOf(e)>=0&&(n[r]=!0);return n}(o.t,r),n),r):n&&SA(t,n,r)),o.t=t),this.j[e]=o,o}};let SN=(e,t,n,r,o)=>e.ta(t,n,r,o),SM=(e,t,n,r,o)=>e.tr(t,n,r,o),SI=(e,t,n,r,o)=>e.ts(t,n,r,o),SO=(e,t,n,r,o)=>e.tt(t,n,r,o),SD="WORD",SR="UWORD",SL="ASCIINUMERICAL",SP="ALPHANUMERICAL",SB="LOCALHOST",SH="UTLD",Sj="SCHEME",SF="SLASH_SCHEME",SU="OPENBRACE",Sz="CLOSEBRACE",SV="OPENBRACKET",S$="CLOSEBRACKET",SG="OPENPAREN",Sq="CLOSEPAREN",SW="OPENANGLEBRACKET",SY="CLOSEANGLEBRACKET",SK="FULLWIDTHLEFTPAREN",SZ="FULLWIDTHRIGHTPAREN",SX="LEFTCORNERBRACKET",SQ="RIGHTCORNERBRACKET",SJ="LEFTWHITECORNERBRACKET",S0="RIGHTWHITECORNERBRACKET",S1="FULLWIDTHLESSTHAN",S2="FULLWIDTHGREATERTHAN",S4="AMPERSAND",S5="APOSTROPHE",S3="ASTERISK",S8="BACKSLASH",S6="BACKTICK",S9="CARET",S7="COLON",Ae="COMMA",At="DOLLAR",An="EQUALS",Ar="EXCLAMATION",Ao="HYPHEN",Ai="PERCENT",As="PIPE",Al="PLUS",Aa="POUND",Ac="QUERY",Ad="QUOTE",Au="FULLWIDTHMIDDLEDOT",Ah="SEMI",Ap="SLASH",Af="TILDE",Am="UNDERSCORE",Ag="EMOJI";var Ab=Object.freeze({__proto__:null,ALPHANUMERICAL:SP,AMPERSAND:S4,APOSTROPHE:S5,ASCIINUMERICAL:SL,ASTERISK:S3,AT:"AT",BACKSLASH:S8,BACKTICK:S6,CARET:S9,CLOSEANGLEBRACKET:SY,CLOSEBRACE:Sz,CLOSEBRACKET:S$,CLOSEPAREN:Sq,COLON:S7,COMMA:Ae,DOLLAR:At,DOT:"DOT",EMOJI:Ag,EQUALS:An,EXCLAMATION:Ar,FULLWIDTHGREATERTHAN:S2,FULLWIDTHLEFTPAREN:SK,FULLWIDTHLESSTHAN:S1,FULLWIDTHMIDDLEDOT:Au,FULLWIDTHRIGHTPAREN:SZ,HYPHEN:Ao,LEFTCORNERBRACKET:SX,LEFTWHITECORNERBRACKET:SJ,LOCALHOST:SB,NL:"NL",NUM:"NUM",OPENANGLEBRACKET:SW,OPENBRACE:SU,OPENBRACKET:SV,OPENPAREN:SG,PERCENT:Ai,PIPE:As,PLUS:Al,POUND:Aa,QUERY:Ac,QUOTE:Ad,RIGHTCORNERBRACKET:SQ,RIGHTWHITECORNERBRACKET:S0,SCHEME:Sj,SEMI:Ah,SLASH:Ap,SLASH_SCHEME:SF,SYM:"SYM",TILDE:Af,TLD:"TLD",UNDERSCORE:Am,UTLD:SH,UWORD:SR,WORD:SD,WS:"WS"});let Ay=/[a-z]/,Av=/\p{L}/u,AE=/\p{Emoji}/u,Ak=/\d/,AC=/\s/,AT=null,Aw=null;function Ax(e,t){let n=function(e){let t=[],n=e.length,r=0;for(;r<n;){let o,i=e.charCodeAt(r),s=i<55296||i>56319||r+1===n||(o=e.charCodeAt(r+1))<56320||o>57343?e[r]:e.slice(r,r+2);t.push(s),r+=s.length}return t}(t.replace(/[A-Z]/g,e=>e.toLowerCase())),r=n.length,o=[],i=0,s=0;for(;s<r;){let l=e,a=null,c=0,d=null,u=-1,h=-1;for(;s<r&&(a=l.go(n[s]));)(l=a).accepts()?(u=0,h=0,d=l):u>=0&&(u+=n[s].length,h++),c+=n[s].length,i+=n[s].length,s++;i-=u,s-=h,c-=u,o.push({t:d.t,v:t.slice(i-c,i),s:i-c,e:i})}return o}function AS(e,t,n,r,o){let i,s=t.length;for(let n=0;n<s-1;n++){let s=t[n];e.j[s]?i=e.j[s]:((i=new S_(r)).jr=o.slice(),e.j[s]=i),e=i}return(i=new S_(n)).jr=o.slice(),e.j[t[s-1]]=i,i}function AA(e){let t=[],n=[],r=0;for(;r<e.length;){let o=0;for(;"0123456789".indexOf(e[r+o])>=0;)o++;if(o>0){t.push(n.join(""));for(let t=parseInt(e.substring(r,r+o),10);t>0;t--)n.pop();r+=o}else n.push(e[r]),r++}return t}let A_={defaultProtocol:"http",events:null,format:AM,formatHref:AM,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function AN(e,t=null){let n=Object.assign({},A_);e&&(n=Object.assign(n,e instanceof AN?e.o:e));let r=n.ignoreTags,o=[];for(let e=0;e<r.length;e++)o.push(r[e].toUpperCase());this.o=n,t&&(this.defaultRender=t),this.ignoreTags=o}function AM(e){return e}function AI(e,t){this.t="token",this.v=e,this.tk=t}function AO(e,t){class n extends AI{constructor(t,n){super(t,n),this.t=e}}for(let e in t)n.prototype[e]=t[e];return n.t=e,n}AN.prototype={o:A_,ignoreTags:[],defaultRender:e=>e,check(e){return this.get("validate",e.toString(),e)},get(e,t,n){let r=null!=t,o=this.o[e];return o&&("object"==typeof o?"function"==typeof(o=n.t in o?o[n.t]:A_[e])&&r&&(o=o(t,n)):"function"==typeof o&&r&&(o=o(t,n.t,n))),o},getObj(e,t,n){let r=this.o[e];return"function"==typeof r&&null!=t&&(r=r(t,n.t,n)),r},render(e){let t=e.render(this);return(this.get("render",null,e)||this.defaultRender)(t,e.t,e)}},AI.prototype={isLink:!1,toString(){return this.v},toHref(e){return this.toString()},toFormattedString(e){let t=this.toString(),n=e.get("truncate",t,this),r=e.get("format",t,this);return n&&r.length>n?r.substring(0,n)+"":r},toFormattedHref(e){return e.get("formatHref",this.toHref(e.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(e=A_.defaultProtocol){return{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(e),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(e){return{type:this.t,value:this.toFormattedString(e),isLink:this.isLink,href:this.toFormattedHref(e),start:this.startIndex(),end:this.endIndex()}},validate(e){return e.get("validate",this.toString(),this)},render(e){let t=this.toHref(e.get("defaultProtocol")),n=e.get("formatHref",t,this),r=e.get("tagName",t,this),o=this.toFormattedString(e),i={},s=e.get("className",t,this),l=e.get("target",t,this),a=e.get("rel",t,this),c=e.getObj("attributes",t,this),d=e.getObj("events",t,this);return i.href=n,s&&(i.class=s),l&&(i.target=l),a&&(i.rel=a),c&&Object.assign(i,c),{tagName:r,attributes:i,content:o,eventListeners:d}}};let AD=AO("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),AR=AO("text"),AL=AO("nl"),AP=AO("url",{isLink:!0,toHref(e=A_.defaultProtocol){return this.hasProtocol()?this.v:`${e}://${this.v}`},hasProtocol(){let e=this.tk;return e.length>=2&&e[0].t!==SB&&e[1].t===S7}}),AB=e=>new S_(e);function AH(e,t,n){let r=n[0].s,o=n[n.length-1].e;return new e(t.slice(r,o),n)}let Aj="undefined"!=typeof console&&console&&console.warn||(()=>{}),AF={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function AU(e,t=!1){if(AF.initialized&&Aj(`linkifyjs: already initialized - will not register custom scheme "${e}" until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(e))throw Error(`linkifyjs: incorrect scheme format.
1. Must only contain digits, lowercase ASCII letters or "-"
2. Cannot start or end with "-"
3. "-" cannot repeat`);AF.customSchemes.push([e,t])}function Az(e){return AF.initialized||function(){AF.scanner=function(e=[]){let t={};S_.groups=t;let n=new S_;null==AT&&(AT=AA("aaa1rp3bb0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4w0s2x0a2z0ure5ba0by2idu3namex4d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re3c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y3k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking4l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dad1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t1u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d1tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0els3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6properties14fh2g1h1i0a1ds2m1ndle4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3nd0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4k2ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic4v1w1x1y1z2na0b1goya4me2vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rton4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0axi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp3ell3ia1ksha5oes2p0ping5uji3w3i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lvo3te1ing3o2yage5u2wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2")),null==Aw&&(Aw=AA("121342632165322333335355455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222")),SO(n,"'",S5),SO(n,"{",SU),SO(n,"}",Sz),SO(n,"[",SV),SO(n,"]",S$),SO(n,"(",SG),SO(n,")",Sq),SO(n,"<",SW),SO(n,">",SY),SO(n,"",SK),SO(n,"",SZ),SO(n,"",SX),SO(n,"",SQ),SO(n,"",SJ),SO(n,"",S0),SO(n,"",S1),SO(n,"",S2),SO(n,"&",S4),SO(n,"*",S3),SO(n,"@","AT"),SO(n,"`",S6),SO(n,"^",S9),SO(n,":",S7),SO(n,",",Ae),SO(n,"$",At),SO(n,".","DOT"),SO(n,"=",An),SO(n,"!",Ar),SO(n,"-",Ao),SO(n,"%",Ai),SO(n,"|",As),SO(n,"+",Al),SO(n,"#",Aa),SO(n,"?",Ac),SO(n,'"',Ad),SO(n,"/",Ap),SO(n,";",Ah),SO(n,"~",Af),SO(n,"_",Am),SO(n,"\\",S8),SO(n,"",Au);let r=SM(n,Ak,"NUM",{[Sv]:!0});SM(r,Ak,r);let o=SM(r,Ay,SL,{[SC]:!0}),i=SM(r,Av,SP,{[ST]:!0}),s=SM(n,Ay,SD,{[SE]:!0});SM(s,Ak,o),SM(s,Ay,s),SM(o,Ak,o),SM(o,Ay,o);let l=SM(n,Av,SR,{[Sk]:!0});SM(l,Ay),SM(l,Ak,i),SM(l,Av,l),SM(i,Ak,i),SM(i,Ay),SM(i,Av,i);let a=SO(n,"\n","NL",{[SS]:!0}),c=SO(n,"\r","WS",{[SS]:!0}),d=SM(n,AC,"WS",{[SS]:!0});SO(n,"",d),SO(c,"\n",a),SO(c,"",d),SM(c,AC,d),SO(d,"\r"),SO(d,"\n"),SM(d,AC,d),SO(d,"",d);let u=SM(n,AE,Ag,{[Sx]:!0});SO(u,"#"),SM(u,AE,u),SO(u,"",u);let h=SO(u,"");SO(h,"#"),SM(h,AE,u);let p=[[Ay,s],[Ak,o]],f=[[Ay,null],[Av,l],[Ak,i]];for(let e=0;e<AT.length;e++)AS(n,AT[e],"TLD",SD,p);for(let e=0;e<Aw.length;e++)AS(n,Aw[e],SH,SR,f);SA("TLD",{tld:!0,ascii:!0},t),SA(SH,{utld:!0,alpha:!0},t),AS(n,"file",Sj,SD,p),AS(n,"mailto",Sj,SD,p),AS(n,"http",SF,SD,p),AS(n,"https",SF,SD,p),AS(n,"ftp",SF,SD,p),AS(n,"ftps",SF,SD,p),SA(Sj,{scheme:!0,ascii:!0},t),SA(SF,{slashscheme:!0,ascii:!0},t),e=e.sort((e,t)=>e[0]>t[0]?1:-1);for(let t=0;t<e.length;t++){let r=e[t][0],o=e[t][1]?{scheme:!0}:{slashscheme:!0};r.indexOf("-")>=0?o[Sw]=!0:Ay.test(r)?Ak.test(r)?o[SC]=!0:o[SE]=!0:o[Sv]=!0,SI(n,r,r,o)}return SI(n,"localhost",SB,{ascii:!0}),n.jd=new S_("SYM"),{start:n,tokens:Object.assign({groups:t},Ab)}}(AF.customSchemes);for(let e=0;e<AF.tokenQueue.length;e++)AF.tokenQueue[e][1]({scanner:AF.scanner});AF.parser=function({groups:e}){let t=e.domain.concat([S4,S3,"AT",S8,S6,S9,At,An,Ao,"NUM",Ai,As,Al,Aa,Ap,"SYM",Af,Am]),n=[S5,S7,Ae,"DOT",Ar,Ai,Ac,Ad,Ah,SW,SY,SU,Sz,S$,SV,SG,Sq,SK,SZ,SX,SQ,SJ,S0,S1,S2],r=[S4,S5,S3,S8,S6,S9,At,An,Ao,SU,Sz,Ai,As,Al,Aa,Ac,Ap,"SYM",Af,Am],o=AB(),i=SO(o,Af);SN(i,r,i),SN(i,e.domain,i);let s=AB(),l=AB(),a=AB();SN(o,e.domain,s),SN(o,e.scheme,l),SN(o,e.slashscheme,a),SN(s,r,i),SN(s,e.domain,s);let c=SO(s,"AT");SO(i,"AT",c),SO(l,"AT",c),SO(a,"AT",c);let d=SO(i,"DOT");SN(d,r,i),SN(d,e.domain,i);let u=AB();SN(c,e.domain,u),SN(u,e.domain,u);let h=SO(u,"DOT");SN(h,e.domain,u);let p=AB(AD);SN(h,e.tld,p),SN(h,e.utld,p),SO(c,SB,p);let f=SO(u,Ao);SO(f,Ao,f),SN(f,e.domain,u),SN(p,e.domain,u),SO(p,"DOT",h),SO(p,Ao,f),SN(SO(p,S7),e.numeric,AD);let m=SO(s,Ao),g=SO(s,"DOT");SO(m,Ao,m),SN(m,e.domain,s),SN(g,r,i),SN(g,e.domain,s);let b=AB(AP);SN(g,e.tld,b),SN(g,e.utld,b),SN(b,e.domain,s),SN(b,r,i),SO(b,"DOT",g),SO(b,Ao,m),SO(b,"AT",c);let y=SO(b,S7),v=AB(AP);SN(y,e.numeric,v);let E=AB(AP),k=AB();SN(E,t,E),SN(E,n,k),SN(k,t,E),SN(k,n,k),SO(b,Ap,E),SO(v,Ap,E);let C=SO(l,S7),T=SO(a,S7),w=SO(T,Ap),x=SO(w,Ap);SN(l,e.domain,s),SO(l,"DOT",g),SO(l,Ao,m),SN(a,e.domain,s),SO(a,"DOT",g),SO(a,Ao,m),SN(C,e.domain,E),SO(C,Ap,E),SO(C,Ac,E),SN(x,e.domain,E),SN(x,t,E),SO(x,Ap,E);let S=[[SU,Sz],[SV,S$],[SG,Sq],[SW,SY],[SK,SZ],[SX,SQ],[SJ,S0],[S1,S2]];for(let e=0;e<S.length;e++){let[r,o]=S[e],i=SO(E,r);SO(k,r,i),SO(i,o,E);let s=AB(AP);SN(i,t,s);let l=AB();SN(i,n),SN(s,t,s),SN(s,n,l),SN(l,t,s),SN(l,n,l),SO(s,o,E),SO(l,o,E)}return SO(o,SB,b),SO(o,"NL",AL),{start:o,tokens:Ab}}(AF.scanner.tokens);for(let e=0;e<AF.pluginQueue.length;e++)AF.pluginQueue[e][1]({scanner:AF.scanner,parser:AF.parser});AF.initialized=!0}(),function(e,t,n){let r=n.length,o=0,i=[],s=[];for(;o<r;){let l=e,a=null,c=null,d=0,u=null,h=-1;for(;o<r&&!(a=l.go(n[o].t));)s.push(n[o++]);for(;o<r&&(c=a||l.go(n[o].t));)a=null,(l=c).accepts()?(h=0,u=l):h>=0&&h++,o++,d++;if(h<0)(o-=d)<r&&(s.push(n[o]),o++);else{s.length>0&&(i.push(AH(AR,t,s)),s=[]),o-=h,d-=h;let e=u.t,r=n.slice(o-d,o);i.push(AH(e,t,r))}}return s.length>0&&i.push(AH(AR,t,s)),i}(AF.parser.start,e,Ax(AF.scanner.start,e))}function AV(e,t=null,n=null){if(t&&"object"==typeof t){if(n)throw Error(`linkifyjs: Invalid link type ${t}; must be a string`);n=t,t=null}let r=new AN(n),o=Az(e),i=[];for(let e=0;e<o.length;e++){let n=o[e];n.isLink&&(!t||n.t===t)&&r.check(n)&&i.push(n.toFormattedObject(r))}return i}Az.scan=Ax;var A$="[\0- -\u2029]",AG=new RegExp(A$),Aq=RegExp(`${A$}$`),AW=RegExp(A$,"g");function AY(e,t){let n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(e=>{let t="string"==typeof e?e:e.scheme;t&&n.push(t)}),!e||e.replace(AW,"").match(RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var AK=ll.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{"string"==typeof e?AU(e):AU(e.scheme,e.optionalSlashes)})},onDestroy(){S_.groups={},AF.scanner=null,AF.parser=null,AF.tokenQueue=[],AF.pluginQueue=[],AF.customSchemes=[],AF.initialized=!1},inclusive(){return this.options.autolink},addOptions:()=>({openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!AY(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>!!e}),addAttributes(){return{href:{default:null,parseHTML:e=>e.getAttribute("href")},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{let t=e.getAttribute("href");return!!t&&!!this.options.isAllowedUri(t,{defaultValidate:e=>!!AY(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})&&null}}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:e=>!!AY(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",sv(this.options.HTMLAttributes,e),0]:["a",sv(this.options.HTMLAttributes,{...e,href:""}),0]},markdownTokenName:"link",parseMarkdown:(e,t)=>t.applyMark("link",t.parseInline(e.tokens||[]),{href:e.href,title:e.title||null}),renderMarkdown:(e,t)=>{var n;let r=(null==(n=e.attrs)?void 0:n.href)||"",o=t.renderChildren(e);return`[${o}](${r})`},addCommands(){return{setLink:e=>({chain:t})=>{let{href:n}=e;return!!this.options.isAllowedUri(n,{defaultValidate:e=>!!AY(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})&&t().setMark(this.name,e).setMeta("preventAutolink",!0).run()},toggleLink:e=>({chain:t})=>{let{href:n}=e||{};return(!n||!!this.options.isAllowedUri(n,{defaultValidate:e=>!!AY(e,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol}))&&t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[lj({find:e=>{let t=[];if(e){let{protocols:n,defaultProtocol:r}=this.options,o=AV(e).filter(e=>e.isLink&&this.options.isAllowedUri(e.value,{defaultValidate:e=>!!AY(e,n),protocols:n,defaultProtocol:r}));o.length&&o.forEach(e=>{this.options.shouldAutoLink(e.value)&&t.push({text:e.value,data:{href:e.href},index:e.start})})}return t},type:this.type,getAttributes:e=>{var t;return{href:null==(t=e.data)?void 0:t.href}}})]},addProseMirrorPlugins(){var e,t,n;let r=[],{protocols:o,defaultProtocol:i}=this.options;return this.options.autolink&&r.push((e={type:this.type,defaultProtocol:this.options.defaultProtocol,validate:e=>this.options.isAllowedUri(e,{defaultValidate:e=>!!AY(e,o),protocols:o,defaultProtocol:i}),shouldAutoLink:this.options.shouldAutoLink},new t4({key:new t8("autolink"),appendTransaction:(t,n,r)=>{let o=t.some(e=>e.docChanged)&&!n.doc.eq(r.doc),i=t.some(e=>e.getMeta("preventAutolink"));if(!o||i)return;let{tr:s}=r;if(sM(sa(n.doc,[...t])).forEach(({newRange:t})=>{let n,o,i=sd(r.doc,t,e=>e.isTextblock);if(i.length>1)n=i[0],o=r.doc.textBetween(n.pos,n.pos+n.node.nodeSize,void 0," ");else if(i.length){let e=r.doc.textBetween(t.from,t.to," "," ");if(!Aq.test(e))return;n=i[0],o=r.doc.textBetween(n.pos,t.to,void 0," ")}if(n&&o){let t=o.split(AG).filter(Boolean);if(t.length<=0)return!1;let i=t[t.length-1],l=n.pos+o.lastIndexOf(i);if(!i)return!1;let a=Az(i).map(t=>t.toObject(e.defaultProtocol));if(!(1===a.length?a[0].isLink:3===a.length&&!!a[1].isLink&&["()","[]"].includes(a[0].value+a[2].value)))return!1;a.filter(e=>e.isLink).map(e=>({...e,from:l+e.start+1,to:l+e.end+1})).filter(e=>!r.schema.marks.code||!r.doc.rangeHasMark(e.from,e.to,r.schema.marks.code)).filter(t=>e.validate(t.value)).filter(t=>e.shouldAutoLink(t.value)).forEach(t=>{sI(t.from,t.to,r.doc).some(t=>t.mark.type===e.type)||s.addMark(t.from,t.to,e.type.create({href:t.href}))})}}),s.steps.length)return s}}))),r.push((t={type:this.type,editor:this.editor,openOnClick:"whenNotEditable"===this.options.openOnClick||this.options.openOnClick,enableClickSelection:this.options.enableClickSelection},new t4({key:new t8("handleClickLink"),props:{handleClick:(e,n,r)=>{var o,i;if(0!==r.button||!e.editable)return!1;let s=!1;if(t.enableClickSelection&&(s=t.editor.commands.extendMarkRange(t.type.name)),t.openOnClick){let n=null;if(r.target instanceof HTMLAnchorElement)n=r.target;else{let e=r.target,t=[];for(;"DIV"!==e.nodeName;)t.push(e),e=e.parentNode;n=t.find(e=>"A"===e.nodeName)}if(!n)return s;let l=sN(e.state,t.type.name),a=null!=(o=null==n?void 0:n.href)?o:l.href,c=null!=(i=null==n?void 0:n.target)?i:l.target;n&&a&&(window.open(a,c),s=!0)}return s}}}))),this.options.linkOnPaste&&r.push((n={editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type,shouldAutoLink:this.options.shouldAutoLink},new t4({key:new t8("handlePasteLink"),props:{handlePaste:(e,t,r)=>{let{shouldAutoLink:o}=n,{state:i}=e,{selection:s}=i,{empty:l}=s;if(l)return!1;let a="";r.content.forEach(e=>{a+=e.textContent});let c=AV(a,{defaultProtocol:n.defaultProtocol}).find(e=>e.isLink&&e.value===a);return!!a&&!!c&&(void 0===o||!!o(c.href))&&n.editor.commands.setMark(n.type,{href:c.href})}}}))),r}}),AZ=lB.create({name:"text",group:"inline",parseMarkdown:e=>({type:"text",text:e.text||""}),renderMarkdown:e=>e.text||""});let AX={tokenize:function(e){let t,n=e.attempt(this.parser.constructs.contentInitial,function(t){return null===t?void e.consume(t):(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),TA(e,n,"linePrefix"))},function(n){return e.enter("paragraph"),function n(r){let o=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=o),t=o,function t(r){if(null===r){e.exit("chunkText"),e.exit("paragraph"),e.consume(r);return}return Cr(r)?(e.consume(r),e.exit("chunkText"),n):(e.consume(r),t)}(r)}(n)});return n}},AQ={tokenize:function(e){let t,n,r,o=this,i=[],s=0;return l;function l(t){if(s<i.length){let n=i[s];return o.containerState=n[1],e.attempt(n[0].continuation,a,c)(t)}return c(t)}function a(e){if(s++,o.containerState._closeFlow){let n;o.containerState._closeFlow=void 0,t&&b();let r=o.events.length,i=r;for(;i--;)if("exit"===o.events[i][0]&&"chunkFlow"===o.events[i][1].type){n=o.events[i][1].end;break}g(s);let l=r;for(;l<o.events.length;)o.events[l][1].end={...n},l++;return Ta(o.events,i+1,0,o.events.slice(r)),o.events.length=l,c(e)}return l(e)}function c(n){if(s===i.length){if(!t)return h(n);if(t.currentConstruct&&t.currentConstruct.concrete)return f(n);o.interrupt=!!(t.currentConstruct&&!t._gfmTableDynamicInterruptHack)}return o.containerState={},e.check(AJ,d,u)(n)}function d(e){return t&&b(),g(s),h(e)}function u(e){return o.parser.lazy[o.now().line]=s!==i.length,r=o.now().offset,f(e)}function h(t){return o.containerState={},e.attempt(AJ,p,f)(t)}function p(e){return s++,i.push([o.currentConstruct,o.containerState]),h(e)}function f(r){if(null===r){t&&b(),g(0),e.consume(r);return}return t=t||o.parser.flow(o.now()),e.enter("chunkFlow",{_tokenizer:t,contentType:"flow",previous:n}),function t(n){if(null===n){m(e.exit("chunkFlow"),!0),g(0),e.consume(n);return}return Cr(n)?(e.consume(n),m(e.exit("chunkFlow")),s=0,o.interrupt=void 0,l):(e.consume(n),t)}(r)}function m(e,i){let l=o.sliceStream(e);if(i&&l.push(null),e.previous=n,n&&(n.next=e),n=e,t.defineSkip(e.start),t.write(l),o.parser.lazy[e.start.line]){let e,n,i=t.events.length;for(;i--;)if(t.events[i][1].start.offset<r&&(!t.events[i][1].end||t.events[i][1].end.offset>r))return;let l=o.events.length,a=l;for(;a--;)if("exit"===o.events[a][0]&&"chunkFlow"===o.events[a][1].type){if(e){n=o.events[a][1].end;break}e=!0}for(g(s),i=l;i<o.events.length;)o.events[i][1].end={...n},i++;Ta(o.events,a+1,0,o.events.slice(l)),o.events.length=i}}function g(t){let n=i.length;for(;n-- >t;){let t=i[n];o.containerState=t[1],t[0].exit.call(o,e)}i.length=t}function b(){t.write([null]),n=void 0,t=void 0,o.containerState._closeFlow=void 0}}},AJ={tokenize:function(e,t,n){return TA(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}};class A0{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,t){let n=null==t?1/0:t;return n<this.left.length?this.left.slice(e,n):e>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(e,t,n){this.setCursor(Math.trunc(e));let r=this.right.splice(this.right.length-(t||0),1/0);return n&&A1(this.left,n),r.reverse()}pop(){return this.setCursor(1/0),this.left.pop()}push(e){this.setCursor(1/0),this.left.push(e)}pushMany(e){this.setCursor(1/0),A1(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),A1(this.right,e.reverse())}setCursor(e){if(e!==this.left.length&&(!(e>this.left.length)||0!==this.right.length)&&(!(e<0)||0!==this.left.length))if(e<this.left.length){let t=this.left.splice(e,1/0);A1(this.right,t.reverse())}else{let t=this.right.splice(this.left.length+this.right.length-e,1/0);A1(this.left,t.reverse())}}}function A1(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function A2(e){let t,n,r,o,i,s,l,a={},c=-1,d=new A0(e);for(;++c<d.length;){for(;c in a;)c=a[c];if(t=d.get(c),c&&"chunkFlow"===t[1].type&&"listItemPrefix"===d.get(c-1)[1].type&&((r=0)<(s=t[1]._tokenizer.events).length&&"lineEndingBlank"===s[r][1].type&&(r+=2),r<s.length&&"content"===s[r][1].type))for(;++r<s.length&&"content"!==s[r][1].type;)"chunkText"===s[r][1].type&&(s[r][1]._isInFirstContentOfListItem=!0,r++);if("enter"===t[0])t[1].contentType&&(Object.assign(a,function(e,t){let n,r,o=e.get(t)[1],i=e.get(t)[2],s=t-1,l=[],a=o._tokenizer;!a&&(a=i.parser[o.contentType](o.start),o._contentTypeTextTrailing&&(a._contentTypeTextTrailing=!0));let c=a.events,d=[],u={},h=-1,p=o,f=0,m=0,g=[0];for(;p;){for(;e.get(++s)[1]!==p;);l.push(s),!p._tokenizer&&(n=i.sliceStream(p),p.next||n.push(null),r&&a.defineSkip(p.start),p._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(n),p._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),r=p,p=p.next}for(p=o;++h<c.length;)"exit"===c[h][0]&&"enter"===c[h-1][0]&&c[h][1].type===c[h-1][1].type&&c[h][1].start.line!==c[h][1].end.line&&(m=h+1,g.push(m),p._tokenizer=void 0,p.previous=void 0,p=p.next);for(a.events=[],p?(p._tokenizer=void 0,p.previous=void 0):g.pop(),h=g.length;h--;){let t=c.slice(g[h],g[h+1]),n=l.pop();d.push([n,n+t.length-1]),e.splice(n,2,t)}for(d.reverse(),h=-1;++h<d.length;)u[f+d[h][0]]=f+d[h][1],f+=d[h][1]-d[h][0]-1;return u}(d,c)),c=a[c],l=!0);else if(t[1]._container){for(r=c,n=void 0;r--;)if("lineEnding"===(o=d.get(r))[1].type||"lineEndingBlank"===o[1].type)"enter"===o[0]&&(n&&(d.get(n)[1].type="lineEndingBlank"),o[1].type="lineEnding",n=r);else if("linePrefix"===o[1].type||"listItemIndent"===o[1].type);else break;n&&(t[1].end={...d.get(n)[1].start},(i=d.slice(n,c)).unshift(t),d.splice(n,c-n+1,i))}}return Ta(e,0,1/0,d.slice(0)),!l}let A4={resolve:function(e){return A2(e),e},tokenize:function(e,t){let n;return function(t){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),r(t)};function r(t){return null===t?o(t):Cr(t)?e.check(A5,i,o)(t):(e.consume(t),r)}function o(n){return e.exit("chunkContent"),e.exit("content"),t(n)}function i(t){return e.consume(t),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,r}}},A5={partial:!0,tokenize:function(e,t,n){let r=this;return function(t){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),TA(e,o,"linePrefix")};function o(o){if(null===o||Cr(o))return n(o);let i=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&i&&"linePrefix"===i[1].type&&i[2].sliceSerialize(i[1],!0).length>=4?t(o):e.interrupt(r.parser.constructs.flow,n,t)(o)}}},A3={tokenize:function(e){let t=this,n=e.attempt(T_,function(r){return null===r?void e.consume(r):(e.enter("lineEndingBlank"),e.consume(r),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n)},e.attempt(this.parser.constructs.flowInitial,r,TA(e,e.attempt(this.parser.constructs.flow,r,e.attempt(A4,r)),"linePrefix")));return n;function r(r){return null===r?void e.consume(r):(e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),t.currentConstruct=void 0,n)}}},A8={resolveAll:_e()},A6=A7("string"),A9=A7("text");function A7(e){return{resolveAll:_e("text"===e?_t:void 0),tokenize:function(t){let n=this,r=this.parser.constructs[e],o=t.attempt(r,i,s);return i;function i(e){return a(e)?o(e):s(e)}function s(e){return null===e?void t.consume(e):(t.enter("data"),t.consume(e),l)}function l(e){return a(e)?(t.exit("data"),o(e)):(t.consume(e),l)}function a(e){if(null===e)return!0;let t=r[e],o=-1;if(t)for(;++o<t.length;){let e=t[o];if(!e.previous||e.previous.call(n,n.previous))return!0}return!1}}}}function _e(e){return function(t,n){let r,o=-1;for(;++o<=t.length;)void 0===r?t[o]&&"data"===t[o][1].type&&(r=o,o++):t[o]&&"data"===t[o][1].type||(o!==r+2&&(t[r][1].end=t[o-1][1].end,t.splice(r+2,o-r-2),o=r+2),r=void 0);return e?e(t,n):t}}function _t(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||"lineEnding"===e[n][1].type)&&"data"===e[n-1][1].type){let r,o=e[n-1][1],i=t.sliceStream(o),s=i.length,l=-1,a=0;for(;s--;){let e=i[s];if("string"==typeof e){for(l=e.length;32===e.charCodeAt(l-1);)a++,l--;if(l)break;l=-1}else if(-2===e)r=!0,a++;else if(-1===e);else{s++;break}}if(t._contentTypeTextTrailing&&n===e.length&&(a=0),a){let i={type:n===e.length||r||a<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?l:o.start._bufferIndex+l,_index:o.start._index+s,line:o.end.line,column:o.end.column-a,offset:o.end.offset-a},end:{...o.end}};o.end={...i.start},o.start.offset===o.end.offset?Object.assign(o,i):(e.splice(n,0,["enter",i,t],["exit",i,t]),n+=2)}n++}return e}let _n={name:"attention",resolveAll:function(e,t){let n,r,o,i,s,l,a,c,d=-1;for(;++d<e.length;)if("enter"===e[d][0]&&"attentionSequence"===e[d][1].type&&e[d][1]._close){for(n=d;n--;)if("exit"===e[n][0]&&"attentionSequence"===e[n][1].type&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[d][1]).charCodeAt(0)){if((e[n][1]._close||e[d][1]._open)&&(e[d][1].end.offset-e[d][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[d][1].end.offset-e[d][1].start.offset)%3))continue;l=e[n][1].end.offset-e[n][1].start.offset>1&&e[d][1].end.offset-e[d][1].start.offset>1?2:1;let u={...e[n][1].end},h={...e[d][1].start};_r(u,-l),_r(h,l),i={type:l>1?"strongSequence":"emphasisSequence",start:u,end:{...e[n][1].end}},s={type:l>1?"strongSequence":"emphasisSequence",start:{...e[d][1].start},end:h},o={type:l>1?"strongText":"emphasisText",start:{...e[n][1].end},end:{...e[d][1].start}},r={type:l>1?"strong":"emphasis",start:{...i.start},end:{...s.end}},e[n][1].end={...i.start},e[d][1].start={...s.end},a=[],e[n][1].end.offset-e[n][1].start.offset&&(a=Tc(a,[["enter",e[n][1],t],["exit",e[n][1],t]])),a=Tc(a,[["enter",r,t],["enter",i,t],["exit",i,t],["enter",o,t]]),a=Tc(a,TP(t.parser.constructs.insideSpan.null,e.slice(n+1,d),t)),a=Tc(a,[["exit",o,t],["enter",s,t],["exit",s,t],["exit",r,t]]),e[d][1].end.offset-e[d][1].start.offset?(c=2,a=Tc(a,[["enter",e[d][1],t],["exit",e[d][1],t]])):c=0,Ta(e,n-1,d-n+3,a),d=n+a.length-c-2;break}}for(d=-1;++d<e.length;)"attentionSequence"===e[d][1].type&&(e[d][1].type="data");return e},tokenize:function(e,t){let n,r=this.parser.constructs.attentionMarkers.null,o=this.previous,i=CW(o);return function(s){return n=s,e.enter("attentionSequence"),function s(l){if(l===n)return e.consume(l),s;let a=e.exit("attentionSequence"),c=CW(l),d=!c||2===c&&i||r.includes(l),u=!i||2===i&&c||r.includes(o);return a._open=!!(42===n?d:d&&(i||!u)),a._close=!!(42===n?u:u&&(c||!d)),t(l)}(s)}}};function _r(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}let _o={continuation:{tokenize:function(e,t,n){let r=this;return function(t){return Ci(t)?TA(e,o,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):o(t)};function o(r){return e.attempt(_o,t,n)(r)}}},exit:function(e){e.exit("blockQuote")},name:"blockQuote",tokenize:function(e,t,n){let r=this;return function(t){if(62===t){let n=r.containerState;return n.open||(e.enter("blockQuote",{_container:!0}),n.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),o}return n(t)};function o(n){return Ci(n)?(e.enter("blockQuotePrefixWhitespace"),e.consume(n),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(n))}}},_i={name:"characterEscape",tokenize:function(e,t,n){return function(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),r};function r(r){return Cn(r)?(e.enter("characterEscapeValue"),e.consume(r),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(r)}}},_s={name:"characterReference",tokenize:function(e,t,n){let r,o,i=this,s=0;return function(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),l};function l(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),a):(e.enter("characterReferenceValue"),r=31,o=k6,c(t))}function a(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),r=6,o=Ct,c):(e.enter("characterReferenceValue"),r=7,o=Ce,c(t))}function c(l){if(59===l&&s){let r=e.exit("characterReferenceValue");return o!==k6||T0(i.sliceSerialize(r))?(e.enter("characterReferenceMarker"),e.consume(l),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):n(l)}return o(l)&&s++<r?(e.consume(l),c):n(l)}}},_l={partial:!0,tokenize:function(e,t,n){let r=this;return function(t){return null===t?n(t):(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),o)};function o(e){return r.parser.lazy[r.now().line]?n(e):t(e)}}},_a={concrete:!0,name:"codeFenced",tokenize:function(e,t,n){let r,o=this,i={partial:!0,tokenize:function(e,t,n){let i=0;return function(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),s};function s(t){return e.enter("codeFencedFence"),Ci(t)?TA(e,a,"linePrefix",o.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):a(t)}function a(t){return t===r?(e.enter("codeFencedFenceSequence"),function t(o){return o===r?(i++,e.consume(o),t):i>=l?(e.exit("codeFencedFenceSequence"),Ci(o)?TA(e,c,"whitespace")(o):c(o)):n(o)}(t)):n(t)}function c(r){return null===r||Cr(r)?(e.exit("codeFencedFence"),t(r)):n(r)}}},s=0,l=0;return function(t){var i;let c;return i=t,s=(c=o.events[o.events.length-1])&&"linePrefix"===c[1].type?c[2].sliceSerialize(c[1],!0).length:0,r=i,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),function t(o){return o===r?(l++,e.consume(o),t):l<3?n(o):(e.exit("codeFencedFenceSequence"),Ci(o)?TA(e,a,"whitespace")(o):a(o))}(i)};function a(i){return null===i||Cr(i)?(e.exit("codeFencedFence"),o.interrupt?t(i):e.check(_l,d,f)(i)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),function t(o){return null===o||Cr(o)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),a(o)):Ci(o)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),TA(e,c,"whitespace")(o)):96===o&&o===r?n(o):(e.consume(o),t)}(i))}function c(t){return null===t||Cr(t)?a(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),function t(o){return null===o||Cr(o)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),a(o)):96===o&&o===r?n(o):(e.consume(o),t)}(t))}function d(t){return e.attempt(i,f,u)(t)}function u(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),h}function h(t){return s>0&&Ci(t)?TA(e,p,"linePrefix",s+1)(t):p(t)}function p(t){return null===t||Cr(t)?e.check(_l,d,f)(t):(e.enter("codeFlowValue"),function t(n){return null===n||Cr(n)?(e.exit("codeFlowValue"),p(n)):(e.consume(n),t)}(t))}function f(n){return e.exit("codeFenced"),t(n)}}},_c={name:"codeIndented",tokenize:function(e,t,n){let r=this;return function(t){return e.enter("codeIndented"),TA(e,o,"linePrefix",5)(t)};function o(t){let o=r.events[r.events.length-1];return o&&"linePrefix"===o[1].type&&o[2].sliceSerialize(o[1],!0).length>=4?function t(n){return null===n?i(n):Cr(n)?e.attempt(_d,t,i)(n):(e.enter("codeFlowValue"),function n(r){return null===r||Cr(r)?(e.exit("codeFlowValue"),t(r)):(e.consume(r),n)}(n))}(t):n(t)}function i(n){return e.exit("codeIndented"),t(n)}}},_d={partial:!0,tokenize:function(e,t,n){let r=this;return o;function o(t){return r.parser.lazy[r.now().line]?n(t):Cr(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),o):TA(e,i,"linePrefix",5)(t)}function i(e){let i=r.events[r.events.length-1];return i&&"linePrefix"===i[1].type&&i[2].sliceSerialize(i[1],!0).length>=4?t(e):Cr(e)?o(e):n(e)}}};function _u(e,t,n,r,o,i,s,l,a){let c=a||1/0,d=0;return function(t){return 60===t?(e.enter(r),e.enter(o),e.enter(i),e.consume(t),e.exit(i),u):null===t||32===t||41===t||k7(t)?n(t):(e.enter(r),e.enter(s),e.enter(l),e.enter("chunkString",{contentType:"string"}),f(t))};function u(n){return 62===n?(e.enter(i),e.consume(n),e.exit(i),e.exit(o),e.exit(r),t):(e.enter(l),e.enter("chunkString",{contentType:"string"}),h(n))}function h(t){return 62===t?(e.exit("chunkString"),e.exit(l),u(t)):null===t||60===t||Cr(t)?n(t):(e.consume(t),92===t?p:h)}function p(t){return 60===t||62===t||92===t?(e.consume(t),h):h(t)}function f(o){return!d&&(null===o||41===o||Co(o))?(e.exit("chunkString"),e.exit(l),e.exit(s),e.exit(r),t(o)):d<c&&40===o?(e.consume(o),d++,f):41===o?(e.consume(o),d--,f):null===o||32===o||40===o||k7(o)?n(o):(e.consume(o),92===o?m:f)}function m(t){return 40===t||41===t||92===t?(e.consume(t),f):f(t)}}function _h(e,t,n,r,o,i){let s,l=this,a=0;return function(t){return e.enter(r),e.enter(o),e.consume(t),e.exit(o),e.enter(i),c};function c(u){return a>999||null===u||91===u||93===u&&!s||94===u&&!a&&"_hiddenFootnoteSupport"in l.parser.constructs?n(u):93===u?(e.exit(i),e.enter(o),e.consume(u),e.exit(o),e.exit(r),t):Cr(u)?(e.enter("lineEnding"),e.consume(u),e.exit("lineEnding"),c):(e.enter("chunkString",{contentType:"string"}),d(u))}function d(t){return null===t||91===t||93===t||Cr(t)||a++>999?(e.exit("chunkString"),c(t)):(e.consume(t),s||(s=!Ci(t)),92===t?u:d)}function u(t){return 91===t||92===t||93===t?(e.consume(t),a++,d):d(t)}}function _p(e,t,n,r,o,i){let s;return function(t){return 34===t||39===t||40===t?(e.enter(r),e.enter(o),e.consume(t),e.exit(o),s=40===t?41:t,l):n(t)};function l(n){return n===s?(e.enter(o),e.consume(n),e.exit(o),e.exit(r),t):(e.enter(i),a(n))}function a(t){return t===s?(e.exit(i),l(s)):null===t?n(t):Cr(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),TA(e,a,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),c(t))}function c(t){return t===s||null===t||Cr(t)?(e.exit("chunkString"),a(t)):(e.consume(t),92===t?d:c)}function d(t){return t===s||92===t?(e.consume(t),c):c(t)}}function _f(e,t){let n;return function r(o){return Cr(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n=!0,r):Ci(o)?TA(e,r,n?"linePrefix":"lineSuffix")(o):t(o)}}let _m={partial:!0,tokenize:function(e,t,n){return function(t){return Co(t)?_f(e,r)(t):n(t)};function r(t){return _p(e,o,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(t)}function o(t){return Ci(t)?TA(e,i,"whitespace")(t):i(t)}function i(e){return null===e||Cr(e)?t(e):n(e)}}},_g=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],_b=["pre","script","style","textarea"],_y={partial:!0,tokenize:function(e,t,n){return function(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),e.attempt(T_,t,n)}}},_v={partial:!0,tokenize:function(e,t,n){let r=this;return function(t){return Cr(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),o):n(t)};function o(e){return r.parser.lazy[r.now().line]?n(e):t(e)}}},_E={name:"labelEnd",resolveAll:function(e){let t=-1,n=[];for(;++t<e.length;){let r=e[t][1];if(n.push(e[t]),"labelImage"===r.type||"labelLink"===r.type||"labelEnd"===r.type){let e="labelImage"===r.type?4:2;r.type="data",t+=e}}return e.length!==n.length&&Ta(e,0,e.length,n),e},resolveTo:function(e,t){let n,r,o,i,s=e.length,l=0;for(;s--;)if(n=e[s][1],r){if("link"===n.type||"labelLink"===n.type&&n._inactive)break;"enter"===e[s][0]&&"labelLink"===n.type&&(n._inactive=!0)}else if(o){if("enter"===e[s][0]&&("labelImage"===n.type||"labelLink"===n.type)&&!n._balanced&&(r=s,"labelLink"!==n.type)){l=2;break}}else"labelEnd"===n.type&&(o=s);let a={type:"labelLink"===e[r][1].type?"link":"image",start:{...e[r][1].start},end:{...e[e.length-1][1].end}},c={type:"label",start:{...e[r][1].start},end:{...e[o][1].end}},d={type:"labelText",start:{...e[r+l+2][1].end},end:{...e[o-2][1].start}};return i=Tc(i=[["enter",a,t],["enter",c,t]],e.slice(r+1,r+l+3)),i=Tc(i,[["enter",d,t]]),i=Tc(i,TP(t.parser.constructs.insideSpan.null,e.slice(r+l+4,o-3),t)),i=Tc(i,[["exit",d,t],e[o-2],e[o-1],["exit",c,t]]),i=Tc(i,e.slice(o+1)),i=Tc(i,[["exit",a,t]]),Ta(e,r,e.length,i),e},tokenize:function(e,t,n){let r,o,i=this,s=i.events.length;for(;s--;)if(("labelImage"===i.events[s][1].type||"labelLink"===i.events[s][1].type)&&!i.events[s][1]._balanced){r=i.events[s][1];break}return function(t){return r?r._inactive?d(t):(o=i.parser.defined.includes(Ck(i.sliceSerialize({start:r.end,end:i.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),l):n(t)};function l(t){return 40===t?e.attempt(_k,c,o?c:d)(t):91===t?e.attempt(_C,c,o?a:d)(t):o?c(t):d(t)}function a(t){return e.attempt(_T,c,d)(t)}function c(e){return t(e)}function d(e){return r._balanced=!0,n(e)}}},_k={tokenize:function(e,t,n){return function(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),r};function r(t){return Co(t)?_f(e,o)(t):o(t)}function o(t){return 41===t?c(t):_u(e,i,s,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(t)}function i(t){return Co(t)?_f(e,l)(t):c(t)}function s(e){return n(e)}function l(t){return 34===t||39===t||40===t?_p(e,a,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):c(t)}function a(t){return Co(t)?_f(e,c)(t):c(t)}function c(r){return 41===r?(e.enter("resourceMarker"),e.consume(r),e.exit("resourceMarker"),e.exit("resource"),t):n(r)}}},_C={tokenize:function(e,t,n){let r=this;return function(t){return _h.call(r,e,o,i,"reference","referenceMarker","referenceString")(t)};function o(e){return r.parser.defined.includes(Ck(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(e):n(e)}function i(e){return n(e)}}},_T={tokenize:function(e,t,n){return function(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),r};function r(r){return 93===r?(e.enter("referenceMarker"),e.consume(r),e.exit("referenceMarker"),e.exit("reference"),t):n(r)}}},_w={name:"labelStartImage",resolveAll:_E.resolveAll,tokenize:function(e,t,n){let r=this;return function(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),o};function o(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),i):n(t)}function i(e){return 94===e&&"_hiddenFootnoteSupport"in r.parser.constructs?n(e):t(e)}}},_x={name:"labelStartLink",resolveAll:_E.resolveAll,tokenize:function(e,t,n){let r=this;return function(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),o};function o(e){return 94===e&&"_hiddenFootnoteSupport"in r.parser.constructs?n(e):t(e)}}},_S={name:"lineEnding",tokenize:function(e,t){return function(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),TA(e,t,"linePrefix")}}},_A={name:"thematicBreak",tokenize:function(e,t,n){let r,o=0;return function(i){var s;return e.enter("thematicBreak"),r=s=i,function i(s){return s===r?(e.enter("thematicBreakSequence"),function t(n){return n===r?(e.consume(n),o++,t):(e.exit("thematicBreakSequence"),Ci(n)?TA(e,i,"whitespace")(n):i(n))}(s)):o>=3&&(null===s||Cr(s))?(e.exit("thematicBreak"),t(s)):n(s)}(s)}}},__={continuation:{tokenize:function(e,t,n){let r=this;return r.containerState._closeFlow=void 0,e.check(T_,function(n){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,TA(e,t,"listItemIndent",r.containerState.size+1)(n)},function(n){return r.containerState.furtherBlankLines||!Ci(n)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(n)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(_M,t,o)(n))});function o(o){return r.containerState._closeFlow=!0,r.interrupt=void 0,TA(e,e.attempt(__,t,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o)}}},exit:function(e){e.exit(this.containerState.type)},name:"list",tokenize:function(e,t,n){let r=this,o=r.events[r.events.length-1],i=o&&"linePrefix"===o[1].type?o[2].sliceSerialize(o[1],!0).length:0,s=0;return function(t){let o=r.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===o?!r.containerState.marker||t===r.containerState.marker:Ce(t)){if(r.containerState.type||(r.containerState.type=o,e.enter(o,{_container:!0})),"listUnordered"===o)return e.enter("listItemPrefix"),42===t||45===t?e.check(_A,n,l)(t):l(t);if(!r.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),function t(o){return Ce(o)&&++s<10?(e.consume(o),t):(!r.interrupt||s<2)&&(r.containerState.marker?o===r.containerState.marker:41===o||46===o)?(e.exit("listItemValue"),l(o)):n(o)}(t)}return n(t)};function l(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||t,e.check(T_,r.interrupt?n:a,e.attempt(_N,d,c))}function a(e){return r.containerState.initialBlankLine=!0,i++,d(e)}function c(t){return Ci(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),d):n(t)}function d(n){return r.containerState.size=i+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(n)}}},_N={partial:!0,tokenize:function(e,t,n){let r=this;return TA(e,function(e){let o=r.events[r.events.length-1];return!Ci(e)&&o&&"listItemPrefixWhitespace"===o[1].type?t(e):n(e)},"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5)}},_M={partial:!0,tokenize:function(e,t,n){let r=this;return TA(e,function(e){let o=r.events[r.events.length-1];return o&&"listItemIndent"===o[1].type&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?t(e):n(e)},"listItemIndent",r.containerState.size+1)}},_I={name:"setextUnderline",resolveTo:function(e,t){let n,r,o,i=e.length;for(;i--;)if("enter"===e[i][0]){if("content"===e[i][1].type){n=i;break}"paragraph"===e[i][1].type&&(r=i)}else"content"===e[i][1].type&&e.splice(i,1),o||"definition"!==e[i][1].type||(o=i);let s={type:"setextHeading",start:{...e[n][1].start},end:{...e[e.length-1][1].end}};return e[r][1].type="setextHeadingText",o?(e.splice(r,0,["enter",s,t]),e.splice(o+1,0,["exit",e[n][1],t]),e[n][1].end={...e[o][1].end}):e[n][1]=s,e.push(["exit",s,t]),e},tokenize:function(e,t,n){let r,o=this;return function(t){var s;let l,a=o.events.length;for(;a--;)if("lineEnding"!==o.events[a][1].type&&"linePrefix"!==o.events[a][1].type&&"content"!==o.events[a][1].type){l="paragraph"===o.events[a][1].type;break}return!o.parser.lazy[o.now().line]&&(o.interrupt||l)?(e.enter("setextHeadingLine"),r=t,s=t,e.enter("setextHeadingLineSequence"),function t(n){return n===r?(e.consume(n),t):(e.exit("setextHeadingLineSequence"),Ci(n)?TA(e,i,"lineSuffix")(n):i(n))}(s)):n(t)};function i(r){return null===r||Cr(r)?(e.exit("setextHeadingLine"),t(r)):n(r)}}};e.s(["attentionMarkers",0,{null:[42,95]},"contentInitial",0,{91:{name:"definition",tokenize:function(e,t,n){let r,o=this;return function(t){var r;return e.enter("definition"),r=t,_h.call(o,e,i,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(r)};function i(t){return(r=Ck(o.sliceSerialize(o.events[o.events.length-1][1]).slice(1,-1)),58===t)?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),s):n(t)}function s(t){return Co(t)?_f(e,l)(t):l(t)}function l(t){return _u(e,a,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(t)}function a(t){return e.attempt(_m,c,c)(t)}function c(t){return Ci(t)?TA(e,d,"whitespace")(t):d(t)}function d(i){return null===i||Cr(i)?(e.exit("definition"),o.parser.defined.push(r),t(i)):n(i)}}}},"disable",0,{null:[]},"document",0,{42:__,43:__,45:__,48:__,49:__,50:__,51:__,52:__,53:__,54:__,55:__,56:__,57:__,62:_o},"flow",0,{35:{name:"headingAtx",resolve:function(e,t){let n,r,o=e.length-2,i=3;return"whitespace"===e[3][1].type&&(i+=2),o-2>i&&"whitespace"===e[o][1].type&&(o-=2),"atxHeadingSequence"===e[o][1].type&&(i===o-1||o-4>i&&"whitespace"===e[o-2][1].type)&&(o-=i+1===o?2:4),o>i&&(n={type:"atxHeadingText",start:e[i][1].start,end:e[o][1].end},r={type:"chunkText",start:e[i][1].start,end:e[o][1].end,contentType:"text"},Ta(e,i,o-i+1,[["enter",n,t],["enter",r,t],["exit",r,t],["exit",n,t]])),e},tokenize:function(e,t,n){let r=0;return function(o){var i;return e.enter("atxHeading"),i=o,e.enter("atxHeadingSequence"),function o(i){return 35===i&&r++<6?(e.consume(i),o):null===i||Co(i)?(e.exit("atxHeadingSequence"),function n(r){return 35===r?(e.enter("atxHeadingSequence"),function t(r){return 35===r?(e.consume(r),t):(e.exit("atxHeadingSequence"),n(r))}(r)):null===r||Cr(r)?(e.exit("atxHeading"),t(r)):Ci(r)?TA(e,n,"whitespace")(r):(e.enter("atxHeadingText"),function t(r){return null===r||35===r||Co(r)?(e.exit("atxHeadingText"),n(r)):(e.consume(r),t)}(r))}(i)):n(i)}(i)}}},42:_A,45:[_I,_A],60:{concrete:!0,name:"htmlFlow",resolveTo:function(e){let t=e.length;for(;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););return t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e},tokenize:function(e,t,n){let r,o,i,s,l,a=this;return function(t){var n;return n=t,e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(n),c};function c(s){return 33===s?(e.consume(s),d):47===s?(e.consume(s),o=!0,p):63===s?(e.consume(s),r=3,a.interrupt?t:O):k8(s)?(e.consume(s),i=String.fromCharCode(s),f):n(s)}function d(o){return 45===o?(e.consume(o),r=2,u):91===o?(e.consume(o),r=5,s=0,h):k8(o)?(e.consume(o),r=4,a.interrupt?t:O):n(o)}function u(r){return 45===r?(e.consume(r),a.interrupt?t:O):n(r)}function h(r){let o="CDATA[";return r===o.charCodeAt(s++)?(e.consume(r),s===o.length)?a.interrupt?t:w:h:n(r)}function p(t){return k8(t)?(e.consume(t),i=String.fromCharCode(t),f):n(t)}function f(s){if(null===s||47===s||62===s||Co(s)){let l=47===s,c=i.toLowerCase();return!l&&!o&&_b.includes(c)?(r=1,a.interrupt?t(s):w(s)):_g.includes(i.toLowerCase())?(r=6,l)?(e.consume(s),m):a.interrupt?t(s):w(s):(r=7,a.interrupt&&!a.parser.lazy[a.now().line]?n(s):o?function t(n){return Ci(n)?(e.consume(n),t):C(n)}(s):g(s))}return 45===s||k6(s)?(e.consume(s),i+=String.fromCharCode(s),f):n(s)}function m(r){return 62===r?(e.consume(r),a.interrupt?t:w):n(r)}function g(t){return 47===t?(e.consume(t),C):58===t||95===t||k8(t)?(e.consume(t),b):Ci(t)?(e.consume(t),g):C(t)}function b(t){return 45===t||46===t||58===t||95===t||k6(t)?(e.consume(t),b):y(t)}function y(t){return 61===t?(e.consume(t),v):Ci(t)?(e.consume(t),y):g(t)}function v(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),l=t,E):Ci(t)?(e.consume(t),v):function t(n){return null===n||34===n||39===n||47===n||60===n||61===n||62===n||96===n||Co(n)?y(n):(e.consume(n),t)}(t)}function E(t){return t===l?(e.consume(t),l=null,k):null===t||Cr(t)?n(t):(e.consume(t),E)}function k(e){return 47===e||62===e||Ci(e)?g(e):n(e)}function C(t){return 62===t?(e.consume(t),T):n(t)}function T(t){return null===t||Cr(t)?w(t):Ci(t)?(e.consume(t),T):n(t)}function w(t){return 45===t&&2===r?(e.consume(t),_):60===t&&1===r?(e.consume(t),N):62===t&&4===r?(e.consume(t),D):63===t&&3===r?(e.consume(t),O):93===t&&5===r?(e.consume(t),I):Cr(t)&&(6===r||7===r)?(e.exit("htmlFlowData"),e.check(_y,R,x)(t)):null===t||Cr(t)?(e.exit("htmlFlowData"),x(t)):(e.consume(t),w)}function x(t){return e.check(_v,S,R)(t)}function S(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),A}function A(t){return null===t||Cr(t)?x(t):(e.enter("htmlFlowData"),w(t))}function _(t){return 45===t?(e.consume(t),O):w(t)}function N(t){return 47===t?(e.consume(t),i="",M):w(t)}function M(t){if(62===t){let n=i.toLowerCase();return _b.includes(n)?(e.consume(t),D):w(t)}return k8(t)&&i.length<8?(e.consume(t),i+=String.fromCharCode(t),M):w(t)}function I(t){return 93===t?(e.consume(t),O):w(t)}function O(t){return 62===t?(e.consume(t),D):45===t&&2===r?(e.consume(t),O):w(t)}function D(t){return null===t||Cr(t)?(e.exit("htmlFlowData"),R(t)):(e.consume(t),D)}function R(n){return e.exit("htmlFlow"),t(n)}}},61:_I,95:_A,96:_a,126:_a},"flowInitial",0,{[-2]:_c,[-1]:_c,32:_c},"insideSpan",0,{null:[_n,A8]},"string",0,{38:_s,92:_i},"text",0,{[-5]:_S,[-4]:_S,[-3]:_S,33:_w,38:_s,42:_n,60:[{name:"autolink",tokenize:function(e,t,n){let r=0;return function(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),o};function o(t){return k8(t)?(e.consume(t),i):64===t?n(t):l(t)}function i(t){return 43===t||45===t||46===t||k6(t)?(r=1,function t(n){return 58===n?(e.consume(n),r=0,s):(43===n||45===n||46===n||k6(n))&&r++<32?(e.consume(n),t):(r=0,l(n))}(t)):l(t)}function s(r){return 62===r?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(r),e.exit("autolinkMarker"),e.exit("autolink"),t):null===r||32===r||60===r||k7(r)?n(r):(e.consume(r),s)}function l(t){return 64===t?(e.consume(t),a):k9(t)?(e.consume(t),l):n(t)}function a(o){return k6(o)?function o(i){return 46===i?(e.consume(i),r=0,a):62===i?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(i),e.exit("autolinkMarker"),e.exit("autolink"),t):function t(i){if((45===i||k6(i))&&r++<63){let n=45===i?t:o;return e.consume(i),n}return n(i)}(i)}(o):n(o)}}},{name:"htmlText",tokenize:function(e,t,n){let r,o,i,s=this;return function(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),l};function l(t){return 33===t?(e.consume(t),a):47===t?(e.consume(t),E):63===t?(e.consume(t),y):k8(t)?(e.consume(t),C):n(t)}function a(t){return 45===t?(e.consume(t),c):91===t?(e.consume(t),o=0,p):k8(t)?(e.consume(t),b):n(t)}function c(t){return 45===t?(e.consume(t),h):n(t)}function d(t){return null===t?n(t):45===t?(e.consume(t),u):Cr(t)?(i=d,M(t)):(e.consume(t),d)}function u(t){return 45===t?(e.consume(t),h):d(t)}function h(e){return 62===e?N(e):45===e?u(e):d(e)}function p(t){let r="CDATA[";return t===r.charCodeAt(o++)?(e.consume(t),o===r.length?f:p):n(t)}function f(t){return null===t?n(t):93===t?(e.consume(t),m):Cr(t)?(i=f,M(t)):(e.consume(t),f)}function m(t){return 93===t?(e.consume(t),g):f(t)}function g(t){return 62===t?N(t):93===t?(e.consume(t),g):f(t)}function b(t){return null===t||62===t?N(t):Cr(t)?(i=b,M(t)):(e.consume(t),b)}function y(t){return null===t?n(t):63===t?(e.consume(t),v):Cr(t)?(i=y,M(t)):(e.consume(t),y)}function v(e){return 62===e?N(e):y(e)}function E(t){return k8(t)?(e.consume(t),k):n(t)}function k(t){return 45===t||k6(t)?(e.consume(t),k):function t(n){return Cr(n)?(i=t,M(n)):Ci(n)?(e.consume(n),t):N(n)}(t)}function C(t){return 45===t||k6(t)?(e.consume(t),C):47===t||62===t||Co(t)?T(t):n(t)}function T(t){return 47===t?(e.consume(t),N):58===t||95===t||k8(t)?(e.consume(t),w):Cr(t)?(i=T,M(t)):Ci(t)?(e.consume(t),T):N(t)}function w(t){return 45===t||46===t||58===t||95===t||k6(t)?(e.consume(t),w):function t(n){return 61===n?(e.consume(n),x):Cr(n)?(i=t,M(n)):Ci(n)?(e.consume(n),t):T(n)}(t)}function x(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),r=t,S):Cr(t)?(i=x,M(t)):Ci(t)?(e.consume(t),x):(e.consume(t),A)}function S(t){return t===r?(e.consume(t),r=void 0,_):null===t?n(t):Cr(t)?(i=S,M(t)):(e.consume(t),S)}function A(t){return null===t||34===t||39===t||60===t||61===t||96===t?n(t):47===t||62===t||Co(t)?T(t):(e.consume(t),A)}function _(e){return 47===e||62===e||Co(e)?T(e):n(e)}function N(r){return 62===r?(e.consume(r),e.exit("htmlTextData"),e.exit("htmlText"),t):n(r)}function M(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),I}function I(t){return Ci(t)?TA(e,O,"linePrefix",s.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):O(t)}function O(t){return e.enter("htmlTextData"),i(t)}}}],91:_x,92:[{name:"hardBreakEscape",tokenize:function(e,t,n){return function(t){return e.enter("hardBreakEscape"),e.consume(t),r};function r(r){return Cr(r)?(e.exit("hardBreakEscape"),t(r)):n(r)}}},_i],93:_E,95:_n,96:{name:"codeText",previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type},resolve:function(e){let t,n,r=e.length-4,o=3;if(("lineEnding"===e[3][1].type||"space"===e[o][1].type)&&("lineEnding"===e[r][1].type||"space"===e[r][1].type)){for(t=o;++t<r;)if("codeTextData"===e[t][1].type){e[o][1].type="codeTextPadding",e[r][1].type="codeTextPadding",o+=2,r-=2;break}}for(t=o-1,r++;++t<=r;)void 0===n?t!==r&&"lineEnding"!==e[t][1].type&&(n=t):(t===r||"lineEnding"===e[t][1].type)&&(e[n][1].type="codeTextData",t!==n+2&&(e[n][1].end=e[t-1][1].end,e.splice(n+2,t-n-2),r-=t-n-2,t=n+2),n=void 0);return e},tokenize:function(e,t,n){let r,o,i=0;return function(t){return e.enter("codeText"),e.enter("codeTextSequence"),function t(n){return 96===n?(e.consume(n),i++,t):(e.exit("codeTextSequence"),s(n))}(t)};function s(a){return null===a?n(a):32===a?(e.enter("space"),e.consume(a),e.exit("space"),s):96===a?(o=e.enter("codeTextSequence"),r=0,function n(s){return 96===s?(e.consume(s),r++,n):r===i?(e.exit("codeTextSequence"),e.exit("codeText"),t(s)):(o.type="codeTextData",l(s))}(a)):Cr(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),s):(e.enter("codeTextData"),l(a))}function l(t){return null===t||32===t||96===t||Cr(t)?(e.exit("codeTextData"),s(t)):(e.consume(t),l)}}}}],19210);var _O=e.i(19210);let _D=/[\0\t\n\r]/g,_R={}.hasOwnProperty;function _L(e){return{line:e.line,column:e.column,offset:e.offset}}function _P(e,t){if(e)throw Error("Cannot close `"+e.type+"` ("+v9({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+v9({start:t.start,end:t.end})+") is open");throw Error("Cannot close document, a token (`"+t.type+"`, "+v9({start:t.start,end:t.end})+") is still open")}function _B(e){let t=this;t.parser=function(n){var r,o;let i,s,l,a;return"string"!=typeof(r={...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})&&(o=r,r=void 0),(function(e){let t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:r(b),autolinkProtocol:c,autolinkEmail:c,atxHeading:r(f),blockQuote:r(function(){return{type:"blockquote",children:[]}}),characterEscape:c,characterReference:c,codeFenced:r(p),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:r(p,o),codeText:r(function(){return{type:"inlineCode",value:""}},o),codeTextData:c,data:c,codeFlowValue:c,definition:r(function(){return{type:"definition",identifier:"",label:null,title:null,url:""}}),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:r(function(){return{type:"emphasis",children:[]}}),hardBreakEscape:r(m),hardBreakTrailing:r(m),htmlFlow:r(g,o),htmlFlowData:c,htmlText:r(g,o),htmlTextData:c,image:r(function(){return{type:"image",title:null,url:"",alt:null}}),label:o,link:r(b),listItem:r(function(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}}),listItemValue:function(e){this.data.expectingFirstListItemValue&&(this.stack[this.stack.length-2].start=Number.parseInt(this.sliceSerialize(e),10),this.data.expectingFirstListItemValue=void 0)},listOrdered:r(y,function(){this.data.expectingFirstListItemValue=!0}),listUnordered:r(y),paragraph:r(function(){return{type:"paragraph",children:[]}}),reference:function(){this.data.referenceType="collapsed"},referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:r(f),strong:r(function(){return{type:"strong",children:[]}}),thematicBreak:r(function(){return{type:"thematicBreak"}})},exit:{atxHeading:s(),atxHeadingSequence:function(e){let t=this.stack[this.stack.length-1];t.depth||(t.depth=this.sliceSerialize(e).length)},autolink:s(),autolinkEmail:function(e){d.call(this,e),this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(e)},autolinkProtocol:function(e){d.call(this,e),this.stack[this.stack.length-1].url=this.sliceSerialize(e)},blockQuote:s(),characterEscapeValue:d,characterReferenceMarkerHexadecimal:h,characterReferenceMarkerNumeric:h,characterReferenceValue:function(e){let t,n=this.sliceSerialize(e),r=this.data.characterReferenceType;r?(t=T1(n,"characterReferenceMarkerNumeric"===r?10:16),this.data.characterReferenceType=void 0):t=T0(n);let o=this.stack[this.stack.length-1];o.value+=t},characterReference:function(e){this.stack.pop().position.end=_L(e.end)},codeFenced:s(function(){let e=this.resume();this.stack[this.stack.length-1].value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}),codeFencedFence:function(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)},codeFencedFenceInfo:function(){let e=this.resume();this.stack[this.stack.length-1].lang=e},codeFencedFenceMeta:function(){let e=this.resume();this.stack[this.stack.length-1].meta=e},codeFlowValue:d,codeIndented:s(function(){let e=this.resume();this.stack[this.stack.length-1].value=e.replace(/(\r?\n|\r)$/g,"")}),codeText:s(function(){let e=this.resume();this.stack[this.stack.length-1].value=e}),codeTextData:d,data:d,definition:s(),definitionDestinationString:function(){let e=this.resume();this.stack[this.stack.length-1].url=e},definitionLabelString:function(e){let t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=Ck(this.sliceSerialize(e)).toLowerCase()},definitionTitleString:function(){let e=this.resume();this.stack[this.stack.length-1].title=e},emphasis:s(),hardBreakEscape:s(u),hardBreakTrailing:s(u),htmlFlow:s(function(){let e=this.resume();this.stack[this.stack.length-1].value=e}),htmlFlowData:d,htmlText:s(function(){let e=this.resume();this.stack[this.stack.length-1].value=e}),htmlTextData:d,image:s(function(){let e=this.stack[this.stack.length-1];if(this.data.inReference){let t=this.data.referenceType||"shortcut";e.type+="Reference",e.referenceType=t,delete e.url,delete e.title}else delete e.identifier,delete e.label;this.data.referenceType=void 0}),label:function(){let e=this.stack[this.stack.length-1],t=this.resume(),n=this.stack[this.stack.length-1];this.data.inReference=!0,"link"===n.type?n.children=e.children:n.alt=t},labelText:function(e){let t=this.sliceSerialize(e),n=this.stack[this.stack.length-2];n.label=T4(t),n.identifier=Ck(t).toLowerCase()},lineEnding:function(e){let n=this.stack[this.stack.length-1];if(this.data.atHardBreak){n.children[n.children.length-1].position.end=_L(e.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(n.type)&&(c.call(this,e),d.call(this,e))},link:s(function(){let e=this.stack[this.stack.length-1];if(this.data.inReference){let t=this.data.referenceType||"shortcut";e.type+="Reference",e.referenceType=t,delete e.url,delete e.title}else delete e.identifier,delete e.label;this.data.referenceType=void 0}),listItem:s(),listOrdered:s(),listUnordered:s(),paragraph:s(),referenceString:function(e){let t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=Ck(this.sliceSerialize(e)).toLowerCase(),this.data.referenceType="full"},resourceDestinationString:function(){let e=this.resume();this.stack[this.stack.length-1].url=e},resourceTitleString:function(){let e=this.resume();this.stack[this.stack.length-1].title=e},resource:function(){this.data.inReference=void 0},setextHeading:s(function(){this.data.setextHeadingSlurpLineEnding=void 0}),setextHeadingLineSequence:function(e){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(e).codePointAt(0)?1:2},setextHeadingText:function(){this.data.setextHeadingSlurpLineEnding=!0},strong:s(),thematicBreak:s()}};!function e(t,n){let r=-1;for(;++r<n.length;){let o=n[r];Array.isArray(o)?e(t,o):function(e,t){let n;for(n in t)if(_R.call(t,n))switch(n){case"canContainEols":{let r=t[n];r&&e[n].push(...r);break}case"transforms":{let r=t[n];r&&e[n].push(...r);break}case"enter":case"exit":{let r=t[n];r&&Object.assign(e[n],r)}}}(t,o)}}(t,(e||{}).mdastExtensions||[]);let n={};return function(e){let r={type:"root",children:[]},s={stack:[r],tokenStack:[],config:t,enter:i,exit:l,buffer:o,resume:a,data:n},c=[],d=-1;for(;++d<e.length;)("listOrdered"===e[d][1].type||"listUnordered"===e[d][1].type)&&("enter"===e[d][0]?c.push(d):d=function(e,t,n){let r,o,i,s,l=t-1,a=-1,c=!1;for(;++l<=n;){let t=e[l];switch(t[1].type){case"listUnordered":case"listOrdered":case"blockQuote":"enter"===t[0]?a++:a--,s=void 0;break;case"lineEndingBlank":"enter"===t[0]&&(!r||s||a||i||(i=l),s=void 0);break;case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:s=void 0}if(!a&&"enter"===t[0]&&"listItemPrefix"===t[1].type||-1===a&&"exit"===t[0]&&("listUnordered"===t[1].type||"listOrdered"===t[1].type)){if(r){let s=l;for(o=void 0;s--;){let t=e[s];if("lineEnding"===t[1].type||"lineEndingBlank"===t[1].type){if("exit"===t[0])continue;o&&(e[o][1].type="lineEndingBlank",c=!0),t[1].type="lineEnding",o=s}else if("linePrefix"===t[1].type||"blockQuotePrefix"===t[1].type||"blockQuotePrefixWhitespace"===t[1].type||"blockQuoteMarker"===t[1].type||"listItemIndent"===t[1].type);else break}i&&(!o||i<o)&&(r._spread=!0),r.end=Object.assign({},o?e[o][1].start:t[1].end),e.splice(o||l,0,["exit",r,t[2]]),l++,n++}if("listItemPrefix"===t[1].type){let o={type:"listItem",_spread:!1,start:Object.assign({},t[1].start),end:void 0};r=o,e.splice(l,0,["enter",o,t[2]]),l++,n++,i=void 0,s=!0}}}return e[t][1]._spread=c,n}(e,c.pop(),d));for(d=-1;++d<e.length;){let n=t[e[d][0]];_R.call(n,e[d][1].type)&&n[e[d][1].type].call(Object.assign({sliceSerialize:e[d][2].sliceSerialize},s),e[d][1])}if(s.tokenStack.length>0){let e=s.tokenStack[s.tokenStack.length-1];(e[1]||_P).call(s,void 0,e[0])}for(r.position={start:_L(e.length>0?e[0][1].start:{line:1,column:1,offset:0}),end:_L(e.length>0?e[e.length-2][1].end:{line:1,column:1,offset:0})},d=-1;++d<t.transforms.length;)r=t.transforms[d](r)||r;return r};function r(e,t){return function(n){i.call(this,e(n),n),t&&t.call(this,n)}}function o(){this.stack.push({type:"fragment",children:[]})}function i(e,t,n){this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push([t,n||void 0]),e.position={start:_L(t.start),end:void 0}}function s(e){return function(t){e&&e.call(this,t),l.call(this,t)}}function l(e,t){let n=this.stack.pop(),r=this.tokenStack.pop();if(r)r[0].type!==e.type&&(t?t.call(this,e,r[0]):(r[1]||_P).call(this,e,r[0]));else throw Error("Cannot close `"+e.type+"` ("+v9({start:e.start,end:e.end})+"): its not open");n.position.end=_L(e.end)}function a(){return kA(this.stack.pop())}function c(e){let t=this.stack[this.stack.length-1].children,n=t[t.length-1];n&&"text"===n.type||((n={type:"text",value:""}).position={start:_L(e.start),end:void 0},t.push(n)),this.stack.push(n)}function d(e){let t=this.stack.pop();t.value+=this.sliceSerialize(e),t.position.end=_L(e.end)}function u(){this.data.atHardBreak=!0}function h(e){this.data.characterReferenceType=e.type}function p(){return{type:"code",lang:null,meta:null,value:""}}function f(){return{type:"heading",depth:0,children:[]}}function m(){return{type:"break"}}function g(){return{type:"html",value:""}}function b(){return{type:"link",title:null,url:"",children:[]}}function y(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}})(o)(function(e){for(;!A2(e););return e}((function(e){let t={constructs:Tu([_O,...(e||{}).extensions||[]]),content:n(AX),defined:[],document:n(AQ),flow:n(A3),lazy:{},string:n(A6),text:n(A9)};return t;function n(e){return function(n){return function(e,t,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0},o={},i=[],s=[],l=[],a={attempt:f(function(e,t){m(e,t.from)}),check:f(p),consume:function(e){Cr(e)?(r.line++,r.column=1,r.offset+=-3===e?2:1,g()):-1!==e&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===s[r._index].length&&(r._bufferIndex=-1,r._index++)),c.previous=e},enter:function(e,t){let n=t||{};return n.type=e,n.start=h(),c.events.push(["enter",n,c]),l.push(n),n},exit:function(e){let t=l.pop();return t.end=h(),c.events.push(["exit",t,c]),t},interrupt:f(p,{interrupt:!0})},c={code:null,containerState:{},defineSkip:function(e){o[e.line]=e.column,g()},events:[],now:h,parser:e,previous:null,sliceSerialize:function(e,t){return function(e,t){let n,r=-1,o=[];for(;++r<e.length;){let i,s=e[r];if("string"==typeof s)i=s;else switch(s){case -5:i="\r";break;case -4:i="\n";break;case -3:i="\r\n";break;case -2:i=t?" ":"	";break;case -1:if(!t&&n)continue;i=" ";break;default:i=String.fromCharCode(s)}n=-2===s,o.push(i)}return o.join("")}(u(e),t)},sliceStream:u,write:function(e){return(s=Tc(s,e),function(){let e;for(;r._index<s.length;){let n=s[r._index];if("string"==typeof n)for(e=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===e&&r._bufferIndex<n.length;){var t;t=n.charCodeAt(r._bufferIndex),d=d(t)}else d=d(n)}}(),null!==s[s.length-1])?[]:(m(t,0),c.events=TP(i,c.events,c),c.events)}},d=t.tokenize.call(c,a);return t.resolveAll&&i.push(t),c;function u(e){return function(e,t){let n,r=t.start._index,o=t.start._bufferIndex,i=t.end._index,s=t.end._bufferIndex;if(r===i)n=[e[r].slice(o,s)];else{if(n=e.slice(r,i),o>-1){let e=n[0];"string"==typeof e?n[0]=e.slice(o):n.shift()}s>0&&n.push(e[i].slice(0,s))}return n}(s,e)}function h(){let{_bufferIndex:e,_index:t,line:n,column:o,offset:i}=r;return{_bufferIndex:e,_index:t,line:n,column:o,offset:i}}function p(e,t){t.restore()}function f(e,t){return function(n,o,i){var s;let d,u,p,f;return Array.isArray(n)?m(n):"tokenize"in n?m([n]):(s=n,function(e){let t=null!==e&&s[e],n=null!==e&&s.null;return m([...Array.isArray(t)?t:t?[t]:[],...Array.isArray(n)?n:n?[n]:[]])(e)});function m(e){return(d=e,u=0,0===e.length)?i:b(e[u])}function b(e){return function(n){let o,i,s,d,u;return(o=h(),i=c.previous,s=c.currentConstruct,d=c.events.length,u=Array.from(l),f={from:d,restore:function(){r=o,c.previous=i,c.currentConstruct=s,c.events.length=d,l=u,g()}},p=e,e.partial||(c.currentConstruct=e),e.name&&c.parser.constructs.disable.null.includes(e.name))?v(n):e.tokenize.call(t?Object.assign(Object.create(c),t):c,a,y,v)(n)}}function y(t){return e(p,f),o}function v(e){return(f.restore(),++u<d.length)?b(d[u]):i}}}function m(e,t){e.resolveAll&&!i.includes(e)&&i.push(e),e.resolve&&Ta(c.events,t,c.events.length-t,e.resolve(c.events.slice(t),c)),e.resolveTo&&(c.events=e.resolveTo(c.events,c))}function g(){r.line in o&&r.column<2&&(r.column=o[r.line],r.offset+=o[r.line]-1)}}(t,e,n)}}})(o).document().write((s=1,l="",a=!0,function(e,t,n){let r,o,c,d,u,h=[];for(e=l+("string"==typeof e?e.toString():new TextDecoder(t||void 0).decode(e)),c=0,l="",a&&(65279===e.charCodeAt(0)&&c++,a=void 0);c<e.length;){if(_D.lastIndex=c,d=(r=_D.exec(e))&&void 0!==r.index?r.index:e.length,u=e.charCodeAt(d),!r){l=e.slice(c);break}if(10===u&&c===d&&i)h.push(-3),i=void 0;else switch(i&&(h.push(-5),i=void 0),c<d&&(h.push(e.slice(c,d)),s+=d-c),u){case 0:h.push(65533),s++;break;case 9:for(o=4*Math.ceil(s/4),h.push(-2);s++<o;)h.push(-1);break;case 10:h.push(-4),s=1;break;default:i=!0,s=1}c=d+1}return n&&(i&&h.push(-5),l&&h.push(l),h.push(null)),h})(n,r,!0))))}}function _H(e){let t=[],n=-1,r=0,o=0;for(;++n<e.length;){let i=e.charCodeAt(n),s="";if(37===i&&k6(e.charCodeAt(n+1))&&k6(e.charCodeAt(n+2)))o=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(s=String.fromCharCode(i));else if(i>55295&&i<57344){let t=e.charCodeAt(n+1);i<56320&&t>56319&&t<57344?(s=String.fromCharCode(i,t),o=1):s=""}else s=String.fromCharCode(i);s&&(t.push(e.slice(r,n),encodeURIComponent(s)),r=n+o+1,s=""),o&&(n+=o,o=0)}return t.join("")+e.slice(r)}function _j(e,t){let n=[{type:"text",value:""}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function _F(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function _U(e,t){let n=t.referenceType,r="]";if("collapsed"===n?r+="[]":"full"===n&&(r+="["+(t.label||t.identifier)+"]"),"imageReference"===t.type)return[{type:"text",value:"!["+t.alt+r}];let o=e.all(t),i=o[0];i&&"text"===i.type?i.value="["+i.value:o.unshift({type:"text",value:"["});let s=o[o.length-1];return s&&"text"===s.type?s.value+=r:o.push({type:"text",value:r}),o}function _z(e){let t=e.spread;return null==t?e.children.length>1:t}function _V(e,t,n){let r=0,o=e.length;if(t){let t=e.codePointAt(r);for(;9===t||32===t;)r++,t=e.codePointAt(r)}if(n){let t=e.codePointAt(o-1);for(;9===t||32===t;)o--,t=e.codePointAt(o-1)}return o>r?e.slice(r,o):""}let _$={blockquote:function(e,t){let n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)},break:function(e,t){let n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:"\n"}]},code:function(e,t){let n=t.value?t.value+"\n":"",r={},o=t.lang?t.lang.split(/\s+/):[];o.length>0&&(r.className=["language-"+o[0]]);let i={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return t.meta&&(i.data={meta:t.meta}),e.patch(t,i),i={type:"element",tagName:"pre",properties:{},children:[i=e.applyData(t,i)]},e.patch(t,i),i},delete:function(e,t){let n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},emphasis:function(e,t){let n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},footnoteReference:function(e,t){let n,r="string"==typeof e.options.clobberPrefix?e.options.clobberPrefix:"user-content-",o=String(t.identifier).toUpperCase(),i=_H(o.toLowerCase()),s=e.footnoteOrder.indexOf(o),l=e.footnoteCounts.get(o);void 0===l?(l=0,e.footnoteOrder.push(o),n=e.footnoteOrder.length):n=s+1,l+=1,e.footnoteCounts.set(o,l);let a={type:"element",tagName:"a",properties:{href:"#"+r+"fn-"+i,id:r+"fnref-"+i+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(n)}]};e.patch(t,a);let c={type:"element",tagName:"sup",properties:{},children:[a]};return e.patch(t,c),e.applyData(t,c)},heading:function(e,t){let n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},html:function(e,t){if(e.options.allowDangerousHtml){let n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}},imageReference:function(e,t){let n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return _U(e,t);let o={src:_H(r.url||""),alt:t.alt};null!==r.title&&void 0!==r.title&&(o.title=r.title);let i={type:"element",tagName:"img",properties:o,children:[]};return e.patch(t,i),e.applyData(t,i)},image:function(e,t){let n={src:_H(t.url)};null!==t.alt&&void 0!==t.alt&&(n.alt=t.alt),null!==t.title&&void 0!==t.title&&(n.title=t.title);let r={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,r),e.applyData(t,r)},inlineCode:function(e,t){let n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);let r={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,r),e.applyData(t,r)},linkReference:function(e,t){let n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return _U(e,t);let o={href:_H(r.url||"")};null!==r.title&&void 0!==r.title&&(o.title=r.title);let i={type:"element",tagName:"a",properties:o,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)},link:function(e,t){let n={href:_H(t.url)};null!==t.title&&void 0!==t.title&&(n.title=t.title);let r={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,r),e.applyData(t,r)},listItem:function(e,t,n){let r=e.all(t),o=n?function(e){let t=!1;if("list"===e.type){t=e.spread||!1;let n=e.children,r=-1;for(;!t&&++r<n.length;)t=_z(n[r])}return t}(n):_z(t),i={},s=[];if("boolean"==typeof t.checked){let e,n=r[0];n&&"element"===n.type&&"p"===n.tagName?e=n:(e={type:"element",tagName:"p",properties:{},children:[]},r.unshift(e)),e.children.length>0&&e.children.unshift({type:"text",value:" "}),e.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let l=-1;for(;++l<r.length;){let e=r[l];(o||0!==l||"element"!==e.type||"p"!==e.tagName)&&s.push({type:"text",value:"\n"}),"element"!==e.type||"p"!==e.tagName||o?s.push(e):s.push(...e.children)}let a=r[r.length-1];a&&(o||"element"!==a.type||"p"!==a.tagName)&&s.push({type:"text",value:"\n"});let c={type:"element",tagName:"li",properties:i,children:s};return e.patch(t,c),e.applyData(t,c)},list:function(e,t){let n={},r=e.all(t),o=-1;for("number"==typeof t.start&&1!==t.start&&(n.start=t.start);++o<r.length;){let e=r[o];if("element"===e.type&&"li"===e.tagName&&e.properties&&Array.isArray(e.properties.className)&&e.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}let i={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(r,!0)};return e.patch(t,i),e.applyData(t,i)},paragraph:function(e,t){let n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},root:function(e,t){let n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)},strong:function(e,t){let n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},table:function(e,t){let n=e.all(t),r=n.shift(),o=[];if(r){let n={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(t.children[0],n),o.push(n)}if(n.length>0){let r={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},i=E1(t.children[1]),s=E0(t.children[t.children.length-1]);i&&s&&(r.position={start:i,end:s}),o.push(r)}let i={type:"element",tagName:"table",properties:{},children:e.wrap(o,!0)};return e.patch(t,i),e.applyData(t,i)},tableCell:function(e,t){let n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},tableRow:function(e,t,n){let r=n?n.children:void 0,o=0===(r?r.indexOf(t):1)?"th":"td",i=n&&"table"===n.type?n.align:void 0,s=i?i.length:t.children.length,l=-1,a=[];for(;++l<s;){let n=t.children[l],r={},s=i?i[l]:void 0;s&&(r.align=s);let c={type:"element",tagName:o,properties:r,children:[]};n&&(c.children=e.all(n),e.patch(n,c),c=e.applyData(n,c)),a.push(c)}let c={type:"element",tagName:"tr",properties:{},children:e.wrap(a,!0)};return e.patch(t,c),e.applyData(t,c)},text:function(e,t){let n={type:"text",value:function(e){let t=String(e),n=/\r?\n|\r/g,r=n.exec(t),o=0,i=[];for(;r;)i.push(_V(t.slice(o,r.index),o>0,!0),r[0]),o=r.index+r[0].length,r=n.exec(t);return i.push(_V(t.slice(o),o>0,!1)),i.join("")}(String(t.value))};return e.patch(t,n),e.applyData(t,n)},thematicBreak:function(e,t){let n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)},toml:_G,yaml:_G,definition:_G,footnoteDefinition:_G};function _G(){}let _q={}.hasOwnProperty,_W={};function _Y(e,t){e.position&&(t.position=E4(e))}function _K(e,t){let n=t;if(e&&e.data){let t=e.data.hName,r=e.data.hChildren,o=e.data.hProperties;"string"==typeof t&&("element"===n.type?n.tagName=t:n={type:"element",tagName:t,properties:{},children:"children"in n?n.children:[n]}),"element"===n.type&&o&&Object.assign(n.properties,E_(o)),"children"in n&&n.children&&null!=r&&(n.children=r)}return n}function _Z(e,t){let n=[],r=-1;for(t&&n.push({type:"text",value:"\n"});++r<e.length;)r&&n.push({type:"text",value:"\n"}),n.push(e[r]);return t&&e.length>0&&n.push({type:"text",value:"\n"}),n}function _X(e){let t=0,n=e.charCodeAt(t);for(;9===n||32===n;)t++,n=e.charCodeAt(t);return e.slice(t)}function _Q(e,t){let n,r,o,i,s=(n=t||_W,r=new Map,o=new Map,i={all:function(e){let t=[];if("children"in e){let n=e.children,r=-1;for(;++r<n.length;){let o=i.one(n[r],e);if(o){if(r&&"break"===n[r-1].type&&(Array.isArray(o)||"text"!==o.type||(o.value=_X(o.value)),!Array.isArray(o)&&"element"===o.type)){let e=o.children[0];e&&"text"===e.type&&(e.value=_X(e.value))}Array.isArray(o)?t.push(...o):t.push(o)}}}return t},applyData:_K,definitionById:r,footnoteById:o,footnoteCounts:new Map,footnoteOrder:[],handlers:{..._$,...n.handlers},one:function(e,t){let n=e.type,r=i.handlers[n];if(_q.call(i.handlers,n)&&r)return r(i,e,t);if(i.options.passThrough&&i.options.passThrough.includes(n)){if("children"in e){let{children:t,...n}=e,r=E_(n);return r.children=i.all(e),r}return E_(e)}return(i.options.unknownHandler||function(e,t){let n=t.data||{},r="value"in t&&!(_q.call(n,"hProperties")||_q.call(n,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)})(i,e,t)},options:n,patch:_Y,wrap:_Z},EJ(e,function(e){if("definition"===e.type||"footnoteDefinition"===e.type){let t="definition"===e.type?r:o,n=String(e.identifier).toUpperCase();t.has(n)||t.set(n,e)}}),i),l=s.one(e,void 0),a=function(e){let t="string"==typeof e.options.clobberPrefix?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||_j,r=e.options.footnoteBackLabel||_F,o=e.options.footnoteLabel||"Footnotes",i=e.options.footnoteLabelTagName||"h2",s=e.options.footnoteLabelProperties||{className:["sr-only"]},l=[],a=-1;for(;++a<e.footnoteOrder.length;){let o=e.footnoteById.get(e.footnoteOrder[a]);if(!o)continue;let i=e.all(o),s=String(o.identifier).toUpperCase(),c=_H(s.toLowerCase()),d=0,u=[],h=e.footnoteCounts.get(s);for(;void 0!==h&&++d<=h;){u.length>0&&u.push({type:"text",value:" "});let e="string"==typeof n?n:n(a,d);"string"==typeof e&&(e={type:"text",value:e}),u.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+c+(d>1?"-"+d:""),dataFootnoteBackref:"",ariaLabel:"string"==typeof r?r:r(a,d),className:["data-footnote-backref"]},children:Array.isArray(e)?e:[e]})}let p=i[i.length-1];if(p&&"element"===p.type&&"p"===p.tagName){let e=p.children[p.children.length-1];e&&"text"===e.type?e.value+=" ":p.children.push({type:"text",value:" "}),p.children.push(...u)}else i.push(...u);let f={type:"element",tagName:"li",properties:{id:t+"fn-"+c},children:e.wrap(i,!0)};e.patch(o,f),l.push(f)}if(0!==l.length)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...E_(s),id:"footnote-label"},children:[{type:"text",value:o}]},{type:"text",value:"\n"},{type:"element",tagName:"ol",properties:{},children:e.wrap(l,!0)},{type:"text",value:"\n"}]}}(s),c=Array.isArray(l)?{type:"root",children:l}:l||{type:"root",children:[]};return a&&(bP("children"in c),c.children.push({type:"text",value:"\n"},a)),c}function _J(e,t){return e&&"run"in e?async function(n,r){let o=_Q(n,{file:r,...t});await e.run(o,r)}:function(n,r){return _Q(n,{file:r,...e||t})}}let _0=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],_1=/["&'<>`]/g,_2=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,_4=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,_5=/[|\\{}()[\]^$+*?.]/g,_3=new WeakMap,_8=/[\dA-Fa-f]/,_6=/\d/,_9=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],_7={nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",fnof:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",bull:"",hellip:"",prime:"",Prime:"",oline:"",frasl:"",weierp:"",image:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:"",quot:'"',amp:"&",lt:"<",gt:">",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",circ:"",tilde:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",permil:"",lsaquo:"",rsaquo:"",euro:""},Ne=["cent","copy","divide","gt","lt","not","para","times"],Nt={}.hasOwnProperty,Nn={};for(l in _7)Nt.call(_7,l)&&(Nn[_7[l]]=l);let Nr=/[^\dA-Za-z]/;function No(e,t,n){var r,o;let i,s,l=(r=n.omitOptionalSemicolons,i="&#x"+e.toString(16).toUpperCase(),r&&t&&!_8.test(String.fromCharCode(t))?i:i+";");if((n.useNamedReferences||n.useShortestReferences)&&(s=function(e,t,n,r){let o=String.fromCharCode(e);if(Nt.call(Nn,o)){let e=Nn[o],i="&"+e;return n&&_9.includes(e)&&!Ne.includes(e)&&(!r||t&&61!==t&&Nr.test(String.fromCharCode(t)))?i:i+";"}return""}(e,t,n.omitOptionalSemicolons,n.attribute)),(n.useShortestReferences||!s)&&n.useShortestReferences){let r,i=(o=n.omitOptionalSemicolons,r="&#"+String(e),o&&t&&!_6.test(String.fromCharCode(t))?r:r+";");i.length<l.length&&(l=i)}return s&&(!n.useShortestReferences||s.length<l.length)?s:l}function Ni(e,t){let n;var r,o=e,i=Object.assign({format:No},t);if(o=o.replace(i.subset?(r=i.subset,(n=_3.get(r))||(n=function(e){let t=[],n=-1;for(;++n<e.length;)t.push(e[n].replace(_5,"\\$&"));return RegExp("(?:"+t.join("|")+")","g")}(r),_3.set(r,n)),n):_1,s),i.subset||i.escapeOnly)return o;return o.replace(_2,function(e,t,n){return i.format((e.charCodeAt(0)-55296)*1024+e.charCodeAt(1)-56320+65536,n.charCodeAt(t+2),i)}).replace(_4,s);function s(e,t,n){return i.format(e.charCodeAt(0),n.charCodeAt(t+1),i)}}let Ns=/^>|^->|<!--|-->|--!>|<!-$/g,Nl=[">"],Na=["<",">"],Nc=Nh(1),Nd=Nh(-1),Nu=[];function Nh(e){return function(t,n,r){let o=t?t.children:Nu,i=(n||0)+e,s=o[i];if(!r)for(;s&&EP(s);)i+=e,s=o[i];return s}}let Np={}.hasOwnProperty;function Nf(e){return function(t,n,r){return Np.call(e,t.tagName)&&e[t.tagName](t,n,r)}}let Nm=Nf({body:function(e,t,n){let r=Nc(n,t);return!r||"comment"!==r.type},caption:Ng,colgroup:Ng,dd:function(e,t,n){let r=Nc(n,t);return!r||"element"===r.type&&("dt"===r.tagName||"dd"===r.tagName)},dt:function(e,t,n){let r=Nc(n,t);return!!(r&&"element"===r.type&&("dt"===r.tagName||"dd"===r.tagName))},head:Ng,html:function(e,t,n){let r=Nc(n,t);return!r||"comment"!==r.type},li:function(e,t,n){let r=Nc(n,t);return!r||"element"===r.type&&"li"===r.tagName},optgroup:function(e,t,n){let r=Nc(n,t);return!r||"element"===r.type&&"optgroup"===r.tagName},option:function(e,t,n){let r=Nc(n,t);return!r||"element"===r.type&&("option"===r.tagName||"optgroup"===r.tagName)},p:function(e,t,n){let r=Nc(n,t);return r?"element"===r.type&&("address"===r.tagName||"article"===r.tagName||"aside"===r.tagName||"blockquote"===r.tagName||"details"===r.tagName||"div"===r.tagName||"dl"===r.tagName||"fieldset"===r.tagName||"figcaption"===r.tagName||"figure"===r.tagName||"footer"===r.tagName||"form"===r.tagName||"h1"===r.tagName||"h2"===r.tagName||"h3"===r.tagName||"h4"===r.tagName||"h5"===r.tagName||"h6"===r.tagName||"header"===r.tagName||"hgroup"===r.tagName||"hr"===r.tagName||"main"===r.tagName||"menu"===r.tagName||"nav"===r.tagName||"ol"===r.tagName||"p"===r.tagName||"pre"===r.tagName||"section"===r.tagName||"table"===r.tagName||"ul"===r.tagName):!n||"element"!==n.type||"a"!==n.tagName&&"audio"!==n.tagName&&"del"!==n.tagName&&"ins"!==n.tagName&&"map"!==n.tagName&&"noscript"!==n.tagName&&"video"!==n.tagName},rp:Nb,rt:Nb,tbody:function(e,t,n){let r=Nc(n,t);return!r||"element"===r.type&&("tbody"===r.tagName||"tfoot"===r.tagName)},td:Ny,tfoot:function(e,t,n){return!Nc(n,t)},th:Ny,thead:function(e,t,n){let r=Nc(n,t);return!!(r&&"element"===r.type&&("tbody"===r.tagName||"tfoot"===r.tagName))},tr:function(e,t,n){let r=Nc(n,t);return!r||"element"===r.type&&"tr"===r.tagName}});function Ng(e,t,n){let r=Nc(n,t,!0);return!r||"comment"!==r.type&&!("text"===r.type&&EP(r.value.charAt(0)))}function Nb(e,t,n){let r=Nc(n,t);return!r||"element"===r.type&&("rp"===r.tagName||"rt"===r.tagName)}function Ny(e,t,n){let r=Nc(n,t);return!r||"element"===r.type&&("td"===r.tagName||"th"===r.tagName)}let Nv=Nf({body:function(e){let t=Nc(e,-1,!0);return!t||"comment"!==t.type&&!("text"===t.type&&EP(t.value.charAt(0)))&&("element"!==t.type||"meta"!==t.tagName&&"link"!==t.tagName&&"script"!==t.tagName&&"style"!==t.tagName&&"template"!==t.tagName)},colgroup:function(e,t,n){let r=Nd(n,t),o=Nc(e,-1,!0);return!(n&&r&&"element"===r.type&&"colgroup"===r.tagName&&Nm(r,n.children.indexOf(r),n))&&!!(o&&"element"===o.type&&"col"===o.tagName)},head:function(e){let t=new Set;for(let n of e.children)if("element"===n.type&&("base"===n.tagName||"title"===n.tagName)){if(t.has(n.tagName))return!1;t.add(n.tagName)}let n=e.children[0];return!n||"element"===n.type},html:function(e){let t=Nc(e,-1);return!t||"comment"!==t.type},tbody:function(e,t,n){let r=Nd(n,t),o=Nc(e,-1);return!(n&&r&&"element"===r.type&&("thead"===r.tagName||"tbody"===r.tagName)&&Nm(r,n.children.indexOf(r),n))&&!!(o&&"element"===o.type&&"tr"===o.tagName)}}),NE={name:[["	\n\f\r &/=>".split(""),"	\n\f\r \"&'/=>`".split("")],["\0	\n\f\r \"&'/<=>".split(""),"\0	\n\f\r \"&'/<=>`".split("")]],unquoted:[["	\n\f\r &>".split(""),"\0	\n\f\r \"&'<=>`".split("")],["\0	\n\f\r \"&'<=>`".split(""),"\0	\n\f\r \"&'<=>`".split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]},Nk=["<","&"];function NC(e,t,n,r){return n&&"element"===n.type&&("script"===n.tagName||"style"===n.tagName)?e.value:Ni(e.value,Object.assign({},r.settings.characterReferences,{subset:Nk}))}let NT=TY("type",{invalid:function(e){throw Error("Expected node, not `"+e+"`")},unknown:function(e){throw Error("Cannot compile unknown node `"+e.type+"`")},handlers:{comment:function(e,t,n,r){return r.settings.bogusComments?"<?"+Ni(e.value,Object.assign({},r.settings.characterReferences,{subset:Nl}))+">":"<!--"+e.value.replace(Ns,function(e){return Ni(e,Object.assign({},r.settings.characterReferences,{subset:Na}))})+"-->"},doctype:function(e,t,n,r){return"<!"+(r.settings.upperDoctype?"DOCTYPE":"doctype")+(r.settings.tightDoctype?"":" ")+"html>"},element:function(e,t,n,r){let o,i=r.schema,s="svg"!==i.space&&r.settings.omitOptionalTags,l="svg"===i.space?r.settings.closeEmptyElements:r.settings.voids.includes(e.tagName.toLowerCase()),a=[];"html"===i.space&&"svg"===e.tagName&&(r.schema=b7);let c=function(e,t){let n,r=[],o=-1;if(t){for(n in t)if(null!==t[n]&&void 0!==t[n]){let o=function(e,t,n){let r,o=yi(e.schema,t),i=e.settings.allowParseErrors&&"html"===e.schema.space?0:1,s=+!e.settings.allowDangerousCharacters,l=e.quote;if(o.overloadedBoolean&&(n===o.attribute||""===n)?n=!0:(o.boolean||o.overloadedBoolean)&&("string"!=typeof n||n===o.attribute||""===n)&&(n=!!n),null==n||!1===n||"number"==typeof n&&Number.isNaN(n))return"";let a=Ni(o.attribute,Object.assign({},e.settings.characterReferences,{subset:NE.name[i][s]}));return!0===n||(n=Array.isArray(n)?(o.commaSeparated?function(e,t){let n=t||{};return(""===e[e.length-1]?[...e,""]:e).join((n.padRight?" ":"")+","+(!1===n.padLeft?"":" ")).trim()}:function(e){return e.join(" ").trim()})(n,{padLeft:!e.settings.tightCommaSeparatedLists}):String(n),e.settings.collapseEmptyAttributes&&!n)?a:(e.settings.preferUnquoted&&(r=Ni(n,Object.assign({},e.settings.characterReferences,{attribute:!0,subset:NE.unquoted[i][s]}))),r!==n&&(e.settings.quoteSmart&&k3(n,l)>k3(n,e.alternative)&&(l=e.alternative),r=l+Ni(n,Object.assign({},e.settings.characterReferences,{subset:("'"===l?NE.single:NE.double)[i][s],attribute:!0}))+l),a+(r?"="+r:r))}(e,n,t[n]);o&&r.push(o)}}for(;++o<r.length;){let t=e.settings.tightAttributes?r[o].charAt(r[o].length-1):void 0;o!==r.length-1&&'"'!==t&&"'"!==t&&(r[o]+=" ")}return r.join("")}(r,e.properties),d=r.all("html"===i.space&&"template"===e.tagName?e.content:e);return r.schema=i,d&&(l=!1),!c&&s&&Nv(e,t,n)||(a.push("<",e.tagName,c?" "+c:""),l&&("svg"===i.space||r.settings.closeSelfClosing)&&(o=c.charAt(c.length-1),(!r.settings.tightSelfClosing||"/"===o||o&&'"'!==o&&"'"!==o)&&a.push(" "),a.push("/")),a.push(">")),a.push(d),l||s&&Nm(e,t,n)||a.push("</"+e.tagName+">"),a.join("")},raw:function(e,t,n,r){return r.settings.allowDangerousHtml?e.value:NC(e,t,n,r)},root:function(e,t,n,r){return r.all(e)},text:NC}}),Nw={},Nx={},NS=[];function NA(e,t,n){return NT(e,t,n,this)}function N_(e){let t=[],n=e&&e.children||NS,r=-1;for(;++r<n.length;)t[r]=this.one(n[r],r,e);return t.join("")}function NN(e){let t={...this.data("settings"),...e};this.compiler=function(e){let n=t||Nw,r=n.quote||'"';if('"'!==r&&"'"!==r)throw Error("Invalid quote `"+r+"`, expected `'` or `\"`");return({one:NA,all:N_,settings:{omitOptionalTags:n.omitOptionalTags||!1,allowParseErrors:n.allowParseErrors||!1,allowDangerousCharacters:n.allowDangerousCharacters||!1,quoteSmart:n.quoteSmart||!1,preferUnquoted:n.preferUnquoted||!1,tightAttributes:n.tightAttributes||!1,upperDoctype:n.upperDoctype||!1,tightDoctype:n.tightDoctype||!1,bogusComments:n.bogusComments||!1,tightCommaSeparatedLists:n.tightCommaSeparatedLists||!1,tightSelfClosing:n.tightSelfClosing||!1,collapseEmptyAttributes:n.collapseEmptyAttributes||!1,allowDangerousHtml:n.allowDangerousHtml||!1,voids:n.voids||_0,characterReferences:n.characterReferences||Nx,closeSelfClosing:n.closeSelfClosing||!1,closeEmptyElements:n.closeEmptyElements||!1},schema:"svg"===n.space?b7:b9,quote:r,alternative:'"'===r?"'":'"'}).one(Array.isArray(e)?{type:"root",children:e}:e,void 0,void 0)}}var NM=Object.defineProperty,NI=(e,t,n)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?NM(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n};function NO(e){if(!e||"column"!==e.type.name)throw Error("Invalid columnPos: does not point to column node.");let t=e.firstChild;if(!t)throw Error("Invalid column: does not have child node.");let n=t.firstChild;if(!n)throw Error("Invalid blockContainer: does not have child node.");return 1===e.childCount&&1===t.childCount&&"paragraph"===n.type.name&&0===n.content.content.length}function ND(e,t){!function(e,t){let n=e.doc.resolve(t),r=n.nodeAfter;if(!r||"columnList"!==r.type.name)throw Error("Invalid columnListPos: does not point to columnList node.");for(let t=r.childCount-1;t>=0;t--){let r=e.doc.resolve(n.pos+1).posAtIndex(t),o=e.doc.resolve(r).nodeAfter;if(!o||"column"!==o.type.name)throw Error("Invalid columnPos: does not point to column node.");NO(o)&&e.delete(r,r+o.nodeSize)}}(e,t);let n=e.doc.resolve(t).nodeAfter;if(!n||"columnList"!==n.type.name)throw Error("Invalid columnListPos: does not point to columnList node.");if(n.childCount>2)return;if(n.childCount<2)throw Error("Invalid columnList: contains fewer than two children.");let r=t+1,o=e.doc.resolve(r).nodeAfter,i=t+n.nodeSize-1,s=e.doc.resolve(i).nodeBefore;if(!o||!s)throw Error("Invalid columnList: does not contain children.");let l=NO(o),a=NO(s);l&&a?e.delete(t,t+n.nodeSize):l?e.step(new tp(t,t+n.nodeSize,i-s.nodeSize+1,i-1,ek.empty,0,!1)):a&&e.step(new tp(t,t+n.nodeSize,r+1,r+o.nodeSize-1,ek.empty,0,!1))}function NR(e,t,n){let r=l7(e),o=n.map(e=>ax(e,r)),i=new Set(t.map(e=>"string"==typeof e?e:e.id)),s=[],l=new Set,a="string"==typeof t[0]?t[0]:t[0].id,c=0;if(e.doc.descendants((t,d)=>{if(0===i.size)return!1;if(!t.type.isInGroup("bnBlock")||!i.has(t.attrs.id))return!0;if(s.push(ac(t,r)),i.delete(t.attrs.id),n.length>0&&t.attrs.id===a){let t=e.doc.nodeSize;e.insert(d,o);let n=e.doc.nodeSize;c+=t-n}let u=e.doc.nodeSize,h=e.doc.resolve(d-c);"column"===h.node().type.name?l.add(h.before(-1)):"columnList"===h.node().type.name&&l.add(h.before()),"blockGroup"===h.node().type.name&&"doc"!==h.node(h.depth-1).type.name&&1===h.node().childCount?e.delete(h.before(),h.after()):e.delete(d-c,d-c+t.nodeSize);let p=e.doc.nodeSize;return c+=u-p,!1}),i.size>0)throw Error("Blocks with the following IDs could not be found in the editor: "+[...i].join(`
`));return l.forEach(t=>ND(e,t)),{insertedBlocks:o.map(e=>ac(e,r)),removedBlocks:s}}let NL=(e,t,n,r)=>{var o;let i=e.pmSchema.nodes.blockGroup,s=i.spec.toDOM(i.create({})),l=function e(t,n,r,o){let i=((null==o?void 0:o.document)??document).createDocumentFragment();for(let s of n){let n=function(t,n,r,o){var i,s,l,a,c;let d=t.pmSchema.nodes.blockContainer,u=n.props||{};for(let[e,r]of Object.entries(t.schema.blockSchema[n.type].propSchema))e in u||void 0===r.default||(u[e]=r.default);let h=n.children||[],p=t.blockImplementations[n.type].implementation.render.call({renderType:"dom",props:void 0},{...n,props:u,children:h},t);if(p.contentDOM&&n.content){let e=function(e,t,n,r,o){let i;if(t)if("string"==typeof t)i=aC([t],e.pmSchema,r);else if(Array.isArray(t))i=aC(t,e.pmSchema,r);else if("tableContent"===t.type)i=aT(t,e.pmSchema);else throw new l1(t.type);else throw Error("blockContent is required");let s=((null==o?void 0:o.document)??document).createDocumentFragment();for(let t of i)if("text"!==t.type.name&&e.schema.inlineContentSchema[t.type.name]){let r=e.schema.inlineContentSpecs[t.type.name].implementation;if(r){let i=aa(t,e.schema.inlineContentSchema,e.schema.styleSchema),l=r.render.call({renderType:"dom",props:void 0},i,()=>{},e);if(l){if(s.appendChild(l.dom),l.contentDOM){let e=n.serializeFragment(t.content,o);l.contentDOM.dataset.editable="",l.contentDOM.appendChild(e)}continue}}}else if("text"===t.type.name){let n=document.createTextNode(t.textContent);for(let r of t.marks.toReversed())if(r.type.name in e.schema.styleSpecs){let t=e.schema.styleSpecs[r.type.name].implementation.render(r.attrs.stringValue,e);t.contentDOM.appendChild(n),n=t.dom}else{let e=r.type.spec.toDOM(r,!0),t=e8.renderSpec(document,e);t.contentDOM.appendChild(n),n=t.dom}s.appendChild(n)}else{let e=n.serializeFragment(em.from([t]),o);s.appendChild(e)}return s}(t,n.content,r,n.type,o);p.contentDOM.appendChild(e)}if(t.pmSchema.nodes[n.type].isInGroup("bnBlock")){if(n.children&&n.children.length>0){let s=e(t,n.children,r,o);null==(i=p.contentDOM)||i.append(s)}return p.dom}let f=null==(l=null==(s=d.spec)?void 0:s.toDOM)?void 0:l.call(s,d.create({id:n.id,...u}));return null==(a=f.contentDOM)||a.appendChild(p.dom),n.children&&n.children.length>0&&(null==(c=f.contentDOM)||c.appendChild(NL(t,n.children,r,o))),f.dom}(t,s,r,o);i.appendChild(n)}return i}(e,t,n,r);return null==(o=s.contentDOM)||o.appendChild(l),s.dom};function NP(e,t,n){e.transact(r=>{var o;let i=(null==(o=e.getSelection())?void 0:o.blocks)||[e.getTextCursorPosition().block],s=e.transact(e=>{let t=l4(e.doc,e.selection.anchor);if(e.selection instanceof aH)return{type:"cell",anchorBlockId:t.node.attrs.id,anchorCellOffset:e.selection.$anchorCell.pos-t.posBeforeNode,headCellOffset:e.selection.$headCell.pos-t.posBeforeNode};if(e.selection instanceof tG)return{type:"node",anchorBlockId:t.node.attrs.id};{let n=l4(e.doc,e.selection.head);return{type:"text",anchorBlockId:t.node.attrs.id,headBlockId:n.node.attrs.id,anchorOffset:e.selection.anchor-t.posBeforeNode,headOffset:e.selection.head-n.posBeforeNode}}});e.removeBlocks(i),e.insertBlocks(function e(t){return t.map(t=>"columnList"===t.type?t.children.map(t=>e(t.children)).flat():{...t,children:e(t.children)}).flat()}(i),t,n),function(e,t){var n,r;let o,i=null==(n=mJ(t.anchorBlockId,e.doc))?void 0:n.posBeforeNode;if(void 0===i)throw Error(`Could not find block with ID ${t.anchorBlockId} to update selection`);if("cell"===t.type)o=aH.create(e.doc,i+t.anchorCellOffset,i+t.headCellOffset);else if("node"===t.type)o=tG.create(e.doc,i+1);else{let n=null==(r=mJ(t.headBlockId,e.doc))?void 0:r.posBeforeNode;if(void 0===n)throw Error(`Could not find block with ID ${t.headBlockId} to update selection`);o=tV.create(e.doc,i+t.anchorOffset,n+t.headOffset)}e.setSelection(o)}(r,s)})}function NB(e){return!e||"columnList"!==e.type}function NH(e){return e.transact(t=>(function(e,t,n){let{$from:r,$to:o}=e.selection,i=r.blockRange(o,e=>e.childCount>0&&("blockGroup"===e.type.name||"column"===e.type.name));if(!i)return!1;let s=i.startIndex;if(0===s)return!1;let l=i.parent.child(s-1);if(l.type!==t)return!1;let a=l.lastChild&&l.lastChild.type===n,c=em.from(a?t.create():null),d=new ek(em.from(t.create(null,em.from(n.create(null,c)))),a?3:1,0),u=i.start,h=i.end;return e.step(new tp(u-(a?3:1),h,u,h,d,1,!0)).scrollIntoView(),!0})(t,e.pmSchema.nodes.blockContainer,e.pmSchema.nodes.blockGroup))}class Nj{constructor(e){this.editor=e}get document(){return this.editor.transact(e=>(function(e,t=l7(e),n=an(t),r=ar(t),o=ao(t),i=ai(t)){let s=[];return e.firstChild&&e.firstChild.descendants(e=>(s.push(ac(e,t,n,r,o,i)),!1)),s})(e.doc,this.editor.pmSchema))}getBlock(e){return this.editor.transact(t=>(function(e,t){let n="string"==typeof t?t:t.id,r=l7(e),o=mJ(n,e);if(o)return ac(o.node,r)})(t.doc,e))}getPrevBlock(e){return this.editor.transact(t=>(function(e,t){let n=mJ("string"==typeof t?t:t.id,e),r=l7(e);if(!n)return;let o=e.resolve(n.posBeforeNode).nodeBefore;if(o)return ac(o,r)})(t.doc,e))}getNextBlock(e){return this.editor.transact(t=>(function(e,t){let n=mJ("string"==typeof t?t:t.id,e),r=l7(e);if(!n)return;let o=e.resolve(n.posBeforeNode+n.node.nodeSize).nodeAfter;if(o)return ac(o,r)})(t.doc,e))}getParentBlock(e){return this.editor.transact(t=>(function(e,t){let n="string"==typeof t?t:t.id,r=l7(e),o=mJ(n,e);if(!o)return;let i=e.resolve(o.posBeforeNode),s=i.node(),l=i.node(-1),a="doc"!==l.type.name?"blockGroup"===s.type.name?l:s:void 0;if(a)return ac(a,r)})(t.doc,e))}forEachBlock(e,t=!1){let n=this.document.slice();t&&n.reverse(),!function n(r){for(let o of r)if(!1===e(o)||!n(t?o.children.slice().reverse():o.children))return!1;return!0}(n)}insertBlocks(e,t,n="before"){return this.editor.transact(r=>(function(e,t,n,r="before"){let o="string"==typeof n?n:n.id,i=l7(e),s=t.map(e=>ax(e,i)),l=mJ(o,e.doc);if(!l)throw Error(`Block with ID ${o} not found`);let a=l.posBeforeNode;return"after"===r&&(a+=l.node.nodeSize),e.step(new th(a,a,new ek(em.from(s),0,0))),s.map(e=>ac(e,i))})(r,e,t,n))}updateBlock(e,t){return this.editor.transact(n=>(function(e,t,n,r,o){let i="string"==typeof t?t:t.id,s=mJ(i,e.doc);if(!s)throw Error(`Block with ID ${i} not found`);return m1(e,s.posBeforeNode,n,void 0,void 0),ac(e.doc.resolve(s.posBeforeNode+1).node(),l7(e))})(n,e,t))}removeBlocks(e){return this.editor.transact(t=>NR(t,e,[]).removedBlocks)}replaceBlocks(e,t){return this.editor.transact(n=>NR(n,e,t))}canNestBlock(){return this.editor.transact(e=>{let{bnBlock:t}=l9(e);return null!==e.doc.resolve(t.beforePos).nodeBefore})}nestBlock(){NH(this.editor)}canUnnestBlock(){return this.editor.transact(e=>{let{bnBlock:t}=l9(e);return e.doc.resolve(t.beforePos).depth>1})}unnestBlock(){this.editor._tiptapEditor.commands.liftListItem("blockContainer")}moveBlocksUp(){var e;(e=this.editor).transact(()=>{let t=e.getSelection(),n=(null==t?void 0:t.blocks[0])||e.getTextCursorPosition().block,r=function e(t,n,r){let o,i;if(n?n.children.length>0?(o=n.children[n.children.length-1],i="after"):(o=n,i="before"):r&&(o=r,i="before"),!o||!i)return;let s=t.getParentBlock(o);return NB(s)?{referenceBlock:o,placement:i}:e(t,"after"===i?o:t.getPrevBlock(o),s)}(e,e.getPrevBlock(n),e.getParentBlock(n));r&&NP(e,r.referenceBlock,r.placement)})}moveBlocksDown(){var e;(e=this.editor).transact(()=>{let t=e.getSelection(),n=(null==t?void 0:t.blocks[(null==t?void 0:t.blocks.length)-1])||e.getTextCursorPosition().block,r=function e(t,n,r){let o,i;if(n?n.children.length>0?(o=n.children[0],i="before"):(o=n,i="after"):r&&(o=r,i="after"),!o||!i)return;let s=t.getParentBlock(o);return NB(s)?{referenceBlock:o,placement:i}:e(t,"before"===i?o:t.getNextBlock(o),s)}(e,e.getNextBlock(n),e.getParentBlock(n));r&&NP(e,r.referenceBlock,r.placement)})}}class NF extends be{constructor(e){super(),this.editor=e,e.on("create",()=>{e._tiptapEditor.on("update",({transaction:t,appendedTransactions:n})=>{this.emit("onChange",{editor:e,transaction:t,appendedTransactions:n})}),e._tiptapEditor.on("selectionUpdate",({transaction:t})=>{this.emit("onSelectionChange",{editor:e,transaction:t})}),e._tiptapEditor.on("mount",()=>{this.emit("onMount",{editor:e})}),e._tiptapEditor.on("unmount",()=>{this.emit("onUnmount",{editor:e})})})}onChange(e,t=!0){let n=({transaction:n,appendedTransactions:r})=>{!t&&NU(n)||e(this.editor,{getChanges:()=>wI(n,r)})};return this.on("onChange",n),()=>{this.off("onChange",n)}}onSelectionChange(e,t=!1){let n=n=>{!t&&NU(n.transaction)||e(this.editor)};return this.on("onSelectionChange",n),()=>{this.off("onSelectionChange",n)}}onMount(e){return this.on("onMount",e),()=>{this.off("onMount",e)}}onUnmount(e){return this.on("onUnmount",e),()=>{this.off("onUnmount",e)}}}function NU(e){return!!e.getMeta("y-sync$")}let Nz=null;function NV(e,t){let n=function(e){if("string"==typeof e){let t=(Nz||(Nz=document.implementation.createHTMLDocument("title"))).createElement("div");t.innerHTML=e,e=t}return e.querySelectorAll("li > ul, li > ol").forEach(e=>{let t=Array.prototype.indexOf.call(e.parentElement.childNodes,e),n=e.parentElement,r=Array.from(n.childNodes).slice(t+1);e.remove(),r.forEach(e=>{e.remove()}),n.insertAdjacentElement("afterend",e),r.reverse().forEach(t=>{if(3===t.nodeType&&!/\S/.test(t.nodeValue||""))return;let n=document.createElement("li");n.append(t),e.insertAdjacentElement("afterend",n)}),0===n.childNodes.length&&n.remove()}),e.querySelectorAll("li + ul, li + ol").forEach(e=>{var t,n;let r=e.previousElementSibling,o=document.createElement("div");r.insertAdjacentElement("afterend",o),o.append(r);let i=document.createElement("div");for(i.setAttribute("data-node-type","blockGroup"),o.append(i);(null==(t=o.nextElementSibling)?void 0:t.nodeName)==="UL"||(null==(n=o.nextElementSibling)?void 0:n.nodeName)==="OL";)i.append(o.nextElementSibling)}),e}(e),r=eX.fromSchema(t).parse(n,{topNode:t.nodes.blockGroup.create()}),o=[];for(let e=0;e<r.childCount;e++)o.push(ac(r.child(e),t));return o}function N$(e,t){let n=t.value?t.value:"",r={};t.lang&&(r["data-language"]=t.lang);let o={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return t.meta&&(o.data={meta:t.meta}),e.patch(t,o),o={type:"element",tagName:"pre",properties:{},children:[o=e.applyData(t,o)]},e.patch(t,o),o}function NG(e){return wm().use(_B).use(Tq).use(_J,{handlers:{..._$,image:(e,t)=>{var n;let r,o;return!function(e){var t;try{let n=(null==(t=new URL(e).pathname.split(".").pop())?void 0:t.toLowerCase())||"";return["mp4","webm","ogg","mov","mkv","flv","avi","wmv","m4v"].includes(n)}catch{return!1}}(String((null==t?void 0:t.url)||""))?_$.image(e,t):(o={type:"element",tagName:"video",properties:{src:r=String((null==t?void 0:t.url)||""),"data-name":null!=t&&t.title?String(t.title):void 0,"data-url":r,controls:!0},children:[]},null==(n=e.patch)||n.call(e,t,o),o=e.applyData?e.applyData(t,o):o)},code:N$,blockquote:(e,t)=>{let n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!1)};return e.patch(t,n),e.applyData(t,n)}}}).use(NN).processSync(e).value}class Nq{constructor(e){this.editor=e}blocksToHTMLLossy(e=this.editor.document){return wN(this.editor.pmSchema,this.editor).exportBlocks(e,{})}blocksToFullHTML(e=this.editor.document){var t,n;let r;return(t=this.editor.pmSchema,n=this.editor,r=e8.fromSchema(t),{serializeBlocks:(e,t)=>NL(n,e,r,t).outerHTML}).serializeBlocks(e,{})}tryParseHTMLToBlocks(e){return NV(e,this.editor.pmSchema)}blocksToMarkdownLossy(e=this.editor.document){var t,n,r;return t=this.editor.pmSchema,n=this.editor,r={},w5(wN(t,n).exportBlocks(e,r))}tryParseMarkdownToBlocks(e){var t;return t=this.editor.pmSchema,NV(NG(e),t)}pasteHTML(e,t=!1){var n;let r=e;if(!t){let t=this.tryParseHTMLToBlocks(e);r=this.blocksToFullHTML(t)}r&&(null==(n=this.editor.prosemirrorView)||n.pasteHTML(r))}pasteText(e){var t;return null==(t=this.editor.prosemirrorView)?void 0:t.pasteText(e)}pasteMarkdown(e){let t=NG(e);return this.pasteHTML(t)}}let NW=["vscode-editor-data","blocknote/html","text/markdown","text/html","text/plain","Files"];function NY(e,t,n,r="after"){return Array.isArray(t.content)&&0===t.content.length?e.updateBlock(t,n).id:e.insertBlocks([n],t,r)[0].id}async function NK(e,t){var n;if(!t.uploadFile)return void console.warn("Attempted ot insert file, but uploadFile is not set in the BlockNote editor options");let r="dataTransfer"in e?e.dataTransfer:e.clipboardData;if(null===r)return;let o=null;for(let e of NW)if(r.types.includes(e)){o=e;break}if("Files"!==o)return;let i=r.items;if(i){e.preventDefault();for(let r=0;r<i.length;r++){let o="file";for(let e of Object.values(t.schema.blockSpecs))for(let t of(null==(n=e.implementation.meta)?void 0:n.fileBlockAccept)||[]){let n=t.startsWith("."),s=i[r].getAsFile();if(s&&(!n&&s.type&&function(e,t){let n=e.split("/"),r=t.split("/");if(2!==n.length)throw Error(`The string ${e} is not a valid MIME type.`);if(2!==r.length)throw Error(`The string ${t} is not a valid MIME type.`);return"*"===n[1]||"*"===r[1]?n[0]===r[0]:("*"===n[0]||"*"===r[0]||n[0]===r[0])&&n[1]===r[1]}(i[r].type,t)||n&&function(e,t){if(!e.startsWith(".")||!t.startsWith("."))throw Error("The strings provided are not valid file extensions.");return e===t}("."+s.name.split(".").pop(),t))){o=e.config.type;break}}let s=i[r].getAsFile();if(s){let n,r={type:o,props:{name:s.name}};if("paste"===e.type){let e=t.getTextCursorPosition().block;n=NY(t,e,r)}else{if("drop"!==e.type)return;let o={left:e.clientX,top:e.clientY},i=t.prosemirrorView.posAtCoords(o);if(!i)return;n=t.transact(e=>{var n;let s=l4(e.doc,i.pos),l=null==(n=t.domElement)?void 0:n.querySelector(`[data-id="${s.node.attrs.id}"]`),a=null==l?void 0:l.getBoundingClientRect();return NY(t,t.getBlock(s.node.attrs.id),r,a&&(a.top+a.bottom)/2>o.top?"before":"after")})}let i=await t.uploadFile(s,n),l="string"==typeof i?{props:{url:i}}:{...i};t.updateBlock(n,l)}}}}let NZ=/(^|\n) {0,3}#{1,6} {1,8}[^\n]{1,64}\r?\n\r?\n\s{0,32}\S/,NX=/(_|__|\*|\*\*|~~|==|\+\+)(?!\s)(?:[^\s](?:.{0,62}[^\s])?|\S)(?=\1)/,NQ=/\[[^\]]{1,128}\]\(https?:\/\/\S{1,999}\)/,NJ=/(?:\s|^)`(?!\s)(?:[^\s`](?:[^`]{0,46}[^\s`])?|[^\s`])`([^\w]|$)/,N0=/(?:^|\n)\s{0,5}-\s{1}[^\n]+\n\s{0,15}-\s/,N1=/(?:^|\n)\s{0,5}\d+\.\s{1}[^\n]+\n\s{0,15}\d+\.\s/,N2=/\n{2} {0,3}-{2,48}\n{2}/,N4=/(?:\n|^)(```|~~~|\$\$)(?!`|~)[^\s]{0,64} {0,64}[^\n]{0,64}\n[\s\S]{0,9999}?\s*\1 {0,64}(?:\n+|$)/,N5=/(?:\n|^)(?!\s)\w[^\n]{0,64}\r?\n(-|=)\1{0,64}\n\n\s{0,64}(\w|$)/,N3=/(?:^|(\r?\n\r?\n))( {0,3}>[^\n]{1,333}\n){1,999}($|(\r?\n))/,N8=/^\s*\|(.+\|)+\s*$/m,N6=/^\s*\|(\s*[-:]+[-:]\s*\|)+\s*$/m,N9=/^\s*\|(.+\|)+\s*$/m;async function N7(e,t){let{schema:n}=t.state;if(!e.clipboardData)return!1;let r=e.clipboardData.getData("text/plain");if(!r)return!1;if(!n.nodes.codeBlock)return t.pasteText(r),!0;let o=e.clipboardData.getData("vscode-editor-data"),i=o?JSON.parse(o):void 0,s=null==i?void 0:i.mode;return!!s&&(t.pasteHTML(`<pre><code class="language-${s}">${r.replace(/\r\n?/g,`
`)}</code></pre>`),!0)}function Me(e,t){"node"in e.state.selection&&"blockContent"===e.state.selection.node.type.spec.group&&t.transact(t=>t.setSelection(new tG(t.doc.resolve(e.state.selection.from-1))));let n=e.serializeForClipboard(e.state.selection.content()).dom.innerHTML,r=e.state.selection.content().content,o=function(e,t,n){var r;let o,i=!1,s=e.state.selection instanceof aH;if(!s){let n=e.state.doc.slice(e.state.selection.from,e.state.selection.to,!1).content,r=[];for(let e=0;e<n.childCount;e++)r.push(n.child(e));(i=void 0===r.find(e=>e.type.isInGroup("bnBlock")||"blockGroup"===e.type.name||"blockContent"===e.type.spec.group))&&(t=n)}let l=wN(e.state.schema,n);if(s){(null==(r=t.firstChild)?void 0:r.type.name)==="table"&&(t=t.firstChild.content);let e=as(t,n.schema.inlineContentSchema,n.schema.styleSchema);o=`<table>${l.exportInlineContent(e,{})}</table>`}else if(i){let e=al(t,n.schema.inlineContentSchema,n.schema.styleSchema);o=l.exportInlineContent(e,{})}else{let e=w3(t);o=l.exportBlocks(e,{})}return o}(e,r,t),i=w5(o);return{clipboardHTML:n,externalHTML:o,markdown:i}}let Mt=()=>{let e=window.getSelection();if(!e||e.isCollapsed)return!0;let t=e.focusNode;for(;t;){if(t instanceof HTMLElement&&"false"===t.getAttribute("contenteditable"))return!0;t=t.parentElement}return!1},Mn=(e,t,n)=>{n.preventDefault(),n.clipboardData.clearData();let{clipboardHTML:r,externalHTML:o,markdown:i}=Me(t,e);n.clipboardData.setData("blocknote/html",r),n.clipboardData.setData("text/html",o),n.clipboardData.setData("text/plain",i)},Mr=lh.create({name:"blockBackgroundColor",addGlobalAttributes:()=>[{types:["tableCell","tableHeader"],attributes:{backgroundColor:((e="backgroundColor")=>({default:m5.backgroundColor.default,parseHTML:e=>e.hasAttribute("data-background-color")?e.getAttribute("data-background-color"):e.style.backgroundColor?e.style.backgroundColor:m5.backgroundColor.default,renderHTML:t=>t[e]===m5.backgroundColor.default?{}:{"data-background-color":t[e]}}))()}}]}),Mo=lB.create({name:"hardBreak",inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,priority:10,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:e}){return["br",sv(this.options.HTMLAttributes,e)]},renderText:()=>`
`}),Mi=(e,t)=>{let n=e.resolve(t),r=n.index();if(0===r)return;let o=n.posAtIndex(r-1);return l8(e.resolve(o))},Ms=(e,t)=>{for(;t.childContainer;){let n=t.childContainer.node,r=e.resolve(t.childContainer.beforePos+1).posAtIndex(n.childCount-1);t=l8(e.resolve(r))}return t},Ml=e=>({state:t,dispatch:n})=>{let r=l8(t.doc.resolve(e)),o=Mi(t.doc,r.bnBlock.beforePos);if(!o)return!1;let i=Ms(t.doc,o);return!!i.isBlockContainer&&"inline*"===i.blockContent.node.type.spec.content&&i.blockContent.node.childCount>0&&!!r.isBlockContainer&&"inline*"===r.blockContent.node.type.spec.content&&((e,t,n,r)=>{if(!r.isBlockContainer)throw Error(`Attempted to merge block at position ${r.bnBlock.beforePos} into previous block at position ${n.bnBlock.beforePos}, but next block is not a block container`);if(r.childContainer){let n=e.doc.resolve(r.childContainer.beforePos+1),o=e.doc.resolve(r.childContainer.afterPos-1),i=n.blockRange(o);if(t){let t=e.doc.resolve(r.bnBlock.beforePos);e.tr.lift(i,t.depth)}}if(t){if(!n.isBlockContainer)throw Error(`Attempted to merge block at position ${r.bnBlock.beforePos} into previous block at position ${n.bnBlock.beforePos}, but previous block is not a block container`);t(e.tr.delete(n.blockContent.afterPos-1,r.blockContent.beforePos+1))}return!0})(t,n,i,r)},Ma=lh.create({priority:50,addKeyboardShortcuts(){let e=(e=!1)=>this.editor.commands.first(({commands:t,tr:n})=>[()=>t.command(({state:e})=>{let n=l6(e);if(!n.isBlockContainer)return!1;let{bnBlock:r,blockContent:o}=n,{depth:i}=e.doc.resolve(r.beforePos),s=0===e.selection.$anchor.parentOffset,l=e.selection.anchor===e.selection.head,a=0===o.node.childCount;return!!s&&!!l&&!!a&&i>1&&t.liftListItem("blockContainer")}),()=>t.command(({state:t})=>{var r;let o=l6(t),i=(null==(r=this.options.editor.schema.blockSchema[o.blockNoteType].meta)?void 0:r.hardBreakShortcut)??"shift+enter";if("none"===i)return!1;if("shift+enter"===i&&e||"enter"===i){let e=n.storedMarks||n.selection.$head.marks().filter(e=>this.editor.extensionManager.splittableMarks.includes(e.type.name));return n.insert(n.selection.head,n.doc.type.schema.nodes.hardBreak.create()).ensureMarks(e),!0}return!1}),()=>t.command(({state:e,dispatch:t})=>{let n=l6(e);if(!n.isBlockContainer)return!1;let{bnBlock:r,blockContent:o}=n,i=0===e.selection.$anchor.parentOffset,s=e.selection.anchor===e.selection.head,l=0===o.node.childCount;if(i&&s&&l){let n=r.afterPos;if(t){let t=e.schema.nodes.blockContainer.createAndFill();e.tr.insert(n,t).scrollIntoView(),e.tr.setSelection(new tV(e.doc.resolve(n+2)))}return!0}return!1}),()=>t.command(({state:e,chain:t})=>{let n,r=l6(e);if(!r.isBlockContainer)return!1;let{blockContent:o}=r,i=0===e.selection.$anchor.parentOffset;return 0!==o.node.childCount&&(t().deleteSelection().command((n=e.selection.from,({state:e,dispatch:t})=>!t||gw(e.tr,n,i,i))).run(),!0)})]);return{Backspace:()=>this.editor.commands.first(({chain:e,commands:t})=>[()=>t.deleteSelection(),()=>t.undoInputRule(),()=>t.command(({state:e})=>{let n,r,o=l6(e);if(!o.isBlockContainer)return!1;let i=e.selection.from===o.blockContent.beforePos+1,s="paragraph"===o.blockContent.node.type.name;return!!i&&!s&&t.command((n=o.bnBlock.beforePos,r={type:"paragraph",props:{}},({tr:e,dispatch:t})=>(t&&m1(e,n,r),!0)))}),()=>t.command(({state:e})=>{let n=l6(e);if(!n.isBlockContainer)return!1;let{blockContent:r}=n;return e.selection.from===r.beforePos+1&&t.liftListItem("blockContainer")}),()=>t.command(({state:t})=>{let n=l6(t);if(!n.isBlockContainer)return!1;let{bnBlock:r,blockContent:o}=n,i=t.selection.from===o.beforePos+1,s=t.selection.empty,l=r.beforePos;return!!i&&!!s&&e().command(Ml(l)).scrollIntoView().run()}),()=>t.command(({state:e,tr:t,dispatch:n})=>{let r=l6(e);if(!r.isBlockContainer||t.selection.from!==r.blockContent.beforePos+1)return!1;let o=t.doc.resolve(r.bnBlock.beforePos);if(o.nodeBefore||"column"!==o.node().type.name)return!1;let i=t.doc.resolve(r.bnBlock.beforePos),s=t.doc.resolve(i.before()),l=s.before();if(n){let e=t.doc.slice(r.bnBlock.beforePos,r.bnBlock.afterPos).content;t.delete(r.bnBlock.beforePos,r.bnBlock.afterPos),0===s.index()?(ND(t,l),t.insert(l,e),t.setSelection(tV.near(t.doc.resolve(l)))):(t.insert(s.pos-1,e),t.setSelection(tV.near(t.doc.resolve(s.pos-1))),ND(t,l))}return!0}),()=>t.command(({state:t})=>{let n=l6(t);if(!n.isBlockContainer)return!1;if(0===n.blockContent.node.childCount&&"inline*"===n.blockContent.node.type.spec.content){let r=Mi(t.doc,n.bnBlock.beforePos);if(!r||!r.isBlockContainer)return!1;let o=e();if("tableRow+"===r.blockContent.node.type.spec.content){let e=n.bnBlock.beforePos-1-1-1-1-1;o=o.setTextSelection(e)}else if(""===r.blockContent.node.type.spec.content){let e=r.blockContent.afterPos-r.blockContent.node.nodeSize;o=o.setNodeSelection(e)}else{let e=r.blockContent.afterPos-r.blockContent.node.nodeSize;o=o.setTextSelection(e)}return o.deleteRange({from:n.bnBlock.beforePos,to:n.bnBlock.afterPos}).scrollIntoView().run()}return!1}),()=>t.command(({state:t})=>{let n=l6(t);if(!n.isBlockContainer)throw Error("todo");let r=t.selection.from===n.blockContent.beforePos+1,o=t.selection.empty,i=Mi(t.doc,n.bnBlock.beforePos);if(i&&r&&o){let r=Ms(t.doc,i);if(!r.isBlockContainer)throw Error("todo");if(""===r.blockContent.node.type.spec.content||"inline*"===r.blockContent.node.type.spec.content&&0===r.blockContent.node.childCount)return e().cut({from:n.bnBlock.beforePos,to:n.bnBlock.afterPos},r.bnBlock.afterPos).deleteRange({from:r.bnBlock.beforePos,to:r.bnBlock.afterPos}).run()}return!1})]),Delete:()=>this.editor.commands.first(({commands:e})=>[()=>e.deleteSelection(),()=>e.command(({state:t})=>{let n=l6(t);if(!n.isBlockContainer)return!1;let{bnBlock:r,blockContent:o,childContainer:i}=n,{depth:s}=t.doc.resolve(r.beforePos),l=r.afterPos===t.doc.nodeSize-3,a=t.selection.from===o.afterPos-1,c=t.selection.empty;if(!l&&a&&c&&void 0===i){let n=s,o=r.afterPos+1,i=t.doc.resolve(o).depth;for(;i<n;)n=i,o+=2,i=t.doc.resolve(o).depth;return e.command(Ml(o-1))}return!1})]),Enter:()=>e(),"Shift-Enter":()=>e(!0),Tab:()=>{var e,t;return("prefer-indent"===this.options.tabBehavior||(null==(e=this.options.editor.getExtension(wz))||!e.store.state)&&(null==(t=this.options.editor.getExtension(m9))?void 0:t.store.state)===void 0)&&NH(this.options.editor)},"Shift-Tab":()=>{var e,t;return("prefer-indent"===this.options.tabBehavior||(null==(e=this.options.editor.getExtension(wz))||!e.store.state)&&(null==(t=this.options.editor.getExtension(m9))?void 0:t.store.state)===void 0)&&this.editor.commands.liftListItem("blockContainer")},"Shift-Mod-ArrowUp":()=>(this.options.editor.moveBlocksUp(),!0),"Shift-Mod-ArrowDown":()=>(this.options.editor.moveBlocksDown(),!0),"Mod-z":()=>this.options.editor.undo(),"Mod-y":()=>this.options.editor.redo(),"Shift-Mod-z":()=>this.options.editor.redo()}}}),Mc=ll.create({name:"insertion",inclusive:!1,excludes:"deletion modification insertion",addAttributes:()=>({id:{default:null,validate:"number"}}),extendMarkSchema:e=>"insertion"!==e.name?{}:{blocknoteIgnore:!0,inclusive:!1,toDOM:(e,t)=>["ins",{"data-id":String(e.attrs.id),"data-inline":String(t),...!t&&{style:"display: contents"}},0],parseDOM:[{tag:"ins",getAttrs:e=>!!e.dataset.id&&{id:parseInt(e.dataset.id,10)}}]}}),Md=ll.create({name:"deletion",inclusive:!1,excludes:"insertion modification deletion",addAttributes:()=>({id:{default:null,validate:"number"}}),extendMarkSchema:e=>"deletion"!==e.name?{}:{blocknoteIgnore:!0,inclusive:!1,toDOM:(e,t)=>["del",{"data-id":String(e.attrs.id),"data-inline":String(t),...!t&&{style:"display: contents"}},0],parseDOM:[{tag:"del",getAttrs:e=>!!e.dataset.id&&{id:parseInt(e.dataset.id,10)}}]}}),Mu=ll.create({name:"modification",inclusive:!1,excludes:"deletion insertion",addAttributes:()=>({id:{default:null,validate:"number"},type:{validate:"string"},attrName:{default:null,validate:"string|null"},previousValue:{default:null},newValue:{default:null}}),extendMarkSchema:e=>"modification"!==e.name?{}:{blocknoteIgnore:!0,inclusive:!1,toDOM:(e,t)=>[t?"span":"div",{"data-type":"modification","data-id":String(e.attrs.id),"data-mod-type":e.attrs.type,"data-mod-prev-val":JSON.stringify(e.attrs.previousValue),"data-mod-new-val":JSON.stringify(e.attrs.newValue)},0],parseDOM:[{tag:"span[data-type='modification']",getAttrs:e=>!!e.dataset.id&&{id:parseInt(e.dataset.id,10),type:e.dataset.modType,previousValue:e.dataset.modPrevVal,newValue:e.dataset.modNewVal}},{tag:"div[data-type='modification']",getAttrs:e=>!!e.dataset.id&&{id:parseInt(e.dataset.id,10),type:e.dataset.modType,previousValue:e.dataset.modPrevVal}}]}}),Mh=lh.create({name:"textAlignment",addGlobalAttributes:()=>[{types:["tableCell","tableHeader"],attributes:{textAlignment:{default:"left",parseHTML:e=>e.getAttribute("data-text-alignment"),renderHTML:e=>"left"===e.textAlignment?{}:{"data-text-alignment":e.textAlignment}}}}]}),Mp=lh.create({name:"blockTextColor",addGlobalAttributes:()=>[{types:["table","tableCell","tableHeader"],attributes:{textColor:((e="textColor")=>({default:m5.textColor.default,parseHTML:e=>e.hasAttribute("data-text-color")?e.getAttribute("data-text-color"):e.style.color?e.style.color:m5.textColor.default,renderHTML:t=>t[e]===m5.textColor.default?{}:{"data-text-color":t[e]}}))()}}]}),Mf={blockColor:"data-block-color",blockStyle:"data-block-style",id:"data-id",depth:"data-depth",depthChange:"data-depth-change"},Mm=lB.create({name:"blockContainer",group:"blockGroupChild bnBlock",content:"blockContent blockGroup?",priority:50,defining:!0,marks:"insertion modification deletion",parseHTML(){return[{tag:"div[data-node-type="+this.name+"]",getAttrs:e=>{if("string"==typeof e)return!1;let t={};for(let[n,r]of Object.entries(Mf))e.getAttribute(r)&&(t[n]=e.getAttribute(r));return t}},{tag:'div[data-node-type="blockOuter"]',skip:!0}]},renderHTML({HTMLAttributes:e}){var t;let n=document.createElement("div");for(let[t,r]of(n.className="bn-block-outer",n.setAttribute("data-node-type","blockOuter"),Object.entries(e)))"class"!==t&&n.setAttribute(t,r);let r={...(null==(t=this.options.domAttributes)?void 0:t.block)||{},...e},o=document.createElement("div");for(let[e,t]of(o.className=mF("bn-block",r.class),o.setAttribute("data-node-type",this.name),Object.entries(r)))"class"!==e&&o.setAttribute(e,t);return n.appendChild(o),{dom:n,contentDOM:o}}}),Mg=lB.create({name:"blockGroup",group:"childContainer",content:"blockGroupChild+",marks:"deletion insertion modification",parseHTML:()=>[{tag:"div",getAttrs:e=>"string"!=typeof e&&"blockGroup"===e.getAttribute("data-node-type")&&null}],renderHTML({HTMLAttributes:e}){var t;let n={...(null==(t=this.options.domAttributes)?void 0:t.blockGroup)||{},...e},r=document.createElement("div");for(let[e,t]of(r.className=mF("bn-block-group",n.class),r.setAttribute("data-node-type","blockGroup"),Object.entries(n)))"class"!==e&&r.setAttribute(e,t);return{dom:r,contentDOM:r}}}),Mb=lB.create({name:"doc",topNode:!0,content:"blockGroup",marks:"insertion modification deletion"}),My=mm(({options:e})=>({key:"collaboration",blockNoteExtensions:[wB(e),wR(e),wL(e),wP(),wF(e)]})),Mv=!1;class ME{constructor(e,t){for(const n of(NI(this,"disabledExtensions",new Set),NI(this,"extensions",[]),NI(this,"abortMap",new Map),NI(this,"extensionFactories",new Map),NI(this,"extensionPlugins",new Map),this.editor=e,this.options=t,e.onMount(()=>{for(let t of this.extensions)if(t.mount){let n=new window.AbortController,r=t.mount({dom:e.prosemirrorView.dom,root:e.prosemirrorView.root,signal:n.signal});r&&n.signal.addEventListener("abort",()=>{r()}),this.abortMap.set(t,n)}}),e.onUnmount(()=>{for(let[e,t]of this.abortMap.entries())this.abortMap.delete(e),t.abort()}),this.disabledExtensions=new Set(t.disableExtensions||[]),function(e,t){let n=[wO(),wU(t),m9(t),wz(t),w$(t),wY(),wZ(t),g9(t),xn(t),gJ(t),...!1!==t.trailingBlock?[xc()]:[]];return t.collaboration?n.push(My(t.collaboration)):n.push(wV()),"table"in e.schema.blockSpecs&&n.push(xl(t)),!1!==t.animations&&n.push(wJ()),n}(this.editor,this.options)))this.addExtension(n);for(const e of this.options.extensions??[])this.addExtension(e);for(const e of Object.values(this.editor.schema.blockSpecs))for(const t of e.extensions??[])this.addExtension(t)}registerExtension(e){var t;let n=[].concat(e).filter(Boolean);if(!n.length)return void console.warn("No extensions found to register",e);let r=n.map(e=>this.addExtension(e)).filter(Boolean),o=new Set;for(let e of r)null!=e&&e.tiptapExtensions&&console.warn(`Extension ${e.key} has tiptap extensions, but these cannot be changed after initializing the editor. Please separate the extension into multiple extensions if you want to add them, or re-initialize the editor.`,e),null!=(t=null==e?void 0:e.inputRules)&&t.length&&console.warn(`Extension ${e.key} has input rules, but these cannot be changed after initializing the editor. Please separate the extension into multiple extensions if you want to add them, or re-initialize the editor.`,e),this.getProsemirrorPluginsFromExtension(e).plugins.forEach(e=>{o.add(e)});this.updatePlugins(e=>[...e,...o])}addExtension(e){let t;if(!(!(t="function"==typeof e?e({editor:this.editor}):e)||this.disabledExtensions.has(t.key))){if("function"==typeof e){let e=t[mf];"function"==typeof e&&this.extensionFactories.set(e,t)}if(this.extensions.push(t),t.blockNoteExtensions)for(let e of t.blockNoteExtensions)this.addExtension(e);return t}}resolveExtensions(e){let t=[];if("function"==typeof e){let n=this.extensionFactories.get(e);n&&t.push(n)}else if(Array.isArray(e))for(let n of e)t.push(...this.resolveExtensions(n));else if("object"==typeof e&&"key"in e)t.push(e);else if("string"==typeof e){let n=this.extensions.find(t=>t.key===e);n&&t.push(n)}return t}unregisterExtension(e){var t;let n=this.resolveExtensions(e);if(!n.length)return void console.warn("No extensions found to unregister",e);let r=!1,o=new Set;for(let i of n){this.extensions=this.extensions.filter(e=>e!==i),this.extensionFactories.forEach((e,t)=>{e===i&&this.extensionFactories.delete(t)}),null==(t=this.abortMap.get(i))||t.abort(),this.abortMap.delete(i);let n=this.extensionPlugins.get(i);null==n||n.forEach(e=>{o.add(e)}),this.extensionPlugins.delete(i),i.tiptapExtensions&&!r&&(r=!0,console.warn(`Extension ${i.key} has tiptap extensions, but they will not be removed. Please separate the extension into multiple extensions if you want to remove them, or re-initialize the editor.`,e))}this.updatePlugins(e=>e.filter(e=>!o.has(e)))}updatePlugins(e){let t=this.editor.prosemirrorState,n=t.reconfigure({plugins:e(t.plugins.slice())});this.editor.prosemirrorView.updateState(n)}getTiptapExtensions(){var e,t,n;let r,o,i=(t=this.editor,n=this.options,o=[lu.ClipboardTextSerializer,lu.Commands,lu.Editable,lu.FocusEvents,lu.Tabindex,Sb,lq.configure({types:["blockContainer","columnList","column"],setIdAttribute:n.setIdAttribute}),Mo,AZ,Mc,Md,Mu,AK.extend({inclusive:!1}).configure({defaultProtocol:wq,protocols:Mv?[]:wG}),...Object.values(t.schema.styleSpecs).map(e=>e.implementation.mark.configure({editor:t})),Mp,Mr,Mh,lh.create({name:"OverrideEscape",addKeyboardShortcuts:()=>({Escape:()=>{var e;return!(null!=(e=t.getExtension(gJ))&&e.shown())&&(t.blur(),!0)}})}),Mb,Mm.configure({editor:t,domAttributes:n.domAttributes}),Ma.configure({editor:t,tabBehavior:n.tabBehavior}),Mg.configure({domAttributes:n.domAttributes}),...Object.values(t.schema.inlineContentSpecs).filter(e=>"link"!==e.config&&"text"!==e.config).map(e=>e.implementation.node.configure({editor:t})),...Object.values(t.schema.blockSpecs).flatMap(e=>[..."node"in e.implementation?[e.implementation.node.configure({editor:t,domAttributes:n.domAttributes})]:[]]),lh.create({name:"copyToClipboard",addProseMirrorPlugins:()=>[new t4({props:{handleDOMEvents:{copy:(e,n)=>(Mt()||Mn(t,e,n),!0),cut:(e,n)=>(Mt()||(Mn(t,e,n),e.editable&&e.dispatch(e.state.tr.deleteSelection())),!0),dragstart(e,n){if(!("node"in e.state.selection)||"blockContent"!==e.state.selection.node.type.spec.group)return;t.transact(t=>t.setSelection(new tG(t.doc.resolve(e.state.selection.from-1)))),n.preventDefault(),n.dataTransfer.clearData();let{clipboardHTML:r,externalHTML:o,markdown:i}=Me(e,t);return n.dataTransfer.setData("blocknote/html",r),n.dataTransfer.setData("text/html",o),n.dataTransfer.setData("text/plain",i),!0}}}})]}),(r=n.pasteHandler||(e=>e.defaultPasteHandler()),lh.create({name:"pasteFromClipboard",addProseMirrorPlugins:()=>[new t4({props:{handleDOMEvents:{paste(e,n){if(n.preventDefault(),t.isEditable)return r({event:n,editor:t,defaultPasteHandler:({prioritizeMarkdownOverHTML:e=!0,plainTextAsMarkdown:r=!0}={})=>(function({event:e,editor:t,prioritizeMarkdownOverHTML:n,plainTextAsMarkdown:r}){var o;let i;if(t.transact(e=>e.selection.$from.parent.type.spec.code&&e.selection.$to.parent.type.spec.code)){let n=null==(o=e.clipboardData)?void 0:o.getData("text/plain");if(n)return t.pasteText(n),!0}for(let t of NW)if(e.clipboardData.types.includes(t)){i=t;break}if(!i)return!0;if("vscode-editor-data"===i)return N7(e,t.prosemirrorView),!0;if("Files"===i)return NK(e,t),!0;let s=e.clipboardData.getData(i);if("blocknote/html"===i)return t.pasteHTML(s,!0),!0;if("text/markdown"===i)return t.pasteMarkdown(s),!0;if(n){let n=e.clipboardData.getData("text/plain");if(NZ.test(n)||NX.test(n)||NQ.test(n)||NJ.test(n)||N0.test(n)||N1.test(n)||N2.test(n)||N4.test(n)||N5.test(n)||N3.test(n)||N8.test(n)||N6.test(n)||N9.test(n))return t.pasteMarkdown(n),!0}return"text/html"===i?t.pasteHTML(s):r?t.pasteMarkdown(s):t.pasteText(s),!0})({event:n,editor:t,prioritizeMarkdownOverHTML:e,plainTextAsMarkdown:r})})}}}})]})),lh.create({name:"dropFile",addProseMirrorPlugins:()=>[new t4({props:{handleDOMEvents:{drop(e,n){if(!t.isEditable)return;let r=null;for(let e of NW)if(n.dataTransfer.types.includes(e)){r=e;break}return null===r||"Files"===r&&(NK(n,t),!0)}}}})]})],Mv=!0,o).filter(e=>!this.disabledExtensions.has(e.name)),s=Sn(this.extensions),l=new Map;for(let e of this.extensions){e.tiptapExtensions&&i.push(...e.tiptapExtensions);let t=s(e.key),{plugins:n,inputRules:r}=this.getProsemirrorPluginsFromExtension(e);n.length&&i.push(lh.create({name:e.key,priority:t,addProseMirrorPlugins:()=>n})),r.length&&(l.has(t)||l.set(t,[]),l.get(t).push(...r))}for(let t of(i.push(lh.create({name:"blocknote-input-rules",addProseMirrorPlugins(){let e=[];return Array.from(l.keys()).sort().reverse().forEach(t=>{e.push(...l.get(t))}),[function({rules:e}){let t=new t4({state:{init:()=>null,apply(e,t){let n=e.getMeta(this);return n||(e.selectionSet||e.docChanged?null:t)}},props:{handleTextInput:(n,r,o,i)=>Sa(n,r,o,i,e,t),handleDOMEvents:{compositionend:n=>{setTimeout(()=>{let{$cursor:r}=n.state.selection;r&&Sa(n,r.pos,r.pos,"",e,t)})}}},isInputRules:!0});return t}({rules:e})]}})),(null==(e=this.options._tiptapOptions)?void 0:e.extensions)??[]))i.push(t);return i}getProsemirrorPluginsFromExtension(e){var t,n,r;let o=[...e.prosemirrorPlugins??[]],i=[];return(null!=(t=e.prosemirrorPlugins)&&t.length||Object.keys(e.keyboardShortcuts||{}).length||null!=(n=e.inputRules)&&n.length)&&(this.extensionPlugins.set(e,o),null!=(r=e.inputRules)&&r.length&&i.push(...e.inputRules.map(e=>new Sl(e.find,(t,n,r,o)=>{let i=e.replace({match:n,range:{from:r,to:o},editor:this.editor});if(i){let e=this.editor.getTextCursorPosition();if("inline"!==this.editor.schema.blockSchema[e.block.type].content)return null;let n=l9(t.tr),s=t.tr.deleteRange(r,o);return m1(s,n.bnBlock.beforePos,i),s}return null}))),Object.keys(e.keyboardShortcuts||{}).length&&o.push(it(Object.fromEntries(Object.entries(e.keyboardShortcuts).map(([e,t])=>[e,()=>t({editor:this.editor})]))))),{plugins:o,inputRules:i}}getExtensions(){return new Map(this.extensions.map(e=>[e.key,e]))}getExtension(e){if("string"==typeof e)return this.extensions.find(t=>t.key===e)||void 0;if("function"==typeof e)return this.extensionFactories.get(e)||void 0;throw Error(`Invalid extension type: ${typeof e}`)}hasExtension(e){return"string"==typeof e?this.extensions.some(t=>t.key===e):"object"==typeof e&&"key"in e?this.extensions.some(t=>t.key===e.key):"function"==typeof e&&this.extensionFactories.has(e)}}class Mk{constructor(e){this.editor=e}getSelection(){return this.editor.transact(e=>(function(e){let t=l7(e);if(e.selection.empty||"node"in e.selection)return;let n=e.doc.resolve(l4(e.doc,e.selection.from).posBeforeNode),r=e.doc.resolve(l4(e.doc,e.selection.to).posBeforeNode),o=(r,o)=>{let i=n.posAtIndex(r,o),s=e.doc.resolve(i).nodeAfter;if(!s)throw Error(`Error getting selection - node not found at position ${i}`);return ac(s,t)},i=[],s=n.sharedDepth(r.pos),l=n.index(s),a=r.index(s);if(n.depth>s){i.push(ac(n.nodeAfter,t));for(let e=n.depth;e>s;e--)if(n.node(e).type.isInGroup("childContainer")){let t=n.index(e)+1,r=n.node(e).childCount;for(let n=t;n<r;n++)i.push(o(n,e))}}else i.push(o(l,s));for(let e=l+1;e<=a;e++)i.push(o(e,s));if(0===i.length)throw Error(`Error getting selection - selection doesn't span any blocks (${e.selection})`);return{blocks:i}})(e))}getSelectionCutBlocks(e=!1){return this.editor.transact(t=>(function(e,t=!1){let n=l7(e),r=t?function(e,t){let{$from:n,$to:r}=t;if(n.pos>n.start()&&n.pos<e.content.size){let t=e.textBetween(n.pos,n.pos+1);if(/^[\w\p{P}]$/u.test(t)){let t=e.textBetween(n.start(),n.pos).match(/[\w\p{P}]+$/u);t&&(n=e.resolve(n.pos-t[0].length))}}if(r.pos<r.end()&&r.pos>0){let t=e.textBetween(r.pos-1,r.pos);if(/^[\w\p{P}]$/u.test(t)){let t=e.textBetween(r.pos,r.end()).match(/^[\w\p{P}]+/u);t&&(r=e.resolve(r.pos+t[0].length))}}return{$from:n,$to:r,from:n.pos,to:r.pos}}(e.doc,e.selection):e.selection,o=r.$from,i=r.$to;for(;i.parentOffset>=i.parent.nodeSize-2&&i.depth>0;)i=e.doc.resolve(i.pos+1);for(;0===i.parentOffset&&i.depth>0;)i=e.doc.resolve(i.pos-1);for(;0===o.parentOffset&&o.depth>0;)o=e.doc.resolve(o.pos-1);for(;o.parentOffset>=o.parent.nodeSize-2&&o.depth>0;)o=e.doc.resolve(o.pos+1);let s=function(e,t,n=an(t),r=ar(t),o=ao(t),i=ai(t)){if(0===e.content.childCount)return{blocks:[],blockCutAtStart:void 0,blockCutAtEnd:void 0};if(1!==e.content.childCount)throw Error("slice must be a single block, did you forget includeParents=true?");return function e(s,l,a){let c,d;if("blockGroup"!==s.type.name)throw Error("unexpected");let u=[];return s.forEach((h,p,f)=>{if("blockContainer"!==h.type.name)throw Error("unexpected");if(0===h.childCount)return;if(0===h.childCount||h.childCount>2)throw Error("unexpected, blockContainer.childCount: "+h.childCount);let m=0===f,g=f===s.childCount-1;if("blockGroup"===h.firstChild.type.name){if(!m)throw Error("unexpected");let t=e(h.firstChild,Math.max(0,l-1),g?Math.max(0,a-1):0);c=t.blockCutAtStart,g&&(d=t.blockCutAtEnd),u.push(...t.blocks);return}let b=ac(h,t,n,r,o,i),y=h.childCount>1?h.child(1):void 0,v=[];if(y){let t=e(y,0,g?Math.max(0,a-1):0);v=t.blocks,g&&(d=t.blockCutAtEnd)}g&&!y&&a>1&&(d=b.id),m&&l>1&&(c=b.id),u.push({...b,children:v})}),{blocks:u,blockCutAtStart:c,blockCutAtEnd:d}}(e.content.firstChild,Math.max(e.openStart-1,0),Math.max(e.openEnd-1,0))}(e.doc.slice(o.pos,i.pos,!0),n);return{_meta:{startPos:o.pos,endPos:i.pos},...s}})(t,e))}setSelection(e,t){return this.editor.transact(n=>(function(e,t,n){let r,o,i="string"==typeof t?t:t.id,s="string"==typeof n?n:n.id,l=at(l7(e));if(i===s)throw Error(`Attempting to set selection with the same anchor and head blocks (id ${i})`);let a=mJ(i,e.doc);if(!a)throw Error(`Block with ID ${i} not found`);let c=mJ(s,e.doc);if(!c)throw Error(`Block with ID ${s} not found`);let d=l3(a),u=l3(c),h=l.blockSchema[d.blockNoteType],p=l.blockSchema[u.blockNoteType];if(!d.isBlockContainer||"none"===h.content)throw Error(`Attempting to set selection anchor in block without content (id ${i})`);if(!u.isBlockContainer||"none"===p.content)throw Error(`Attempting to set selection anchor in block without content (id ${s})`);if("table"===h.content){let e=aA.get(d.blockContent.node);r=d.blockContent.beforePos+e.positionAt(0,0,d.blockContent.node)+1+2}else r=d.blockContent.beforePos+1;if("table"===p.content){let t=aA.get(u.blockContent.node),n=u.blockContent.beforePos+t.positionAt(t.height-1,t.width-1,u.blockContent.node)+1,r=e.doc.resolve(n).nodeAfter.nodeSize;o=n+r-2}else o=u.blockContent.afterPos-1;e.setSelection(tV.create(e.doc,r,o))})(n,e,t))}getTextCursorPosition(){return this.editor.transact(e=>(function(e){let t,{bnBlock:n}=l9(e),r=l7(e.doc),o=e.doc.resolve(n.beforePos),i=o.nodeBefore,s=e.doc.resolve(n.afterPos).nodeAfter;return o.depth>1&&((t=o.node()).type.isInGroup("bnBlock")||(t=o.node(o.depth-1))),{block:ac(n.node,r),prevBlock:null===i?void 0:ac(i,r),nextBlock:null===s?void 0:ac(s,r),parentBlock:void 0===t?void 0:ac(t,r)}})(e))}setTextCursorPosition(e,t="start"){return this.editor.transact(n=>(function e(t,n,r="start"){let o="string"==typeof n?n:n.id,i=at(l7(t.doc)),s=mJ(o,t.doc);if(!s)throw Error(`Block with ID ${o} not found`);let l=l3(s),a=i.blockSchema[l.blockNoteType].content;if(l.isBlockContainer){let e=l.blockContent;if("none"===a)return void t.setSelection(tG.create(t.doc,e.beforePos));if("inline"===a)"start"===r?t.setSelection(tV.create(t.doc,e.beforePos+1)):t.setSelection(tV.create(t.doc,e.afterPos-1));else if("table"===a)"start"===r?t.setSelection(tV.create(t.doc,e.beforePos+4)):t.setSelection(tV.create(t.doc,e.afterPos-4));else throw new l1(a)}else e(t,("start"===r?l.childContainer.node.firstChild:l.childContainer.node.lastChild).attrs.id,r)})(n,e,t))}getSelectionBoundingBox(){if(!this.editor.prosemirrorView)return;let{selection:e}=this.editor.prosemirrorState,{ranges:t}=e,n=Math.min(...t.map(e=>e.$from.pos)),r=Math.max(...t.map(e=>e.$to.pos));if(sH(e)){let e=this.editor.prosemirrorView.nodeDOM(n);if(e)return e.getBoundingClientRect()}return sz(this.editor.prosemirrorView,n,r).toJSON()}}class MC{constructor(e){NI(this,"activeTransaction",null),NI(this,"isInCan",!1),this.editor=e}can(e){try{return this.isInCan=!0,e()}finally{this.isInCan=!1}}exec(e){if(this.activeTransaction)throw Error("`exec` should not be called within a `transact` call, move the `exec` call outside of the `transact` call");return this.isInCan?this.canExec(e):e(this.prosemirrorState,e=>this.prosemirrorView.dispatch(e),this.prosemirrorView)}canExec(e){if(this.activeTransaction)throw Error("`canExec` should not be called within a `transact` call, move the `canExec` call outside of the `transact` call");return e(this.prosemirrorState,void 0,this.prosemirrorView)}transact(e){if(this.activeTransaction)return e(this.activeTransaction);try{this.activeTransaction=this.editor._tiptapEditor.state.tr;let t=e(this.activeTransaction),n=this.activeTransaction;return this.activeTransaction=null,n&&(n.docChanged||n.selectionSet||n.scrolledIntoView||n.storedMarksSet||!n.isGeneric)&&this.prosemirrorView.dispatch(n),t}finally{this.activeTransaction=null}}get prosemirrorState(){if(this.activeTransaction)throw Error("`prosemirrorState` should not be called within a `transact` call, move the `prosemirrorState` call outside of the `transact` call or use `editor.transact` to read the current editor state");return this.editor._tiptapEditor.state}get prosemirrorView(){return this.editor._tiptapEditor.view}isFocused(){var e;return(null==(e=this.prosemirrorView)?void 0:e.hasFocus())||!1}focus(){var e;null==(e=this.prosemirrorView)||e.focus()}get isEditable(){if(!this.editor._tiptapEditor){if(!this.editor.headless)throw Error("no editor, but also not headless?");return!1}return void 0===this.editor._tiptapEditor.isEditable||this.editor._tiptapEditor.isEditable}set isEditable(e){if(!this.editor._tiptapEditor){if(!this.editor.headless)throw Error("no editor, but also not headless?");return}this.editor._tiptapEditor.options.editable!==e&&this.editor._tiptapEditor.setEditable(e)}undo(){let e=this.editor.getExtension("yUndo");if(e)return this.exec(e.undoCommand);let t=this.editor.getExtension("history");if(t)return this.exec(t.undoCommand);throw Error("No undo plugin found")}redo(){let e=this.editor.getExtension("yUndo");if(e)return this.exec(e.redoCommand);let t=this.editor.getExtension("history");if(t)return this.exec(t.redoCommand);throw Error("No redo plugin found")}}class MT{constructor(e){this.editor=e}insertInlineContent(e,{updateSelection:t=!1}={}){let n=aC(e,this.editor.pmSchema);this.editor.transact(e=>{!function(e,t,n,r={updateSelection:!0}){let{from:o,to:i}="number"==typeof t?{from:t,to:t}:{from:t.from,to:t.to},s=!0,l=!0,a="";if(n.forEach(e=>{e.check(),s&&e.isText&&0===e.marks.length?a+=e.text:s=!1,l=!!l&&e.isBlock}),o===i&&l){let{parent:t}=e.doc.resolve(o);!t.isTextblock||t.type.spec.code||t.childCount||(o-=1,i+=1)}s?e.insertText(a,o,i):e.replaceWith(o,i,n),r.updateSelection&&iz(e,e.steps.length-1,-1)}(e,{from:e.selection.from,to:e.selection.to},n,{updateSelection:t})})}getActiveStyles(){return this.editor.transact(e=>{let t={};for(let n of e.selection.$to.marks()){let e=this.editor.schema.styleSchema[n.type.name];if(!e){"link"===n.type.name||n.type.spec.blocknoteIgnore||console.warn("mark not found in styleschema",n.type.name);continue}"boolean"===e.propSchema?t[e.type]=!0:t[e.type]=n.attrs.stringValue}return t})}addStyles(e){for(let[t,n]of Object.entries(e)){let e=this.editor.schema.styleSchema[t];if(!e)throw Error(`style ${t} not found in styleSchema`);if("boolean"===e.propSchema)this.editor._tiptapEditor.commands.setMark(t);else if("string"===e.propSchema)this.editor._tiptapEditor.commands.setMark(t,{stringValue:n});else throw new l1(e.propSchema)}}removeStyles(e){for(let t of Object.keys(e))this.editor._tiptapEditor.commands.unsetMark(t)}toggleStyles(e){for(let[t,n]of Object.entries(e)){let e=this.editor.schema.styleSchema[t];if(!e)throw Error(`style ${t} not found in styleSchema`);if("boolean"===e.propSchema)this.editor._tiptapEditor.commands.toggleMark(t);else if("string"===e.propSchema)this.editor._tiptapEditor.commands.toggleMark(t,{stringValue:n});else throw new l1(e.propSchema)}}getSelectedText(){return this.editor.transact(e=>e.doc.textBetween(e.selection.from,e.selection.to))}getSelectedLinkUrl(){return this.editor._tiptapEditor.getAttributes("link").href}createLink(e,t){if(""===e)return;let n=this.editor.pmSchema.mark("link",{href:e});this.editor.transact(e=>{let{from:r,to:o}=e.selection;t?e.insertText(t,r,o).addMark(r,r+t.length,n):e.setSelection(tV.create(e.doc,o)).addMark(r,o,n)})}}function Mw(e,t){let n=em.from(e.content);if(!function(e,t){var n,r;let o=1===e.childCount,i=(null==(n=e.firstChild)?void 0:n.type.spec.content)==="inline*",s=(null==(r=e.firstChild)?void 0:r.type.spec.content)==="tableRow+";if(o){if(i)return!1;if(s){let e=l6(t.state);if(e.isBlockContainer)return"tableRow+"!==e.blockContent.node.type.spec.content}}return!0}(n=function(e,t){let n=[];for(let r=0;r<e.childCount;r++)if("tableRow"===e.child(r).type.name)if(n.length>0&&"table"===n[n.length-1].type.name){let t=n[n.length-1],o=t.copy(t.content.addToEnd(e.child(r)));n[n.length-1]=o}else{let o=t.nodes.table.createChecked(void 0,e.child(r));n.push(o)}else n.push(e.child(r));return em.from(n)}(n,t.state.schema),t))return new ek(n,e.openStart,e.openEnd);for(let e=0;e<n.childCount;e++)if("blockContent"===n.child(e).type.spec.group){let r=[n.child(e)];if(e+1<n.childCount&&"blockGroup"===n.child(e+1).type.name){let t=n.child(e+1).child(0).child(0);("bulletListItem"===t.type.name||"numberedListItem"===t.type.name||"checkListItem"===t.type.name)&&(r.push(n.child(e+1)),n=function(e,t){let n=[];return e.forEach((e,r,o)=>{o!==t&&n.push(e)}),em.from(n)}(n,e+1))}let o=t.state.schema.nodes.blockContainer.createChecked(void 0,r);n=n.replaceChild(e,o)}return new ek(n,e.openStart,e.openEnd)}let Mx={enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!1};class MS extends be{constructor(e){var t,n,r,o,i,s,l,a,c,d,u;let h;super(),NI(this,"pmSchema"),NI(this,"_tiptapEditor"),NI(this,"elementRenderer",null),NI(this,"blockCache",new WeakMap),NI(this,"dictionary"),NI(this,"schema"),NI(this,"blockImplementations"),NI(this,"inlineContentImplementations"),NI(this,"styleImplementations"),NI(this,"uploadFile"),NI(this,"onUploadStartCallbacks",[]),NI(this,"onUploadEndCallbacks",[]),NI(this,"resolveFileUrl"),NI(this,"settings"),NI(this,"_blockManager"),NI(this,"_eventManager"),NI(this,"_exportManager"),NI(this,"_extensionManager"),NI(this,"_selectionManager"),NI(this,"_stateManager"),NI(this,"_styleManager"),NI(this,"unregisterExtension",(...e)=>this._extensionManager.unregisterExtension(...e)),NI(this,"registerExtension",(...e)=>this._extensionManager.registerExtension(...e)),NI(this,"getExtension",(...e)=>this._extensionManager.getExtension(...e)),NI(this,"mount",e=>{this._tiptapEditor.mount({mount:e})}),NI(this,"unmount",()=>{this._tiptapEditor.unmount()}),this.options=e,this.dictionary=e.dictionary||Ss,this.settings={tables:{splitCells:(null==(t=null==e?void 0:e.tables)?void 0:t.splitCells)??!1,cellBackgroundColor:(null==(n=null==e?void 0:e.tables)?void 0:n.cellBackgroundColor)??!1,cellTextColor:(null==(r=null==e?void 0:e.tables)?void 0:r.cellTextColor)??!1,headers:(null==(o=null==e?void 0:e.tables)?void 0:o.headers)??!1}};const p={defaultStyles:!0,schema:e.schema||Si.create(),...e,placeholders:{...this.dictionary.placeholders,...e.placeholders}};if(this.schema=p.schema,this.blockImplementations=p.schema.blockSpecs,this.inlineContentImplementations=p.schema.inlineContentSpecs,this.styleImplementations=p.schema.styleSpecs,p.uploadFile){const e=p.uploadFile;this.uploadFile=async(t,n)=>{this.onUploadStartCallbacks.forEach(e=>e.apply(this,[n]));try{return await e(t,n)}finally{this.onUploadEndCallbacks.forEach(e=>e.apply(this,[n]))}}}this.resolveFileUrl=p.resolveFileUrl,this._eventManager=new NF(this),this._extensionManager=new ME(this,p);const f=this._extensionManager.getTiptapExtensions(),m=this._extensionManager.hasExtension("ySync")||this._extensionManager.hasExtension("liveblocksExtension");m&&p.initialContent&&console.warn("When using Collaboration, initialContent might cause conflicts, because changes should come from the collaboration provider");const g={...Mx,...p._tiptapOptions,element:null,autofocus:p.autofocus??!1,extensions:f,editorProps:{...null==(i=p._tiptapOptions)?void 0:i.editorProps,attributes:{tabIndex:"0",...null==(l=null==(s=p._tiptapOptions)?void 0:s.editorProps)?void 0:l.attributes,...null==(a=p.domAttributes)?void 0:a.editor,class:mF("bn-editor",p.defaultStyles?"bn-default-styles":"",(null==(d=null==(c=p.domAttributes)?void 0:c.editor)?void 0:d.class)||"")},transformPasted:Mw}};try{const e=p.initialContent||(m?[{type:"paragraph",id:"initialBlockId"}]:[{type:"paragraph",id:lq.options.generateID()}]);if(!Array.isArray(e)||0===e.length)throw Error("initialContent must be a non-empty array of blocks, received: "+e);const t=(u=g.extensions,sw(sS(u),void 0)),n=e.map(e=>ax(e,t,this.schema.styleSchema).toJSON()),r=si({type:"doc",content:[{type:"blockGroup",content:n}]},t,g.parseOptions);this._tiptapEditor=new lS({...g,content:r.toJSON()}),this.pmSchema=this._tiptapEditor.schema}catch(e){throw Error("Error creating document from blocks passed as `initialContent`",{cause:e})}const b=this.pmSchema.nodes.doc.createAndFill;this.pmSchema.nodes.doc.createAndFill=(...e)=>{if(h)return h;let t=JSON.parse(JSON.stringify(b.apply(this.pmSchema.nodes.doc,e).toJSON()));return t.content[0].content[0].attrs.id="initialBlockId",h=eR.fromJSON(this.pmSchema,t)},this.pmSchema.cached.blockNoteEditor=this,this._blockManager=new Nj(this),this._exportManager=new Nq(this),this._selectionManager=new Mk(this),this._stateManager=new MC(this),this._styleManager=new MT(this),this.emit("create")}static create(e){return new MS(e??{})}get extensions(){return this._extensionManager.getExtensions()}exec(e){return this._stateManager.exec(e)}canExec(e){return this._stateManager.canExec(e)}transact(e){return this._stateManager.transact(e)}get prosemirrorState(){return this._stateManager.prosemirrorState}get prosemirrorView(){return this._stateManager.prosemirrorView}get domElement(){var e;if(!this.headless)return null==(e=this.prosemirrorView)?void 0:e.dom}isFocused(){var e;return!this.headless&&((null==(e=this.prosemirrorView)?void 0:e.hasFocus())||!1)}get headless(){return!this._tiptapEditor.isInitialized}focus(){this.headless||this.prosemirrorView.focus()}blur(){var e;this.headless||null==(e=this.domElement)||e.blur()}onUploadStart(e){return this.onUploadStartCallbacks.push(e),()=>{let t=this.onUploadStartCallbacks.indexOf(e);t>-1&&this.onUploadStartCallbacks.splice(t,1)}}onUploadEnd(e){return this.onUploadEndCallbacks.push(e),()=>{let t=this.onUploadEndCallbacks.indexOf(e);t>-1&&this.onUploadEndCallbacks.splice(t,1)}}get topLevelBlocks(){return this.document}get document(){return this._blockManager.document}getBlock(e){return this._blockManager.getBlock(e)}getPrevBlock(e){return this._blockManager.getPrevBlock(e)}getNextBlock(e){return this._blockManager.getNextBlock(e)}getParentBlock(e){return this._blockManager.getParentBlock(e)}forEachBlock(e,t=!1){this._blockManager.forEachBlock(e,t)}onEditorContentChange(e){this._tiptapEditor.on("update",e)}onEditorSelectionChange(e){this._tiptapEditor.on("selectionUpdate",e)}onBeforeChange(e){return this._extensionManager.getExtension(wO).subscribe(e)}getTextCursorPosition(){return this._selectionManager.getTextCursorPosition()}setTextCursorPosition(e,t="start"){return this._selectionManager.setTextCursorPosition(e,t)}getSelection(){return this._selectionManager.getSelection()}getSelectionCutBlocks(e=!1){return this._selectionManager.getSelectionCutBlocks(e)}setSelection(e,t){return this._selectionManager.setSelection(e,t)}get isEditable(){return this._stateManager.isEditable}set isEditable(e){this._stateManager.isEditable=e}insertBlocks(e,t,n="before"){return this._blockManager.insertBlocks(e,t,n)}updateBlock(e,t){return this._blockManager.updateBlock(e,t)}removeBlocks(e){return this._blockManager.removeBlocks(e)}replaceBlocks(e,t){return this._blockManager.replaceBlocks(e,t)}undo(){return this._stateManager.undo()}redo(){return this._stateManager.redo()}insertInlineContent(e,{updateSelection:t=!1}={}){this._styleManager.insertInlineContent(e,{updateSelection:t})}getActiveStyles(){return this._styleManager.getActiveStyles()}addStyles(e){this._styleManager.addStyles(e)}removeStyles(e){this._styleManager.removeStyles(e)}toggleStyles(e){this._styleManager.toggleStyles(e)}getSelectedText(){return this._styleManager.getSelectedText()}getSelectedLinkUrl(){return this._styleManager.getSelectedLinkUrl()}createLink(e,t){this._styleManager.createLink(e,t)}canNestBlock(){return this._blockManager.canNestBlock()}nestBlock(){this._blockManager.nestBlock()}canUnnestBlock(){return this._blockManager.canUnnestBlock()}unnestBlock(){this._blockManager.unnestBlock()}moveBlocksUp(){return this._blockManager.moveBlocksUp()}moveBlocksDown(){return this._blockManager.moveBlocksDown()}blocksToHTMLLossy(e=this.document){return this._exportManager.blocksToHTMLLossy(e)}blocksToFullHTML(e=this.document){return this._exportManager.blocksToFullHTML(e)}tryParseHTMLToBlocks(e){return this._exportManager.tryParseHTMLToBlocks(e)}blocksToMarkdownLossy(e=this.document){return this._exportManager.blocksToMarkdownLossy(e)}tryParseMarkdownToBlocks(e){return this._exportManager.tryParseMarkdownToBlocks(e)}onChange(e,t){return this._eventManager.onChange(e,t)}onSelectionChange(e,t){return this._eventManager.onSelectionChange(e,t)}onMount(e){this._eventManager.onMount(e)}onUnmount(e){this._eventManager.onUnmount(e)}getSelectionBoundingBox(){return this._selectionManager.getSelectionBoundingBox()}get isEmpty(){let e=this.document;return 0===e.length||1===e.length&&"paragraph"===e[0].type&&0===e[0].content.length}pasteHTML(e,t=!1){this._exportManager.pasteHTML(e,t)}pasteText(e){return this._exportManager.pasteText(e)}pasteMarkdown(e){return this._exportManager.pasteMarkdown(e)}}var MA=e.i(91926);function M_(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(let[n,r]of e)if(!t.has(n)||!Object.is(r,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();let n=MN(e);if(n.length!==MN(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}function MN(e){return Object.keys(e).concat(Object.getOwnPropertySymbols(e))}var MM=X,MI=e.i(33347);let{getOwnPropertyNames:MO,getOwnPropertySymbols:MD}=Object,{hasOwnProperty:MR}=Object.prototype;function ML(e,t){return function(n,r,o){return e(n,r,o)&&t(n,r,o)}}function MP(e){return function(t,n,r){if(!t||!n||"object"!=typeof t||"object"!=typeof n)return e(t,n,r);let{cache:o}=r,i=o.get(t),s=o.get(n);if(i&&s)return i===n&&s===t;o.set(t,n),o.set(n,t);let l=e(t,n,r);return o.delete(t),o.delete(n),l}}function MB(e){return MO(e).concat(MD(e))}let MH=Object.hasOwn||((e,t)=>MR.call(e,t));function Mj(e,t){return e===t||!e&&!t&&e!=e&&t!=t}let{getOwnPropertyDescriptor:MF,keys:MU}=Object;function Mz(e,t){return e.byteLength===t.byteLength&&M0(new Uint8Array(e),new Uint8Array(t))}function MV(e,t,n){let r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function M$(e,t){return e.byteLength===t.byteLength&&M0(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function MG(e,t){return Mj(e.getTime(),t.getTime())}function Mq(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function MW(e,t){return e===t}function MY(e,t,n){let r,o,i=e.size;if(i!==t.size)return!1;if(!i)return!0;let s=Array(i),l=e.entries(),a=0;for(;(r=l.next())&&!r.done;){let i=t.entries(),l=!1,c=0;for(;(o=i.next())&&!o.done;){if(s[c]){c++;continue}let i=r.value,d=o.value;if(n.equals(i[0],d[0],a,c,e,t,n)&&n.equals(i[1],d[1],i[0],d[0],e,t,n)){l=s[c]=!0;break}c++}if(!l)return!1;a++}return!0}function MK(e,t,n){let r=MU(e),o=r.length;if(MU(t).length!==o)return!1;for(;o-- >0;)if(!M2(e,t,n,r[o]))return!1;return!0}function MZ(e,t,n){let r,o,i,s=MB(e),l=s.length;if(MB(t).length!==l)return!1;for(;l-- >0;)if(!M2(e,t,n,r=s[l])||(o=MF(e,r),i=MF(t,r),(o||i)&&(!o||!i||o.configurable!==i.configurable||o.enumerable!==i.enumerable||o.writable!==i.writable)))return!1;return!0}function MX(e,t){return Mj(e.valueOf(),t.valueOf())}function MQ(e,t){return e.source===t.source&&e.flags===t.flags}function MJ(e,t,n){let r,o,i=e.size;if(i!==t.size)return!1;if(!i)return!0;let s=Array(i),l=e.values();for(;(r=l.next())&&!r.done;){let i=t.values(),l=!1,a=0;for(;(o=i.next())&&!o.done;){if(!s[a]&&n.equals(r.value,o.value,r.value,o.value,e,t,n)){l=s[a]=!0;break}a++}if(!l)return!1}return!0}function M0(e,t){let n=e.byteLength;if(t.byteLength!==n||e.byteOffset!==t.byteOffset)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}function M1(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function M2(e,t,n,r){return("_owner"===r||"__o"===r||"__v"===r)&&(!!e.$$typeof||!!t.$$typeof)||MH(t,r)&&n.equals(e[r],t[r],r,r,e,t,n)}let M4={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},M5=Object.prototype.toString;function M3(e={}){let{circular:t=!1,createInternalComparator:n,createState:r,strict:o=!1}=e,i=function({areArrayBuffersEqual:e,areArraysEqual:t,areDataViewsEqual:n,areDatesEqual:r,areErrorsEqual:o,areFunctionsEqual:i,areMapsEqual:s,areNumbersEqual:l,areObjectsEqual:a,arePrimitiveWrappersEqual:c,areRegExpsEqual:d,areSetsEqual:u,areTypedArraysEqual:h,areUrlsEqual:p,unknownTagComparators:f}){return function(m,g,b){if(m===g)return!0;if(null==m||null==g)return!1;let y=typeof m;if(y!==typeof g)return!1;if("object"!==y)return"number"===y?l(m,g,b):"function"===y&&i(m,g,b);let v=m.constructor;if(v!==g.constructor)return!1;if(v===Object)return a(m,g,b);if(Array.isArray(m))return t(m,g,b);if(v===Date)return r(m,g,b);if(v===RegExp)return d(m,g,b);if(v===Map)return s(m,g,b);if(v===Set)return u(m,g,b);let E=M5.call(m);if("[object Date]"===E)return r(m,g,b);if("[object RegExp]"===E)return d(m,g,b);if("[object Map]"===E)return s(m,g,b);if("[object Set]"===E)return u(m,g,b);if("[object Object]"===E)return"function"!=typeof m.then&&"function"!=typeof g.then&&a(m,g,b);if("[object URL]"===E)return p(m,g,b);if("[object Error]"===E)return o(m,g,b);if("[object Arguments]"===E)return a(m,g,b);if(M4[E])return h(m,g,b);if("[object ArrayBuffer]"===E)return e(m,g,b);if("[object DataView]"===E)return n(m,g,b);if("[object Boolean]"===E||"[object Number]"===E||"[object String]"===E)return c(m,g,b);if(f){let e=f[E];if(!e){let t=null!=m?m[Symbol.toStringTag]:void 0;t&&(e=f[t])}if(e)return e(m,g,b)}return!1}}(function({circular:e,createCustomConfig:t,strict:n}){let r={areArrayBuffersEqual:Mz,areArraysEqual:n?MZ:MV,areDataViewsEqual:M$,areDatesEqual:MG,areErrorsEqual:Mq,areFunctionsEqual:MW,areMapsEqual:n?ML(MY,MZ):MY,areNumbersEqual:Mj,areObjectsEqual:n?MZ:MK,arePrimitiveWrappersEqual:MX,areRegExpsEqual:MQ,areSetsEqual:n?ML(MJ,MZ):MJ,areTypedArraysEqual:n?ML(M0,MZ):M0,areUrlsEqual:M1,unknownTagComparators:void 0};if(t&&(r=Object.assign({},r,t(r))),e){let e=MP(r.areArraysEqual),t=MP(r.areMapsEqual),n=MP(r.areObjectsEqual),o=MP(r.areSetsEqual);r=Object.assign({},r,{areArraysEqual:e,areMapsEqual:t,areObjectsEqual:n,areSetsEqual:o})}return r}(e)),s=n?n(i):function(e,t,n,r,o,s,l){return i(e,t,l)};return function({circular:e,comparator:t,createState:n,equals:r,strict:o}){if(n)return function(i,s){let{cache:l=e?new WeakMap:void 0,meta:a}=n();return t(i,s,{cache:l,equals:r,meta:a,strict:o})};if(e)return function(e,n){return t(e,n,{cache:new WeakMap,equals:r,meta:void 0,strict:o})};let i={cache:void 0,equals:r,meta:void 0,strict:o};return function(e,n){return t(e,n,i)}}({circular:t,comparator:i,createState:r,equals:s,strict:o})}M3(),M3({strict:!0}),M3({circular:!0}),M3({circular:!0,strict:!0}),M3({createInternalComparator:()=>Mj}),M3({strict:!0,createInternalComparator:()=>Mj}),M3({circular:!0,createInternalComparator:()=>Mj}),M3({circular:!0,createInternalComparator:()=>Mj,strict:!0});var M8=({contentComponent:e})=>{let t=(0,MI.useSyncExternalStore)(e.subscribe,e.getSnapshot,e.getServerSnapshot);return(0,Z.jsx)(Z.Fragment,{children:Object.values(t)})},M6=class extends MM.default.Component{constructor(e){var t;super(e),this.editorContentRef=MM.default.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(null==(t=e.editor)?void 0:t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var e;let t=this.props.editor;if(t&&!t.isDestroyed&&(null==(e=t.view.dom)?void 0:e.parentNode)){let e,n;if(t.contentComponent)return;let r=this.editorContentRef.current;r.append(...t.view.dom.parentNode.childNodes),t.setOptions({element:r}),e=new Set,n={},t.contentComponent={subscribe:t=>(e.add(t),()=>{e.delete(t)}),getSnapshot:()=>n,getServerSnapshot:()=>n,setRenderer(t,r){n={...n,[t]:xS.default.createPortal(r.reactElement,r.element,t)},e.forEach(e=>e())},removeRenderer(t){let r={...n};delete r[t],n=r,e.forEach(e=>e())}},this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=t.contentComponent.subscribe(()=>{this.setState(e=>e.hasContentComponentInitialized?e:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),t.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var e;let t=this.props.editor;if(t){this.initialized=!1,t.isDestroyed||t.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),t.contentComponent=null;try{if(!(null==(e=t.view.dom)?void 0:e.parentNode))return;let n=document.createElement("div");n.append(...t.view.dom.parentNode.childNodes),t.setOptions({element:n})}catch{}}}render(){let{editor:e,innerRef:t,...n}=this.props;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("div",{ref:((...e)=>t=>{e.forEach(e=>{"function"==typeof e?e(t):e&&(e.current=t)})})(t,this.editorContentRef),...n}),(null==e?void 0:e.contentComponent)&&(0,Z.jsx)(M8,{contentComponent:e.contentComponent})]})}},M9=(0,MM.forwardRef)((e,t)=>{let n=MM.default.useMemo(()=>Math.floor(0xffffffff*Math.random()).toString(),[e.editor]);return MM.default.createElement(M6,{key:n,innerRef:t,...e})});MM.default.memo(M9),"undefined"!=typeof window?MM.useLayoutEffect:MM.useEffect,"undefined"==typeof window||"undefined"!=typeof window&&window.next,(0,MM.createContext)({editor:null}).Consumer;var M7=(0,MM.createContext)({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),Ie=()=>(0,MM.useContext)(M7),It=MM.default.forwardRef((e,t)=>{let{onDragStart:n}=Ie(),r=e.as||"div";return(0,Z.jsx)(r,{...e,ref:t,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...e.style}})});function In(e){return!!("function"==typeof e&&e.prototype&&e.prototype.isReactComponent)}function Ir(e){return!!("object"==typeof e&&e.$$typeof&&("Symbol(react.forward_ref)"===e.$$typeof.toString()||"react.forward_ref"===e.$$typeof.description))}var Io=class{constructor(e,{editor:t,props:n={},as:r="div",className:o=""}){this.ref=null,this.id=Math.floor(0xffffffff*Math.random()).toString(),this.component=e,this.editor=t,this.props=n,this.element=document.createElement(r),this.element.classList.add("react-renderer"),o&&this.element.classList.add(...o.split(" ")),this.editor.isInitialized?(0,xS.flushSync)(()=>{this.render()}):queueMicrotask(()=>{this.render()})}render(){var e;let t=this.component,n=this.props,r=this.editor,o=function(){try{if(MM.version)return parseInt(MM.version.split(".")[0],10)>=19}catch{}return!1}(),i=function(e){if(In(e)||Ir(e))return!0;if("object"==typeof e&&e.$$typeof&&("Symbol(react.memo)"===e.$$typeof.toString()||"react.memo"===e.$$typeof.description)){let t=e.type;if(t)return In(t)||Ir(t)}return!1}(t),s={...n};s.ref&&!(o||i)&&delete s.ref,!s.ref&&(o||i)&&(s.ref=e=>{this.ref=e}),this.reactElement=(0,Z.jsx)(t,{...s}),null==(e=null==r?void 0:r.contentComponent)||e.setRenderer(this.id,this)}updateProps(e={}){this.props={...this.props,...e},this.render()}destroy(){var e;let t=this.editor;null==(e=null==t?void 0:t.contentComponent)||e.removeRenderer(this.id);try{this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}catch{}}updateAttributes(e){Object.keys(e).forEach(t=>{this.element.setAttribute(t,e[t])})}};MM.default.createContext({markViewContentRef:()=>{}});var Ii=class extends lH{constructor(e,t,n){if(super(e,t,n),this.selectionRafId=null,!this.node.isLeaf){this.options.contentDOMElementTag?this.contentDOMElement=document.createElement(this.options.contentDOMElementTag):this.contentDOMElement=document.createElement(this.node.isInline?"span":"div"),this.contentDOMElement.dataset.nodeViewContentReact="",this.contentDOMElement.dataset.nodeViewWrapper="",this.contentDOMElement.style.whiteSpace="inherit";const e=this.dom.querySelector("[data-node-view-content]");if(!e)return;e.appendChild(this.contentDOMElement)}}mount(){let e={editor:this.editor,node:this.node,decorations:this.decorations,innerDecorations:this.innerDecorations,view:this.view,selected:!1,extension:this.extension,HTMLAttributes:this.HTMLAttributes,getPos:()=>this.getPos(),updateAttributes:(e={})=>this.updateAttributes(e),deleteNode:()=>this.deleteNode(),ref:(0,MM.createRef)()};if(!this.component.displayName){let e;this.component.displayName=(e=this.extension.name).charAt(0).toUpperCase()+e.substring(1)}let t={onDragStart:this.onDragStart.bind(this),nodeViewContentRef:e=>{e&&this.contentDOMElement&&e.firstChild!==this.contentDOMElement&&(e.hasAttribute("data-node-view-wrapper")&&e.removeAttribute("data-node-view-wrapper"),e.appendChild(this.contentDOMElement))}},n=this.component,r=(0,MM.memo)(e=>(0,Z.jsx)(M7.Provider,{value:t,children:(0,MM.createElement)(n,e)}));r.displayName="ReactNodeView";let o=this.node.isInline?"span":"div";this.options.as&&(o=this.options.as);let{className:i=""}=this.options;this.handleSelectionUpdate=this.handleSelectionUpdate.bind(this),this.renderer=new Io(r,{editor:this.editor,props:e,as:o,className:`node-${this.node.type.name} ${i}`.trim()}),this.editor.on("selectionUpdate",this.handleSelectionUpdate),this.updateElementAttributes()}get dom(){var e;if(this.renderer.element.firstElementChild&&!(null==(e=this.renderer.element.firstElementChild)?void 0:e.hasAttribute("data-node-view-wrapper")))throw Error("Please use the NodeViewWrapper component for your node view.");return this.renderer.element}get contentDOM(){return this.node.isLeaf?null:this.contentDOMElement}handleSelectionUpdate(){this.selectionRafId&&(cancelAnimationFrame(this.selectionRafId),this.selectionRafId=null),this.selectionRafId=requestAnimationFrame(()=>{this.selectionRafId=null;let{from:e,to:t}=this.editor.state.selection,n=this.getPos();if("number"==typeof n)if(e<=n&&t>=n+this.node.nodeSize){if(this.renderer.props.selected)return;this.selectNode()}else{if(!this.renderer.props.selected)return;this.deselectNode()}})}update(e,t,n){let r=e=>{this.renderer.updateProps(e),"function"==typeof this.options.attrs&&this.updateElementAttributes()};if(e.type!==this.node.type)return!1;if("function"==typeof this.options.update){let o=this.node,i=this.decorations,s=this.innerDecorations;return this.node=e,this.decorations=t,this.innerDecorations=n,this.options.update({oldNode:o,oldDecorations:i,newNode:e,newDecorations:t,oldInnerDecorations:s,innerDecorations:n,updateProps:()=>r({node:e,decorations:t,innerDecorations:n})})}return e===this.node&&this.decorations===t&&this.innerDecorations===n||(this.node=e,this.decorations=t,this.innerDecorations=n,r({node:e,decorations:t,innerDecorations:n}),!0)}selectNode(){this.renderer.updateProps({selected:!0}),this.renderer.element.classList.add("ProseMirror-selectednode")}deselectNode(){this.renderer.updateProps({selected:!1}),this.renderer.element.classList.remove("ProseMirror-selectednode")}destroy(){this.renderer.destroy(),this.editor.off("selectionUpdate",this.handleSelectionUpdate),this.contentDOMElement=null,this.selectionRafId&&(cancelAnimationFrame(this.selectionRafId),this.selectionRafId=null)}updateElementAttributes(){if(this.options.attrs){let e={};if("function"==typeof this.options.attrs){let t=this.editor.extensionManager.attributes,n=sE(this.node,t);e=this.options.attrs({node:this.node,HTMLAttributes:n})}else e=this.options.attrs;this.renderer.updateAttributes(e)}}},Is=e.i(92433),Il=Object.defineProperty,Ia=(e,t,n)=>{let r;return(r="symbol"!=typeof t?t+"":t)in e?Il(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n};let Ic=(0,X.createContext)(void 0);function Id(e){return(0,X.useContext)(Ic)}let Iu=(0,X.createContext)(void 0);function Ih(){return(0,X.useContext)(Iu)}function Ip(e){let t=Id();if(!(null!=t&&t.editor))throw Error("useBlockNoteEditor was called outside of a BlockNoteContext provider or BlockNoteView component");return t.editor}function If(){return Id().editor.dictionary}let Im=e=>{let t=Ih(),n=If(),r=Ip(),o=r.getBlock(e.blockId),[i,s]=(0,X.useState)(""),l=(0,X.useCallback)(e=>{s(e.currentTarget.value)},[]),a=(0,X.useCallback)(e=>{"Enter"===e.key&&(e.preventDefault(),r.updateBlock(o.id,{props:{name:mV(i),url:i}}))},[r,o.id,i]),c=(0,X.useCallback)(()=>{r.updateBlock(o.id,{props:{name:mV(i),url:i}})},[r,o.id,i]);return(0,Z.jsxs)(t.FilePanel.TabPanel,{className:"bn-tab-panel",children:[(0,Z.jsx)(t.FilePanel.TextInput,{className:"bn-text-input",placeholder:n.file_panel.embed.url_placeholder,value:i,onChange:l,onKeyDown:a,"data-test":"embed-input"}),(0,Z.jsx)(t.FilePanel.Button,{className:"bn-button",onClick:c,"data-test":"embed-input-button",children:n.file_panel.embed.embed_button[o.type]||n.file_panel.embed.embed_button.file})]})},Ig=e=>{var t,n;let r=Ih(),o=If(),{setLoading:i}=e,s=Ip(),l=s.getBlock(e.blockId),[a,c]=(0,X.useState)(!1);(0,X.useEffect)(()=>{a&&setTimeout(()=>{c(!1)},3e3)},[a]);let d=(0,X.useCallback)(t=>{null!==t&&n(t);async function n(t){if(i(!0),void 0!==s.uploadFile)try{let n=await s.uploadFile(t,e.blockId);"string"==typeof n&&(n={props:{name:t.name,url:n}}),s.updateBlock(e.blockId,n)}catch{c(!0)}finally{i(!1)}}},[e.blockId,s,i]),u=s.schema.blockSpecs[l.type],h=null!=(n=null==(t=u.implementation.meta)?void 0:t.fileBlockAccept)&&n.length?u.implementation.meta.fileBlockAccept.join(","):"*/*";return(0,Z.jsxs)(r.FilePanel.TabPanel,{className:"bn-tab-panel",children:[(0,Z.jsx)(r.FilePanel.FileInput,{className:"bn-file-input","data-test":"upload-input",accept:h,placeholder:o.file_panel.upload.file_placeholder[l.type]||o.file_panel.upload.file_placeholder.file,value:null,onChange:d}),a&&(0,Z.jsx)("div",{className:"bn-error-text",children:o.file_panel.upload.upload_error})]})},Ib=e=>{let t=Ih(),n=If(),r=Ip(),[o,i]=(0,X.useState)(!1),s=e.tabs??[...void 0!==r.uploadFile?[{name:n.file_panel.upload.title,tabPanel:(0,Z.jsx)(Ig,{blockId:e.blockId,setLoading:i})}]:[],{name:n.file_panel.embed.title,tabPanel:(0,Z.jsx)(Im,{blockId:e.blockId})}],[l,a]=(0,X.useState)(e.defaultOpenTab||s[0].name);return(0,Z.jsx)(t.FilePanel.Root,{className:"bn-panel",defaultOpenTab:l,openTab:l,setOpenTab:a,tabs:s,loading:o})},Iy=e=>{var t,n,r,o;let i,s,{refs:l,floatingStyles:a,context:c}=xJ({whileElementsMounted:x_.autoUpdate,...e.useFloatingOptions}),{isMounted:d,styles:u}=function(e,t){void 0===t&&(t={});let{initial:n={opacity:0},open:r,close:o,common:i,duration:s=250}=t,l=e.placement,a=l.split("-")[0],c=X.useMemo(()=>({side:a,placement:l}),[a,l]),d="number"==typeof s,u=(d?s:s.open)||0,h=(d?s:s.close)||0,[p,f]=X.useState(()=>({...x3(i,c),...x3(n,c)})),{isMounted:m,status:g}=x8(e,{duration:s}),b=xT(n),y=xT(r),v=xT(o),E=xT(i);return xC(()=>{let e=x3(b.current,c),t=x3(v.current,c),n=x3(E.current,c),r=x3(y.current,c)||Object.keys(e).reduce((e,t)=>(e[t]="",e),{});if("initial"===g&&f(t=>({transitionProperty:t.transitionProperty,...n,...e})),"open"===g&&f({transitionProperty:Object.keys(r).map(x5).join(","),transitionDuration:u+"ms",...n,...r}),"close"===g){let r=t||e;f({transitionProperty:Object.keys(r).map(x5).join(","),transitionDuration:h+"ms",...n,...r})}},[h,v,b,y,E,u,g,c]),{isMounted:m,styles:p}}(c,e.useTransitionStylesProps),{status:h}=x8(c,e.useTransitionStatusProps),{getFloatingProps:p}=x2([xQ(c,e.useDismissProps),x$(c,{enabled:!1,...e.useHoverProps})]),f=(0,X.useRef)(""),m=(0,X.useRef)(null),g=(o=[m,l.setFloating],i=X.useRef(void 0),s=X.useCallback(e=>{let t=o.map(t=>{if(null!=t){if("function"==typeof t){let n=t(e);return"function"==typeof n?n:()=>{t(null)}}return t.current=e,()=>{t.current=null}}});return()=>{t.forEach(e=>null==e?void 0:e())}},o),X.useMemo(()=>o.every(e=>null==e)?null:e=>{i.current&&(i.current(),i.current=void 0),null!=e&&(i.current=s(e))},o));if((0,X.useEffect)(()=>{if(e.reference){var t;let n,r,o="element"in e.reference?e.reference.element:void 0;void 0!==o&&l.setReference(o),l.setPositionReference({getBoundingClientRect:(t=e.reference,n=new DOMRect,r="getBoundingClientRect"in t?()=>t.getBoundingClientRect():()=>t.element.getBoundingClientRect(),()=>"element"in t&&(t.cacheMountedBoundingClientRect??!0)?(t.element.isConnected&&(n=r()),n):r()),contextElement:o})}},[e.reference,l]),(0,X.useEffect)(()=>{var e;("initial"===h||"open"===h)&&null!=(e=m.current)&&e.innerHTML&&(f.current=m.current.innerHTML)},[h,e.reference,e.children]),!d)return!1;let b={...e.elementProps,style:{display:"flex",...null==(t=e.elementProps)?void 0:t.style,zIndex:`calc(var(--bn-ui-base-z-index) + ${(null==(r=null==(n=e.elementProps)?void 0:n.style)?void 0:r.zIndex)||0})`,...a,...u},...p()};return"close"===h?(0,Z.jsx)("div",{ref:g,...b,dangerouslySetInnerHTML:{__html:f.current}}):(0,Z.jsx)("div",{ref:g,...b,children:e.children})},Iv=e=>{let{blockId:t,children:n,...r}=e,o=Ip(),i=(0,X.useMemo)(()=>o.transact(e=>{if(!t)return;let n=mJ(t,e.doc);if(!n)return;let{node:r}=o.prosemirrorView.domAtPos(n.posBeforeNode+1);if(r instanceof Element)return{element:r}}),[o,t]);return(0,Z.jsx)(Iy,{reference:i,...r,children:void 0!==t&&n})};function IE(e,t){let n=((null==t?void 0:t.editor)??Ip()).getExtension(e);if(!n)throw Error("Extension not found",{cause:{plugin:e}});return n}function Ik(e,t){let{store:n}=IE(e,t);if(!n)throw Error("Store not found on plugin",{cause:{plugin:e}});return function(e,t=e=>e){return(0,MA.useSyncExternalStoreWithSelector)(e.subscribe,()=>e.state,()=>e.state,t,M_)}(n,null==t?void 0:t.selector)}let IC=e=>{let t=Ip(),n=IE(m9),r=Ik(m9),o=(0,X.useMemo)(()=>({useFloatingOptions:{open:!!r,onOpenChange:(e,r,o)=>{e||n.closeMenu(),"escape-key"===o&&t.focus()},middleware:[(0,xA.offset)(10),(0,xA.flip)()]},elementProps:{style:{zIndex:90}},...e.floatingUIOptions}),[r,t,n,e.floatingUIOptions]),i=e.filePanel||Ib;return(0,Z.jsx)(Iv,{blockId:r,...o,children:r&&(0,Z.jsx)(i,{blockId:r})})},IT=(N=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(o=r;0!=o--;)if(!e(t[o],n[o]))return!1;return!0}if(t instanceof Map&&n instanceof Map){if(t.size!==n.size)return!1;for(o of t.entries())if(!n.has(o[0]))return!1;for(o of t.entries())if(!e(o[1],n.get(o[0])))return!1;return!0}if(t instanceof Set&&n instanceof Set){if(t.size!==n.size)return!1;for(o of t.entries())if(!n.has(o[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(n)){if((r=t.length)!=n.length)return!1;for(o=r;0!=o--;)if(t[o]!==n[o])return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(i=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(o=r;0!=o--;)if(!Object.prototype.hasOwnProperty.call(n,i[o]))return!1;for(o=r;0!=o--;){var r,o,i,s=i[o];if(!("_owner"===s&&t.$$typeof)&&!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}).__esModule&&Object.prototype.hasOwnProperty.call(N,"default")?N.default:N;var Iw={exports:{}},Ix={},IS={exports:{}},IA={};Iw.exports=function(){if(K)return Ix;K=1;var e=X.default,t=(Y||(Y=1,IS.exports=function(){if(W)return IA;W=1;var e=X.default,t="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},n=e.useState,r=e.useEffect,o=e.useLayoutEffect,i=e.useDebugValue;function s(e){var n=e.getSnapshot;e=e.value;try{var r=n();return!t(e,r)}catch{return!0}}var l=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?function(e,t){return t()}:function(e,t){var l=t(),a=n({inst:{value:l,getSnapshot:t}}),c=a[0].inst,d=a[1];return o(function(){c.value=l,c.getSnapshot=t,s(c)&&d({inst:c})},[e,l,t]),r(function(){return s(c)&&d({inst:c}),e(function(){s(c)&&d({inst:c})})},[e]),i(l),l};return IA.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:l,IA}()),IS.exports),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},r=t.useSyncExternalStore,o=e.useRef,i=e.useEffect,s=e.useMemo,l=e.useDebugValue;return Ix.useSyncExternalStoreWithSelector=function(e,t,a,c,d){var u=o(null);if(null===u.current){var h={hasValue:!1,value:null};u.current=h}else h=u.current;var p=r(e,(u=s(function(){function e(e){if(!i){if(i=!0,r=e,e=c(e),void 0!==d&&h.hasValue){var t=h.value;if(d(t,e))return o=t}return o=e}if(t=o,n(r,e))return t;var s=c(e);return void 0!==d&&d(t,s)?(r=e,t):(r=e,o=s)}var r,o,i=!1,s=void 0===a?null:a;return[function(){return e(t())},null===s?void 0:function(){return e(s())}]},[t,a,c,d]))[0],u[1]);return i(function(){h.hasValue=!0,h.value=p},[p]),l(p),p},Ix}();var I_=Iw.exports;let IN="u">typeof window?X.useLayoutEffect:X.useEffect;class IM{constructor(e){Ia(this,"transactionNumber",0),Ia(this,"lastTransactionNumber",0),Ia(this,"lastSnapshot"),Ia(this,"editor"),Ia(this,"subscribers",new Set),this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber||(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber}),this.lastSnapshot}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e,t){if(this.editor=e,this.editor){let e=()=>{this.transactionNumber+=1,this.subscribers.forEach(e=>e())},n=this.editor._tiptapEditor,r={all:"transaction",selection:"selectionUpdate",change:"update"};return n.on(r[t],e),()=>{n.off(r[t],e)}}}}function II(e){let t=Id(),n=e.editor||(null==t?void 0:t.editor)||null,r=e.on||"all",[o]=(0,X.useState)(()=>new IM(n)),i=I_.useSyncExternalStoreWithSelector(o.subscribe,o.getSnapshot,o.getServerSnapshot,e.selector,e.equalityFn??IT);return IN(()=>o.watch(n,r),[n,o,r]),(0,X.useDebugValue)(i),i}let IO=e=>{let{position:t,children:n,...r}=e,{from:o,to:i}=t||{},s=Ip(),l=(0,X.useMemo)(()=>{var e;if(void 0!==o&&void 0!==i)return{element:(null==(e=s.domElement)?void 0:e.firstElementChild)||void 0,getBoundingClientRect:()=>sz(s.prosemirrorView,o,i??o)}},[s,o,i]);return(0,Z.jsx)(Iy,{reference:l,...r,children:void 0!==t&&n})};var ID={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},IR=X.default.createContext&&X.default.createContext(ID),IL=["attr","size","title"];function IP(){return(IP=Object.assign.bind()).apply(this,arguments)}function IB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function IH(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?IB(Object(n),!0).forEach(function(t){var r,o,i;r=e,o=t,i=n[t],(o=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(o))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IB(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ij(e){return t=>X.default.createElement(IF,IP({attr:IH({},e.attr)},t),function e(t){return t&&t.map((t,n)=>X.default.createElement(t.tag,IH({key:n},t.attr),e(t.child)))}(e.child))}function IF(e){var t=t=>{var n,{attr:r,size:o,title:i}=e,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,IL),l=o||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),X.default.createElement("svg",IP({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,s,{className:n,style:IH(IH({color:e.color||t.color},t.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&X.default.createElement("title",null,i),e.children)};return void 0!==IR?X.default.createElement(IR.Consumer,null,e=>t(e)):t(ID)}function IU(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M8 7V11L2 6L8 1V5H13C17.4183 5 21 8.58172 21 13C21 17.4183 17.4183 21 13 21H4V19H13C16.3137 19 19 16.3137 19 13C19 9.68629 16.3137 7 13 7H8Z"},child:[]}]})(e)}function Iz(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M7.29117 20.8242L2 22L3.17581 16.7088C2.42544 15.3056 2 13.7025 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C10.2975 22 8.6944 21.5746 7.29117 20.8242ZM7.58075 18.711L8.23428 19.0605C9.38248 19.6745 10.6655 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 13.3345 4.32549 14.6175 4.93949 15.7657L5.28896 16.4192L4.63416 19.3658L7.58075 18.711Z"},child:[]}]})(e)}function IV(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M7.24264 17.9967H3V13.754L14.435 2.319C14.8256 1.92848 15.4587 1.92848 15.8492 2.319L18.6777 5.14743C19.0682 5.53795 19.0682 6.17112 18.6777 6.56164L7.24264 17.9967ZM3 19.9967H21V21.9967H3V19.9967Z"},child:[]}]})(e)}function I$(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3 8L9.00319 2H19.9978C20.5513 2 21 2.45531 21 2.9918V21.0082C21 21.556 20.5551 22 20.0066 22H3.9934C3.44476 22 3 21.5501 3 20.9932V8ZM10 4V9H5V20H19V4H10Z"},child:[]}]})(e)}function IG(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M5.55397 22H3.3999L10.9999 3H12.9999L20.5999 22H18.4458L16.0458 16H7.95397L5.55397 22ZM8.75397 14H15.2458L11.9999 5.88517L8.75397 14Z"},child:[]}]})(e)}function Iq(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M13 20H11V13H4V20H2V4H4V11H11V4H13V20ZM21.0005 8V20H19.0005L19 10.204L17 10.74V8.67L19.5005 8H21.0005Z"},child:[]}]})(e)}function IW(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M4 4V11H11V4H13V20H11V13H4V20H2V4H4ZM18.5 8C20.5711 8 22.25 9.67893 22.25 11.75C22.25 12.6074 21.9623 13.3976 21.4781 14.0292L21.3302 14.2102L18.0343 18H22V20H15L14.9993 18.444L19.8207 12.8981C20.0881 12.5908 20.25 12.1893 20.25 11.75C20.25 10.7835 19.4665 10 18.5 10C17.5818 10 16.8288 10.7071 16.7558 11.6065L16.75 11.75H14.75C14.75 9.67893 16.4289 8 18.5 8Z"},child:[]}]})(e)}function IY(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M22 8L21.9984 10L19.4934 12.883C21.0823 13.3184 22.25 14.7728 22.25 16.5C22.25 18.5711 20.5711 20.25 18.5 20.25C16.674 20.25 15.1528 18.9449 14.8184 17.2166L16.7821 16.8352C16.9384 17.6413 17.6481 18.25 18.5 18.25C19.4665 18.25 20.25 17.4665 20.25 16.5C20.25 15.5335 19.4665 14.75 18.5 14.75C18.214 14.75 17.944 14.8186 17.7056 14.9403L16.3992 13.3932L19.3484 10H15V8H22ZM4 4V11H11V4H13V20H11V13H4V20H2V4H4Z"},child:[]}]})(e)}function IK(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M13 20H11V13H4V20H2V4H4V11H11V4H13V20ZM22 8V16H23.5V18H22V20H20V18H14.5V16.66L19.5 8H22ZM20 11.133L17.19 16H20V11.133Z"},child:[]}]})(e)}function IZ(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M22 8V10H17.6769L17.2126 12.6358C17.5435 12.5472 17.8912 12.5 18.25 12.5C20.4591 12.5 22.25 14.2909 22.25 16.5C22.25 18.7091 20.4591 20.5 18.25 20.5C16.4233 20.5 14.8827 19.2756 14.4039 17.6027L16.3271 17.0519C16.5667 17.8881 17.3369 18.5 18.25 18.5C19.3546 18.5 20.25 17.6046 20.25 16.5C20.25 15.3954 19.3546 14.5 18.25 14.5C17.6194 14.5 17.057 14.7918 16.6904 15.2478L14.8803 14.3439L16 8H22ZM4 4V11H11V4H13V20H11V13H4V20H2V4H4Z"},child:[]}]})(e)}function IX(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M21.097 8L18.499 12.5C20.7091 12.5 22.5 14.2909 22.5 16.5C22.5 18.7091 20.7091 20.5 18.5 20.5C16.2909 20.5 14.5 18.7091 14.5 16.5C14.5 15.7636 14.699 15.0737 15.0461 14.4811L18.788 8H21.097ZM4 4V11H11V4H13V20H11V13H4V20H2V4H4ZM18.5 14.5C17.3954 14.5 16.5 15.3954 16.5 16.5C16.5 17.6046 17.3954 18.5 18.5 18.5C19.6046 18.5 20.5 17.6046 20.5 16.5C20.5 15.3954 19.6046 14.5 18.5 14.5Z"},child:[]}]})(e)}function IQ(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3 4H21V6H3V4ZM3 19H21V21H3V19ZM11 14H21V16H11V14ZM11 9H21V11H11V9ZM3 12.5L7 9V16L3 12.5Z"},child:[]}]})(e)}function IJ(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3 4H21V6H3V4ZM3 19H21V21H3V19ZM11 14H21V16H11V14ZM11 9H21V11H11V9ZM7 12.5L3 16V9L7 12.5Z"},child:[]}]})(e)}function I0(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M8 5H11V19H8V21H16V19H13V5H16V3H8V5ZM2 7C1.44772 7 1 7.44772 1 8V16C1 16.5523 1.44772 17 2 17H8V15H3V9H8V7H2ZM16 9H21V15H16V17H22C22.5523 17 23 16.5523 23 16V8C23 7.44772 22.5523 7 22 7H16V9Z"},child:[]}]})(e)}function I1(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M17 17H22V19H19V22H17V17ZM7 7H2V5H5V2H7V7ZM18.364 15.5355L16.9497 14.1213L18.364 12.7071C20.3166 10.7545 20.3166 7.58866 18.364 5.63604C16.4113 3.68342 13.2455 3.68342 11.2929 5.63604L9.87868 7.05025L8.46447 5.63604L9.87868 4.22183C12.6123 1.48816 17.0445 1.48816 19.7782 4.22183C22.5118 6.9555 22.5118 11.3877 19.7782 14.1213L18.364 15.5355ZM15.5355 18.364L14.1213 19.7782C11.3877 22.5118 6.9555 22.5118 4.22183 19.7782C1.48816 17.0445 1.48816 12.6123 4.22183 9.87868L5.63604 8.46447L7.05025 9.87868L5.63604 11.2929C3.68342 13.2455 3.68342 16.4113 5.63604 18.364C7.58866 20.3166 10.7545 20.3166 12.7071 18.364L14.1213 16.9497L15.5355 18.364ZM14.8284 7.75736L16.2426 9.17157L9.17157 16.2426L7.75736 14.8284L14.8284 7.75736Z"},child:[]}]})(e)}function I2(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M18.3638 15.5355L16.9496 14.1213L18.3638 12.7071C20.3164 10.7545 20.3164 7.58866 18.3638 5.63604C16.4112 3.68341 13.2453 3.68341 11.2927 5.63604L9.87849 7.05025L8.46428 5.63604L9.87849 4.22182C12.6122 1.48815 17.0443 1.48815 19.778 4.22182C22.5117 6.95549 22.5117 11.3876 19.778 14.1213L18.3638 15.5355ZM15.5353 18.364L14.1211 19.7782C11.3875 22.5118 6.95531 22.5118 4.22164 19.7782C1.48797 17.0445 1.48797 12.6123 4.22164 9.87868L5.63585 8.46446L7.05007 9.87868L5.63585 11.2929C3.68323 13.2455 3.68323 16.4113 5.63585 18.364C7.58847 20.3166 10.7543 20.3166 12.7069 18.364L14.1211 16.9497L15.5353 18.364ZM14.8282 7.75736L16.2425 9.17157L9.17139 16.2426L7.75717 14.8284L14.8282 7.75736Z"},child:[]}]})(e)}function I4(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M8.00008 6V9H5.00008V6H8.00008ZM3.00008 4V11H10.0001V4H3.00008ZM13.0001 4H21.0001V6H13.0001V4ZM13.0001 11H21.0001V13H13.0001V11ZM13.0001 18H21.0001V20H13.0001V18ZM10.7072 16.2071L9.29297 14.7929L6.00008 18.0858L4.20718 16.2929L2.79297 17.7071L6.00008 20.9142L10.7072 16.2071Z"},child:[]}]})(e)}function I5(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M8 4H21V6H8V4ZM5 3V6H6V7H3V6H4V4H3V3H5ZM3 14V11.5H5V11H3V10H6V12.5H4V13H6V14H3ZM5 19.5H3V18.5H5V18H3V17H6V21H3V20H5V19.5ZM8 11H21V13H8V11ZM8 18H21V20H8V18Z"},child:[]}]})(e)}function I3(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M8 4H21V6H8V4ZM4.5 6.5C3.67157 6.5 3 5.82843 3 5C3 4.17157 3.67157 3.5 4.5 3.5C5.32843 3.5 6 4.17157 6 5C6 5.82843 5.32843 6.5 4.5 6.5ZM4.5 13.5C3.67157 13.5 3 12.8284 3 12C3 11.1716 3.67157 10.5 4.5 10.5C5.32843 10.5 6 11.1716 6 12C6 12.8284 5.32843 13.5 4.5 13.5ZM4.5 20.4C3.67157 20.4 3 19.7284 3 18.9C3 18.0716 3.67157 17.4 4.5 17.4C5.32843 17.4 6 18.0716 6 18.9C6 19.7284 5.32843 20.4 4.5 20.4ZM8 11H21V13H8V11ZM8 18H21V20H8V18Z"},child:[]}]})(e)}function I8(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M20 3C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3H20ZM11 5H5V10.999H7V9L10 12L7 15V13H5V19H11V17H13V19H19V13H17V15L14 12L17 9V10.999H19V5H13V7H11V5ZM13 13V15H11V13H13ZM13 9V11H11V9H13Z"},child:[]}]})(e)}function I6(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M21 20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3H20C20.5523 3 21 3.44772 21 4V20ZM19 11V5H13.001V7H15L12 10L9 7H11V5H5V11H7V13H5V19H11V17H9L12 14L15 17H13.001V19H19V13H17V11H19ZM11 13H9V11H11V13ZM15 13H13V11H15V13Z"},child:[]}]})(e)}function I9(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M21 4H3V6H21V4ZM21 11H8V13H21V11ZM21 18H8V20H21V18ZM5 11H3V20H5V11Z"},child:[]}]})(e)}function I7(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M13 6V21H11V6H5V4H19V6H13Z"},child:[]}]})(e)}function Oe(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M5 11.1005L7 9.1005L12.5 14.6005L16 11.1005L19 14.1005V5H5V11.1005ZM4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3ZM15.5 10C14.6716 10 14 9.32843 14 8.5C14 7.67157 14.6716 7 15.5 7C16.3284 7 17 7.67157 17 8.5C17 9.32843 16.3284 10 15.5 10Z"},child:[]}]})(e)}function Ot(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M21 15V18H24V20H21V23H19V20H16V18H19V15H21ZM21.0082 3C21.556 3 22 3.44495 22 3.9934L22.0007 13.3417C21.3749 13.1204 20.7015 13 20 13V5H4L4.001 19L13.2929 9.70715C13.6528 9.34604 14.22 9.31823 14.6123 9.62322L14.7065 9.70772L18.2521 13.2586C15.791 14.0069 14 16.2943 14 19C14 19.7015 14.1204 20.3749 14.3417 21.0007L2.9918 21C2.44405 21 2 20.5551 2 20.0066V3.9934C2 3.44476 2.45531 3 2.9918 3H21.0082ZM8 7C9.10457 7 10 7.89543 10 9C10 10.1046 9.10457 11 8 11C6.89543 11 6 10.1046 6 9C6 7.89543 6.89543 7 8 7Z"},child:[]}]})(e)}function On(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M20 3C20.5523 3 21 3.44772 21 4V5.757L19 7.757V5H5V13.1L9 9.1005L13.328 13.429L12.0012 14.7562L11.995 18.995L16.2414 19.0012L17.571 17.671L18.8995 19H19V16.242L21 14.242V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3H20ZM21.7782 7.80761L23.1924 9.22183L15.4142 17L13.9979 16.9979L14 15.5858L21.7782 7.80761ZM15.5 7C16.3284 7 17 7.67157 17 8.5C17 9.32843 16.3284 10 15.5 10C14.6716 10 14 9.32843 14 8.5C14 7.67157 14.6716 7 15.5 7Z"},child:[]}]})(e)}function Or(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M22 18V20H2V18H22ZM2 3.5L10 8.5L2 13.5V3.5ZM22 11V13H12V11H22ZM22 4V6H12V4H22Z"},child:[]}]})(e)}function Oo(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3 3.9934C3 3.44476 3.44495 3 3.9934 3H20.0066C20.5552 3 21 3.44495 21 3.9934V20.0066C21 20.5552 20.5551 21 20.0066 21H3.9934C3.44476 21 3 20.5551 3 20.0066V3.9934ZM10.6219 8.41459C10.5562 8.37078 10.479 8.34741 10.4 8.34741C10.1791 8.34741 10 8.52649 10 8.74741V15.2526C10 15.3316 10.0234 15.4088 10.0672 15.4745C10.1897 15.6583 10.4381 15.708 10.6219 15.5854L15.5008 12.3328C15.5447 12.3035 15.5824 12.2658 15.6117 12.2219C15.7343 12.0381 15.6846 11.7897 15.5008 11.6672L10.6219 8.41459Z"},child:[]}]})(e)}function Oi(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M2 16.0001H5.88889L11.1834 20.3319C11.2727 20.405 11.3846 20.4449 11.5 20.4449C11.7761 20.4449 12 20.2211 12 19.9449V4.05519C12 3.93977 11.9601 3.8279 11.887 3.73857C11.7121 3.52485 11.3971 3.49335 11.1834 3.66821L5.88889 8.00007H2C1.44772 8.00007 1 8.44778 1 9.00007V15.0001C1 15.5524 1.44772 16.0001 2 16.0001ZM23 12C23 15.292 21.5539 18.2463 19.2622 20.2622L17.8445 18.8444C19.7758 17.1937 21 14.7398 21 12C21 9.26016 19.7758 6.80629 17.8445 5.15557L19.2622 3.73779C21.5539 5.75368 23 8.70795 23 12ZM18 12C18 10.0883 17.106 8.38548 15.7133 7.28673L14.2842 8.71584C15.3213 9.43855 16 10.64 16 12C16 13.36 15.3213 14.5614 14.2842 15.2841L15.7133 16.7132C17.106 15.6145 18 13.9116 18 12Z"},child:[]}]})(e)}function Os(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M11 11V5H13V11H19V13H13V19H11V13H5V11H11Z"},child:[]}]})(e)}function Ol(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M9.9997 15.1709L19.1921 5.97852L20.6063 7.39273L9.9997 17.9993L3.63574 11.6354L5.04996 10.2212L9.9997 15.1709Z"},child:[]}]})(e)}function Oa(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M17 6H22V8H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V8H2V6H7V3C7 2.44772 7.44772 2 8 2H16C16.5523 2 17 2.44772 17 3V6ZM18 8H6V20H18V8ZM9 4V6H15V4H9Z"},child:[]}]})(e)}function Oc(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M17 6H22V8H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V8H2V6H7V3C7 2.44772 7.44772 2 8 2H16C16.5523 2 17 2.44772 17 3V6ZM9 11V17H11V11H9ZM13 11V17H15V11H13ZM9 4V6H15V4H9Z"},child:[]}]})(e)}function Od(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M4 19H20V12H22V20C22 20.5523 21.5523 21 21 21H3C2.44772 21 2 20.5523 2 20V12H4V19ZM14 9H19L12 16L5 9H10V3H14V9Z"},child:[]}]})(e)}function Ou(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M10 6V8H5V19H16V14H18V20C18 20.5523 17.5523 21 17 21H4C3.44772 21 3 20.5523 3 20V7C3 6.44772 3.44772 6 4 6H10ZM21 3V12L17.206 8.207L11.2071 14.2071L9.79289 12.7929L15.792 6.793L12 3H21Z"},child:[]}]})(e)}function Oh(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M5 10C3.9 10 3 10.9 3 12C3 13.1 3.9 14 5 14C6.1 14 7 13.1 7 12C7 10.9 6.1 10 5 10ZM19 10C17.9 10 17 10.9 17 12C17 13.1 17.9 14 19 14C20.1 14 21 13.1 21 12C21 10.9 20.1 10 19 10ZM12 10C10.9 10 10 10.9 10 12C10 13.1 10.9 14 12 14C13.1 14 14 13.1 14 12C14 10.9 13.1 10 12 10Z"},child:[]}]})(e)}function Op(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20ZM8 13H16C16 15.2091 14.2091 17 12 17C9.79086 17 8 15.2091 8 13ZM8 11C7.17157 11 6.5 10.3284 6.5 9.5C6.5 8.67157 7.17157 8 8 8C8.82843 8 9.5 8.67157 9.5 9.5C9.5 10.3284 8.82843 11 8 11ZM16 11C15.1716 11 14.5 10.3284 14.5 9.5C14.5 8.67157 15.1716 8 16 8C16.8284 8 17.5 8.67157 17.5 9.5C17.5 10.3284 16.8284 11 16 11Z"},child:[]}]})(e)}let Of={bold:function(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M8 11H12.5C13.8807 11 15 9.88071 15 8.5C15 7.11929 13.8807 6 12.5 6H8V11ZM18 15.5C18 17.9853 15.9853 20 13.5 20H6V4H12.5C14.9853 4 17 6.01472 17 8.5C17 9.70431 16.5269 10.7981 15.7564 11.6058C17.0979 12.3847 18 13.837 18 15.5ZM8 13V18H13.5C14.8807 18 16 16.8807 16 15.5C16 14.1193 14.8807 13 13.5 13H8Z"},child:[]}]})(e)},italic:function(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M15 20H7V18H9.92661L12.0425 6H9V4H17V6H14.0734L11.9575 18H15V20Z"},child:[]}]})(e)},underline:function(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M8 3V12C8 14.2091 9.79086 16 12 16C14.2091 16 16 14.2091 16 12V3H18V12C18 15.3137 15.3137 18 12 18C8.68629 18 6 15.3137 6 12V3H8ZM4 20H20V22H4V20Z"},child:[]}]})(e)},strike:function(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M17.1538 14C17.3846 14.5161 17.5 15.0893 17.5 15.7196C17.5 17.0625 16.9762 18.1116 15.9286 18.867C14.8809 19.6223 13.4335 20 11.5862 20C9.94674 20 8.32335 19.6185 6.71592 18.8555V16.6009C8.23538 17.4783 9.7908 17.917 11.3822 17.917C13.9333 17.917 15.2128 17.1846 15.2208 15.7196C15.2208 15.0939 15.0049 14.5598 14.5731 14.1173C14.5339 14.0772 14.4939 14.0381 14.4531 14H3V12H21V14H17.1538ZM13.076 11H7.62908C7.4566 10.8433 7.29616 10.6692 7.14776 10.4778C6.71592 9.92084 6.5 9.24559 6.5 8.45207C6.5 7.21602 6.96583 6.165 7.89749 5.299C8.82916 4.43299 10.2706 4 12.2219 4C13.6934 4 15.1009 4.32808 16.4444 4.98426V7.13591C15.2448 6.44921 13.9293 6.10587 12.4978 6.10587C10.0187 6.10587 8.77917 6.88793 8.77917 8.45207C8.77917 8.87172 8.99709 9.23796 9.43293 9.55079C9.86878 9.86362 10.4066 10.1135 11.0463 10.3004C11.6665 10.4816 12.3431 10.7148 13.076 11H13.076Z"},child:[]}]})(e)},code:function(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M23 12L15.9289 19.0711L14.5147 17.6569L20.1716 12L14.5147 6.34317L15.9289 4.92896L23 12ZM3.82843 12L9.48528 17.6569L8.07107 19.0711L1 12L8.07107 4.92896L9.48528 6.34317L3.82843 12Z"},child:[]}]})(e)}},Om=e=>{let t=If(),n=Ih(),r=Ip(),o=II({editor:r,selector:({editor:t})=>{var n,r;if(!(!t.isEditable||!((r=e.basicTextStyle)in t.schema.styleSchema)||t.schema.styleSchema[r].type!==r||"boolean"!==t.schema.styleSchema[r].propSchema||!((null==(n=t.getSelection())?void 0:n.blocks)||[t.getTextCursorPosition().block]).find(e=>void 0!==e.content)))return e.basicTextStyle in t.getActiveStyles()?{active:!0}:{active:!1}}}),i=(0,X.useCallback)(e=>{r.focus(),r.toggleStyles({[e]:!0})},[r,e]);if(void 0===o)return null;let s=Of[e.basicTextStyle];return(0,Z.jsx)(n.FormattingToolbar.Button,{className:"bn-button","data-test":e.basicTextStyle,onClick:()=>i(e.basicTextStyle),isSelected:o.active,label:t.formatting_toolbar[e.basicTextStyle].tooltip,mainTooltip:t.formatting_toolbar[e.basicTextStyle].tooltip,secondaryTooltip:mj(t.formatting_toolbar[e.basicTextStyle].secondary_tooltip,t.generic.ctrl_shortcut),icon:(0,Z.jsx)(s,{})})},Og=e=>{let t=e.textColor||"default",n=e.backgroundColor||"default",r=e.size||16,o=(0,X.useMemo)(()=>({pointerEvents:"none",fontSize:(.75*r).toString()+"px",height:r.toString()+"px",lineHeight:r.toString()+"px",textAlign:"center",width:r.toString()+"px"}),[r]);return(0,Z.jsx)("div",{className:"bn-color-icon","data-background-color":n,"data-text-color":t,style:o,children:"A"})},Ob=["default","gray","brown","red","orange","yellow","green","blue","purple","pink"],Oy=e=>{let t=Ih(),n=If();return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(()=>e.text?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(t.Generic.Menu.Label,{children:n.color_picker.text_title}),Ob.map(r=>(0,Z.jsx)(t.Generic.Menu.Item,{onClick:()=>{e.onClick&&e.onClick(),e.text.setColor(r)},"data-test":"text-color-"+r,icon:(0,Z.jsx)(Og,{textColor:r,size:e.iconSize}),checked:e.text.color===r,children:n.color_picker.colors[r]},"text-color-"+r))]}):null,{}),(0,Z.jsx)(()=>e.background?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(t.Generic.Menu.Label,{children:n.color_picker.background_title}),Ob.map(r=>(0,Z.jsx)(t.Generic.Menu.Item,{onClick:()=>{e.onClick&&e.onClick(),e.background.setColor(r)},"data-test":"background-color-"+r,icon:(0,Z.jsx)(Og,{backgroundColor:r,size:e.iconSize}),checked:e.background.color===r,children:n.color_picker.colors[r]},"background-color-"+r))]}):null,{})]})};function Ov(e,t){return`${e}Color`in t.schema.styleSchema&&t.schema.styleSchema[`${e}Color`].type===`${e}Color`&&"string"===t.schema.styleSchema[`${e}Color`].propSchema}let OE=()=>{let e=Ih(),t=If(),n=Ip(),r=Ov("text",n),o=Ov("background",n),i=II({editor:n,selector:({editor:e})=>{var t;if(!e.isEditable||!((null==(t=e.getSelection())?void 0:t.blocks)||[e.getTextCursorPosition().block]).find(e=>void 0!==e.content))return;let n=Ov("text",e),r=Ov("background",e);if(!(!n&&!r))return{textColor:n?e.getActiveStyles().textColor||"default":void 0,backgroundColor:r?e.getActiveStyles().backgroundColor||"default":void 0}}}),s=(0,X.useCallback)(e=>{if(!r)throw Error("Tried to set text color, but style does not exist in editor schema.");"default"===e?n.removeStyles({textColor:e}):n.addStyles({textColor:e}),setTimeout(()=>{n.focus()})},[n,r]),l=(0,X.useCallback)(e=>{if(!o)throw Error("Tried to set background color, but style does not exist in editor schema.");"default"===e?n.removeStyles({backgroundColor:e}):n.addStyles({backgroundColor:e}),setTimeout(()=>{n.focus()})},[o,n]);return void 0===i?null:(0,Z.jsxs)(e.Generic.Menu.Root,{children:[(0,Z.jsx)(e.Generic.Menu.Trigger,{children:(0,Z.jsx)(e.FormattingToolbar.Button,{className:"bn-button","data-test":"colors",label:t.formatting_toolbar.colors.tooltip,mainTooltip:t.formatting_toolbar.colors.tooltip,icon:(0,Z.jsx)(Og,{textColor:i.textColor,backgroundColor:i.backgroundColor,size:20})})}),(0,Z.jsx)(e.Generic.Menu.Dropdown,{className:"bn-menu-dropdown bn-color-picker-dropdown",children:(0,Z.jsx)(Oy,{text:i.textColor?{color:i.textColor,setColor:s}:void 0,background:i.backgroundColor?{color:i.backgroundColor,setColor:l}:void 0})})]})},Ok=e=>{for(let t of wG)if(e.startsWith(t))return e;return`${wq}://${e}`},OC=e=>{let t=Ih(),n=If(),{editLink:r}=IE(w$),{url:o,text:i,showTextField:s}=e,[l,a]=(0,X.useState)(o),[c,d]=(0,X.useState)(i);(0,X.useEffect)(()=>{a(o),d(i)},[i,o]);let u=(0,X.useCallback)(t=>{var n,o;"Enter"===t.key&&(t.preventDefault(),r(Ok(l),c,e.range.from),null==(n=e.setToolbarOpen)||n.call(e,!1),null==(o=e.setToolbarPositionFrozen)||o.call(e,!1))},[r,l,c,e]),h=(0,X.useCallback)(e=>a(e.currentTarget.value),[]),p=(0,X.useCallback)(e=>d(e.currentTarget.value),[]),f=(0,X.useCallback)(()=>{var t,n;r(Ok(l),c,e.range.from),null==(t=e.setToolbarOpen)||t.call(e,!1),null==(n=e.setToolbarPositionFrozen)||n.call(e,!1)},[r,l,c,e]);return(0,Z.jsxs)(t.Generic.Form.Root,{children:[(0,Z.jsx)(t.Generic.Form.TextInput,{className:"bn-text-input",name:"url",icon:(0,Z.jsx)(I2,{}),autoFocus:!0,placeholder:n.link_toolbar.form.url_placeholder,value:l,onKeyDown:u,onChange:h,onSubmit:f}),!1!==s&&(0,Z.jsx)(t.Generic.Form.TextInput,{className:"bn-text-input",name:"title",icon:(0,Z.jsx)(I7,{}),placeholder:n.link_toolbar.form.title_placeholder,value:c,onKeyDown:u,onChange:p,onSubmit:f})]})},OT=()=>{let e=Ip(),t=Ih(),n=If(),r=IE(wz),{showSelection:o}=IE(g9),[i,s]=(0,X.useState)(!1);(0,X.useEffect)(()=>(o(i),()=>o(!1)),[i,o]);let l=II({editor:e,selector:({editor:e})=>{var t;if(!(!e.isEditable||!("link"in e.schema.inlineContentSchema&&"link"===e.schema.inlineContentSchema.link)||gY(e.prosemirrorState.selection)||!((null==(t=e.getSelection())?void 0:t.blocks)||[e.getTextCursorPosition().block]).find(e=>void 0!==e.content)))return{url:e.getSelectedLinkUrl(),text:e.getSelectedText(),range:{from:e.prosemirrorState.selection.from,to:e.prosemirrorState.selection.to}}}});return(0,X.useEffect)(()=>{var t;let n=e=>{(e.ctrlKey||e.metaKey)&&"k"===e.key&&(s(!0),e.preventDefault())};return null==(t=e.domElement)||t.addEventListener("keydown",n),()=>{var t;null==(t=e.domElement)||t.removeEventListener("keydown",n)}},[e.domElement]),void 0===l?null:(0,Z.jsxs)(t.Generic.Popover.Root,{open:i,children:[(0,Z.jsx)(t.Generic.Popover.Trigger,{children:(0,Z.jsx)(t.FormattingToolbar.Button,{className:"bn-button","data-test":"createLink",label:n.formatting_toolbar.link.tooltip,mainTooltip:n.formatting_toolbar.link.tooltip,secondaryTooltip:mj(n.formatting_toolbar.link.secondary_tooltip,n.generic.ctrl_shortcut),icon:(0,Z.jsx)(I2,{}),onClick:()=>s(!0)})}),(0,Z.jsx)(t.Generic.Popover.Content,{className:"bn-popover-content bn-form-popover",variant:"form-popover",children:(0,Z.jsx)(OC,{url:l.url||"",text:l.text,range:l.range,showTextField:!1,setToolbarOpen:e=>r.store.setState(e)})})]})},Ow=()=>{let e=If(),t=Ih(),n=Ip(),r=II({editor:n,selector:({editor:e})=>{var t;if(!e.isEditable)return;let n=(null==(t=e.getSelection())?void 0:t.blocks)||[e.getTextCursorPosition().block];if(1!==n.length)return;let r=n[0];if(gW(r,e,r.type,{url:"string",caption:"string"}))return r}}),[o,i]=(0,X.useState)();(0,X.useEffect)(()=>{void 0!==r&&i(r.props.caption)},[r]);let s=(0,X.useCallback)(e=>i(e.currentTarget.value),[]),l=(0,X.useCallback)(e=>{void 0!==r&&gq(n,r.type,{caption:"string"})&&"Enter"===e.key&&(e.preventDefault(),n.updateBlock(r.id,{props:{caption:o}}))},[r,o,n]);return void 0===r?null:(0,Z.jsxs)(t.Generic.Popover.Root,{children:[(0,Z.jsx)(t.Generic.Popover.Trigger,{children:(0,Z.jsx)(t.FormattingToolbar.Button,{className:"bn-button",label:e.formatting_toolbar.file_caption.tooltip,mainTooltip:e.formatting_toolbar.file_caption.tooltip,icon:(0,Z.jsx)(I0,{})})}),(0,Z.jsx)(t.Generic.Popover.Content,{className:"bn-popover-content bn-form-popover",variant:"form-popover",children:(0,Z.jsx)(t.Generic.Form.Root,{children:(0,Z.jsx)(t.Generic.Form.TextInput,{name:"file-caption",icon:(0,Z.jsx)(I0,{}),value:o||"",autoFocus:!0,placeholder:e.formatting_toolbar.file_caption.input_placeholder,onKeyDown:l,onChange:s})})})]})},Ox=()=>{let e=If(),t=Ih(),n=Ip(),r=II({editor:n,selector:({editor:e})=>{var t;if(!e.isEditable)return;let n=(null==(t=e.getSelection())?void 0:t.blocks)||[e.getTextCursorPosition().block];if(1!==n.length)return;let r=n[0];if(gW(r,e,r.type,{url:"string"}))return r}}),o=(0,X.useCallback)(()=>{void 0!==r&&(n.focus(),n.removeBlocks([r.id]))},[r,n]);return void 0===r?null:(0,Z.jsx)(t.FormattingToolbar.Button,{className:"bn-button",label:e.formatting_toolbar.file_delete.tooltip[r.type]||e.formatting_toolbar.file_delete.tooltip.file,mainTooltip:e.formatting_toolbar.file_delete.tooltip[r.type]||e.formatting_toolbar.file_delete.tooltip.file,icon:(0,Z.jsx)(Oa,{}),onClick:o})},OS=()=>{let e=If(),t=Ih(),n=Ip(),r=II({editor:n,selector:({editor:e})=>{var t;if(!e.isEditable)return;let n=(null==(t=e.getSelection())?void 0:t.blocks)||[e.getTextCursorPosition().block];if(1!==n.length)return;let r=n[0];if(gW(r,e,r.type,{url:"string",name:"string"}))return r}}),[o,i]=(0,X.useState)();(0,X.useEffect)(()=>{void 0!==r&&i(r.props.name)},[r]);let s=(0,X.useCallback)(e=>i(e.currentTarget.value),[]),l=(0,X.useCallback)(e=>{void 0!==r&&gq(n,r.type,{name:"string"})&&"Enter"===e.key&&(e.preventDefault(),n.updateBlock(r.id,{props:{name:o}}))},[r,o,n]);return void 0===r?null:(0,Z.jsxs)(t.Generic.Popover.Root,{children:[(0,Z.jsx)(t.Generic.Popover.Trigger,{children:(0,Z.jsx)(t.FormattingToolbar.Button,{className:"bn-button",label:e.formatting_toolbar.file_rename.tooltip[r.type]||e.formatting_toolbar.file_rename.tooltip.file,mainTooltip:e.formatting_toolbar.file_rename.tooltip[r.type]||e.formatting_toolbar.file_rename.tooltip.file,icon:(0,Z.jsx)(IG,{})})}),(0,Z.jsx)(t.Generic.Popover.Content,{className:"bn-popover-content bn-form-popover",variant:"form-popover",children:(0,Z.jsx)(t.Generic.Form.Root,{children:(0,Z.jsx)(t.Generic.Form.TextInput,{name:"file-name",icon:(0,Z.jsx)(IG,{}),value:o||"",autoFocus:!0,placeholder:e.formatting_toolbar.file_rename.input_placeholder[r.type]||e.formatting_toolbar.file_rename.input_placeholder.file,onKeyDown:l,onChange:s})})})]})},OA=()=>{let e=If(),t=Ih(),n=II({editor:Ip(),selector:({editor:e})=>{var t;if(!e.isEditable)return;let n=(null==(t=e.getSelection())?void 0:t.blocks)||[e.getTextCursorPosition().block];if(1!==n.length)return;let r=n[0];if(gW(r,e,r.type,{url:"string"}))return r}});return void 0===n?null:(0,Z.jsxs)(t.Generic.Popover.Root,{position:"bottom",children:[(0,Z.jsx)(t.Generic.Popover.Trigger,{children:(0,Z.jsx)(t.FormattingToolbar.Button,{className:"bn-button",mainTooltip:e.formatting_toolbar.file_replace.tooltip[n.type]||e.formatting_toolbar.file_replace.tooltip.file,label:e.formatting_toolbar.file_replace.tooltip[n.type]||e.formatting_toolbar.file_replace.tooltip.file,icon:(0,Z.jsx)(On,{})})}),(0,Z.jsx)(t.Generic.Popover.Content,{className:"bn-popover-content bn-panel-popover",variant:"panel-popover",children:(0,Z.jsx)(Ib,{blockId:n.id})})]})},O_=()=>{let e=If(),t=Ih(),n=Ip(),r=II({editor:n,selector:({editor:e})=>{var t;if(!(!e.isEditable||!((null==(t=e.getSelection())?void 0:t.blocks)||[e.getTextCursorPosition().block]).find(e=>void 0!==e.content)))return{canNestBlock:e.canNestBlock()}}}),o=(0,X.useCallback)(()=>{void 0!==r&&r.canNestBlock&&(n.focus(),n.nestBlock())},[n,r]);return void 0===r?null:(0,Z.jsx)(t.FormattingToolbar.Button,{className:"bn-button","data-test":"nestBlock",onClick:o,isDisabled:!r.canNestBlock,label:e.formatting_toolbar.nest.tooltip,mainTooltip:e.formatting_toolbar.nest.tooltip,secondaryTooltip:mj(e.formatting_toolbar.nest.secondary_tooltip,e.generic.ctrl_shortcut),icon:(0,Z.jsx)(IJ,{})})},ON=()=>{let e=If(),t=Ih(),n=Ip(),r=II({editor:n,selector:({editor:e})=>{var t;if(!(!e.isEditable||!((null==(t=e.getSelection())?void 0:t.blocks)||[e.getTextCursorPosition().block]).find(e=>void 0!==e.content)))return{canUnnestBlock:e.canUnnestBlock()}}}),o=(0,X.useCallback)(()=>{void 0!==r&&r.canUnnestBlock&&(n.focus(),n.unnestBlock())},[n,r]);return void 0===r?null:(0,Z.jsx)(t.FormattingToolbar.Button,{className:"bn-button","data-test":"unnestBlock",onClick:o,isDisabled:!r.canUnnestBlock,label:e.formatting_toolbar.unnest.tooltip,mainTooltip:e.formatting_toolbar.unnest.tooltip,secondaryTooltip:mj(e.formatting_toolbar.unnest.secondary_tooltip,e.generic.ctrl_shortcut),icon:(0,Z.jsx)(IQ,{})})},OM=e=>{let t=Ih(),n=Ip(),r=II({editor:n,selector:({editor:e})=>{var t;return(null==(t=e.getSelection())?void 0:t.blocks)||[e.getTextCursorPosition().block]}}),o=r[0],i=(0,X.useMemo)(()=>{let t;return(e.items||[{name:(t=n.dictionary).slash_menu.paragraph.title,type:"paragraph",icon:I7},{name:t.slash_menu.heading.title,type:"heading",props:{level:1,isToggleable:!1},icon:Iq},{name:t.slash_menu.heading_2.title,type:"heading",props:{level:2,isToggleable:!1},icon:IW},{name:t.slash_menu.heading_3.title,type:"heading",props:{level:3,isToggleable:!1},icon:IY},{name:t.slash_menu.heading_4.title,type:"heading",props:{level:4,isToggleable:!1},icon:IK},{name:t.slash_menu.heading_5.title,type:"heading",props:{level:5,isToggleable:!1},icon:IZ},{name:t.slash_menu.heading_6.title,type:"heading",props:{level:6,isToggleable:!1},icon:IX},{name:t.slash_menu.toggle_heading.title,type:"heading",props:{level:1,isToggleable:!0},icon:Iq},{name:t.slash_menu.toggle_heading_2.title,type:"heading",props:{level:2,isToggleable:!0},icon:IW},{name:t.slash_menu.toggle_heading_3.title,type:"heading",props:{level:3,isToggleable:!0},icon:IY},{name:t.slash_menu.quote.title,type:"quote",icon:I9},{name:t.slash_menu.toggle_list.title,type:"toggleListItem",icon:Or},{name:t.slash_menu.bullet_list.title,type:"bulletListItem",icon:I3},{name:t.slash_menu.numbered_list.title,type:"numberedListItem",icon:I5},{name:t.slash_menu.check_list.title,type:"checkListItem",icon:I4}]).filter(e=>gq(n,e.type,Object.fromEntries(Object.entries(e.props||{}).map(([e,t])=>[e,typeof t]))))},[n,e.items]),s=(0,X.useMemo)(()=>i.map(e=>{let t=e.icon,i=e.type===o.type,s=0===Object.entries(e.props||{}).filter(([e,t])=>t!==o.props[e]).length;return{text:e.name,icon:(0,Z.jsx)(t,{size:16}),onClick:()=>{n.focus(),n.transact(()=>{for(let t of r)n.updateBlock(t,{type:e.type,props:e.props})})},isSelected:i&&s}}),[n,i,o.props,o.type,r]);return(0,X.useMemo)(()=>void 0!==s.find(e=>e.isSelected),[s])&&n.isEditable?(0,Z.jsx)(t.FormattingToolbar.Select,{className:"bn-select",items:s}):null},OI=()=>{let e=If(),t=Ih(),n=IE("comments"),{store:r}=IE(wz),o=(0,X.useCallback)(()=>{n.startPendingComment(),r.setState(!1)},[n,r]);return(0,Z.jsx)(t.FormattingToolbar.Button,{className:"bn-button",label:e.formatting_toolbar.comment.tooltip,mainTooltip:e.formatting_toolbar.comment.tooltip,icon:(0,Z.jsx)(Iz,{}),onClick:o})},OO=()=>Ip().getExtension("comments")?(0,Z.jsx)(OI,{}):null,OD=()=>{let e=If(),t=Ih(),n=Ip(),r=(0,X.useCallback)(()=>{n._tiptapEditor.chain().focus().addPendingComment().run()},[n]);return n._tiptapEditor.commands.addPendingComment&&n.isEditable?(0,Z.jsx)(t.FormattingToolbar.Button,{className:"bn-button",label:e.formatting_toolbar.comment.tooltip,mainTooltip:e.formatting_toolbar.comment.tooltip,icon:(0,Z.jsx)(Iz,{}),onClick:r}):null};function OR(e,t){try{let n=new URL(e,t);if("javascript:"!==n.protocol)return n.href}catch{}return"#"}let OL=()=>{let e=If(),t=Ih(),n=Ip(),r=II({editor:n,selector:({editor:e})=>{var t;let n=(null==(t=e.getSelection())?void 0:t.blocks)||[e.getTextCursorPosition().block];if(1!==n.length)return;let r=n[0];if(gW(r,e,r.type,{url:"string"}))return r}}),o=(0,X.useCallback)(()=>{void 0!==r&&(n.focus(),n.resolveFileUrl?n.resolveFileUrl(r.props.url).then(e=>window.open(OR(e,window.location.href))):window.open(OR(r.props.url,window.location.href)))},[r,n]);return void 0===r?null:(0,Z.jsx)(t.FormattingToolbar.Button,{className:"bn-button",label:e.formatting_toolbar.file_download.tooltip[r.type]||e.formatting_toolbar.file_download.tooltip.file,mainTooltip:e.formatting_toolbar.file_download.tooltip[r.type]||e.formatting_toolbar.file_download.tooltip.file,icon:(0,Z.jsx)(Od,{}),onClick:o})},OP=()=>{let e=If(),t=Ih(),n=Ip(),r=II({editor:n,selector:({editor:e})=>{var t;if(!e.isEditable)return;let n=(null==(t=e.getSelection())?void 0:t.blocks)||[e.getTextCursorPosition().block];if(1!==n.length)return;let r=n[0];if(gW(r,e,r.type,{url:"string",showPreview:"boolean"}))return r}}),o=(0,X.useCallback)(()=>{void 0!==r&&gq(n,r.type,{showPreview:"boolean"})&&n.updateBlock(r.id,{props:{showPreview:!r.props.showPreview}})},[r,n]);return void 0===r?null:(0,Z.jsx)(t.FormattingToolbar.Button,{className:"bn-button",label:"Toggle preview",mainTooltip:e.formatting_toolbar.file_preview_toggle.tooltip,icon:(0,Z.jsx)(Ot,{}),isSelected:r.props.showPreview,onClick:o})},OB=()=>{let e=If(),t=Ih(),n=Ip(),r=IE(xl),o=II({editor:n,selector:({editor:e})=>{var t;if(!e.isEditable||!e.settings.tables.splitCells)return;let n=(null==(t=e.getSelection())?void 0:t.blocks)||[e.getTextCursorPosition().block];if(1!==n.length)return;let o=n[0];if("table"===o.type)return{mergeDirection:r.getMergeDirection(o)}}}),i=(0,X.useCallback)(()=>{null==r||r.mergeCells()},[r]);return void 0===o?null:(0,Z.jsx)(t.FormattingToolbar.Button,{className:"bn-button",label:e.formatting_toolbar.table_cell_merge.tooltip,mainTooltip:e.formatting_toolbar.table_cell_merge.tooltip,icon:"horizontal"===o.mergeDirection?(0,Z.jsx)(I8,{}):(0,Z.jsx)(I6,{}),onClick:i})},OH=()=>Ip().getExtension(xl)?(0,Z.jsx)(OB,{}):null,Oj={left:function(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3 4H21V6H3V4ZM3 19H17V21H3V19ZM3 14H21V16H3V14ZM3 9H17V11H3V9Z"},child:[]}]})(e)},center:function(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3 4H21V6H3V4ZM5 19H19V21H5V19ZM3 14H21V16H3V14ZM5 9H19V11H5V9Z"},child:[]}]})(e)},right:function(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3 4H21V6H3V4ZM7 19H21V21H7V19ZM3 14H21V16H3V14ZM7 9H21V11H7V9Z"},child:[]}]})(e)},justify:function(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3 4H21V6H3V4ZM3 19H21V21H3V19ZM3 14H21V16H3V14ZM3 9H21V11H3V9Z"},child:[]}]})(e)}},OF=e=>{let t=Ih(),n=If(),r=Ip(),o=II({editor:r,selector:({editor:e})=>{var t,n;if(!e.isEditable)return;let r=(null==(t=e.getSelection())?void 0:t.blocks)||[e.getTextCursorPosition().block],o=r[0];return gW(o,e,o.type,{textAlignment:m5.textAlignment})?{textAlignment:o.props.textAlignment,blocks:r}:1===r.length&&gW(o,e,"table")&&(null==(n=e.getExtension(xl))?void 0:n.getCellSelection())?{textAlignment:lZ(o.content.rows[0].cells[0]).props.textAlignment,blocks:[o]}:void 0}}),i=(0,X.useCallback)(e=>{var t;if(void 0!==o){for(let n of(r.focus(),o.blocks))if(gW(n,r,n.type,{textAlignment:m5.textAlignment})&&gq(r,n.type,{textAlignment:m5.textAlignment}))r.updateBlock(n,{props:{textAlignment:e}});else if("table"===n.type){let o=null==(t=r.getExtension(xl))?void 0:t.getCellSelection();if(!o)continue;let i=n.content.rows.map(e=>({...e,cells:e.cells.map(e=>lZ(e))}));o.cells.forEach(({row:t,col:n})=>{i[t].cells[n].props.textAlignment=e}),r.updateBlock(n,{type:"table",content:{...n.content,type:"tableContent",rows:i}}),r.setTextCursorPosition(n)}}},[r,o]);if(void 0===o)return null;let s=Oj[e.textAlignment];return(0,Z.jsx)(t.FormattingToolbar.Button,{className:"bn-button","data-test":`alignText${e.textAlignment.slice(0,1).toUpperCase()+e.textAlignment.slice(1)}`,onClick:()=>i(e.textAlignment),isSelected:o.textAlignment===e.textAlignment,label:n.formatting_toolbar[`align_${e.textAlignment}`].tooltip,mainTooltip:n.formatting_toolbar[`align_${e.textAlignment}`].tooltip,icon:(0,Z.jsx)(s,{})})},OU=e=>[(0,Z.jsx)(OM,{items:e},"blockTypeSelect"),(0,Z.jsx)(OH,{},"tableCellMergeButton"),(0,Z.jsx)(Ow,{},"fileCaptionButton"),(0,Z.jsx)(OA,{},"replaceFileButton"),(0,Z.jsx)(OS,{},"fileRenameButton"),(0,Z.jsx)(Ox,{},"fileDeleteButton"),(0,Z.jsx)(OL,{},"fileDownloadButton"),(0,Z.jsx)(OP,{},"filePreviewButton"),(0,Z.jsx)(Om,{basicTextStyle:"bold"},"boldStyleButton"),(0,Z.jsx)(Om,{basicTextStyle:"italic"},"italicStyleButton"),(0,Z.jsx)(Om,{basicTextStyle:"underline"},"underlineStyleButton"),(0,Z.jsx)(Om,{basicTextStyle:"strike"},"strikeStyleButton"),(0,Z.jsx)(OF,{textAlignment:"left"},"textAlignLeftButton"),(0,Z.jsx)(OF,{textAlignment:"center"},"textAlignCenterButton"),(0,Z.jsx)(OF,{textAlignment:"right"},"textAlignRightButton"),(0,Z.jsx)(OE,{},"colorStyleButton"),(0,Z.jsx)(O_,{},"nestBlockButton"),(0,Z.jsx)(ON,{},"unnestBlockButton"),(0,Z.jsx)(OT,{},"createLinkButton"),(0,Z.jsx)(OO,{},"addCommentButton"),(0,Z.jsx)(OD,{},"addTiptapCommentButton")],Oz=e=>{let t=Ih();return(0,Z.jsx)(t.FormattingToolbar.Root,{className:"bn-toolbar bn-formatting-toolbar",children:e.children||OU(e.blockTypeSelectItems)})},OV=e=>{let t=Ip(),n=IE(wz,{editor:t}),r=Ik(wz,{editor:t}),o=II({editor:t,selector:({editor:e})=>n.store.state?{from:e.prosemirrorState.selection.from,to:e.prosemirrorState.selection.to}:void 0}),i=II({editor:t,selector:({editor:e})=>{let t=e.getTextCursorPosition().block;return gW(t,e,t.type,{textAlignment:m5.textAlignment})?(e=>{switch(e){case"left":default:return"top-start";case"center":return"top";case"right":return"top-end"}})(t.props.textAlignment):"top-start"}}),s=(0,X.useMemo)(()=>({useFloatingOptions:{open:r,onOpenChange:(e,r,o)=>{n.store.setState(e),"escape-key"===o&&t.focus()},placement:i,middleware:[(0,xA.offset)(10),(0,xA.shift)(),(0,xA.flip)()]},elementProps:{style:{zIndex:40}},...e.floatingUIOptions}),[r,i,e.floatingUIOptions,n.store,t]),l=e.formattingToolbar||Oz;return(0,Z.jsx)(IO,{position:o,...s,children:r&&(0,Z.jsx)(l,{})})},O$=e=>{let t=Ih(),n=If(),{deleteLink:r}=IE(w$);return(0,Z.jsx)(t.LinkToolbar.Button,{className:"bn-button",label:n.link_toolbar.delete.tooltip,mainTooltip:n.link_toolbar.delete.tooltip,isSelected:!1,onClick:()=>{var t;r(e.range.from),null==(t=e.setToolbarOpen)||t.call(e,!1)},icon:(0,Z.jsx)(I1,{})})},OG=e=>{let t=Ih(),n=If();return(0,Z.jsxs)(t.Generic.Popover.Root,{onOpenChange:e.setToolbarPositionFrozen,children:[(0,Z.jsx)(t.Generic.Popover.Trigger,{children:(0,Z.jsx)(t.LinkToolbar.Button,{className:"bn-button",mainTooltip:n.link_toolbar.edit.tooltip,isSelected:!1,children:n.link_toolbar.edit.text})}),(0,Z.jsx)(t.Generic.Popover.Content,{className:"bn-popover-content bn-form-popover",variant:"form-popover",children:(0,Z.jsx)(OC,{url:e.url,text:e.text,range:e.range,setToolbarOpen:e.setToolbarOpen,setToolbarPositionFrozen:e.setToolbarPositionFrozen})})]})},Oq=e=>{let t=Ih(),n=If();return(0,Z.jsx)(t.LinkToolbar.Button,{className:"bn-button",mainTooltip:n.link_toolbar.open.tooltip,label:n.link_toolbar.open.tooltip,isSelected:!1,onClick:()=>{window.open(OR(e.url,window.location.href),"_blank")},icon:(0,Z.jsx)(Ou,{})})},OW=e=>{let t=Ih();return(0,Z.jsx)(t.LinkToolbar.Root,{className:"bn-toolbar bn-link-toolbar",children:e.children||(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(OG,{url:e.url,text:e.text,range:e.range,setToolbarOpen:e.setToolbarOpen,setToolbarPositionFrozen:e.setToolbarPositionFrozen}),(0,Z.jsx)(Oq,{url:e.url}),(0,Z.jsx)(O$,{range:e.range,setToolbarOpen:e.setToolbarOpen})]})})},OY=e=>{let t=Ip(),[n,r]=(0,X.useState)(!1),[o,i]=(0,X.useState)(!1),s=IE(w$),[l,a]=(0,X.useState)(void 0);(0,X.useEffect)(()=>{var e;let n=()=>{let e=s.getLinkAtSelection();if(!e){a(void 0),o||r(!1);return}a({cursorType:"text",url:e.mark.attrs.href,text:e.text,range:e.range,element:s.getLinkElementAtPos(e.range.from)}),o||r(!0)},i=e=>{if(void 0!==l&&"text"===l.cursorType||!(e.target instanceof HTMLElement))return;let t=s.getLinkAtElement(e.target);t&&a({cursorType:"mouse",url:t.mark.attrs.href,text:t.text,range:t.range,element:s.getLinkElementAtPos(t.range.from)})},c=t.onChange(n),d=t.onSelectionChange(n);return null==(e=t.domElement)||e.addEventListener("mouseover",i),()=>{var e;c(),d(),null==(e=t.domElement)||e.removeEventListener("mouseover",i)}},[t,s,l,o]);let c=(0,X.useMemo)(()=>({useFloatingOptions:{open:n,onOpenChange:(e,n,i)=>{o||void 0!==l&&"text"===l.cursorType&&"hover"===i||("escape-key"===i&&t.focus(),r(e))},placement:"top-start",middleware:[(0,xA.offset)(10),(0,xA.flip)()]},useHoverProps:{enabled:void 0!==l&&"mouse"===l.cursorType,delay:{open:250,close:250},handleClose:function(e){void 0===e&&(e={});let{buffer:t=.5,blockPointerEvents:n=!1,requireIntent:r=!0}=e,o={current:-1},i=!1,s=null,l=null,a="undefined"!=typeof performance?performance.now():0,c=e=>{let{x:n,y:c,placement:d,elements:u,onClose:h,nodeId:p,tree:f}=e;return function(e){function m(){xF(o),h()}if(xF(o),!u.domReference||!u.floating||null==d||null==n||null==c)return;let{clientX:g,clientY:b}=e,y=[g,b],v="composedPath"in e?e.composedPath()[0]:e.target,E="mouseleave"===e.type,k=xY(u.floating,v),C=xY(u.domReference,v),T=u.domReference.getBoundingClientRect(),w=u.floating.getBoundingClientRect(),x=d.split("-")[0],S=n>w.right-w.width/2,A=c>w.bottom-w.height/2,_=y[0]>=T.x&&y[0]<=T.x+T.width&&y[1]>=T.y&&y[1]<=T.y+T.height,N=w.width>T.width,M=w.height>T.height,I=(N?T:w).left,O=(N?T:w).right,D=(M?T:w).top,R=(M?T:w).bottom;if(k&&(i=!0,!E))return;if(C&&(i=!1),C&&!E){i=!0;return}if(E&&(0,xh.isElement)(e.relatedTarget)&&xY(u.floating,e.relatedTarget)||f&&function e(t,n,r){return void 0===r&&(r=!0),t.filter(e=>{var t;return e.parentId===n&&(!r||(null==(t=e.context)?void 0:t.open))}).flatMap(n=>[n,...e(t,n.id,r)])}(f.nodesRef.current,p).length)return;if("top"===x&&c>=T.bottom-1||"bottom"===x&&c<=T.top+1||"left"===x&&n>=T.right-1||"right"===x&&n<=T.left+1)return m();let L=[];switch(x){case"top":L=[[I,T.top+1],[I,w.bottom-1],[O,w.bottom-1],[O,T.top+1]];break;case"bottom":L=[[I,w.top+1],[I,T.bottom-1],[O,T.bottom-1],[O,w.top+1]];break;case"left":L=[[w.right-1,R],[w.right-1,D],[T.left+1,D],[T.left+1,R]];break;case"right":L=[[T.right-1,R],[T.right-1,D],[w.left+1,D],[w.left+1,R]]}if(!x6([g,b],L)){if(i&&!_)return m();if(!E&&r){let t=function(e,t){let n=performance.now(),r=n-a;if(null===s||null===l||0===r)return s=e,l=t,a=n,null;let o=e-s,i=t-l,c=Math.sqrt(o*o+i*i);return s=e,l=t,a=n,c/r}(e.clientX,e.clientY);if(null!==t&&t<.1)return m()}x6([g,b],function(e){let[n,r]=e;switch(x){case"top":{let e=[[w.left,S||N?w.bottom-t:w.top],[w.right,S?N?w.bottom-t:w.top:w.bottom-t]];return[[N?n+t/2:S?n+4*t:n-4*t,r+t+1],[N?n-t/2:S?n+4*t:n-4*t,r+t+1],...e]}case"bottom":{let e=[[w.left,S||N?w.top+t:w.bottom],[w.right,S?N?w.top+t:w.bottom:w.top+t]];return[[N?n+t/2:S?n+4*t:n-4*t,r-t],[N?n-t/2:S?n+4*t:n-4*t,r-t],...e]}case"left":return[[A||M?w.right-t:w.left,w.top],[A?M?w.right-t:w.left:w.right-t,w.bottom],[n+t+1,M?r+t/2:A?r+4*t:r-4*t],[n+t+1,M?r-t/2:A?r+4*t:r-4*t]];case"right":{let e=[[A||M?w.left+t:w.right,w.top],[A?M?w.left+t:w.right:w.left+t,w.bottom]];return[[n-t,M?r+t/2:A?r+4*t:r-4*t],[n-t,M?r-t/2:A?r+4*t:r-4*t],...e]}}}([n,c]))?!i&&r&&(o.current=window.setTimeout(m,40)):m()}}};return c.__options={blockPointerEvents:n},c}()},elementProps:{style:{zIndex:50}},...e.floatingUIOptions}),[t,l,e.floatingUIOptions,n,o]),d=(0,X.useMemo)(()=>null!=l&&l.element?{element:l.element}:void 0,[null==l?void 0:l.element]);if(!t.isEditable)return null;let u=e.linkToolbar||OW;return(0,Z.jsx)(Iy,{reference:d,...c,children:l&&(0,Z.jsx)(u,{url:l.url,text:l.text,range:l.range,setToolbarOpen:r,setToolbarPositionFrozen:i})})};function OK(e){return Ij({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8Z"},child:[]},{tag:"path",attr:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8Z"},child:[]}]})(e)}let OZ=()=>{let e=Ih(),t=If(),n=Ip(),r=IE(gJ),o=Ik(xn,{editor:n,selector:e=>null==e?void 0:e.block}),i=(0,X.useCallback)(()=>{if(void 0===o)return;let e=o.content;if(void 0!==e&&Array.isArray(e)&&0===e.length)n.setTextCursorPosition(o),r.openSuggestionMenu("/");else{let e=n.insertBlocks([{type:"paragraph"}],o,"after")[0];n.setTextCursorPosition(e),r.openSuggestionMenu("/")}},[o,n,r]);return void 0===o?null:(0,Z.jsx)(e.SideMenu.Button,{className:"bn-button",label:t.side_menu.add_block_label,icon:(0,Z.jsx)(OK,{size:24,onClick:i,"data-test":"dragHandleAdd"})})};function OX(e){return Ij({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"},child:[]}]})(e)}function OQ(e){return Ij({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m7 10 5 5 5-5z"},child:[]}]})(e)}let OJ=e=>{let t=Ih(),n=Ip(),r=Ik(xn,{editor:n,selector:e=>null==e?void 0:e.block});return void 0!==r&&(gW(r,n,r.type,{textColor:"string"})||gW(r,n,r.type,{backgroundColor:"string"}))?(0,Z.jsxs)(t.Generic.Menu.Root,{position:"right",sub:!0,children:[(0,Z.jsx)(t.Generic.Menu.Trigger,{sub:!0,children:(0,Z.jsx)(t.Generic.Menu.Item,{className:"bn-menu-item",subTrigger:!0,children:e.children})}),(0,Z.jsx)(t.Generic.Menu.Dropdown,{sub:!0,className:"bn-menu-dropdown bn-color-picker-dropdown",children:(0,Z.jsx)(Oy,{iconSize:18,text:gW(r,n,r.type,{textColor:"string"})&&gq(n,r.type,{textColor:"string"})?{color:r.props.textColor,setColor:e=>n.updateBlock(r,{type:r.type,props:{textColor:e}})}:void 0,background:gW(r,n,r.type,{backgroundColor:"string"})&&gq(n,r.type,{backgroundColor:"string"})?{color:r.props.backgroundColor,setColor:e=>n.updateBlock(r,{props:{backgroundColor:e}})}:void 0})})]}):null},O0=e=>{let t=Ih(),n=Ip(),r=Ik(xn,{editor:n,selector:e=>null==e?void 0:e.block});return void 0===r?null:(0,Z.jsx)(t.Generic.Menu.Item,{className:"bn-menu-item",onClick:()=>n.removeBlocks([r]),children:e.children})},O1=e=>{let t=Ih(),n=Ip(),r=Ik(xn,{editor:n,selector:e=>null==e?void 0:e.block});if(void 0===r||"table"!==r.type||!n.settings.tables.headers)return null;let o=!!r.content.headerRows;return(0,Z.jsx)(t.Generic.Menu.Item,{className:"bn-menu-item",checked:o,onClick:()=>{n.updateBlock(r,{content:{...r.content,headerRows:o?void 0:1}})},children:e.children})},O2=e=>{let t=Ih(),n=Ip(),r=Ik(xn,{editor:n,selector:e=>null==e?void 0:e.block});if(void 0===r||"table"!==r.type||!n.settings.tables.headers)return null;let o=!!r.content.headerCols;return(0,Z.jsx)(t.Generic.Menu.Item,{className:"bn-menu-item",checked:o,onClick:()=>{n.updateBlock(r,{content:{...r.content,headerCols:o?void 0:1}})},children:e.children})},O4=e=>{let t=Ih(),n=If();return(0,Z.jsx)(t.Generic.Menu.Dropdown,{className:"bn-menu-dropdown bn-drag-handle-menu",children:e.children||(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(O0,{children:n.drag_handle.delete_menuitem}),(0,Z.jsx)(OJ,{children:n.drag_handle.colors_menuitem}),(0,Z.jsx)(O1,{children:n.drag_handle.header_row_menuitem}),(0,Z.jsx)(O2,{children:n.drag_handle.header_column_menuitem})]})})},O5=e=>{let t=Ih(),n=If(),r=IE(xn),o=Ik(xn,{selector:e=>null==e?void 0:e.block});if(void 0===o)return null;let i=e.dragHandleMenu||O4;return(0,Z.jsxs)(t.Generic.Menu.Root,{onOpenChange:e=>{e?r.freezeMenu():r.unfreezeMenu()},position:"left",children:[(0,Z.jsx)(t.Generic.Menu.Trigger,{children:(0,Z.jsx)(t.SideMenu.Button,{label:n.side_menu.drag_handle_label,draggable:!0,onDragStart:e=>r.blockDragStart(e,o),onDragEnd:r.blockDragEnd,className:"bn-button",icon:(0,Z.jsx)(OX,{size:24,"data-test":"dragHandle"})})}),(0,Z.jsx)(i,{children:e.children})]})},O3=e=>{let t=Ih(),n=Ip(),r=Ik(xn,{editor:n,selector:e=>null==e?void 0:e.block}),o=(0,X.useMemo)(()=>{var e;if(void 0===r)return{};let t={"data-block-type":r.type};return"heading"===r.type&&(t["data-level"]=r.props.level.toString()),null!=(e=n.schema.blockSpecs[r.type].implementation.meta)&&e.fileBlockAccept&&(r.props.url?t["data-url"]="true":t["data-url"]="false"),t},[r,n.schema.blockSpecs]);return(0,Z.jsx)(t.SideMenu.Root,{className:"bn-side-menu",...o,children:e.children||(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(OZ,{}),(0,Z.jsx)(O5,{dragHandleMenu:e.dragHandleMenu})]})})},O8=e=>{let{show:t,block:n}=Ik(xn,{selector:e=>void 0!==e?{show:e.show,block:e.block}:void 0})||{},r=(0,X.useMemo)(()=>({useFloatingOptions:{open:t,placement:"left-start"},useDismissProps:{enabled:!1},elementProps:{style:{zIndex:20}},...e.floatingUIOptions}),[e.floatingUIOptions,t]),o=e.sideMenu||O3;return(0,Z.jsx)(Iv,{blockId:t?null==n?void 0:n.id:void 0,...r,children:(null==n?void 0:n.id)&&(0,Z.jsx)(o,{})})};async function O6(e,t){return(await xu(e,t)).map(({id:e,onItemClick:t})=>({id:e,onItemClick:t,icon:e}))}function O9(e){let t=Ih(),n=If(),{items:r,loadingState:o,selectedIndex:i,onItemClick:s,columns:l}=e,a="loading-initial"===o||"loading"===o?(0,Z.jsx)(t.GridSuggestionMenu.Loader,{className:"bn-grid-suggestion-menu-loader",columns:l}):null,c=(0,X.useMemo)(()=>{let e=[];for(let n=0;n<r.length;n++){let o=r[n];e.push((0,Z.jsx)(t.GridSuggestionMenu.Item,{className:"bn-grid-suggestion-menu-item",item:o,id:`bn-grid-suggestion-menu-item-${n}`,isSelected:n===i,onClick:()=>null==s?void 0:s(o)},o.id))}return e},[t,r,s,i]);return(0,Z.jsxs)(t.GridSuggestionMenu.Root,{id:"bn-grid-suggestion-menu",columns:l,className:"bn-grid-suggestion-menu",children:[a,c,0===c.length&&"loaded"===e.loadingState&&(0,Z.jsx)(t.GridSuggestionMenu.EmptyItem,{className:"bn-grid-suggestion-menu-empty-item",columns:l,children:n.suggestion_menu.no_items_title})]})}function O7(e,t,n,r=3){let o=(0,X.useRef)(0);(0,X.useEffect)(()=>{void 0!==t&&(e.length>0?o.current=t.length:t.length-o.current>r&&n())},[n,r,e.length,t])}function De(e,t){let[n,r]=(0,X.useState)([]),[o,i]=(0,X.useState)(!1),s=(0,X.useRef)(void 0),l=(0,X.useRef)(void 0);return(0,X.useEffect)(()=>{s.current=e,i(!0),t(e).then(t=>{s.current===e&&(r(t),i(!1),l.current=e)})},[e,t]),{items:n||[],usedQuery:l.current,loadingState:void 0===l.current?"loading-initial":o?"loading":"loaded"}}function Dt(e){let t=Id().setContentEditableProps,n=Ip(),{getItems:r,gridSuggestionMenuComponent:o,query:i,clearQuery:s,closeMenu:l,onItemClick:a,columns:c}=e,d=(0,X.useCallback)(e=>{l(),s(),null==a||a(e)},[a,l,s]),{items:u,usedQuery:h,loadingState:p}=De(i,r);O7(u,h,l);let{selectedIndex:f}=function(e,t,n,r,o){let[i,s]=(0,X.useState)(0);return(0,X.useEffect)(()=>{var t;let l=e=>("ArrowLeft"===e.key&&(e.preventDefault(),n.length&&s((i-1+n.length)%n.length)),"ArrowRight"===e.key&&(e.preventDefault(),n.length&&s((i+1+n.length)%n.length)),"ArrowUp"===e.key?(e.preventDefault(),n.length&&s((i-r+n.length)%n.length),!0):"ArrowDown"===e.key?(e.preventDefault(),n.length&&s((i+r)%n.length),!0):"Enter"===e.key&&!e.isComposing&&(e.stopPropagation(),e.preventDefault(),n.length&&(null==o||o(n[i])),!0));return null==(t=e.domElement)||t.addEventListener("keydown",l,!0),()=>{var t;null==(t=e.domElement)||t.removeEventListener("keydown",l,!0)}},[e.domElement,n,i,o,r,void 0!==r&&r>1]),(0,X.useEffect)(()=>{s(0)},[t]),{selectedIndex:0===n.length?void 0:i}}(n,i,u,c,d);return(0,X.useEffect)(()=>(t(e=>({...e,"aria-expanded":!0,"aria-controls":"bn-suggestion-menu"})),()=>{t(e=>({...e,"aria-expanded":!1,"aria-controls":void 0}))}),[t]),(0,X.useEffect)(()=>(t(e=>({...e,"aria-activedescendant":f?"bn-suggestion-menu-item-"+f:void 0})),()=>{t(e=>({...e,"aria-activedescendant":void 0}))}),[t,f]),(0,Z.jsx)(o,{items:u,onItemClick:d,loadingState:p,selectedIndex:f,columns:c})}function Dn(e){let t=Ip(),{triggerCharacter:n,gridSuggestionMenuComponent:r,columns:o,minQueryLength:i,onItemClick:s,getItems:l}=e,a=(0,X.useMemo)(()=>s||(e=>{e.onItemClick(t)}),[t,s]),c=(0,X.useMemo)(()=>l||(async e=>await O6(t,e)),[t,l]),d=IE(gJ);(0,X.useEffect)(()=>{d.addTriggerCharacter(n)},[d,n]);let u=Ik(gJ),h=Ik(gJ,{selector:e=>{var n;return{element:(null==(n=t.domElement)?void 0:n.firstChild)||void 0,getBoundingClientRect:()=>(null==e?void 0:e.referencePos)||new DOMRect}}}),p=(0,X.useMemo)(()=>({useFloatingOptions:{open:(null==u?void 0:u.show)&&(null==u?void 0:u.triggerCharacter)===n,onOpenChange:e=>{e||d.closeMenu()},placement:"bottom-start",middleware:[(0,xA.offset)(10),(0,xA.autoPlacement)({allowedPlacements:["bottom-start","top-start"],padding:10}),(0,xA.shift)(),(0,xA.size)({apply({elements:e,availableHeight:t}){e.floating.style.maxHeight=`${Math.max(0,t)}px`},padding:10})]},elementProps:{onMouseDownCapture:e=>e.preventDefault(),style:{zIndex:70}},...e.floatingUIOptions}),[e.floatingUIOptions,null==u?void 0:u.show,null==u?void 0:u.triggerCharacter,d,n]);return!u||!u.ignoreQueryLength&&i&&(u.query.startsWith(" ")||u.query.length<i)?null:(0,Z.jsx)(Iy,{reference:h,...p,children:n&&(0,Z.jsx)(Dt,{query:u.query,closeMenu:d.closeMenu,clearQuery:d.clearQuery,getItems:c,columns:o,gridSuggestionMenuComponent:r||O9,onItemClick:a})})}function Dr(e){let t=Ih(),n=If(),{items:r,loadingState:o,selectedIndex:i,onItemClick:s}=e,l="loading-initial"===o||"loading"===o?(0,Z.jsx)(t.SuggestionMenu.Loader,{className:"bn-suggestion-menu-loader"}):null,a=(0,X.useMemo)(()=>{let e,n=[];for(let o=0;o<r.length;o++){let l=r[o];l.group!==e&&(e=l.group,n.push((0,Z.jsx)(t.SuggestionMenu.Label,{className:"bn-suggestion-menu-label",children:e},e))),n.push((0,Z.jsx)(t.SuggestionMenu.Item,{className:mF("bn-suggestion-menu-item","small"===l.size?"bn-suggestion-menu-item-small":""),item:l,id:`bn-suggestion-menu-item-${o}`,isSelected:o===i,onClick:()=>null==s?void 0:s(l)},l.title))}return n},[t,r,s,i]);return(0,Z.jsxs)(t.SuggestionMenu.Root,{id:"bn-suggestion-menu",className:"bn-suggestion-menu",children:[a,0===a.length&&("loading"===e.loadingState||"loaded"===e.loadingState)&&(0,Z.jsx)(t.SuggestionMenu.EmptyItem,{className:"bn-suggestion-menu-item",children:n.suggestion_menu.no_items_title}),l]})}function Do(e){let t=Id().setContentEditableProps,n=Ip(),{getItems:r,suggestionMenuComponent:o,query:i,clearQuery:s,closeMenu:l,onItemClick:a}=e,c=(0,X.useCallback)(e=>{l(),s(),null==a||a(e)},[a,l,s]),{items:d,usedQuery:u,loadingState:h}=De(i,r);O7(d,u,l);let{selectedIndex:p}=function(e,t,n,r,o){let{selectedIndex:i,setSelectedIndex:s,handler:l}=function(e,t){let[n,r]=(0,X.useState)(0);return{selectedIndex:n,setSelectedIndex:r,handler:o=>{if("ArrowUp"===o.key)return o.preventDefault(),e.length&&r((n-1+e.length)%e.length),!0;if("ArrowDown"===o.key)return o.preventDefault(),e.length&&r((n+1)%e.length),!0;let i=void 0!==o.nativeEvent?o.nativeEvent.isComposing:o.isComposing;return"Enter"===o.key&&!i&&(o.preventDefault(),o.stopPropagation(),e.length&&(null==t||t(e[n])),!0)}}}(n,r);return(0,X.useEffect)(()=>{var t;return null==(t=e.domElement)||t.addEventListener("keydown",l,!0),()=>{var t;null==(t=e.domElement)||t.removeEventListener("keydown",l,!0)}},[e.domElement,n,i,r,void 0,l]),(0,X.useEffect)(()=>{s(0)},[t,s]),{selectedIndex:0===n.length?void 0:i}}(n,i,d,c);return(0,X.useEffect)(()=>(t(e=>({...e,"aria-expanded":!0,"aria-controls":"bn-suggestion-menu"})),()=>{t(e=>({...e,"aria-expanded":!1,"aria-controls":void 0}))}),[t]),(0,X.useEffect)(()=>(t(e=>({...e,"aria-activedescendant":p?"bn-suggestion-menu-item-"+p:void 0})),()=>{t(e=>({...e,"aria-activedescendant":void 0}))}),[t,p]),(0,Z.jsx)(o,{items:d,onItemClick:c,loadingState:h,selectedIndex:p})}let Di={heading:Iq,heading_2:IW,heading_3:IY,heading_4:IK,heading_5:IZ,heading_6:IX,toggle_heading:Iq,toggle_heading_2:IW,toggle_heading_3:IY,quote:I9,toggle_list:Or,numbered_list:I5,bullet_list:I3,check_list:I4,paragraph:I7,table:function(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M13 10V14H19V10H13ZM11 10H5V14H11V10ZM13 19H19V16H13V19ZM11 19V16H5V19H11ZM13 5V8H19V5H13ZM11 5H5V8H11V5ZM4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3Z"},child:[]}]})(e)},image:Oe,video:function(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M2 3.9934C2 3.44476 2.45531 3 2.9918 3H21.0082C21.556 3 22 3.44495 22 3.9934V20.0066C22 20.5552 21.5447 21 21.0082 21H2.9918C2.44405 21 2 20.5551 2 20.0066V3.9934ZM8 5V19H16V5H8ZM4 5V7H6V5H4ZM18 5V7H20V5H18ZM4 9V11H6V9H4ZM18 9V11H20V9H18ZM4 13V15H6V13H4ZM18 13V15H20V13H18ZM4 17V19H6V17H4ZM18 17V19H20V17H18Z"},child:[]}]})(e)},audio:Oi,file:I$,emoji:function(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM8 13C8 15.2091 9.79086 17 12 17C14.2091 17 16 15.2091 16 13H8ZM8 11C8.82843 11 9.5 10.3284 9.5 9.5C9.5 8.67157 8.82843 8 8 8C7.17157 8 6.5 8.67157 6.5 9.5C6.5 10.3284 7.17157 11 8 11ZM16 11C16.8284 11 17.5 10.3284 17.5 9.5C17.5 8.67157 16.8284 8 16 8C15.1716 8 14.5 8.67157 14.5 9.5C14.5 10.3284 15.1716 11 16 11Z"},child:[]}]})(e)},code_block:function(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M3.41436 5.99995L5.70726 3.70706L4.29304 2.29285L0.585938 5.99995L4.29304 9.70706L5.70726 8.29285L3.41436 5.99995ZM9.58594 5.99995L7.29304 3.70706L8.70726 2.29285L12.4144 5.99995L8.70726 9.70706L7.29304 8.29285L9.58594 5.99995ZM14.0002 2.99995H21.0002C21.5524 2.99995 22.0002 3.44767 22.0002 3.99995V20C22.0002 20.5522 21.5524 21 21.0002 21H3.00015C2.44787 21 2.00015 20.5522 2.00015 20V12H4.00015V19H20.0002V4.99995H14.0002V2.99995Z"},child:[]}]})(e)},divider:function(e){return Ij({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M5 11V13H19V11H5Z"},child:[]}]})(e)}};function Ds(e){let t=Ip(),{triggerCharacter:n,suggestionMenuComponent:r,minQueryLength:o,onItemClick:i,getItems:s}=e,l=(0,X.useMemo)(()=>i||(e=>{e.onItemClick(t)}),[t,i]),a=(0,X.useMemo)(()=>s||(async e=>{var n;let r;return n=(r=[],gq(t,"heading",{level:"number"})&&(t.schema.blockSchema.heading.propSchema.level.values||[]).filter(e=>e<=3).forEach(e=>{r.push({onItemClick:()=>{g0(t,{type:"heading",props:{level:e}})},badge:mj(`Mod-Alt-${e}`),key:1===e?"heading":`heading_${e}`,...t.dictionary.slash_menu[1===e?"heading":`heading_${e}`]})}),gq(t,"quote")&&r.push({onItemClick:()=>{g0(t,{type:"quote"})},key:"quote",...t.dictionary.slash_menu.quote}),gq(t,"toggleListItem")&&r.push({onItemClick:()=>{g0(t,{type:"toggleListItem"})},badge:mj("Mod-Shift-6"),key:"toggle_list",...t.dictionary.slash_menu.toggle_list}),gq(t,"numberedListItem")&&r.push({onItemClick:()=>{g0(t,{type:"numberedListItem"})},badge:mj("Mod-Shift-7"),key:"numbered_list",...t.dictionary.slash_menu.numbered_list}),gq(t,"bulletListItem")&&r.push({onItemClick:()=>{g0(t,{type:"bulletListItem"})},badge:mj("Mod-Shift-8"),key:"bullet_list",...t.dictionary.slash_menu.bullet_list}),gq(t,"checkListItem")&&r.push({onItemClick:()=>{g0(t,{type:"checkListItem"})},badge:mj("Mod-Shift-9"),key:"check_list",...t.dictionary.slash_menu.check_list}),gq(t,"paragraph")&&r.push({onItemClick:()=>{g0(t,{type:"paragraph"})},badge:mj("Mod-Alt-0"),key:"paragraph",...t.dictionary.slash_menu.paragraph}),gq(t,"codeBlock")&&r.push({onItemClick:()=>{g0(t,{type:"codeBlock"})},badge:mj("Mod-Alt-c"),key:"code_block",...t.dictionary.slash_menu.code_block}),gq(t,"divider")&&r.push({onItemClick:()=>{g0(t,{type:"divider"})},key:"divider",...t.dictionary.slash_menu.divider}),gq(t,"table")&&r.push({onItemClick:()=>{g0(t,{type:"table",content:{type:"tableContent",rows:[{cells:["","",""]},{cells:["","",""]}]}})},badge:void 0,key:"table",...t.dictionary.slash_menu.table}),gq(t,"image",{url:"string"})&&r.push({onItemClick:()=>{var e;let n=g0(t,{type:"image"});null==(e=t.getExtension(m9))||e.showMenu(n.id)},key:"image",...t.dictionary.slash_menu.image}),gq(t,"video",{url:"string"})&&r.push({onItemClick:()=>{var e;let n=g0(t,{type:"video"});null==(e=t.getExtension(m9))||e.showMenu(n.id)},key:"video",...t.dictionary.slash_menu.video}),gq(t,"audio",{url:"string"})&&r.push({onItemClick:()=>{var e;let n=g0(t,{type:"audio"});null==(e=t.getExtension(m9))||e.showMenu(n.id)},key:"audio",...t.dictionary.slash_menu.audio}),gq(t,"file",{url:"string"})&&r.push({onItemClick:()=>{var e;let n=g0(t,{type:"file"});null==(e=t.getExtension(m9))||e.showMenu(n.id)},key:"file",...t.dictionary.slash_menu.file}),gq(t,"heading",{level:"number",isToggleable:"boolean"})&&(t.schema.blockSchema.heading.propSchema.level.values||[]).filter(e=>e<=3).forEach(e=>{r.push({onItemClick:()=>{g0(t,{type:"heading",props:{level:e,isToggleable:!0}})},key:1===e?"toggle_heading":`toggle_heading_${e}`,...t.dictionary.slash_menu[1===e?"toggle_heading":`toggle_heading_${e}`]})}),gq(t,"heading",{level:"number"})&&(t.schema.blockSchema.heading.propSchema.level.values||[]).filter(e=>e>3).forEach(e=>{r.push({onItemClick:()=>{g0(t,{type:"heading",props:{level:e}})},badge:mj(`Mod-Alt-${e}`),key:`heading_${e}`,...t.dictionary.slash_menu[`heading_${e}`]})}),r.push({onItemClick:()=>{var e;null==(e=t.getExtension(gJ))||e.openSuggestionMenu(":",{deleteTriggerCharacter:!0,ignoreQueryLength:!0})},key:"emoji",...t.dictionary.slash_menu.emoji}),r).map(e=>{let t=Di[e.key];return{...e,icon:(0,Z.jsx)(t,{size:18})}}),n.filter(({title:t,aliases:n})=>t.toLowerCase().includes(e.toLowerCase())||n&&0!==n.filter(t=>t.toLowerCase().includes(e.toLowerCase())).length)}),[t,s]),c=IE(gJ);(0,X.useEffect)(()=>{c.addTriggerCharacter(n)},[c,n]);let d=Ik(gJ),u=Ik(gJ,{selector:e=>{var n;return{element:(null==(n=t.domElement)?void 0:n.firstChild)||void 0,getBoundingClientRect:()=>(null==e?void 0:e.referencePos)||new DOMRect}}}),h=(0,X.useMemo)(()=>({useFloatingOptions:{open:(null==d?void 0:d.show)&&(null==d?void 0:d.triggerCharacter)===n,onOpenChange:e=>{e||c.closeMenu()},placement:"bottom-start",middleware:[(0,xA.offset)(10),(0,xA.autoPlacement)({allowedPlacements:["bottom-start","top-start"],padding:10}),(0,xA.shift)(),(0,xA.size)({apply({elements:e,availableHeight:t}){e.floating.style.maxHeight=`${Math.max(0,t)}px`},padding:10})]},elementProps:{onMouseDownCapture:e=>e.preventDefault(),style:{zIndex:80}},...e.floatingUIOptions}),[e.floatingUIOptions,null==d?void 0:d.show,null==d?void 0:d.triggerCharacter,c,n]);return!d||!d.ignoreQueryLength&&o&&(d.query.startsWith(" ")||d.query.length<o)?null:(0,Z.jsx)(Iy,{reference:u,...h,children:n&&(0,Z.jsx)(Do,{query:d.query,closeMenu:c.closeMenu,clearQuery:c.clearQuery,getItems:a,suggestionMenuComponent:r||Dr,onItemClick:l})})}let Dl=e=>{let t=Ih(),n=Ip(),r=IE(xl),o=Ik(xl,{selector:e=>null==e?void 0:e.block}),i=(0,X.useRef)(!1),[s,l]=(0,X.useState)(),a=(0,X.useCallback)(t=>{r.freezeHandles(),e.hideOtherElements(!0),o&&(l({originalContent:o.content,originalCroppedContent:{rows:r.cropEmptyRowsOrColumns(o,"addOrRemoveColumns"===e.orientation?"columns":"rows")},startPos:"addOrRemoveColumns"===e.orientation?t.clientX:t.clientY}),i.current=!1,t.preventDefault())},[o,e,r]),c=(0,X.useCallback)(()=>{!o||i.current||n.updateBlock(o,{type:"table",content:{...o.content,rows:"addOrRemoveColumns"===e.orientation?r.addRowsOrColumns(o,"columns",1):r.addRowsOrColumns(o,"rows",1)}})},[o,n,e.orientation,r]);return(0,X.useEffect)(()=>{let t=t=>{var l,a;if(!o)return;if(!s)throw Error("editingState is undefined");i.current=!0;let c=("addOrRemoveColumns"===e.orientation?t.clientX:t.clientY)-s.startPos,d="addOrRemoveColumns"===e.orientation?(null==(l=s.originalCroppedContent.rows[0])?void 0:l.cells.length)??0:s.originalCroppedContent.rows.length,u="addOrRemoveColumns"===e.orientation?(null==(a=s.originalContent.rows[0])?void 0:a.cells.length)??0:s.originalContent.rows.length,h="addOrRemoveColumns"===e.orientation?o.content.rows[0].cells.length:o.content.rows.length,p=u+((e,t=.3)=>{let n=Math.floor(e)+t,r=Math.ceil(e)-t;return e>=n&&e<=r?Math.round(e):e<n?Math.floor(e):Math.ceil(e)})(c/("addOrRemoveColumns"===e.orientation?120:31),.3);p>=d&&p>0&&p!==h&&(n.updateBlock(o,{type:"table",content:{...o.content,rows:"addOrRemoveColumns"===e.orientation?r.addRowsOrColumns({type:"table",content:s.originalCroppedContent},"columns",p-d):r.addRowsOrColumns({type:"table",content:s.originalCroppedContent},"rows",p-d)}}),o.content&&n.setTextCursorPosition(o))};return s&&window.addEventListener("mousemove",t),()=>{window.removeEventListener("mousemove",t)}},[o,s,n,e.orientation,r]),(0,X.useEffect)(()=>{let t=()=>{e.hideOtherElements(!1),r.unfreezeHandles(),l(void 0)};return s&&window.addEventListener("mouseup",t),()=>{window.removeEventListener("mouseup",t)}},[s,e,r]),n.isEditable?(0,Z.jsx)(t.TableHandle.ExtendButton,{className:mF("bn-extend-button","addOrRemoveColumns"===e.orientation?"bn-extend-button-add-remove-columns":"bn-extend-button-add-remove-rows",null!==s?"bn-extend-button-editing":""),onClick:c,onMouseDown:a,children:e.children||(0,Z.jsx)(Os,{size:18,"data-test":"extendButton"})}):null},Da=e=>{let t=Ih(),n=If(),r=IE(xl),o=Ik(xl,{selector:t=>"column"===e.orientation?null==t?void 0:t.colIndex:null==t?void 0:t.rowIndex});return void 0===r||void 0===o?null:(0,Z.jsx)(t.Generic.Menu.Item,{onClick:()=>{r.addRowOrColumn(o,"row"===e.orientation?{orientation:"row",side:e.side}:{orientation:"column",side:e.side})},children:n.table_handle[`add_${e.side}_menuitem`]})},Dc=e=>{let t=Ih(),n=If(),r=IE(xl),o=Ik(xl,{selector:t=>"column"===e.orientation?null==t?void 0:t.colIndex:null==t?void 0:t.rowIndex});return void 0===r||void 0===o?null:(0,Z.jsx)(t.Generic.Menu.Item,{onClick:()=>r.removeRowOrColumn(o,e.orientation),children:"row"===e.orientation?n.table_handle.delete_row_menuitem:n.table_handle.delete_column_menuitem})},Dd=e=>{let t=Ih(),n=If(),r=Ip(),o=IE(xl),{block:i,index:s}=Ik(xl,{selector:t=>({block:null==t?void 0:t.block,index:"column"===e.orientation?null==t?void 0:t.colIndex:null==t?void 0:t.rowIndex})}),l=(0,X.useMemo)(()=>void 0===o||void 0===i||void 0===s?[]:"row"===e.orientation?o.getCellsAtRowHandle(i,s):o.getCellsAtColumnHandle(i,s),[i,s,e.orientation,o]),a=(e,t)=>{if(void 0===i)return;let n=i.content.rows.map(e=>({...e,cells:e.cells.map(e=>lZ(e))}));l.forEach(({row:r,col:o})=>{"text"===t?n[r].cells[o].props.textColor=e:n[r].cells[o].props.backgroundColor=e}),r.updateBlock(i,{type:"table",content:{...i.content,rows:n}}),r.setTextCursorPosition(i)};if(!l||!l[0]||!o||!1===r.settings.tables.cellTextColor&&!1===r.settings.tables.cellBackgroundColor)return null;let c=lZ(l[0].cell);return(0,Z.jsxs)(t.Generic.Menu.Root,{position:"right",sub:!0,children:[(0,Z.jsx)(t.Generic.Menu.Trigger,{sub:!0,children:(0,Z.jsx)(t.Generic.Menu.Item,{className:"bn-menu-item",subTrigger:!0,children:e.children||n.drag_handle.colors_menuitem})}),(0,Z.jsx)(t.Generic.Menu.Dropdown,{sub:!0,className:"bn-menu-dropdown bn-color-picker-dropdown",children:(0,Z.jsx)(Oy,{iconSize:18,text:r.settings.tables.cellTextColor?{color:l.every(({cell:e})=>lQ(e)&&e.props.textColor===c.props.textColor)?c.props.textColor:"default",setColor:e=>{a(e,"text")}}:void 0,background:r.settings.tables.cellBackgroundColor?{color:l.every(({cell:e})=>lQ(e)&&e.props.backgroundColor===c.props.backgroundColor)?c.props.backgroundColor:"default",setColor:e=>a(e,"background")}:void 0})})]})},Du=e=>{let t=Ih(),n=If(),r=Ip(),o=IE(xl),{block:i,index:s}=Ik(xl,{selector:t=>({block:null==t?void 0:t.block,index:"column"===e.orientation?null==t?void 0:t.colIndex:null==t?void 0:t.rowIndex})});if(void 0===o||void 0===i||0!==s||"row"!==e.orientation||!r.settings.tables.headers)return null;let l=!!i.content.headerRows;return(0,Z.jsx)(t.Generic.Menu.Item,{className:"bn-menu-item",checked:l,onClick:()=>{r.updateBlock(i,{...i,content:{...i.content,headerRows:l?void 0:1}})},children:n.drag_handle.header_row_menuitem})},Dh=e=>{let t=Ih(),n=If(),r=Ip(),o=IE(xl),i=Ik(xl,{selector:e=>null==e?void 0:e.block}),s=Ik(xl,{selector:t=>"column"===e.orientation?null==t?void 0:t.colIndex:null==t?void 0:t.rowIndex});if(!o||0!==s||!i||"column"!==e.orientation||!r.settings.tables.headers)return null;let l=!!i.content.headerCols;return(0,Z.jsx)(t.Generic.Menu.Item,{className:"bn-menu-item",checked:l,onClick:()=>{r.updateBlock(i,{...i,content:{...i.content,headerCols:l?void 0:1}})},children:n.drag_handle.header_column_menuitem})},Dp=e=>{let t=Ih();return(0,Z.jsx)(t.Generic.Menu.Dropdown,{className:"bn-table-handle-menu",children:e.children||(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(Dc,{orientation:e.orientation}),(0,Z.jsx)(Da,{orientation:e.orientation,side:"row"===e.orientation?"above":"left"}),(0,Z.jsx)(Da,{orientation:e.orientation,side:"row"===e.orientation?"below":"right"}),(0,Z.jsx)(Du,{orientation:e.orientation}),(0,Z.jsx)(Dh,{orientation:e.orientation}),(0,Z.jsx)(Dd,{orientation:e.orientation})]})})},Df=e=>{let t=Ip(),n=Ih(),[r,o]=(0,X.useState)(!1),i=e.tableHandleMenu||Dp,s=IE(xl),l=Ik(xl),a=(0,X.useMemo)(()=>!!s&&!!l&&!!l.block&&"table"===l.block.type&&("column"===e.orientation?s.getCellsAtColumnHandle(l.block,l.colIndex).every(({cell:e})=>1===lJ(e)):s.getCellsAtRowHandle(l.block,l.rowIndex).every(({cell:e})=>1===l0(e))),[e.orientation,l,s]);return l?(0,Z.jsxs)(n.Generic.Menu.Root,{onOpenChange:n=>{n?(s.freezeHandles(),e.hideOtherElements(!0)):(s.unfreezeHandles(),e.hideOtherElements(!1),t.focus())},position:"right",children:[(0,Z.jsx)(n.Generic.Menu.Trigger,{children:(0,Z.jsx)(n.TableHandle.Root,{className:mF("bn-table-handle",r?"bn-table-handle-dragging":"",a?"":"bn-table-handle-not-draggable"),draggable:a,onDragStart:t=>{o(!0),e.hideOtherElements(!0),"column"===e.orientation?s.colDragStart(t):s.rowDragStart(t)},onDragEnd:()=>{s.dragEnd(),e.hideOtherElements(!1),o(!1)},style:"column"===e.orientation?{transform:"rotate(0.25turn)"}:void 0,children:e.children||(0,Z.jsx)(OX,{size:24,"data-test":"tableHandle"})})}),(0,Z.jsx)(i,{orientation:e.orientation})]}):null},Dm=e=>{var t,n;let r=Ih(),o=If(),i=Ip(),{block:s,colIndex:l,rowIndex:a}=Ik(xl,{selector:e=>({block:null==e?void 0:e.block,colIndex:null==e?void 0:e.colIndex,rowIndex:null==e?void 0:e.rowIndex})}),c=(e,t)=>{if(void 0===s||void 0===l||void 0===a)return;let n=s.content.rows.map(e=>({...e,cells:e.cells.map(e=>lZ(e))}));"text"===t?n[a].cells[l].props.textColor=e:n[a].cells[l].props.backgroundColor=e,i.updateBlock(s,{type:"table",content:{...s.content,rows:n}}),i.setTextCursorPosition(s)};if(void 0===s||void 0===l||void 0===a)return null;let d=null==(n=null==(t=s.content.rows[a])?void 0:t.cells)?void 0:n[l];return d&&(!1!==i.settings.tables.cellTextColor||!1!==i.settings.tables.cellBackgroundColor)?(0,Z.jsxs)(r.Generic.Menu.Root,{position:"right",sub:!0,children:[(0,Z.jsx)(r.Generic.Menu.Trigger,{sub:!0,children:(0,Z.jsx)(r.Generic.Menu.Item,{className:"bn-menu-item",subTrigger:!0,children:e.children||o.drag_handle.colors_menuitem})}),(0,Z.jsx)(r.Generic.Menu.Dropdown,{sub:!0,className:"bn-menu-dropdown bn-color-picker-dropdown",children:(0,Z.jsx)(Oy,{iconSize:18,text:i.settings.tables.cellTextColor?{color:lQ(d)?d.props.textColor:"default",setColor:e=>c(e,"text")}:void 0,background:i.settings.tables.cellBackgroundColor?{color:lQ(d)?d.props.backgroundColor:"default",setColor:e=>c(e,"background")}:void 0})})]}):null},Dg=()=>{var e,t;let n=Ih(),r=If(),o=Ip(),i=IE(xl),{block:s,colIndex:l,rowIndex:a}=Ik(xl,{selector:e=>({block:null==e?void 0:e.block,colIndex:null==e?void 0:e.colIndex,rowIndex:null==e?void 0:e.rowIndex})});if(void 0===s||void 0===l||void 0===a)return null;let c=null==(t=null==(e=s.content.rows[a])?void 0:e.cells)?void 0:t[l];return c&&lQ(c)&&(1!==l0(c)||1!==lJ(c))&&o.settings.tables.splitCells?(0,Z.jsx)(n.Generic.Menu.Item,{onClick:()=>{i.splitCell({row:a,col:l})},children:r.table_handle.split_cell_menuitem}):null},Db=e=>{let t=Ih();return(0,Z.jsx)(t.Generic.Menu.Dropdown,{className:"bn-menu-dropdown bn-table-handle-menu",children:e.children||(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(Dg,{}),(0,Z.jsx)(Dm,{})]})})},Dy=e=>{let t=Ih(),n=Ip(),r=IE(xl),o=e.tableCellMenu||Db;return n.settings.tables.splitCells||n.settings.tables.cellBackgroundColor||n.settings.tables.cellTextColor?(0,Z.jsxs)(t.Generic.Menu.Root,{onOpenChange:t=>{t?(r.freezeHandles(),e.hideOtherElements(!0)):(r.unfreezeHandles(),e.hideOtherElements(!1),n.focus())},position:"right",children:[(0,Z.jsx)(t.Generic.Menu.Trigger,{children:(0,Z.jsx)(t.Generic.Menu.Button,{className:"bn-table-cell-handle",children:e.children||(0,Z.jsx)(OQ,{size:12,"data-test":"tableCellHandle"})})}),(0,Z.jsx)(o,{})]}):null},Dv=e=>{let t=Ip(),[n,r]=(0,X.useState)(),o=Ik(xl),i=(0,X.useMemo)(()=>{let e={};if(void 0===o)return{};let n=mJ(o.block.id,t.prosemirrorState.doc);if(!n)return{};let r=n.posBeforeNode+1,i=t.prosemirrorView.domAtPos(r+1).node;if(!(i instanceof Element))return{};if(e.tableReference={element:i},void 0===o.rowIndex||void 0===o.colIndex)return e;let s=t.prosemirrorState.doc.resolve(r+1).posAtIndex(o.rowIndex),l=t.prosemirrorState.doc.resolve(s+1).posAtIndex(o.colIndex),a=t.prosemirrorView.domAtPos(l+1).node;return a instanceof Element?(e.cellReference={element:a},e.rowReference={element:i,getBoundingClientRect:()=>{let e=i.getBoundingClientRect(),t=a.getBoundingClientRect();return new DOMRect(e.x,o.draggingState&&"row"===o.draggingState.draggedCellOrientation?o.draggingState.mousePos-t.height/2:t.y,e.width,t.height)}},e.columnReference={element:i,getBoundingClientRect:()=>{let e=i.getBoundingClientRect(),t=a.getBoundingClientRect();return new DOMRect(o.draggingState&&"col"===o.draggingState.draggedCellOrientation?o.draggingState.mousePos-t.width/2:t.x,e.y,t.width,e.height)}},e):{}},[t,o]),s=(0,X.useMemo)(()=>void 0!==o?{rowTableHandle:{useFloatingOptions:{open:o.show&&void 0!==o.rowIndex&&(!n||"rowTableHandle"===n),placement:"left",middleware:[(0,xA.offset)(-10)]},elementProps:{style:{zIndex:10}}},columnTableHandle:{useFloatingOptions:{open:o.show&&void 0!==o.colIndex&&(!n||"columnTableHandle"===n),placement:"top",middleware:[(0,xA.offset)(-12)]},elementProps:{style:{zIndex:10}}},tableCellHandle:{useFloatingOptions:{open:o.show&&void 0!==o.rowIndex&&void 0!==o.colIndex&&(!n||"tableCellHandle"===n),placement:"top-end",middleware:[(0,xA.offset)({mainAxis:-15,crossAxis:-1})]},elementProps:{style:{zIndex:10}}},extendRowsButton:{useFloatingOptions:{open:o.show&&o.showAddOrRemoveRowsButton&&(!n||"extendRowsButton"===n),placement:"bottom",middleware:[(0,xA.size)({apply({rects:e,elements:t}){Object.assign(t.floating.style,{width:`${e.reference.width}px`})}})]},elementProps:{style:{zIndex:10}}},extendColumnsButton:{useFloatingOptions:{open:o.show&&o.showAddOrRemoveColumnsButton&&(!n||"extendColumnsButton"===n),placement:"right",middleware:[(0,xA.size)({apply({rects:e,elements:t}){Object.assign(t.floating.style,{height:`${e.reference.height}px`})}})]},elementProps:{style:{zIndex:10}}}}:void 0,[n,o]);if(!o)return null;let l=e.tableHandle||Df,a=e.extendButton||Dl,c=e.tableCellHandle||Dy;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(Iy,{reference:null==i?void 0:i.rowReference,...null==s?void 0:s.rowTableHandle,children:o.show&&void 0!==o.rowIndex&&(!n||"rowTableHandle"===n)&&(0,Z.jsx)(l,{orientation:"row",hideOtherElements:e=>r(e?"rowTableHandle":void 0)})}),(0,Z.jsx)(Iy,{reference:null==i?void 0:i.columnReference,...null==s?void 0:s.columnTableHandle,children:o.show&&void 0!==o.colIndex&&(!n||"columnTableHandle"===n)&&(0,Z.jsx)(l,{orientation:"column",hideOtherElements:e=>r(e?"columnTableHandle":void 0)})}),(0,Z.jsx)(Iy,{reference:null==i?void 0:i.cellReference,...null==s?void 0:s.tableCellHandle,children:o.show&&void 0!==o.rowIndex&&void 0!==o.colIndex&&(!n||"tableCellHandle"===n)&&(0,Z.jsx)(c,{hideOtherElements:e=>r(e?"tableCellHandle":void 0)})}),(0,Z.jsx)(Iy,{reference:null==i?void 0:i.tableReference,...null==s?void 0:s.extendRowsButton,children:o.show&&o.showAddOrRemoveRowsButton&&(!n||"extendRowsButton"===n)&&(0,Z.jsx)(a,{orientation:"addOrRemoveRows",hideOtherElements:e=>r(e?"extendRowsButton":void 0)})}),(0,Z.jsx)(Iy,{reference:null==i?void 0:i.tableReference,...null==s?void 0:s.extendColumnsButton,children:o.show&&o.showAddOrRemoveColumnsButton&&(!n||"extendColumnsButton"===n)&&(0,Z.jsx)(a,{orientation:"addOrRemoveColumns",hideOtherElements:e=>r(e?"extendColumnsButton":void 0)})})]})},DE=(0,X.lazy)(()=>Promise.resolve().then(()=>Rn)),Dk=(0,X.lazy)(()=>Promise.resolve().then(()=>Ro));function DC(e){let t=Ip();if(!t)throw Error("BlockNoteDefaultUI must be used within a BlockNoteContext.Provider");return(0,Z.jsxs)(Z.Fragment,{children:[t.getExtension(wz)&&!1!==e.formattingToolbar&&(0,Z.jsx)(OV,{}),t.getExtension(w$)&&!1!==e.linkToolbar&&(0,Z.jsx)(OY,{}),t.getExtension(gJ)&&!1!==e.slashMenu&&(0,Z.jsx)(Ds,{triggerCharacter:"/"}),t.getExtension(gJ)&&!1!==e.emojiPicker&&(0,Z.jsx)(Dn,{triggerCharacter:":",columns:10,minQueryLength:2}),t.getExtension(xn)&&!1!==e.sideMenu&&(0,Z.jsx)(O8,{}),t.getExtension(m9)&&!1!==e.filePanel&&(0,Z.jsx)(IC,{}),t.getExtension(xl)&&!1!==e.tableHandles&&(0,Z.jsx)(Dv,{}),t.getExtension(bs)&&!1!==e.comments&&(0,Z.jsxs)(X.Suspense,{children:[(0,Z.jsx)(DE,{}),(0,Z.jsx)(Dk,{})]})]})}let DT=()=>{let e=(0,X.useMemo)(()=>{var e;return null==(e=window.matchMedia)?void 0:e.call(window,"(prefers-color-scheme: dark)")},[]),t=(0,X.useMemo)(()=>{var e;return null==(e=window.matchMedia)?void 0:e.call(window,"(prefers-color-scheme: light)")},[]),n=null==e?void 0:e.matches,r=null==t?void 0:t.matches,[o,i]=(0,X.useState)(n?"dark":r?"light":"no-preference");return(0,X.useEffect)(()=>{i(n?"dark":r?"light":"no-preference")},[n,r]),(0,X.useEffect)(()=>{if("function"==typeof(null==e?void 0:e.addEventListener)){let n=({matches:e})=>e&&i("dark"),r=({matches:e})=>e&&i("light");return null==e||e.addEventListener("change",n),null==t||t.addEventListener("change",r),()=>{null==e||e.removeEventListener("change",n),null==t||t.removeEventListener("change",r)}}{let n=()=>i(e.matches?"dark":t.matches?"light":"no-preference");return null==e||e.addEventListener("change",n),null==t||t.addEventListener("change",n),()=>{null==e||e.removeEventListener("change",n),null==t||t.removeEventListener("change",n)}}},[e,t]),window.matchMedia,o},Dw=(0,X.createContext)(void 0),Dx=({contentComponent:e})=>{let t=(0,X.useSyncExternalStore)(e.subscribe,e.getSnapshot,e.getServerSnapshot);return(0,Z.jsx)(Z.Fragment,{children:Object.values(t)})},DS=(0,X.forwardRef)((e,t)=>{let[n,r]=(0,X.useState)();return(0,X.useImperativeHandle)(t,()=>(e,t)=>{(0,xS.flushSync)(()=>{r({node:e,container:t})}),r(void 0)},[]),(0,Z.jsx)(Z.Fragment,{children:n&&(0,xS.createPortal)(n.node,n.container)})}),DA=()=>{},D_=X.default.forwardRef(({className:e,renderEditor:t,editable:n,editorColorScheme:r,children:o,...i},s)=>(0,Z.jsx)("div",{className:mF("bn-container",r,e),"data-color-scheme":r,...i,ref:s,children:t?(0,Z.jsx)(DM,{editable:n,children:o}):o})),DN=X.default.forwardRef(function(e,t){var n,r,o,i;let s,l,{editor:a,className:c,theme:d,children:u,editable:h,onSelectionChange:p,onChange:f,formattingToolbar:m,linkToolbar:g,slashMenu:b,emojiPicker:y,sideMenu:v,filePanel:E,tableHandles:k,comments:C,autoFocus:T,renderEditor:w=!0,...x}=e,[S,A]=(0,X.useState)(),_=Id(),N=DT(),M=(null==_?void 0:_.colorSchemePreference)||N,I=d||("dark"===M?"dark":"light");n=f||DA,r=a,s=Id(),r||(r=null==s?void 0:s.editor),(0,X.useEffect)(()=>{if(!r)throw Error("'editor' is required, either from BlockNoteContext or as a function argument");return r.onChange(n)},[n,r]),o=p||DA,i=a,l=Id(),i||(i=null==l?void 0:l.editor),(0,X.useEffect)(()=>{if(!i)throw Error("'editor' is required, either from BlockNoteContext or as a function argument");return i.onSelectionChange(o,void 0)},[o,i,void 0]),(0,X.useEffect)(()=>{a.isEditable=!1!==h},[h,a]);let O=(0,X.useCallback)(e=>{a.elementRenderer=e},[a]),D=(0,X.useMemo)(()=>({..._,editor:a,setContentEditableProps:A,colorSchemePreference:I}),[_,a,I]),R=(0,X.useMemo)(()=>({editorProps:{autoFocus:T,contentEditableProps:S},defaultUIProps:{formattingToolbar:m,linkToolbar:g,slashMenu:b,emojiPicker:y,sideMenu:v,filePanel:E,tableHandles:k,comments:C}}),[T,S,m,g,b,y,v,E,k,C]);return(0,Z.jsx)(Ic.Provider,{value:D,children:(0,Z.jsxs)(Dw.Provider,{value:R,children:[(0,Z.jsx)(DS,{ref:O}),(0,Z.jsx)(D_,{className:c,renderEditor:w,editable:h,editorColorScheme:I,ref:t,...x,children:u})]})})}),DM=e=>{let t=(0,X.useContext)(Dw),n=Ip(),r=(0,X.useMemo)(()=>{let e,t;return e=new Set,t={},{subscribe:t=>(e.add(t),()=>{e.delete(t)}),getSnapshot:()=>t,getServerSnapshot:()=>t,setRenderer(n,r){t={...t,[n]:(0,xS.createPortal)(r.reactElement,r.element,n)},e.forEach(e=>e())},removeRenderer(n){let r={...t};delete r[n],t=r,e.forEach(e=>e())}}},[]),o=(0,X.useCallback)(t=>{void 0!==e.editable&&e.editable!==n.isEditable&&(n.isEditable=e.editable),n._tiptapEditor.contentComponent=r,t?n.mount(t):n.unmount()},[n,r,e.editable]);return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(Dx,{contentComponent:r}),(0,Z.jsx)(DI,{...t.editorProps,...e,mount:o}),(0,Z.jsx)(DC,{...t.defaultUIProps}),e.children]})},DI=e=>{let{autoFocus:t,mount:n,contentEditableProps:r}=e;return(0,Z.jsx)("div",{"aria-autocomplete":"list","aria-haspopup":"listbox","data-bn-autofocus":t,ref:n,...r})};function DO(e,t){let n,r,o=document.createElement("div");if(null!=t&&t.elementRenderer)t.elementRenderer(e(e=>n=e||void 0),o);else{if(!(null!=t&&t.headless))throw Error("elementRenderer not available, expected headless editor");r=(0,Is.createRoot)(o),(0,xS.flushSync)(()=>{r.render(e(e=>n=e||void 0))})}if(!o.childElementCount)return console.warn("ReactInlineContentSpec: renderHTML() failed"),{dom:document.createElement("span")};null==n||n.setAttribute("data-tmp-find","true");let i=o.cloneNode(!0),s=i.firstElementChild,l=i.querySelector("[data-tmp-find]");return null==l||l.removeAttribute("data-tmp-find"),null==r||r.unmount(),{dom:s,contentDOM:l||void 0}}function DD(e){var t;return(0,Z.jsx)(It,{onDragOver:e=>e.preventDefault(),...Object.fromEntries(Object.entries(e.domAttributes||{}).filter(([e])=>"class"!==e)),className:mF("bn-block-content",(null==(t=e.domAttributes)?void 0:t.class)||""),"data-content-type":e.blockType,...Object.fromEntries(Object.entries(e.blockProps).filter(([t,n])=>n!==e.propSchema[t].default).map(([e,t])=>[mz(e),t])),"data-file-block":!0===e.isFileBlock||void 0,children:e.children})}function DR(e,t,n){return (r={})=>{let o="function"==typeof e?e(r):e,i="function"==typeof t?t(r):t,s=n?"function"==typeof n?n(r):n:void 0;return{config:o,implementation:{...i,toExternalHTML(e,t){let n=i.toExternalHTML||i.render;return DO(r=>(0,Z.jsx)(DD,{blockType:e.type,blockProps:e.props,propSchema:o.propSchema,domAttributes:this.blockContentDOMAttributes,children:(0,Z.jsx)(n,{block:e,editor:t,contentRef:e=>{r(e),e&&(e.className=mF("bn-inline-content",e.className))}})}),t)},render(e,t){if("nodeView"===this.renderType){var n,r;return(n=e=>{var n;let r=m$(e.getPos,t,e.editor,o.type),s=Ie().nodeViewContentRef;if(!s)throw Error("nodeViewContentRef is not set");let l=i.render;return(0,Z.jsx)(DD,{blockType:r.type,blockProps:r.props,propSchema:o.propSchema,isFileBlock:!!(null!=(n=i.meta)&&n.fileBlockAccept),domAttributes:this.blockContentDOMAttributes,children:(0,Z.jsx)(l,{block:r,editor:t,contentRef:e=>{s(e),e&&(e.className=mF("bn-inline-content",e.className),e.dataset.nodeViewContent="")}})})},r={className:"bn-react-node-view-renderer"},e=>e.editor.contentComponent?new Ii(n,e,r):{})(this.props)}{let n=i.render;return DO(r=>(0,Z.jsx)(DD,{blockType:e.type,blockProps:e.props,propSchema:o.propSchema,domAttributes:this.blockContentDOMAttributes,children:(0,Z.jsx)(n,{block:e,editor:t,contentRef:e=>{r(e),e&&(e.className=mF("bn-inline-content",e.className))}})}),t)}}},extensions:s}}}function DL(e){let t=Ip(),[n,r]=(0,X.useState)("loading"),[o,i]=(0,X.useState)();if((0,X.useEffect)(()=>{let n=!0;return(async()=>{let o="";r("loading");try{o=t.resolveFileUrl?await t.resolveFileUrl(e):e}catch{r("error");return}n&&(r("loaded"),i(o))})(),()=>{n=!1}},[t,e]),"loaded"!==n)return{loadingState:n};if(!o)throw Error("Finished fetching file but did not get download URL.");return{loadingState:n,downloadUrl:o}}let DP=e=>(0,Z.jsxs)("figure",{children:[e.children,(0,Z.jsx)("figcaption",{children:e.caption})]});function DB(e){var t,n;let r,o,[i,s]=(0,X.useState)(!1);return t=t=>{t===e&&s(!0)},r=Ip(),(0,X.useEffect)(()=>r.onUploadStart(t),[t,r]),n=t=>{t===e&&s(!1)},o=Ip(),(0,X.useEffect)(()=>o.onUploadEnd(n),[n,o]),i}let DH=e=>{let t=Ip(),n=If(),r=IE(m9),o=(0,X.useCallback)(e=>{e.preventDefault()},[]),i=(0,X.useCallback)(()=>{t.isEditable&&e.editor.transact(()=>r.showMenu(e.block.id))},[t.isEditable,r,e.block.id,e.editor]);return(0,Z.jsxs)("div",{className:"bn-add-file-button",onMouseDown:o,onClick:i,children:[(0,Z.jsx)("div",{className:"bn-add-file-button-icon",children:e.buttonIcon||(0,Z.jsx)(I$,{size:24})}),(0,Z.jsx)("div",{className:"bn-add-file-button-text",children:e.block.type in n.file_blocks.add_button_text?n.file_blocks.add_button_text[e.block.type]:n.file_blocks.add_button_text.file})]})},Dj=e=>(0,Z.jsxs)("div",{className:"bn-file-name-with-icon",contentEditable:!1,draggable:!1,children:[(0,Z.jsx)("div",{className:"bn-file-icon",children:(0,Z.jsx)(I$,{size:24})}),(0,Z.jsx)("p",{className:"bn-file-name",children:e.block.props.name})]}),DF=e=>{let t=DB(e.block.id);return(0,Z.jsx)("div",{className:"bn-file-block-content-wrapper",onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,style:e.style,children:t?(0,Z.jsx)("div",{className:"bn-file-loading-preview",children:"Loading..."}):""===e.block.props.url?(0,Z.jsx)(DH,{...e}):(0,Z.jsxs)(Z.Fragment,{children:[!1!==e.block.props.showPreview&&e.children?e.children:(0,Z.jsx)(Dj,{...e}),e.block.props.caption&&(0,Z.jsx)("p",{className:"bn-file-caption",children:e.block.props.caption})]})})},DU=e=>(0,Z.jsxs)("div",{children:[e.children,(0,Z.jsx)("p",{children:e.caption})]}),Dz=e=>{let t=DL(e.block.props.url);return(0,Z.jsx)("audio",{className:"bn-audio",src:"loading"===t.loadingState?e.block.props.url:t.downloadUrl,controls:!0,contentEditable:!1,draggable:!1})},DV=e=>{if(!e.block.props.url)return(0,Z.jsx)("p",{children:"Add audio"});let t=e.block.props.showPreview?(0,Z.jsx)("audio",{src:e.block.props.url}):(0,Z.jsx)("a",{href:e.block.props.url,children:e.block.props.name||e.block.props.url});return e.block.props.caption?e.block.props.showPreview?(0,Z.jsx)(DP,{caption:e.block.props.caption,children:t}):(0,Z.jsx)(DU,{caption:e.block.props.caption,children:t}):t},D$=e=>(0,Z.jsx)(DF,{...e,buttonIcon:(0,Z.jsx)(Oi,{size:24}),children:(0,Z.jsx)(Dz,{...e})}),DG=(DR(gr,e=>({render:D$,parse:go(e),toExternalHTML:DV,runsBefore:["file"]})),DR(gh,{render:e=>(0,Z.jsx)(DF,{...e}),parse:gp(),toExternalHTML:e=>{if(!e.block.props.url)return(0,Z.jsx)("p",{children:"Add file"});let t=(0,Z.jsx)("a",{href:e.block.props.url,children:e.block.props.name||e.block.props.url});return e.block.props.caption?(0,Z.jsx)(DU,{caption:e.block.props.caption,children:t}):t}}),e=>{let[t,n]=(0,X.useState)(void 0),[r,o]=(0,X.useState)(e.block.props.previewWidth),[i,s]=(0,X.useState)(!1),l=(0,X.useRef)(null);(0,X.useEffect)(()=>{let i=n=>{var r,i;let s="touches"in n?n.touches[0].clientX:n.clientX;o(Math.min(Math.max("center"===e.block.props.textAlignment?"left"===t.handleUsed?t.initialWidth+(t.initialClientX-s)*2:t.initialWidth+(s-t.initialClientX)*2:"left"===t.handleUsed?t.initialWidth+t.initialClientX-s:t.initialWidth+s-t.initialClientX,64),(null==(i=null==(r=e.editor.domElement)?void 0:r.firstElementChild)?void 0:i.clientWidth)||Number.MAX_VALUE))},s=()=>{n(void 0),e.editor.updateBlock(e.block,{props:{previewWidth:r}})};return t&&(window.addEventListener("mousemove",i),window.addEventListener("touchmove",i),window.addEventListener("mouseup",s),window.addEventListener("touchend",s)),()=>{window.removeEventListener("mousemove",i),window.removeEventListener("touchmove",i),window.removeEventListener("mouseup",s),window.removeEventListener("touchend",s)}},[e,t,r]);let a=(0,X.useCallback)(()=>{e.editor.isEditable&&s(!0)},[e.editor.isEditable]),c=(0,X.useCallback)(()=>{s(!1)},[]),d=(0,X.useCallback)(e=>{e.preventDefault();let t="touches"in e?e.touches[0].clientX:e.clientX;n({handleUsed:"left",initialWidth:l.current.clientWidth,initialClientX:t})},[]),u=(0,X.useCallback)(e=>{e.preventDefault();let t="touches"in e?e.touches[0].clientX:e.clientX;n({handleUsed:"right",initialWidth:l.current.clientWidth,initialClientX:t})},[]),h=DB(e.block.id);return(0,Z.jsx)(DF,{...e,onMouseEnter:a,onMouseLeave:c,style:e.block.props.url&&!h&&e.block.props.showPreview?{width:r?`${r}px`:"fit-content"}:void 0,children:(0,Z.jsxs)("div",{className:"bn-visual-media-wrapper",style:{position:"relative"},ref:l,children:[e.children,(i||t)&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("div",{className:"bn-resize-handle",style:{left:"4px"},onMouseDown:d,onTouchStart:d}),(0,Z.jsx)("div",{className:"bn-resize-handle",style:{right:"4px"},onMouseDown:u,onTouchStart:u})]}),t&&(0,Z.jsx)("div",{style:{position:"absolute",height:"100%",width:"100%"}})]})})}),Dq=e=>{let t=DL(e.block.props.url);return(0,Z.jsx)("img",{className:"bn-visual-media",src:"loading"===t.loadingState?e.block.props.url:t.downloadUrl,alt:e.block.props.caption||"BlockNote image",contentEditable:!1,draggable:!1})},DW=e=>{if(!e.block.props.url)return(0,Z.jsx)("p",{children:"Add image"});let t=e.block.props.showPreview?(0,Z.jsx)("img",{src:e.block.props.url,alt:e.block.props.name||e.block.props.caption||"BlockNote image",width:e.block.props.previewWidth}):(0,Z.jsx)("a",{href:e.block.props.url,children:e.block.props.name||e.block.props.url});return e.block.props.caption?e.block.props.showPreview?(0,Z.jsx)(DP,{caption:e.block.props.caption,children:t}):(0,Z.jsx)(DU,{caption:e.block.props.caption,children:t}):t},DY=e=>(0,Z.jsx)(DG,{...e,buttonIcon:(0,Z.jsx)(Oe,{size:24}),children:(0,Z.jsx)(Dq,{...e})});DR(gk,e=>({render:DY,parse:gC(e),toExternalHTML:DW}));let DK=e=>{let t=DL(e.block.props.url);return(0,Z.jsx)("video",{className:"bn-visual-media",src:"loading"===t.loadingState?e.block.props.url:t.downloadUrl,controls:!0,contentEditable:!1,draggable:!1})},DZ=e=>{if(!e.block.props.url)return(0,Z.jsx)("p",{children:"Add video"});let t=e.block.props.showPreview?(0,Z.jsx)("video",{src:e.block.props.url}):(0,Z.jsx)("a",{href:e.block.props.url,children:e.block.props.name||e.block.props.url});return e.block.props.caption?e.block.props.showPreview?(0,Z.jsx)(DP,{caption:e.block.props.caption,children:t}):(0,Z.jsx)(DU,{caption:e.block.props.caption,children:t}):t},DX=e=>(0,Z.jsx)(DG,{...e,buttonIcon:(0,Z.jsx)(Oo,{size:24}),children:(0,Z.jsx)(DK,{...e})});DR(gV,e=>({render:DX,parse:g$(e),toExternalHTML:DZ}));let DQ=(e={},t=[])=>(0,X.useMemo)(()=>{let t=MS.create(e);return window&&(window.ProseMirror=t._tiptapEditor),t},t),DJ=e=>{let[t,n]=(0,X.useState)(!1),r=II({editor:e.editor,selector:({editor:e})=>e.isEmpty}),o=Ih(),i=(0,X.useCallback)(()=>{n(!0)},[]),s=(0,X.useCallback)(()=>{n(!1)},[]);return(0,X.useEffect)(()=>{e.editable&&e.autoFocus&&e.editor.focus()},[e.autoFocus,e.editable,e.editor]),(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(o.Comments.Editor,{autoFocus:e.autoFocus,className:"bn-comment-editor",editor:e.editor,onFocus:i,onBlur:s,editable:e.editable}),e.actions&&(0,Z.jsx)("div",{className:"bn-comment-actions-wrapper",children:(0,Z.jsx)(e.actions,{isFocused:t,isEmpty:r})})]})};async function D0(){return a||(a=(async()=>{let[t,n]=await Promise.all([e.A(86535),e.A(27305)]),r="default"in t?t.default:t,o="default"in n?n.default:n;return await r.init({data:o}),{emojiMart:r,emojiData:o}})())}function D1(e){let t=(0,X.useRef)(null),n=(0,X.useRef)(null);return n.current&&n.current.update(e),(0,X.useEffect)(()=>((async()=>{let{emojiMart:r}=await D0();n.current=new r.Picker({...e,ref:t})})(),()=>{n.current=null}),[]),X.default.createElement("div",{ref:t})}let D2=e=>{let[t,n]=(0,X.useState)(!1),r=Ih(),o=Ip(),i=Id();return(0,Z.jsxs)(r.Generic.Popover.Root,{open:t,children:[(0,Z.jsx)(r.Generic.Popover.Trigger,{children:(0,Z.jsx)("div",{onClick:r=>{var o;r.preventDefault(),r.stopPropagation(),n(!t),null==(o=e.onOpenChange)||o.call(e,!t)},style:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.children})}),(0,xS.createPortal)((0,Z.jsx)(r.Generic.Popover.Content,{className:"bn-emoji-picker-popover",variant:"panel-popover",children:(0,Z.jsx)(D1,{perLine:7,onClickOutside:()=>{var t;n(!1),null==(t=e.onOpenChange)||t.call(e,!1)},onEmojiSelect:t=>{var r;e.onEmojiSelect(t),n(!1),null==(r=e.onOpenChange)||r.call(e,!1)},theme:null==i?void 0:i.colorSchemePreference})}),o.domElement.parentElement)]})};function D4(e){let t=IE(bs).userStore,n=(0,X.useCallback)(()=>{let n=new Map;for(let r of e){let e=t.getUser(r);e&&n.set(r,e)}return n},[t,e]),r=(0,X.useMemo)(()=>({current:n()}),[n]),o=(0,X.useCallback)(o=>{let i=t.subscribe(e=>{r.current=n(),o()});return t.loadUsers(e),i},[t,n,e,r]);return(0,X.useSyncExternalStore)(o,()=>r.current)}let D5=e=>{let t=Ih(),n=If(),r=IE(bs),o=e.comment.reactions.find(t=>t.emoji===e.emoji);if(!o)throw Error("Trying to render reaction badge for non-existing reaction");let[i,s]=(0,X.useState)([]),l=D4(i);return(0,Z.jsx)(t.Generic.Badge.Root,{className:mF("bn-badge","bn-comment-reaction"),text:o.userIds.length.toString(),icon:o.emoji,isSelected:r.threadStore.auth.canDeleteReaction(e.comment,o.emoji),onClick:()=>e.onReactionSelect(o.emoji),onMouseEnter:()=>s(o.userIds),mainTooltip:n.comments.reactions.reacted_by,secondaryTooltip:`${Array.from(l.values()).map(e=>e.username).join(`
`)}`},o.emoji)},{textColor:D3,backgroundColor:D8,...D6}=g5,D9=Si.create({blockSpecs:{paragraph:gO()},styleSpecs:D6}),D7=({comment:e,thread:t,showResolveButton:n})=>{var r;let o,i=IE(bs),s=If(),l=DQ({initialContent:e.body,trailingBlock:!1,dictionary:{...s,placeholders:{emptyDocument:s.placeholders.edit_comment}},schema:i.commentEditorSchema||D9}),a=Ih(),[c,d]=(0,X.useState)(!1),[u,h]=(0,X.useState)(!1),p=i.threadStore,f=(0,X.useCallback)(()=>{d(!0)},[]),m=(0,X.useCallback)(()=>{l.replaceBlocks(l.document,e.body),d(!1)},[l,e.body]),g=(0,X.useCallback)(async n=>{await p.updateComment({commentId:e.id,comment:{body:l.document},threadId:t.id}),d(!1)},[e,t.id,l,p]),b=(0,X.useCallback)(async()=>{await p.deleteComment({commentId:e.id,threadId:t.id})},[e,t.id,p]),y=(0,X.useCallback)(async n=>{p.auth.canAddReaction(e,n)?await p.addReaction({threadId:t.id,commentId:e.id,emoji:n}):p.auth.canDeleteReaction(e,n)&&await p.deleteReaction({threadId:t.id,commentId:e.id,emoji:n})},[p,e,t.id]),v=(0,X.useCallback)(async()=>{await p.resolveThread({threadId:t.id})},[t.id,p]),E=(0,X.useCallback)(async()=>{await p.unresolveThread({threadId:t.id})},[t.id,p]),k=D4([r=e.userId]).get(r);if(!e.body)return null;let C=p.auth.canAddReaction(e),T=p.auth.canDeleteComment(e),w=p.auth.canUpdateComment(e),x=n&&(t.resolved?p.auth.canUnresolveThread(t):p.auth.canResolveThread(t));c||(o=(0,Z.jsxs)(a.Generic.Toolbar.Root,{className:mF("bn-action-toolbar","bn-comment-actions"),variant:"action-toolbar",children:[C&&(0,Z.jsx)(D2,{onEmojiSelect:e=>y(e.native),onOpenChange:h,children:(0,Z.jsx)(a.Generic.Toolbar.Button,{mainTooltip:s.comments.actions.add_reaction,variant:"compact",children:(0,Z.jsx)(Op,{size:16})},"add-reaction")}),x&&(t.resolved?(0,Z.jsx)(a.Generic.Toolbar.Button,{mainTooltip:"Re-open",variant:"compact",onClick:E,children:(0,Z.jsx)(IU,{size:16})},"reopen"):(0,Z.jsx)(a.Generic.Toolbar.Button,{mainTooltip:s.comments.actions.resolve,variant:"compact",onClick:v,children:(0,Z.jsx)(Ol,{size:16})},"resolve")),(T||w)&&(0,Z.jsxs)(a.Generic.Menu.Root,{position:"bottom-start",children:[(0,Z.jsx)(a.Generic.Menu.Trigger,{children:(0,Z.jsx)(a.Generic.Toolbar.Button,{mainTooltip:s.comments.actions.more_actions,variant:"compact",children:(0,Z.jsx)(Oh,{size:16})},"more-actions")}),(0,Z.jsxs)(a.Generic.Menu.Dropdown,{className:"bn-menu-dropdown",children:[w&&(0,Z.jsx)(a.Generic.Menu.Item,{icon:(0,Z.jsx)(IV,{}),onClick:f,children:s.comments.actions.edit_comment},"edit-comment"),T&&(0,Z.jsx)(a.Generic.Menu.Item,{icon:(0,Z.jsx)(Oc,{}),onClick:b,children:s.comments.actions.delete_comment},"delete-comment")]})]})]}));let S=e.createdAt.toLocaleDateString(void 0,{month:"short",day:"numeric"});if(!e.body)throw Error("soft deletes are not yet supported");return(0,Z.jsx)(a.Comments.Comment,{authorInfo:k??"loading",timeString:S,edited:e.updatedAt.getTime()!==e.createdAt.getTime(),showActions:"hover",actions:o,className:"bn-thread-comment",emojiPickerOpen:u,children:(0,Z.jsx)(DJ,{autoFocus:c,editor:l,editable:c,actions:e.reactions.length>0||c?({isEmpty:t})=>(0,Z.jsxs)(Z.Fragment,{children:[e.reactions.length>0&&!c&&(0,Z.jsxs)(a.Generic.Badge.Group,{className:mF("bn-badge-group","bn-comment-reactions"),children:[e.reactions.map(t=>(0,Z.jsx)(D5,{comment:e,emoji:t.emoji,onReactionSelect:y},t.emoji)),C&&(0,Z.jsx)(D2,{onEmojiSelect:e=>y(e.native),onOpenChange:h,children:(0,Z.jsx)(a.Generic.Badge.Root,{className:mF("bn-badge","bn-comment-add-reaction"),text:"+",icon:(0,Z.jsx)(Op,{size:16}),mainTooltip:s.comments.actions.add_reaction})})]}),c&&(0,Z.jsxs)(a.Generic.Toolbar.Root,{variant:"action-toolbar",className:mF("bn-action-toolbar","bn-comment-actions"),children:[(0,Z.jsx)(a.Generic.Toolbar.Button,{mainTooltip:s.comments.save_button_text,variant:"compact",onClick:g,isDisabled:t,children:s.comments.save_button_text}),(0,Z.jsx)(a.Generic.Toolbar.Button,{className:"bn-button",mainTooltip:s.comments.cancel_button_text,variant:"compact",onClick:m,children:s.comments.cancel_button_text})]})]}):void 0})})},Re=({thread:e,maxCommentsBeforeCollapse:t})=>{let n=Ih(),r=If(),o=D4(e.resolvedBy?[e.resolvedBy]:[]),i=e.comments.map((t,n)=>(0,Z.jsx)(D7,{thread:e,comment:t,showResolveButton:0===n},t.id+JSON.stringify(t.body||"{}")));if(e.resolved&&e.resolvedUpdatedAt&&e.resolvedBy){if(!o.get(e.resolvedBy))throw Error(`User ${e.resolvedBy} resolved thread ${e.id}, but their data could not be found.`);let t=e.comments.findLastIndex(t=>e.resolvedUpdatedAt.getTime()>t.createdAt.getTime())+1;i.splice(t,0,(0,Z.jsx)(n.Comments.Comment,{className:"bn-thread-comment",authorInfo:e.resolvedBy&&o.get(e.resolvedBy)||"loading",timeString:e.resolvedUpdatedAt.toLocaleDateString(void 0,{month:"short",day:"numeric"}),edited:!1,showActions:!1,children:(0,Z.jsx)("div",{className:"bn-resolved-text",children:r.comments.sidebar.marked_as_resolved})},"resolved-comment"))}return t&&i.length>t&&i.splice(1,i.length-2,(0,Z.jsx)(n.Comments.ExpandSectionsPrompt,{className:"bn-thread-expand-prompt",children:r.comments.sidebar.more_replies(e.comments.length-2)},"expand-prompt")),i};function Rt(){let e=IE(bs),t=Ih(),n=If(),r=DQ({trailingBlock:!1,dictionary:{...n,placeholders:{emptyDocument:n.placeholders.new_comment}},schema:e.commentEditorSchema||D9});return(0,Z.jsx)(t.Comments.Card,{className:"bn-thread",children:(0,Z.jsx)(DJ,{autoFocus:!0,editable:!0,editor:r,actions:({isEmpty:n})=>(0,Z.jsx)(t.Generic.Toolbar.Root,{className:mF("bn-action-toolbar","bn-comment-actions"),variant:"action-toolbar",children:(0,Z.jsx)(t.Generic.Toolbar.Button,{className:"bn-button",mainTooltip:"Save",variant:"compact",isDisabled:n,onClick:async()=>{await e.createThread({initialComment:{body:r.document}}),e.stopPendingComment()},children:"Save"})})})})}let Rn=Object.freeze(Object.defineProperty({__proto__:null,default:function(e){let t=Ip(),n=IE(bs),r=Ik(bs,{editor:t,selector:e=>e.pendingComment}),o=II({editor:t,selector:({editor:e})=>r?{from:e.prosemirrorState.selection.from,to:e.prosemirrorState.selection.to}:void 0}),i=(0,X.useMemo)(()=>({useFloatingOptions:{open:!!r,onOpenChange:e=>{e||(n.stopPendingComment(),t.focus())},placement:"bottom",middleware:[(0,xA.offset)(10),(0,xA.shift)(),(0,xA.flip)()]},elementProps:{style:{zIndex:60}},...e.floatingUIOptions}),[n,t,r,e.floatingUIOptions]),s=e.floatingComposer||Rt;return(0,Z.jsx)(IO,{position:o,...i,children:(0,Z.jsx)(s,{})})}},Symbol.toStringTag,{value:"Module"})),Rr=({thread:e,selected:t,referenceText:n,maxCommentsBeforeCollapse:r,onFocus:o,onBlur:i,tabIndex:s})=>{let l=Ih(),a=If(),c=IE(bs),d=DQ({trailingBlock:!1,dictionary:{...a,placeholders:{emptyDocument:a.placeholders.comment_reply}},schema:c.commentEditorSchema||D9}),u=(0,X.useCallback)(async()=>{await c.threadStore.addComment({comment:{body:d.document},threadId:e.id}),d.removeBlocks(d.document)},[c,d,e.id]);return(0,Z.jsxs)(l.Comments.Card,{className:"bn-thread",headerText:n,onFocus:o,onBlur:i,selected:t,tabIndex:s,children:[(0,Z.jsx)(l.Comments.CardSection,{className:"bn-thread-comments",children:(0,Z.jsx)(Re,{thread:e,maxCommentsBeforeCollapse:t?void 0:r||5})}),t&&(0,Z.jsx)(l.Comments.CardSection,{className:"bn-thread-composer",children:(0,Z.jsx)(DJ,{autoFocus:!1,editable:!0,editor:d,actions:({isEmpty:e})=>e?null:(0,Z.jsx)(l.Generic.Toolbar.Root,{variant:"action-toolbar",className:mF("bn-action-toolbar","bn-comment-actions"),children:(0,Z.jsx)(l.Generic.Toolbar.Button,{mainTooltip:a.comments.save_button_text,variant:"compact",isDisabled:e,onClick:u,children:a.comments.save_button_text})})})})]})},Ro=Object.freeze(Object.defineProperty({__proto__:null,default:function(e){let t,n,r,o=Ip(),i=IE(bs),s=Ik(bs,{editor:o,selector:e=>e.selectedThreadId?{id:e.selectedThreadId,position:e.threadPositions.get(e.selectedThreadId)}:void 0}),l=(t=IE(bs).threadStore,(n=(0,X.useRef)(void 0)).current||(n.current=t.getThreads()),r=(0,X.useCallback)(e=>t.subscribe(t=>{n.current=t,e()}),[t]),(0,X.useSyncExternalStore)(r,()=>n.current)),a=(0,X.useMemo)(()=>s?l.get(s.id):void 0,[s,l]),c=(0,X.useMemo)(()=>({useFloatingOptions:{open:!!s,onOpenChange:(e,t,n)=>{"escape-key"===n&&o.focus(),e||i.selectThread(void 0)},placement:"bottom",middleware:[(0,xA.offset)(10),(0,xA.shift)(),(0,xA.flip)()]},elementProps:{style:{zIndex:30}},...e.floatingUIOptions}),[i,o,e.floatingUIOptions,s]),d=e.floatingThread||Rr;return(0,Z.jsx)(IO,{position:null==s?void 0:s.position,...c,children:a&&(0,Z.jsx)(d,{thread:a,selected:!0})})}},Symbol.toStringTag,{value:"Module"}));function Ri(e,t){let n=e.getBoundingClientRect(),r=t.getBoundingClientRect(),o=n.top<r.top,i=n.bottom>r.bottom;return o&&i?"both":o?"top":i?"bottom":"none"}function Rs(e){return"0rem"===e?"0rem":`calc(${e} * var(--mantine-scale))`}function Rl(e,{shouldScale:t=!1}={}){return function n(r){if(0===r||"0"===r)return`0${e}`;if("number"==typeof r){let n=`${r/16}${e}`;return t?Rs(n):n}if("string"==typeof r){if(""===r||r.startsWith("calc(")||r.startsWith("clamp(")||r.includes("rgba("))return r;if(r.includes(","))return r.split(",").map(e=>n(e)).join(",");if(r.includes(" "))return r.split(" ").map(e=>n(e)).join(" ");let o=r.replace("px","");if(!Number.isNaN(Number(o))){let n=`${Number(o)/16}${e}`;return t?Rs(n):n}}return r}}X.default.memo(({thread:e,selectedThreadId:t,maxCommentsBeforeCollapse:n,referenceText:r})=>{let o=IE(bs),i=(0,X.useCallback)(t=>{t.target.closest(".bn-action-toolbar")||o.selectThread(e.id)},[o,e.id]),s=(0,X.useCallback)(e=>{if(!e.relatedTarget||e.relatedTarget.closest(".bn-action-toolbar"))return;let t=e.target instanceof Node?e.target:null,n=e.relatedTarget instanceof Node?e.relatedTarget.closest(".bn-thread"):null;t&&n&&n.contains(t)||o.selectThread(void 0)},[o]);return(0,Z.jsx)(Rr,{thread:e,selected:e.id===t,referenceText:r,maxCommentsBeforeCollapse:n,onFocus:i,onBlur:s,tabIndex:0})});let Ra=Rl("rem",{shouldScale:!0}),Rc=Rl("em");function Rd(e){if("number"==typeof e)return!0;if("string"==typeof e){if(e.startsWith("calc(")||e.startsWith("var(")||e.includes(" ")&&""!==e.trim())return!0;let t=/^[+-]?[0-9]+(\.[0-9]+)?(px|em|rem|ex|ch|lh|rlh|vw|vh|vmin|vmax|vb|vi|svw|svh|lvw|lvh|dvw|dvh|cm|mm|in|pt|pc|q|cqw|cqh|cqi|cqb|cqmin|cqmax|%)?$/;return e.trim().split(/\s+/).every(e=>t.test(e))}return!1}function Ru(e,t="size",n=!0){if(void 0!==e)return Rd(e)?n?Ra(e):e:`var(--${t}-${e})`}function Rh(e){return Ru(e,"mantine-spacing")}function Rp(e){return void 0===e?"var(--mantine-radius-default)":Ru(e,"mantine-radius")}function Rf(e){return Ru(e,"mantine-font-size")}function Rm(e){if(e)return Ru(e,"mantine-shadow",!1)}var Rg=e.i(7284);function Rb(e){return Object.keys(e).reduce((t,n)=>(void 0!==e[n]&&(t[n]=e[n]),t),{})}function Ry(e){if(/^#?([0-9A-F]{3}){1,2}([0-9A-F]{2})?$/i.test(e)){let t=e.replace("#","");if(3===t.length){let e=t.split("");t=[e[0],e[0],e[1],e[1],e[2],e[2]].join("")}if(8===t.length){let e=parseInt(t.slice(6,8),16)/255;return{r:parseInt(t.slice(0,2),16),g:parseInt(t.slice(2,4),16),b:parseInt(t.slice(4,6),16),a:e}}let n=parseInt(t,16);return{r:n>>16&255,g:n>>8&255,b:255&n,a:1}}return e.startsWith("rgb")?function(e){let[t,n,r,o]=e.replace(/[^0-9,./]/g,"").split(/[/,]/).map(Number);return{r:t,g:n,b:r,a:void 0===o?1:o}}(e):e.startsWith("hsl")?function(e){let t,n,r,o=e.match(/^hsla?\(\s*(\d+)\s*,\s*(\d+%)\s*,\s*(\d+%)\s*(,\s*(0?\.\d+|\d+(\.\d+)?))?\s*\)$/i);if(!o)return{r:0,g:0,b:0,a:1};let i=parseInt(o[1],10),s=parseInt(o[2],10)/100,l=parseInt(o[3],10)/100,a=o[5]?parseFloat(o[5]):void 0,c=(1-Math.abs(2*l-1))*s,d=i/60,u=c*(1-Math.abs(d%2-1)),h=l-c/2;return d>=0&&d<1?(t=c,n=u,r=0):d>=1&&d<2?(t=u,n=c,r=0):d>=2&&d<3?(t=0,n=c,r=u):d>=3&&d<4?(t=0,n=u,r=c):d>=4&&d<5?(t=u,n=0,r=c):(t=c,n=0,r=u),{r:Math.round((t+h)*255),g:Math.round((n+h)*255),b:Math.round((r+h)*255),a:a||1}}(e):{r:0,g:0,b:0,a:1}}function Rv(e,t){if(e.startsWith("var("))return`color-mix(in srgb, ${e}, black ${100*t}%)`;let{r:n,g:r,b:o,a:i}=Ry(e),s=1-t,l=e=>Math.round(e*s);return`rgba(${l(n)}, ${l(r)}, ${l(o)}, ${i})`}function RE(e,t){return"number"==typeof e.primaryShade?e.primaryShade:"dark"===t?e.primaryShade.dark:e.primaryShade.light}function Rk(e){return e<=.03928?e/12.92:((e+.055)/1.055)**2.4}function RC(e,t=.179){return!e.startsWith("var(")&&function(e){if(e.startsWith("oklch(")){let t;return(((t=e.match(/oklch\((.*?)%\s/))?parseFloat(t[1]):null)||0)/100}let{r:t,g:n,b:r}=Ry(e);return .2126*Rk(t/255)+.7152*Rk(n/255)+.0722*Rk(r/255)}(e)>t}function RT({color:e,theme:t,colorScheme:n}){if("string"!=typeof e)throw Error(`[@mantine/core] Failed to parse color. Expected color to be a string, instead got ${typeof e}`);if("bright"===e)return{color:e,value:"dark"===n?t.white:t.black,shade:void 0,isThemeColor:!1,isLight:RC("dark"===n?t.white:t.black,t.luminanceThreshold),variable:"--mantine-color-bright"};if("dimmed"===e)return{color:e,value:"dark"===n?t.colors.dark[2]:t.colors.gray[7],shade:void 0,isThemeColor:!1,isLight:RC("dark"===n?t.colors.dark[2]:t.colors.gray[6],t.luminanceThreshold),variable:"--mantine-color-dimmed"};if("white"===e||"black"===e)return{color:e,value:"white"===e?t.white:t.black,shade:void 0,isThemeColor:!1,isLight:RC("white"===e?t.white:t.black,t.luminanceThreshold),variable:`--mantine-color-${e}`};let[r,o]=e.split("."),i=o?Number(o):void 0,s=r in t.colors;if(s){let e=void 0!==i?t.colors[r][i]:t.colors[r][RE(t,n||"light")];return{color:r,value:e,shade:i,isThemeColor:s,isLight:RC(e,t.luminanceThreshold),variable:o?`--mantine-color-${r}-${i}`:`--mantine-color-${r}-filled`}}return{color:e,value:e,isThemeColor:s,isLight:RC(e,t.luminanceThreshold),shade:i,variable:void 0}}function Rw(e,t){let n=RT({color:e||t.primaryColor,theme:t});return n.variable?`var(${n.variable})`:e}function Rx(e,t){let n={from:e?.from||t.defaultGradient.from,to:e?.to||t.defaultGradient.to,deg:e?.deg??t.defaultGradient.deg??0},r=Rw(n.from,t),o=Rw(n.to,t);return`linear-gradient(${n.deg}deg, ${r} 0%, ${o} 100%)`}function RS(e,t){if("string"!=typeof e||t>1||t<0)return"rgba(0, 0, 0, 1)";if(e.startsWith("var("))return`color-mix(in srgb, ${e}, transparent ${(1-t)*100}%)`;if(e.startsWith("oklch"))return e.includes("/")?e.replace(/\/\s*[\d.]+\s*\)/,`/ ${t})`):e.replace(")",` / ${t})`);let{r:n,g:r,b:o}=Ry(e);return`rgba(${n}, ${r}, ${o}, ${t})`}let RA="-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji",R_={scale:1,fontSmoothing:!0,focusRing:"auto",white:"#fff",black:"#000",colors:{dark:["#C9C9C9","#b8b8b8","#828282","#696969","#424242","#3b3b3b","#2e2e2e","#242424","#1f1f1f","#141414"],gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"]},primaryShade:{light:6,dark:8},primaryColor:"blue",variantColorResolver:({color:e,theme:t,variant:n,gradient:r,autoContrast:o})=>{let i=RT({color:e,theme:t}),s="boolean"==typeof o?o:t.autoContrast;if("none"===n)return{background:"transparent",hover:"transparent",color:"inherit",border:"none"};if("filled"===n){let t=s&&i.isLight?"var(--mantine-color-black)":"var(--mantine-color-white)";return i.isThemeColor?void 0===i.shade?{background:`var(--mantine-color-${e}-filled)`,hover:`var(--mantine-color-${e}-filled-hover)`,color:t,border:`${Ra(1)} solid transparent`}:{background:`var(--mantine-color-${i.color}-${i.shade})`,hover:`var(--mantine-color-${i.color}-${9===i.shade?8:i.shade+1})`,color:t,border:`${Ra(1)} solid transparent`}:{background:e,hover:Rv(e,.1),color:t,border:`${Ra(1)} solid transparent`}}if("light"===n){if(i.isThemeColor){if(void 0===i.shade)return{background:`var(--mantine-color-${e}-light)`,hover:`var(--mantine-color-${e}-light-hover)`,color:`var(--mantine-color-${e}-light-color)`,border:`${Ra(1)} solid transparent`};let n=t.colors[i.color][i.shade];return{background:RS(n,.1),hover:RS(n,.12),color:`var(--mantine-color-${i.color}-${Math.min(i.shade,6)})`,border:`${Ra(1)} solid transparent`}}return{background:RS(e,.1),hover:RS(e,.12),color:e,border:`${Ra(1)} solid transparent`}}if("outline"===n)return i.isThemeColor?void 0===i.shade?{background:"transparent",hover:`var(--mantine-color-${e}-outline-hover)`,color:`var(--mantine-color-${e}-outline)`,border:`${Ra(1)} solid var(--mantine-color-${e}-outline)`}:{background:"transparent",hover:RS(t.colors[i.color][i.shade],.05),color:`var(--mantine-color-${i.color}-${i.shade})`,border:`${Ra(1)} solid var(--mantine-color-${i.color}-${i.shade})`}:{background:"transparent",hover:RS(e,.05),color:e,border:`${Ra(1)} solid ${e}`};if("subtle"===n)return i.isThemeColor?void 0===i.shade?{background:"transparent",hover:`var(--mantine-color-${e}-light-hover)`,color:`var(--mantine-color-${e}-light-color)`,border:`${Ra(1)} solid transparent`}:{background:"transparent",hover:RS(t.colors[i.color][i.shade],.12),color:`var(--mantine-color-${i.color}-${Math.min(i.shade,6)})`,border:`${Ra(1)} solid transparent`}:{background:"transparent",hover:RS(e,.12),color:e,border:`${Ra(1)} solid transparent`};if("transparent"===n)return i.isThemeColor?void 0===i.shade?{background:"transparent",hover:"transparent",color:`var(--mantine-color-${e}-light-color)`,border:`${Ra(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:`var(--mantine-color-${i.color}-${Math.min(i.shade,6)})`,border:`${Ra(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:e,border:`${Ra(1)} solid transparent`};if("white"===n)return i.isThemeColor?void 0===i.shade?{background:"var(--mantine-color-white)",hover:Rv(t.white,.01),color:`var(--mantine-color-${e}-filled)`,border:`${Ra(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:Rv(t.white,.01),color:`var(--mantine-color-${i.color}-${i.shade})`,border:`${Ra(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:Rv(t.white,.01),color:e,border:`${Ra(1)} solid transparent`};return"gradient"===n?{background:Rx(r,t),hover:Rx(r,t),color:"var(--mantine-color-white)",border:"none"}:"default"===n?{background:"var(--mantine-color-default)",hover:"var(--mantine-color-default-hover)",color:"var(--mantine-color-default-color)",border:`${Ra(1)} solid var(--mantine-color-default-border)`}:{}},autoContrast:!1,luminanceThreshold:.3,fontFamily:RA,fontFamilyMonospace:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace",respectReducedMotion:!1,cursorType:"default",defaultGradient:{from:"blue",to:"cyan",deg:45},defaultRadius:"sm",activeClassName:"mantine-active",focusClassName:"",headings:{fontFamily:RA,fontWeight:"700",textWrap:"wrap",sizes:{h1:{fontSize:Ra(34),lineHeight:"1.3"},h2:{fontSize:Ra(26),lineHeight:"1.35"},h3:{fontSize:Ra(22),lineHeight:"1.4"},h4:{fontSize:Ra(18),lineHeight:"1.45"},h5:{fontSize:Ra(16),lineHeight:"1.5"},h6:{fontSize:Ra(14),lineHeight:"1.5"}}},fontSizes:{xs:Ra(12),sm:Ra(14),md:Ra(16),lg:Ra(18),xl:Ra(20)},lineHeights:{xs:"1.4",sm:"1.45",md:"1.55",lg:"1.6",xl:"1.65"},radius:{xs:Ra(2),sm:Ra(4),md:Ra(8),lg:Ra(16),xl:Ra(32)},spacing:{xs:Ra(10),sm:Ra(12),md:Ra(16),lg:Ra(20),xl:Ra(32)},breakpoints:{xs:"36em",sm:"48em",md:"62em",lg:"75em",xl:"88em"},shadows:{xs:`0 ${Ra(1)} ${Ra(3)} rgba(0, 0, 0, 0.05), 0 ${Ra(1)} ${Ra(2)} rgba(0, 0, 0, 0.1)`,sm:`0 ${Ra(1)} ${Ra(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${Ra(10)} ${Ra(15)} ${Ra(-5)}, rgba(0, 0, 0, 0.04) 0 ${Ra(7)} ${Ra(7)} ${Ra(-5)}`,md:`0 ${Ra(1)} ${Ra(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${Ra(20)} ${Ra(25)} ${Ra(-5)}, rgba(0, 0, 0, 0.04) 0 ${Ra(10)} ${Ra(10)} ${Ra(-5)}`,lg:`0 ${Ra(1)} ${Ra(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${Ra(28)} ${Ra(23)} ${Ra(-7)}, rgba(0, 0, 0, 0.04) 0 ${Ra(12)} ${Ra(12)} ${Ra(-7)}`,xl:`0 ${Ra(1)} ${Ra(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${Ra(36)} ${Ra(28)} ${Ra(-7)}, rgba(0, 0, 0, 0.04) 0 ${Ra(17)} ${Ra(17)} ${Ra(-7)}`},other:{},components:{}};function RN(e){return e&&"object"==typeof e&&!Array.isArray(e)}function RM(e,t){let n={...e};return RN(e)&&RN(t)&&Object.keys(t).forEach(r=>{RN(t[r])&&r in e?n[r]=RM(n[r],t[r]):n[r]=t[r]}),n}function RI(e){return!(e<0)&&!(e>9)&&parseInt(e.toString(),10)===e}function RO(e){if(!(e.primaryColor in e.colors))throw Error("[@mantine/core] MantineProvider: Invalid theme.primaryColor, it accepts only key of theme.colors, learn more  https://mantine.dev/theming/colors/#primary-color");if("object"==typeof e.primaryShade&&(!RI(e.primaryShade.dark)||!RI(e.primaryShade.light))||"number"==typeof e.primaryShade&&!RI(e.primaryShade))throw Error("[@mantine/core] MantineProvider: Invalid theme.primaryShade, it accepts only 0-9 integers or an object { light: 0-9, dark: 0-9 }")}let RD=(0,X.createContext)(null);function RR(){let e=(0,X.useContext)(RD);if(!e)throw Error("@mantine/core: MantineProvider was not found in component tree, make sure you have it in your app");return e}function RL({theme:e,children:t,inherit:n=!0}){let r=(0,X.useContext)(RD)||R_,o=(0,X.useMemo)(()=>(function(e,t){if(!t)return RO(e),e;let n=RM(e,t);return t.fontFamily&&!t.headings?.fontFamily&&(n.headings.fontFamily=t.fontFamily),RO(n),n})(n?r:R_,e),[e,r,n]);return(0,Z.jsx)(RD.Provider,{value:o,children:t})}function RP(e,t,n){let r=RR(),o=r.components[e]?.defaultProps,i="function"==typeof o?o(r):o;return{...t,...i,...Rb(n)}}RL.displayName="@mantine/core/MantineThemeProvider";let RB=(0,X.createContext)(null);function RH(){let e=(0,X.useContext)(RB);if(!e)throw Error("[@mantine/core] MantineProvider was not found in tree");return e}function Rj(){return RH().getStyleNonce}function RF(){return RH().env||"default"}let RU={always:"mantine-focus-always",auto:"mantine-focus-auto",never:"mantine-focus-never"},Rz={};function RV({theme:e,classNames:t,props:n,stylesCtx:r}){let o;return o={},(Array.isArray(t)?t:[t]).map(t=>"function"==typeof t?t(e,n,r):t||Rz).forEach(e=>{Object.entries(e).forEach(([e,t])=>{o[e]?o[e]=(0,Rg.default)(o[e],t):o[e]=t})}),o}function R$({selector:e,stylesCtx:t,theme:n,classNames:r,props:o}){return RV({theme:n,classNames:r,props:o,stylesCtx:t})[e]}function RG({theme:e,styles:t,props:n,stylesCtx:r}){return(Array.isArray(t)?t:[t]).reduce((t,o)=>"function"==typeof o?{...t,...o(e,n,r)}:{...t,...o},{})}function Rq({style:e,theme:t}){return Array.isArray(e)?[...e].reduce((e,n)=>({...e,...Rq({style:n,theme:t})}),{}):"function"==typeof e?e(t):null==e?{}:e}function RW({name:e,classes:t,props:n,stylesCtx:r,className:o,style:i,rootSelector:s="root",unstyled:l,classNames:a,styles:c,vars:d,varsResolver:u,attributes:h}){let p=RR(),f=RH().classNamesPrefix,m=RH().withStaticClasses,g=RH().headless,b=(Array.isArray(e)?e:[e]).filter(e=>e),{withStylesTransform:y,getTransformedStyles:v}=function({props:e,stylesCtx:t,themeName:n}){let r=RR(),o=RH().stylesTransform?.styles?.();return{getTransformedStyles:i=>o?[...i.map(n=>o(n,{props:e,theme:r,ctx:t})),...n.map(n=>o(r.components[n]?.styles,{props:e,theme:r,ctx:t}))].filter(Boolean):[],withStylesTransform:!!o}}({props:n,stylesCtx:r,themeName:b});return(e,E)=>({className:function({theme:e,options:t,themeName:n,selector:r,classNamesPrefix:o,classNames:i,classes:s,unstyled:l,className:a,rootSelector:c,props:d,stylesCtx:u,withStaticClasses:h,headless:p,transformedStyles:f}){return(0,Rg.default)(function({theme:e,options:t,unstyled:n}){return(0,Rg.default)(t?.focusable&&!n&&(e.focusClassName||RU[e.focusRing]),t?.active&&!n&&e.activeClassName)}({theme:e,options:t,unstyled:l||p}),function({themeName:e,theme:t,selector:n,props:r,stylesCtx:o}){return e.map(e=>RV({theme:t,classNames:t.components[e]?.classNames,props:r,stylesCtx:o})?.[n])}({theme:e,themeName:n,selector:r,props:d,stylesCtx:u}),function({options:e,classes:t,selector:n,unstyled:r}){return e?.variant&&!r?t[`${n}--${e.variant}`]:void 0}({options:t,classes:s,selector:r,unstyled:l}),R$({selector:r,stylesCtx:u,theme:e,classNames:i,props:d}),R$({selector:r,stylesCtx:u,theme:e,classNames:f,props:d}),function({selector:e,stylesCtx:t,options:n,props:r,theme:o}){return RV({theme:o,classNames:n?.classNames,props:n?.props||r,stylesCtx:t})[e]}({selector:r,stylesCtx:u,options:t,props:d,theme:e}),function({rootSelector:e,selector:t,className:n}){return e===t?n:void 0}({rootSelector:c,selector:r,className:a}),function({selector:e,classes:t,unstyled:n}){return n?void 0:t[e]}({selector:r,classes:s,unstyled:l||p}),h&&!p&&function({themeName:e,classNamesPrefix:t,selector:n,withStaticClass:r}){return!1===r?[]:e.map(e=>`${t}-${e}-${n}`)}({themeName:n,classNamesPrefix:o,selector:r,withStaticClass:t?.withStaticClass}),t?.className)}({theme:p,options:E,themeName:b,selector:e,classNamesPrefix:f,classNames:a,classes:t,unstyled:l,className:o,rootSelector:s,props:n,stylesCtx:r,withStaticClasses:m,headless:g,transformedStyles:v([E?.styles,c])}),style:function({theme:e,themeName:t,selector:n,options:r,props:o,stylesCtx:i,rootSelector:s,styles:l,style:a,vars:c,varsResolver:d,headless:u,withStylesTransform:h}){return{...!h&&function({theme:e,themeName:t,props:n,stylesCtx:r,selector:o}){return t.map(t=>RG({theme:e,styles:e.components[t]?.styles,props:n,stylesCtx:r})[o]).reduce((e,t)=>({...e,...t}),{})}({theme:e,themeName:t,props:o,stylesCtx:i,selector:n}),...!h&&RG({theme:e,styles:l,props:o,stylesCtx:i})[n],...!h&&RG({theme:e,styles:r?.styles,props:r?.props||o,stylesCtx:i})[n],...function({vars:e,varsResolver:t,theme:n,props:r,stylesCtx:o,selector:i,themeName:s,headless:l}){return[l?{}:t?.(n,r,o),...s.map(e=>n.components?.[e]?.vars?.(n,r,o)),e?.(n,r,o)].reduce((e,t)=>(t&&Object.keys(t).forEach(n=>{e[n]={...e[n],...Rb(t[n])}}),e),{})?.[i]}({theme:e,props:o,stylesCtx:i,vars:c,varsResolver:d,selector:n,themeName:t,headless:u}),...s===n?Rq({style:a,theme:e}):null,...Rq({style:r?.style,theme:e})}}({theme:p,themeName:b,selector:e,options:E,props:n,stylesCtx:r,rootSelector:s,styles:c,style:i,vars:d,varsResolver:u,headless:g,withStylesTransform:y}),...h?.[e]})}function RY(e){return Object.keys(e)}function RK(e){return RY(e).reduce((t,n)=>void 0!==e[n]?`${t}${n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}:${e[n]};`:t,"").trim()}function RZ(e){let t=Rj();return(0,Z.jsx)("style",{"data-mantine-styles":"inline",nonce:t?.(),dangerouslySetInnerHTML:{__html:function({selector:e,styles:t,media:n,container:r}){let o=t?RK(t):"",i=Array.isArray(n)?n.map(t=>`@media${t.query}{${e}{${RK(t.styles)}}}`):[],s=Array.isArray(r)?r.map(t=>`@container ${t.query}{${e}{${RK(t.styles)}}}`):[];return`${o?`${e}{${o}}`:""}${i.join("")}${s.join("")}`.trim()}(e)}})}function RX(e){return e.startsWith("data-")?e:`data-${e}`}function RQ(e,t){return Array.isArray(e)?[...e].reduce((e,n)=>({...e,...RQ(n,t)}),{}):"function"==typeof e?e(t):null==e?{}:e}function RJ(e){let{m:t,mx:n,my:r,mt:o,mb:i,ml:s,mr:l,me:a,ms:c,p:d,px:u,py:h,pt:p,pb:f,pl:m,pr:g,pe:b,ps:y,bd:v,bdrs:E,bg:k,c:C,opacity:T,ff:w,fz:x,fw:S,lts:A,ta:_,lh:N,fs:M,tt:I,td:O,w:D,miw:R,maw:L,h:P,mih:B,mah:H,bgsz:j,bgp:F,bgr:U,bga:z,pos:V,top:$,left:G,bottom:q,right:W,inset:Y,display:K,flex:Z,hiddenFrom:X,visibleFrom:Q,lightHidden:J,darkHidden:ee,sx:et,...en}=e;return{styleProps:Rb({m:t,mx:n,my:r,mt:o,mb:i,ml:s,mr:l,me:a,ms:c,p:d,px:u,py:h,pt:p,pb:f,pl:m,pr:g,pe:b,ps:y,bd:v,bg:k,c:C,opacity:T,ff:w,fz:x,fw:S,lts:A,ta:_,lh:N,fs:M,tt:I,td:O,w:D,miw:R,maw:L,h:P,mih:B,mah:H,bgsz:j,bgp:F,bgr:U,bga:z,pos:V,top:$,left:G,bottom:q,right:W,inset:Y,display:K,flex:Z,bdrs:E,hiddenFrom:X,visibleFrom:Q,lightHidden:J,darkHidden:ee,sx:et}),rest:en}}let R0={m:{type:"spacing",property:"margin"},mt:{type:"spacing",property:"marginTop"},mb:{type:"spacing",property:"marginBottom"},ml:{type:"spacing",property:"marginLeft"},mr:{type:"spacing",property:"marginRight"},ms:{type:"spacing",property:"marginInlineStart"},me:{type:"spacing",property:"marginInlineEnd"},mx:{type:"spacing",property:"marginInline"},my:{type:"spacing",property:"marginBlock"},p:{type:"spacing",property:"padding"},pt:{type:"spacing",property:"paddingTop"},pb:{type:"spacing",property:"paddingBottom"},pl:{type:"spacing",property:"paddingLeft"},pr:{type:"spacing",property:"paddingRight"},ps:{type:"spacing",property:"paddingInlineStart"},pe:{type:"spacing",property:"paddingInlineEnd"},px:{type:"spacing",property:"paddingInline"},py:{type:"spacing",property:"paddingBlock"},bd:{type:"border",property:"border"},bdrs:{type:"radius",property:"borderRadius"},bg:{type:"color",property:"background"},c:{type:"textColor",property:"color"},opacity:{type:"identity",property:"opacity"},ff:{type:"fontFamily",property:"fontFamily"},fz:{type:"fontSize",property:"fontSize"},fw:{type:"identity",property:"fontWeight"},lts:{type:"size",property:"letterSpacing"},ta:{type:"identity",property:"textAlign"},lh:{type:"lineHeight",property:"lineHeight"},fs:{type:"identity",property:"fontStyle"},tt:{type:"identity",property:"textTransform"},td:{type:"identity",property:"textDecoration"},w:{type:"spacing",property:"width"},miw:{type:"spacing",property:"minWidth"},maw:{type:"spacing",property:"maxWidth"},h:{type:"spacing",property:"height"},mih:{type:"spacing",property:"minHeight"},mah:{type:"spacing",property:"maxHeight"},bgsz:{type:"size",property:"backgroundSize"},bgp:{type:"identity",property:"backgroundPosition"},bgr:{type:"identity",property:"backgroundRepeat"},bga:{type:"identity",property:"backgroundAttachment"},pos:{type:"identity",property:"position"},top:{type:"size",property:"top"},left:{type:"size",property:"left"},bottom:{type:"size",property:"bottom"},right:{type:"size",property:"right"},inset:{type:"size",property:"inset"},display:{type:"identity",property:"display"},flex:{type:"identity",property:"flex"}};function R1(e,t){let n=RT({color:e,theme:t});return"dimmed"===n.color?"var(--mantine-color-dimmed)":"bright"===n.color?"var(--mantine-color-bright)":n.variable?`var(${n.variable})`:n.color}let R2={text:"var(--mantine-font-family)",mono:"var(--mantine-font-family-monospace)",monospace:"var(--mantine-font-family-monospace)",heading:"var(--mantine-font-family-headings)",headings:"var(--mantine-font-family-headings)"},R4=["h1","h2","h3","h4","h5","h6"],R5=["h1","h2","h3","h4","h5","h6"],R3={color:R1,textColor:function(e,t){let n=RT({color:e,theme:t});return n.isThemeColor&&void 0===n.shade?`var(--mantine-color-${n.color}-text)`:R1(e,t)},fontSize:function(e,t){return"string"==typeof e&&e in t.fontSizes?`var(--mantine-font-size-${e})`:"string"==typeof e&&R4.includes(e)?`var(--mantine-${e}-font-size)`:"number"==typeof e||"string"==typeof e?Ra(e):e},spacing:function(e,t){if("number"==typeof e)return Ra(e);if("string"==typeof e){let n=e.replace("-","");if(!(n in t.spacing))return Ra(e);let r=`--mantine-spacing-${n}`;return e.startsWith("-")?`calc(var(${r}) * -1)`:`var(${r})`}return e},radius:function(e,t){return"string"==typeof e&&e in t.radius?`var(--mantine-radius-${e})`:"number"==typeof e||"string"==typeof e?Ra(e):e},identity:function(e){return e},size:function(e){return"number"==typeof e?Ra(e):e},lineHeight:function(e,t){return"string"==typeof e&&e in t.lineHeights?`var(--mantine-line-height-${e})`:"string"==typeof e&&R5.includes(e)?`var(--mantine-${e}-line-height)`:e},fontFamily:function(e){return"string"==typeof e&&e in R2?R2[e]:e},border:function(e,t){if("number"==typeof e)return Ra(e);if("string"==typeof e){let[n,r,...o]=e.split(" ").filter(e=>""!==e.trim()),i=`${Ra(n)}`;return r&&(i+=` ${r}`),o.length>0&&(i+=` ${R1(o.join(" "),t)}`),i.trim()}return e}};function R8(e){return e.replace("(min-width: ","").replace("em)","")}function R6({styleProps:e,data:t,theme:n}){return function({media:e,...t}){let n=Object.keys(e).sort((e,t)=>Number(R8(e))-Number(R8(t))).map(t=>({query:t,styles:e[t]}));return{...t,media:n}}(RY(e).reduce((r,o)=>{var i,s;if("hiddenFrom"===o||"visibleFrom"===o||"sx"===o)return r;let l=t[o],a=Array.isArray(l.property)?l.property:[l.property],c="object"==typeof(s=e[o])&&null!==s?"base"in s?s.base:void 0:s;if(!function(e){if("object"!=typeof e||null===e)return!1;let t=Object.keys(e);return 1!==t.length||"base"!==t[0]}(e[o]))return a.forEach(e=>{r.inlineStyles[e]=R3[l.type](c,n)}),r;r.hasResponsiveStyles=!0;let d="object"==typeof(i=e[o])&&null!==i?RY(i).filter(e=>"base"!==e):[];return a.forEach(t=>{null!=c&&(r.styles[t]=R3[l.type](c,n)),d.forEach(i=>{var s;let a=`(min-width: ${n.breakpoints[i]})`;r.media[a]={...r.media[a],[t]:R3[l.type]((s=e[o],"object"==typeof s&&null!==s&&i in s?s[i]:s),n)}})}),r},{hasResponsiveStyles:!1,styles:{},inlineStyles:{},media:{}}))}function R9(){let e=(0,X.useId)().replace(/[:]/g,"");return`__m__-${e}`}let R7=(0,X.forwardRef)(({component:e,style:t,__vars:n,className:r,variant:o,mod:i,size:s,hiddenFrom:l,visibleFrom:a,lightHidden:c,darkHidden:d,renderRoot:u,__size:h,...p},f)=>{let m=RR(),{styleProps:g,rest:b}=RJ(p),y=RH().stylesTransform?.sx,v=y?.()?.(g.sx),E=R9(),k=R6({styleProps:g,theme:m,data:R0}),C={ref:f,style:function({theme:e,style:t,vars:n,styleProps:r}){let o=RQ(t,e),i=RQ(n,e);return{...o,...i,...r}}({theme:m,style:t,vars:n,styleProps:k.inlineStyles}),className:(0,Rg.default)(r,v,{[E]:k.hasResponsiveStyles,"mantine-light-hidden":c,"mantine-dark-hidden":d,[`mantine-hidden-from-${l}`]:l,[`mantine-visible-from-${a}`]:a}),"data-variant":o,"data-size":Rd(s)?void 0:s||void 0,size:h,...function e(t){return t?"string"==typeof t?{[RX(t)]:!0}:Array.isArray(t)?[...t].reduce((t,n)=>({...t,...e(n)}),{}):Object.keys(t).reduce((e,n)=>{let r=t[n];return void 0===r||""===r||!1===r||null===r||(e[RX(n)]=t[n]),e},{}):null}(i),...b};return(0,Z.jsxs)(Z.Fragment,{children:[k.hasResponsiveStyles&&(0,Z.jsx)(RZ,{selector:`.${E}`,styles:k.styles,media:k.media}),"function"==typeof u?u(C):(0,Z.jsx)(e||"div",{...C})]})});function Le(e){return e}function Lt(e){let t=(0,X.forwardRef)(e);return t.extend=Le,t.withProps=e=>{let n=(0,X.forwardRef)((n,r)=>(0,Z.jsx)(t,{...e,...n,ref:r}));return n.extend=t.extend,n.displayName=`WithProps(${t.displayName})`,n},t}function Ln(e){let t=(0,X.forwardRef)(e);return t.withProps=e=>{let n=(0,X.forwardRef)((n,r)=>(0,Z.jsx)(t,{...e,...n,ref:r}));return n.extend=t.extend,n.displayName=`WithProps(${t.displayName})`,n},t.extend=Le,t}R7.displayName="@mantine/core/Box";var Lr={root:"m_5ae2e3c",barsLoader:"m_7a2bd4cd",bar:"m_870bb79","bars-loader-animation":"m_5d2b3b9d",dotsLoader:"m_4e3f22d7",dot:"m_870c4af","loader-dots-animation":"m_aac34a1",ovalLoader:"m_b34414df","oval-loader-animation":"m_f8e89c4b"};let Lo=(0,X.forwardRef)(({className:e,...t},n)=>(0,Z.jsxs)(R7,{component:"span",className:(0,Rg.default)(Lr.barsLoader,e),...t,ref:n,children:[(0,Z.jsx)("span",{className:Lr.bar}),(0,Z.jsx)("span",{className:Lr.bar}),(0,Z.jsx)("span",{className:Lr.bar})]}));Lo.displayName="@mantine/core/Bars";let Li=(0,X.forwardRef)(({className:e,...t},n)=>(0,Z.jsxs)(R7,{component:"span",className:(0,Rg.default)(Lr.dotsLoader,e),...t,ref:n,children:[(0,Z.jsx)("span",{className:Lr.dot}),(0,Z.jsx)("span",{className:Lr.dot}),(0,Z.jsx)("span",{className:Lr.dot})]}));Li.displayName="@mantine/core/Dots";let Ls=(0,X.forwardRef)(({className:e,...t},n)=>(0,Z.jsx)(R7,{component:"span",className:(0,Rg.default)(Lr.ovalLoader,e),...t,ref:n}));Ls.displayName="@mantine/core/Oval";let Ll={bars:Lo,oval:Ls,dots:Li},La={loaders:Ll,type:"oval"},Lc=(e,{size:t,color:n})=>({root:{"--loader-size":Ru(t,"loader-size"),"--loader-color":n?Rw(n,e):void 0}}),Ld=Lt((e,t)=>{let n=RP("Loader",La,e),{size:r,color:o,type:i,vars:s,className:l,style:a,classNames:c,styles:d,unstyled:u,loaders:h,variant:p,children:f,attributes:m,...g}=n,b=RW({name:"Loader",props:n,classes:Lr,className:l,style:a,classNames:c,styles:d,unstyled:u,attributes:m,vars:s,varsResolver:Lc});return f?(0,Z.jsx)(R7,{...b("root"),ref:t,...g,children:f}):(0,Z.jsx)(R7,{...b("root"),ref:t,component:h[i],variant:p,size:r,...g})});Ld.defaultLoaders=Ll,Ld.classes=Lr,Ld.displayName="@mantine/core/Loader";let Lu=e=>({in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:`scale(.9) translateY(${"bottom"===e?10:-10}px)`},transitionProperty:"transform, opacity"}),Lh={fade:{in:{opacity:1},out:{opacity:0},transitionProperty:"opacity"},"fade-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(30px)"},transitionProperty:"opacity, transform"},"fade-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-30px)"},transitionProperty:"opacity, transform"},"fade-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(30px)"},transitionProperty:"opacity, transform"},"fade-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-30px)"},transitionProperty:"opacity, transform"},scale:{in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:"scale(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-y":{in:{opacity:1,transform:"scaleY(1)"},out:{opacity:0,transform:"scaleY(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-x":{in:{opacity:1,transform:"scaleX(1)"},out:{opacity:0,transform:"scaleX(0)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"skew-up":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:"translateY(-20px) skew(-10deg, -5deg)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"skew-down":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:"translateY(20px) skew(-10deg, -5deg)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-left":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:"translateY(20px) rotate(-5deg)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-right":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:"translateY(20px) rotate(5deg)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-100%)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(100%)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"slide-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(100%)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"slide-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-100%)"},common:{transformOrigin:"right"},transitionProperty:"transform, opacity"},pop:{...Lu("bottom"),common:{transformOrigin:"center center"}},"pop-bottom-left":{...Lu("bottom"),common:{transformOrigin:"bottom left"}},"pop-bottom-right":{...Lu("bottom"),common:{transformOrigin:"bottom right"}},"pop-top-left":{...Lu("top"),common:{transformOrigin:"top left"}},"pop-top-right":{...Lu("top"),common:{transformOrigin:"top right"}}},Lp={entering:"in",entered:"in",exiting:"out",exited:"out","pre-exiting":"out","pre-entering":"out"};function Lf(e,t){let n=(0,X.useRef)(!1);(0,X.useEffect)(()=>()=>{n.current=!1},[]),(0,X.useEffect)(()=>{if(n.current)return e();n.current=!0},t)}function Lm({keepMounted:e,transition:t="fade",duration:n=250,exitDuration:r=n,mounted:o,children:i,timingFunction:s="ease",onExit:l,onEntered:a,onEnter:c,onExited:d,enterDelay:u,exitDelay:h}){let p=RF(),{transitionDuration:f,transitionStatus:m,transitionTimingFunction:g}=function({duration:e,exitDuration:t,timingFunction:n,mounted:r,onEnter:o,onExit:i,onEntered:s,onExited:l,enterDelay:a,exitDelay:c}){let d=RR(),u=function(e,t,{getInitialValueInEffect:n}={getInitialValueInEffect:!0}){let[r,o]=(0,X.useState)(n?t:!!("undefined"!=typeof window&&"matchMedia"in window)&&window.matchMedia(e).matches);return(0,X.useEffect)(()=>{try{let n=window.matchMedia(e);o(n.matches);var t=e=>o(e.matches);try{return n.addEventListener("change",t),()=>n.removeEventListener("change",t)}catch(e){return n.addListener(t),()=>n.removeListener(t)}}catch(e){return}},[e]),r||!1}("(prefers-reduced-motion: reduce)",void 0,void 0),h=!!d.respectReducedMotion&&u,[p,f]=(0,X.useState)(h?0:e),[m,g]=(0,X.useState)(r?"entered":"exited"),b=(0,X.useRef)(-1),y=(0,X.useRef)(-1),v=(0,X.useRef)(-1);function E(){window.clearTimeout(b.current),window.clearTimeout(y.current),cancelAnimationFrame(v.current)}let k=n=>{E();let r=n?o:i,a=n?s:l,c=h?0:n?e:t;f(c),0===c?("function"==typeof r&&r(),"function"==typeof a&&a(),g(n?"entered":"exited")):v.current=requestAnimationFrame(()=>{xS.default.flushSync(()=>{g(n?"pre-entering":"pre-exiting")}),v.current=requestAnimationFrame(()=>{"function"==typeof r&&r(),g(n?"entering":"exiting"),b.current=window.setTimeout(()=>{"function"==typeof a&&a(),g(n?"entered":"exited")},c)})})};return Lf(()=>{(E(),"number"!=typeof(r?a:c))?k(r):y.current=window.setTimeout(()=>{k(r)},r?a:c)},[r]),(0,X.useEffect)(()=>()=>{E()},[]),{transitionDuration:p,transitionStatus:m,transitionTimingFunction:n||"ease"}}({mounted:o,exitDuration:r,duration:n,timingFunction:s,onExit:l,onEntered:a,onEnter:c,onExited:d,enterDelay:u,exitDelay:h});return 0===f||"test"===p?o?(0,Z.jsx)(Z.Fragment,{children:i({})}):e?i({display:"none"}):null:"exited"===m?e?i({display:"none"}):null:(0,Z.jsx)(Z.Fragment,{children:i(function({transition:e,state:t,duration:n,timingFunction:r}){let o={WebkitBackfaceVisibility:"hidden",transitionDuration:`${n}ms`,transitionTimingFunction:r};return"string"==typeof e?e in Lh?{transitionProperty:Lh[e].transitionProperty,...o,...Lh[e].common,...Lh[e][Lp[t]]}:{}:{transitionProperty:e.transitionProperty,...o,...e.common,...e[Lp[t]]}}({transition:t,duration:f,state:m,timingFunction:g}))})}Lm.displayName="@mantine/core/Transition";var Lg={root:"m_87cf2631"};let Lb={__staticSelector:"UnstyledButton"},Ly=Ln((e,t)=>{let n=RP("UnstyledButton",Lb,e),{className:r,component:o="button",__staticSelector:i,unstyled:s,classNames:l,styles:a,style:c,attributes:d,...u}=n,h=RW({name:i,props:n,classes:Lg,className:r,style:c,classNames:l,styles:a,unstyled:s,attributes:d});return(0,Z.jsx)(R7,{...h("root",{focusable:!0}),component:o,ref:t,type:"button"===o?"button":void 0,...u})});Ly.classes=Lg,Ly.displayName="@mantine/core/UnstyledButton";var Lv={root:"m_77c9d27d",inner:"m_80f1301b",label:"m_811560b9",section:"m_a74036a",loader:"m_a25b86ee",group:"m_80d6d844",groupSection:"m_70be2a01"};let LE={orientation:"horizontal"},Lk=(e,{borderWidth:t})=>({group:{"--button-border-width":Ra(t)}}),LC=Lt((e,t)=>{let n=RP("ButtonGroup",LE,e),{className:r,style:o,classNames:i,styles:s,unstyled:l,orientation:a,vars:c,borderWidth:d,variant:u,mod:h,attributes:p,...f}=RP("ButtonGroup",LE,e),m=RW({name:"ButtonGroup",props:n,classes:Lv,className:r,style:o,classNames:i,styles:s,unstyled:l,attributes:p,vars:c,varsResolver:Lk,rootSelector:"group"});return(0,Z.jsx)(R7,{...m("group"),ref:t,variant:u,mod:[{"data-orientation":a},h],role:"group",...f})});LC.classes=Lv,LC.displayName="@mantine/core/ButtonGroup";let LT=(e,{radius:t,color:n,gradient:r,variant:o,autoContrast:i,size:s})=>{let l=e.variantColorResolver({color:n||e.primaryColor,theme:e,gradient:r,variant:o||"filled",autoContrast:i});return{groupSection:{"--section-height":Ru(s,"section-height"),"--section-padding-x":Ru(s,"section-padding-x"),"--section-fz":s?.includes("compact")?Rf(s.replace("compact-","")):Rf(s),"--section-radius":void 0===t?void 0:Rp(t),"--section-bg":n||o?l.background:void 0,"--section-color":l.color,"--section-bd":n||o?l.border:void 0}}},Lw=Lt((e,t)=>{let n=RP("ButtonGroupSection",null,e),{className:r,style:o,classNames:i,styles:s,unstyled:l,vars:a,variant:c,gradient:d,radius:u,autoContrast:h,attributes:p,...f}=n,m=RW({name:"ButtonGroupSection",props:n,classes:Lv,className:r,style:o,classNames:i,styles:s,unstyled:l,attributes:p,vars:a,varsResolver:LT,rootSelector:"groupSection"});return(0,Z.jsx)(R7,{...m("groupSection"),ref:t,variant:c,...f})});Lw.classes=Lv,Lw.displayName="@mantine/core/ButtonGroupSection";let Lx={in:{opacity:1,transform:`translate(-50%, calc(-50% + ${Ra(1)}))`},out:{opacity:0,transform:"translate(-50%, -200%)"},common:{transformOrigin:"center"},transitionProperty:"transform, opacity"},LS=(e,{radius:t,color:n,gradient:r,variant:o,size:i,justify:s,autoContrast:l})=>{let a=e.variantColorResolver({color:n||e.primaryColor,theme:e,gradient:r,variant:o||"filled",autoContrast:l});return{root:{"--button-justify":s,"--button-height":Ru(i,"button-height"),"--button-padding-x":Ru(i,"button-padding-x"),"--button-fz":i?.includes("compact")?Rf(i.replace("compact-","")):Rf(i),"--button-radius":void 0===t?void 0:Rp(t),"--button-bg":n||o?a.background:void 0,"--button-hover":n||o?a.hover:void 0,"--button-color":a.color,"--button-bd":n||o?a.border:void 0,"--button-hover-color":n||o?a.hoverColor:void 0}}},LA=Ln((e,t)=>{let n=RP("Button",null,e),{style:r,vars:o,className:i,color:s,disabled:l,children:a,leftSection:c,rightSection:d,fullWidth:u,variant:h,radius:p,loading:f,loaderProps:m,gradient:g,classNames:b,styles:y,unstyled:v,"data-disabled":E,autoContrast:k,mod:C,attributes:T,...w}=n,x=RW({name:"Button",props:n,classes:Lv,className:i,style:r,classNames:b,styles:y,unstyled:v,attributes:T,vars:o,varsResolver:LS}),S=!!c,A=!!d;return(0,Z.jsxs)(Ly,{ref:t,...x("root",{active:!l&&!f&&!E}),unstyled:v,variant:h,disabled:l||f,mod:[{disabled:l||E,loading:f,block:u,"with-left-section":S,"with-right-section":A},C],...w,children:["boolean"==typeof f&&(0,Z.jsx)(Lm,{mounted:f,transition:Lx,duration:150,children:e=>(0,Z.jsx)(R7,{component:"span",...x("loader",{style:e}),"aria-hidden":!0,children:(0,Z.jsx)(Ld,{color:"var(--button-color)",size:"calc(var(--button-height) / 1.8)",...m})})}),(0,Z.jsxs)("span",{...x("inner"),children:[c&&(0,Z.jsx)(R7,{component:"span",...x("section"),mod:{position:"left"},children:c}),(0,Z.jsx)(R7,{component:"span",mod:{loading:f},...x("label"),children:a}),d&&(0,Z.jsx)(R7,{component:"span",...x("section"),mod:{position:"right"},children:d})]})]})});LA.classes=Lv,LA.displayName="@mantine/core/Button",LA.Group=LC,LA.GroupSection=Lw;var L_={root:"m_8d3f4000",icon:"m_8d3afb97",loader:"m_302b9fb1",group:"m_1a0f1b21",groupSection:"m_437b6484"};let LN={orientation:"horizontal"},LM=(e,{borderWidth:t})=>({group:{"--ai-border-width":Ra(t)}}),LI=Lt((e,t)=>{let n=RP("ActionIconGroup",LN,e),{className:r,style:o,classNames:i,styles:s,unstyled:l,orientation:a,vars:c,borderWidth:d,variant:u,mod:h,attributes:p,...f}=RP("ActionIconGroup",LN,e),m=RW({name:"ActionIconGroup",props:n,classes:L_,className:r,style:o,classNames:i,styles:s,unstyled:l,attributes:p,vars:c,varsResolver:LM,rootSelector:"group"});return(0,Z.jsx)(R7,{...m("group"),ref:t,variant:u,mod:[{"data-orientation":a},h],role:"group",...f})});LI.classes=L_,LI.displayName="@mantine/core/ActionIconGroup";let LO=(e,{radius:t,color:n,gradient:r,variant:o,autoContrast:i,size:s})=>{let l=e.variantColorResolver({color:n||e.primaryColor,theme:e,gradient:r,variant:o||"filled",autoContrast:i});return{groupSection:{"--section-height":Ru(s,"section-height"),"--section-padding-x":Ru(s,"section-padding-x"),"--section-fz":Rf(s),"--section-radius":void 0===t?void 0:Rp(t),"--section-bg":n||o?l.background:void 0,"--section-color":l.color,"--section-bd":n||o?l.border:void 0}}},LD=Lt((e,t)=>{let n=RP("ActionIconGroupSection",null,e),{className:r,style:o,classNames:i,styles:s,unstyled:l,vars:a,variant:c,gradient:d,radius:u,autoContrast:h,attributes:p,...f}=n,m=RW({name:"ActionIconGroupSection",props:n,classes:L_,className:r,style:o,classNames:i,styles:s,unstyled:l,attributes:p,vars:a,varsResolver:LO,rootSelector:"groupSection"});return(0,Z.jsx)(R7,{...m("groupSection"),ref:t,variant:c,...f})});LD.classes=L_,LD.displayName="@mantine/core/ActionIconGroupSection";let LR=(e,{size:t,radius:n,variant:r,gradient:o,color:i,autoContrast:s})=>{let l=e.variantColorResolver({color:i||e.primaryColor,theme:e,gradient:o,variant:r||"filled",autoContrast:s});return{root:{"--ai-size":Ru(t,"ai-size"),"--ai-radius":void 0===n?void 0:Rp(n),"--ai-bg":i||r?l.background:void 0,"--ai-hover":i||r?l.hover:void 0,"--ai-hover-color":i||r?l.hoverColor:void 0,"--ai-color":l.color,"--ai-bd":i||r?l.border:void 0}}},LL=Ln((e,t)=>{let n=RP("ActionIcon",null,e),{className:r,unstyled:o,variant:i,classNames:s,styles:l,style:a,loading:c,loaderProps:d,size:u,color:h,radius:p,__staticSelector:f,gradient:m,vars:g,children:b,disabled:y,"data-disabled":v,autoContrast:E,mod:k,attributes:C,...T}=n,w=RW({name:["ActionIcon",f],props:n,className:r,style:a,classes:L_,classNames:s,styles:l,unstyled:o,attributes:C,vars:g,varsResolver:LR});return(0,Z.jsxs)(Ly,{...w("root",{active:!y&&!c&&!v}),...T,unstyled:o,variant:i,size:u,disabled:y||c,ref:t,mod:[{loading:c,disabled:y||v},k],children:["boolean"==typeof c&&(0,Z.jsx)(Lm,{mounted:c,transition:"slide-down",duration:150,children:e=>(0,Z.jsx)(R7,{component:"span",...w("loader",{style:e}),"aria-hidden":!0,children:(0,Z.jsx)(Ld,{color:"var(--ai-color)",size:"calc(var(--ai-size) * 0.55)",...d})})}),(0,Z.jsx)(R7,{component:"span",mod:{loading:c},...w("icon"),children:b})]})});function LP(e,t){if("function"==typeof e)return e(t);"object"==typeof e&&null!==e&&"current"in e&&(e.current=t)}function LB(...e){let t=new Map;return n=>{if(e.forEach(e=>{let r=LP(e,n);r&&t.set(e,r)}),t.size>0)return()=>{e.forEach(e=>{let n=t.get(e);n&&"function"==typeof n?n():LP(e,null)}),t.clear()}}}function LH(...e){return(0,X.useCallback)(LB(...e),e)}LL.classes=L_,LL.displayName="@mantine/core/ActionIcon",LL.Group=LI,LL.GroupSection=LD;let Lj={app:100,modal:200,popover:300,overlay:400,max:9999};function LF(e){let t=X.default.version;return"string"!=typeof X.default.version||t.startsWith("18.")?e?.ref:e?.props?.ref}function LU(e){return!Array.isArray(e)&&null!==e&&"object"==typeof e&&e.type!==X.Fragment}function Lz(e){let t=X.Children.toArray(e);return 1===t.length&&LU(t[0])?t[0]:null}let LV="undefined"!=typeof document?X.useLayoutEffect:X.useEffect,L$=(0,X.createContext)({dir:"ltr",toggleDirection:()=>{},setDirection:()=>{}});function LG(){return(0,X.useContext)(L$)}function Lq(e,t,n,r){return"center"===e||"center"===r?{top:t}:"end"===e?{bottom:n}:"start"===e?{top:n}:{}}function LW(e,t,n,r,o){return"center"===e||"center"===r?{left:t}:"end"===e?{["ltr"===o?"right":"left"]:n}:"start"===e?{["ltr"===o?"left":"right"]:n}:{}}let LY={bottom:"borderTopLeftRadius",left:"borderTopRightRadius",right:"borderBottomLeftRadius",top:"borderBottomRightRadius"},LK=(0,X.forwardRef)(({position:e,arrowSize:t,arrowOffset:n,arrowRadius:r,arrowPosition:o,visible:i,arrowX:s,arrowY:l,style:a,...c},d)=>{let{dir:u}=LG();return i?(0,Z.jsx)("div",{...c,ref:d,style:{...a,...function({position:e,arrowSize:t,arrowOffset:n,arrowRadius:r,arrowPosition:o,arrowX:i,arrowY:s,dir:l}){let[a,c="center"]=e.split("-"),d={width:t,height:t,transform:"rotate(45deg)",position:"absolute",[LY[a]]:r},u=-t/2;return"left"===a?{...d,...Lq(c,s,n,o),right:u,borderLeftColor:"transparent",borderBottomColor:"transparent",clipPath:"polygon(100% 0, 0 0, 100% 100%)"}:"right"===a?{...d,...Lq(c,s,n,o),left:u,borderRightColor:"transparent",borderTopColor:"transparent",clipPath:"polygon(0 100%, 0 0, 100% 100%)"}:"top"===a?{...d,...LW(c,i,n,o,l),bottom:u,borderTopColor:"transparent",borderLeftColor:"transparent",clipPath:"polygon(0 100%, 100% 100%, 100% 0)"}:"bottom"===a?{...d,...LW(c,i,n,o,l),top:u,borderBottomColor:"transparent",borderRightColor:"transparent",clipPath:"polygon(0 100%, 0 0, 100% 0)"}:{}}({position:e,arrowSize:t,arrowOffset:n,arrowRadius:r,arrowPosition:o,dir:u,arrowX:s,arrowY:l})}}):null});function LZ(e,t){if("rtl"===e&&(t.includes("right")||t.includes("left"))){let[e,n]=t.split("-"),r="right"===e?"left":"right";return void 0===n?r:`${r}-${n}`}return t}function LX(e){let t=document.createElement("div");return t.setAttribute("data-portal","true"),"string"==typeof e.className&&t.classList.add(...e.className.split(" ").filter(Boolean)),"object"==typeof e.style&&Object.assign(t.style,e.style),"string"==typeof e.id&&t.setAttribute("id",e.id),t}LK.displayName="@mantine/core/FloatingArrow";let LQ={reuseTargetNode:!0},LJ=Lt((e,t)=>{let{children:n,target:r,reuseTargetNode:o,...i}=RP("Portal",LQ,e),[s,l]=(0,X.useState)(!1),a=(0,X.useRef)(null);return(LV(()=>(l(!0),a.current=function({target:e,reuseTargetNode:t,...n}){if(e)return"string"==typeof e?document.querySelector(e)||LX(n):e;if(t){let e=document.querySelector("[data-mantine-shared-portal-node]");if(e)return e;let t=LX(n);return t.setAttribute("data-mantine-shared-portal-node","true"),document.body.appendChild(t),t}return LX(n)}({target:r,reuseTargetNode:o,...i}),LP(t,a.current),r||o||!a.current||document.body.appendChild(a.current),()=>{r||o||!a.current||document.body.removeChild(a.current)}),[r]),s&&a.current)?(0,xS.createPortal)((0,Z.jsx)(Z.Fragment,{children:n}),a.current):null});LJ.displayName="@mantine/core/Portal";let L0=Lt(({withinPortal:e=!0,children:t,...n},r)=>"test"!==RF()&&e?(0,Z.jsx)(LJ,{ref:r,...n,children:t}):(0,Z.jsx)(Z.Fragment,{children:t}));L0.displayName="@mantine/core/OptionalPortal";let L1={duration:100,transition:"fade"};function L2(e,t){return{...L1,...t,...e}}var L4={tooltip:"m_1b3c8819",arrow:"m_f898399f"};let L5={refProp:"ref",withinPortal:!0,offset:10,position:"right",zIndex:Lj.popover},L3=(e,{radius:t,color:n})=>({tooltip:{"--tooltip-radius":void 0===t?void 0:Rp(t),"--tooltip-bg":n?Rw(n,e):void 0,"--tooltip-color":n?"var(--mantine-color-white)":void 0}}),L8=Lt((e,t)=>{let n=RP("TooltipFloating",L5,e),{children:r,refProp:o,withinPortal:i,style:s,className:l,classNames:a,styles:c,unstyled:d,radius:u,color:h,label:p,offset:f,position:m,multiline:g,zIndex:b,disabled:y,defaultOpened:v,variant:E,vars:k,portalProps:C,attributes:T,...w}=n,x=RR(),S=RW({name:"TooltipFloating",props:n,classes:L4,className:l,style:s,classNames:a,styles:c,unstyled:d,attributes:T,rootSelector:"tooltip",vars:k,varsResolver:L3}),{handleMouseMove:A,x:_,y:N,opened:M,boundaryRef:I,floating:O,setOpened:D}=function({offset:e,position:t,defaultOpened:n}){let[r,o]=(0,X.useState)(n),i=(0,X.useRef)(null),{x:s,y:l,elements:a,refs:c,update:d,placement:u}=xJ({placement:t,middleware:[(0,xA.shift)({crossAxis:!0,padding:5,rootBoundary:"document"})]}),h=u.includes("right")?e:t.includes("left")?-1*e:0,p=u.includes("bottom")?e:t.includes("top")?-1*e:0,f=(0,X.useCallback)(({clientX:e,clientY:t})=>{c.setPositionReference({getBoundingClientRect:()=>({width:0,height:0,x:e,y:t,left:e+h,top:t+p,right:e,bottom:t})})},[a.reference]);return(0,X.useEffect)(()=>{if(c.floating.current){let e=i.current;e.addEventListener("mousemove",f);let t=(0,xh.getOverflowAncestors)(c.floating.current);return t.forEach(e=>{e.addEventListener("scroll",d)}),()=>{e.removeEventListener("mousemove",f),t.forEach(e=>{e.removeEventListener("scroll",d)})}}},[a.reference,c.floating.current,d,f,r]),{handleMouseMove:f,x:s,y:l,opened:r,setOpened:o,boundaryRef:i,floating:c.setFloating}}({offset:f,position:m,defaultOpened:v}),R=Lz(r);if(!R)throw Error("[@mantine/core] Tooltip.Floating component children should be an element or a component that accepts ref, fragments, strings, numbers and other primitive values are not supported");let L=LH(I,LF(R),t),P=R.props;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(L0,{...C,withinPortal:i,children:(0,Z.jsx)(R7,{...w,...S("tooltip",{style:{...function e(t,n){return Array.isArray(t)?[...t].reduce((t,r)=>({...t,...e(r,n)}),{}):"function"==typeof t?t(n):null==t?{}:t}(s,x),zIndex:b,display:!y&&M?"block":"none",top:(N&&Math.round(N))??"",left:(_&&Math.round(_))??""}}),variant:E,ref:O,mod:{multiline:g},children:p})}),(0,X.cloneElement)(R,{...P,[o]:L,onMouseEnter:e=>{P.onMouseEnter?.(e),A(e),D(!0)},onMouseLeave:e=>{P.onMouseLeave?.(e),D(!1)}})]})});L8.classes=L4,L8.displayName="@mantine/core/TooltipFloating";let L6=(0,X.createContext)(!1),L9=L6.Provider,L7={openDelay:0,closeDelay:0};function Pe(e){let{openDelay:t,closeDelay:n,children:r}=RP("TooltipGroup",L7,e);return(0,Z.jsx)(L9,{value:!0,children:(0,Z.jsx)(xW,{delay:{open:t,close:n},children:r})})}Pe.displayName="@mantine/core/TooltipGroup",Pe.extend=e=>e;let Pt=X.default["useId".toString()]||(()=>void 0);function Pn(e){let t,n=(t=Pt())?`mantine-${t.replace(/:/g,"")}`:"",[r,o]=(0,X.useState)(n);return(LV(()=>{o(function(e="mantine-"){return`${e}${Math.random().toString(36).slice(2,11)}`}())},[]),"string"==typeof e)?e:"undefined"==typeof window?n:r}let Pr={position:"top",refProp:"ref",withinPortal:!0,arrowSize:4,arrowOffset:5,arrowRadius:0,arrowPosition:"side",offset:5,transitionProps:{duration:100,transition:"fade"},events:{hover:!0,focus:!1,touch:!1},zIndex:Lj.popover,positionDependencies:[],middlewares:{flip:!0,shift:!0,inline:!1}},Po=(e,{radius:t,color:n,variant:r,autoContrast:o})=>{let i=e.variantColorResolver({theme:e,color:n||e.primaryColor,autoContrast:o,variant:r||"filled"});return{tooltip:{"--tooltip-radius":void 0===t?void 0:Rp(t),"--tooltip-bg":n?i.background:void 0,"--tooltip-color":n?i.color:void 0}}},Pi=Lt((e,t)=>{let n=RP("Tooltip",Pr,e),{children:r,position:o,refProp:i,label:s,openDelay:l,closeDelay:a,onPositionChange:c,opened:d,defaultOpened:u,withinPortal:h,radius:p,color:f,classNames:m,styles:g,unstyled:b,style:y,className:v,withArrow:E,arrowSize:k,arrowOffset:C,arrowRadius:T,arrowPosition:w,offset:x,transitionProps:S,multiline:A,events:_,zIndex:N,disabled:M,positionDependencies:I,onClick:O,onMouseEnter:D,onMouseLeave:R,inline:L,variant:P,keepMounted:B,vars:H,portalProps:j,mod:F,floatingStrategy:U,middlewares:z,autoContrast:V,attributes:$,target:G,...q}=RP("Tooltip",Pr,n),{dir:W}=LG(),Y=(0,X.useRef)(null),K=function(e){let t,n,[r,o]=(0,X.useState)(e.defaultOpened),i="boolean"==typeof e.opened?e.opened:r,s=(0,X.useContext)(L6),l=Pn(),a=(0,X.useCallback)(e=>{o(e),e&&y(l)},[l]),{x:c,y:d,context:u,refs:h,placement:p,middlewareData:{arrow:{x:f,y:m}={}}}=xJ({strategy:e.strategy,placement:e.position,open:i,onOpenChange:a,middleware:(t=function(e){if(void 0===e)return{shift:!0,flip:!0};let t={...e};return void 0===e.shift&&(t.shift=!0),void 0===e.flip&&(t.flip=!0),t}(e.middlewares),n=[(0,xA.offset)(e.offset)],t.shift&&n.push((0,xA.shift)("boolean"==typeof t.shift?{padding:8}:{padding:8,...t.shift})),t.flip&&n.push("boolean"==typeof t.flip?(0,xA.flip)():(0,xA.flip)(t.flip)),n.push((0,xA.arrow)({element:e.arrowRef,padding:e.arrowOffset})),t.inline?n.push("boolean"==typeof t.inline?(0,xA.inline)():(0,xA.inline)(t.inline)):e.inline&&n.push((0,xA.inline)()),n),whileElementsMounted:x_.autoUpdate}),{delay:g,currentId:b,setCurrentId:y}=function(e,t){void 0===t&&(t={});let{open:n,onOpenChange:r,floatingId:o}=e,{id:i,enabled:s=!0}=t,l=null!=i?i:o,a=X.useContext(xq),{currentId:c,setCurrentId:d,initialDelay:u,setState:h,timeoutMs:p}=a;return xC(()=>{!s||c&&(h({delay:{open:1,close:xz(u,"close")}}),c!==l&&r(!1))},[s,l,r,h,c,u]),xC(()=>{function e(){r(!1),h({delay:u,currentId:null})}if(s&&c&&!n&&c===l){if(p){let t=window.setTimeout(e,p);return()=>{clearTimeout(t)}}e()}},[s,n,h,c,l,r,u,p]),xC(()=>{!s||d!==xG&&n&&d(l)},[s,n,d,l]),a}(u,{id:l}),{getReferenceProps:v,getFloatingProps:E}=x2([x$(u,{enabled:e.events?.hover,delay:s?g:{open:e.openDelay,close:e.closeDelay},mouseOnly:!e.events?.touch}),function(e,t){void 0===t&&(t={});let{open:n,onOpenChange:r,events:o,dataRef:i,elements:s}=e,{enabled:l=!0,visibleOnly:a=!0}=t,c=X.useRef(!1),d=X.useRef(-1),u=X.useRef(!0);X.useEffect(()=>{if(!l)return;let e=(0,xh.getWindow)(s.domReference);function t(){!n&&(0,xh.isHTMLElement)(s.domReference)&&s.domReference===xm(xv(s.domReference))&&(c.current=!0)}function r(){u.current=!0}function o(){u.current=!1}return e.addEventListener("blur",t),x0()&&(e.addEventListener("keydown",r,!0),e.addEventListener("pointerdown",o,!0)),()=>{e.removeEventListener("blur",t),x0()&&(e.removeEventListener("keydown",r,!0),e.removeEventListener("pointerdown",o,!0))}},[s.domReference,n,l]),X.useEffect(()=>{if(l)return o.on("openchange",e),()=>{o.off("openchange",e)};function e(e){let{reason:t}=e;("reference-press"===t||"escape-key"===t)&&(c.current=!0)}},[o,l]),X.useEffect(()=>()=>{xF(d)},[]);let h=X.useMemo(()=>({onMouseLeave(){c.current=!1},onFocus(e){if(c.current)return;let t=xb(e.nativeEvent);if(a&&(0,xh.isElement)(t)){if(x0()&&!e.relatedTarget){if(!u.current&&!((0,xh.isHTMLElement)(t)&&t.matches("input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])")))return}else if(!function(e){let t;if(!e||((t=navigator.userAgentData)&&Array.isArray(t.brands)?t.brands.map(e=>{let{brand:t,version:n}=e;return t+"/"+n}).join(" "):navigator.userAgent).includes("jsdom/"))return!0;try{return e.matches(":focus-visible")}catch(e){return!0}}(t))return}r(!0,e.nativeEvent,"focus")},onBlur(e){c.current=!1;let t=e.relatedTarget,n=e.nativeEvent,o=(0,xh.isElement)(t)&&t.hasAttribute(xj("focus-guard"))&&"outside"===t.getAttribute("data-type");d.current=window.setTimeout(()=>{var e;let l=xm(s.domReference?s.domReference.ownerDocument:document);!t&&l===s.domReference||xg(null==(e=i.current.floatingContext)?void 0:e.refs.floating.current,l)||xg(s.domReference,l)||o||r(!1,n,"focus")})}}),[i,s.domReference,r,a]);return X.useMemo(()=>l?{reference:h}:{},[l,h])}(u,{enabled:e.events?.focus,visibleOnly:!0}),function(e,t){var n,r;void 0===t&&(t={});let{open:o,elements:i,floatingId:s}=e,{enabled:l=!0,role:a="dialog"}=t,c=xL(),d=(null==(n=i.domReference)?void 0:n.id)||c,u=X.useMemo(()=>{var e,t;return(null==(e=(t=i.floating)?t.hasAttribute(xf)?t:t.querySelector("["+xf+"]")||t:null)?void 0:e.id)||s},[i.floating,s]),h=null!=(r=x4.get(a))?r:a,p=null!=xH(),f=X.useMemo(()=>"tooltip"===h||"label"===a?{["aria-"+("label"===a?"labelledby":"describedby")]:o?u:void 0}:{"aria-expanded":o?"true":"false","aria-haspopup":"alertdialog"===h?"dialog":h,"aria-controls":o?u:void 0,..."listbox"===h&&{role:"combobox"},..."menu"===h&&{id:d},..."menu"===h&&p&&{role:"menuitem"},..."select"===a&&{"aria-autocomplete":"none"},..."combobox"===a&&{"aria-autocomplete":"list"}},[h,u,p,o,d,a]),m=X.useMemo(()=>{let e={id:u,...h&&{role:h}};return"tooltip"===h||"label"===a?e:{...e,..."menu"===h&&{"aria-labelledby":d}}},[h,u,d,a]),g=X.useCallback(e=>{let{active:t,selected:n}=e,r={role:"option",...t&&{id:u+"-fui-option"}};switch(a){case"select":case"combobox":return{...r,"aria-selected":n}}return{}},[u,a]);return X.useMemo(()=>l?{reference:f,floating:m,item:g}:{},[l,f,m,g])}(u,{role:"tooltip"}),xQ(u,{enabled:void 0===e.opened})]);Lf(()=>{e.onPositionChange?.(p)},[p]);let k=i&&b&&b!==l;return{x:c,y:d,arrowX:f,arrowY:m,reference:h.setReference,floating:h.setFloating,getFloatingProps:E,getReferenceProps:v,isGroupPhase:k,opened:i,placement:p}}({position:LZ(W,o),closeDelay:a,openDelay:l,onPositionChange:c,opened:d,defaultOpened:u,events:_,arrowRef:Y,arrowOffset:C,offset:"number"==typeof x?x+(E?k/2:0):x,positionDependencies:[...I,G??r],inline:L,strategy:U,middlewares:z});(0,X.useEffect)(()=>{let e=G instanceof HTMLElement?G:"string"==typeof G?document.querySelector(G):G?.current||null;e&&K.reference(e)},[G,K]);let Q=RW({name:"Tooltip",props:n,classes:L4,className:v,style:y,classNames:m,styles:g,unstyled:b,attributes:$,rootSelector:"tooltip",vars:H,varsResolver:Po}),J=Lz(r);if(!G&&!J)return null;if(G){let e=L2(S,{duration:100,transition:"fade"});return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(L0,{...j,withinPortal:h,children:(0,Z.jsx)(Lm,{...e,keepMounted:B,mounted:!M&&!!K.opened,duration:K.isGroupPhase?10:e.duration,children:e=>(0,Z.jsxs)(R7,{...q,"data-fixed":"fixed"===U||void 0,variant:P,mod:[{multiline:A},F],...K.getFloatingProps({ref:K.floating,className:Q("tooltip").className,style:{...Q("tooltip").style,...e,zIndex:N,top:K.y??0,left:K.x??0}}),children:[s,(0,Z.jsx)(LK,{ref:Y,arrowX:K.arrowX,arrowY:K.arrowY,visible:E,position:K.placement,arrowSize:k,arrowOffset:C,arrowRadius:T,arrowPosition:w,...Q("arrow")})]})})})})}let ee=J.props,et=LH(K.reference,LF(J),t),en=L2(S,{duration:100,transition:"fade"});return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(L0,{...j,withinPortal:h,children:(0,Z.jsx)(Lm,{...en,keepMounted:B,mounted:!M&&!!K.opened,duration:K.isGroupPhase?10:en.duration,children:e=>(0,Z.jsxs)(R7,{...q,"data-fixed":"fixed"===U||void 0,variant:P,mod:[{multiline:A},F],...K.getFloatingProps({ref:K.floating,className:Q("tooltip").className,style:{...Q("tooltip").style,...e,zIndex:N,top:K.y??0,left:K.x??0}}),children:[s,(0,Z.jsx)(LK,{ref:Y,arrowX:K.arrowX,arrowY:K.arrowY,visible:E,position:K.placement,arrowSize:k,arrowOffset:C,arrowRadius:T,arrowPosition:w,...Q("arrow")})]})})}),(0,X.cloneElement)(J,K.getReferenceProps({onClick:O,onMouseEnter:D,onMouseLeave:R,onMouseMove:n.onMouseMove,onPointerDown:n.onPointerDown,onPointerEnter:n.onPointerEnter,...ee,className:(0,Rg.default)(v,ee.className),[i]:et}))]})});Pi.classes=L4,Pi.displayName="@mantine/core/Tooltip",Pi.Floating=L8,Pi.Group=Pe;var Ps={root:"m_6d731127"};let Pl={gap:"md",align:"stretch",justify:"flex-start"},Pa=(e,{gap:t,align:n,justify:r})=>({root:{"--stack-gap":Rh(t),"--stack-align":n,"--stack-justify":r}}),Pc=Lt((e,t)=>{let n=RP("Stack",Pl,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,vars:a,align:c,justify:d,gap:u,variant:h,attributes:p,...f}=n,m=RW({name:"Stack",props:n,classes:Ps,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:p,vars:a,varsResolver:Pa});return(0,Z.jsx)(R7,{ref:t,...m("root"),variant:h,...f})});Pc.classes=Ps,Pc.displayName="@mantine/core/Stack";var Pd={root:"m_b6d8b162"};let Pu={inherit:!1},Ph=(e,{variant:t,lineClamp:n,gradient:r,size:o,color:i})=>({root:{"--text-fz":Rf(o),"--text-lh":Ru(o,"mantine-line-height",!1),"--text-gradient":"gradient"===t?Rx(r,e):void 0,"--text-line-clamp":"number"==typeof n?n.toString():void 0,"--text-color":i?Rw(i,e):void 0}}),Pp=Ln((e,t)=>{let n=RP("Text",Pu,e),{lineClamp:r,truncate:o,inline:i,inherit:s,gradient:l,span:a,__staticSelector:c,vars:d,className:u,style:h,classNames:p,styles:f,unstyled:m,variant:g,mod:b,size:y,attributes:v,...E}=n,k=RW({name:["Text",c],props:n,classes:Pd,className:u,style:h,classNames:p,styles:f,unstyled:m,attributes:v,vars:d,varsResolver:Ph});return(0,Z.jsx)(R7,{...k("root",{focusable:!0}),ref:t,component:a?"span":"p",variant:g,mod:[{"data-truncate":"start"===o?"start":"end"===o||o?"end":void 0,"data-line-clamp":"number"==typeof r,"data-inline":i,"data-inherit":s},b],size:y,...E})});Pp.classes=Pd,Pp.displayName="@mantine/core/Text";var Pf={root:"m_4081bf90"};let Pm={preventGrowOverflow:!0,gap:"md",align:"center",justify:"flex-start",wrap:"wrap"},Pg=(e,{grow:t,preventGrowOverflow:n,gap:r,align:o,justify:i,wrap:s},{childWidth:l})=>({root:{"--group-child-width":t&&n?l:void 0,"--group-gap":Rh(r),"--group-align":o,"--group-justify":i,"--group-wrap":s}}),Pb=Lt((e,t)=>{let n=RP("Group",Pm,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,children:a,gap:c,align:d,justify:u,wrap:h,grow:p,preventGrowOverflow:f,vars:m,variant:g,__size:b,mod:y,attributes:v,...E}=n,k=X.Children.toArray(a).filter(Boolean),C=k.length,T=Rh(c??"md"),w=RW({name:"Group",props:n,stylesCtx:{childWidth:`calc(${100/C}% - (${T} - ${T} / ${C}))`},className:o,style:i,classes:Pf,classNames:r,styles:s,unstyled:l,attributes:v,vars:m,varsResolver:Pg});return(0,Z.jsx)(R7,{...w("root"),ref:t,variant:g,mod:[{grow:p},y],size:b,...E,children:k})});function Py({value:e,defaultValue:t,finalValue:n,onChange:r=()=>{}}){let[o,i]=(0,X.useState)(void 0!==t?t:n);return void 0!==e?[e,r,!0]:[o,(e,...t)=>{i(e),r?.(e,...t)},!1]}function Pv({size:e,style:t,...n}){let r=void 0!==e?{width:Ra(e),height:Ra(e),...t}:t;return(0,Z.jsx)("svg",{viewBox:"0 0 10 7",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:r,"aria-hidden":!0,...n,children:(0,Z.jsx)("path",{d:"M4 4.586L1.707 2.293A1 1 0 1 0 .293 3.707l3 3a.997.997 0 0 0 1.414 0l5-5A1 1 0 1 0 8.293.293L4 4.586z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function PE(e=null){let t=(0,X.createContext)(e);return[({children:e,value:n})=>(0,Z.jsx)(t.Provider,{value:n,children:e}),()=>(0,X.useContext)(t)]}Pb.classes=Pf,Pb.displayName="@mantine/core/Group";let[Pk,PC]=PE();function PT(e){let{value:t,defaultValue:n,onChange:r,multiple:o,children:i}=RP("ChipGroup",null,e),[s,l]=Py({value:t,defaultValue:n,finalValue:o?[]:null,onChange:r});return(0,Z.jsx)(Pk,{value:{isChipSelected:e=>Array.isArray(s)?s.includes(e):e===s,onChange:e=>{let t=e.currentTarget.value;Array.isArray(s)?l(s.includes(t)?s.filter(e=>e!==t):[...s,t]):l(t)},multiple:o},children:i})}PT.displayName="@mantine/core/ChipGroup";var Pw={root:"m_f59ffda3",label:"m_be049a53","label--outline":"m_3904c1af","label--filled":"m_fa109255","label--light":"m_f7e165c3",iconWrapper:"m_9ac86df9",checkIcon:"m_d6d72580",input:"m_bde07329"};let Px={type:"checkbox"},PS=(e,{size:t,radius:n,variant:r,color:o,autoContrast:i})=>{let s=e.variantColorResolver({color:o||e.primaryColor,theme:e,variant:r||"filled",autoContrast:i});return{root:{"--chip-fz":Rf(t),"--chip-size":Ru(t,"chip-size"),"--chip-radius":void 0===n?void 0:Rp(n),"--chip-checked-padding":Ru(t,"chip-checked-padding"),"--chip-padding":Ru(t,"chip-padding"),"--chip-icon-size":Ru(t,"chip-icon-size"),"--chip-bg":o||r?s.background:void 0,"--chip-hover":o||r?s.hover:void 0,"--chip-color":o||r?s.color:void 0,"--chip-bd":o||r?s.border:void 0,"--chip-spacing":Ru(t,"chip-spacing")}}},PA=Lt((e,t)=>{let n=RP("Chip",Px,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,vars:a,id:c,checked:d,defaultChecked:u,onChange:h,value:p,wrapperProps:f,type:m,disabled:g,children:b,size:y,variant:v,icon:E,rootRef:k,autoContrast:C,mod:T,attributes:w,...x}=n,S=RW({name:"Chip",classes:Pw,props:n,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:w,vars:a,varsResolver:PS}),A=PC(),_=Pn(c),{styleProps:N,rest:M}=RJ(x),[I,O]=Py({value:d,defaultValue:u,finalValue:!1,onChange:h}),D=A?{checked:A.isChipSelected(p),onChange:e=>{A.onChange(e),h?.(e.currentTarget.checked)},type:A.multiple?"checkbox":"radio"}:{},R=D.checked||I;return(0,Z.jsxs)(R7,{size:y,variant:v,ref:k,mod:T,...S("root"),...N,...f,children:[(0,Z.jsx)("input",{type:m,...S("input"),checked:R,onChange:e=>O(e.currentTarget.checked),id:_,disabled:g,ref:t,value:p,...D,...M}),(0,Z.jsxs)("label",{htmlFor:_,"data-checked":R||void 0,"data-disabled":g||void 0,...S("label",{variant:v||"filled"}),children:[R&&null!==E&&!1!==E&&(0,Z.jsx)("span",{...S("iconWrapper"),children:void 0===E?(0,Z.jsx)(Pv,{...S("checkIcon")}):E}),(0,Z.jsx)("span",{children:b})]})]})});PA.classes=Pw,PA.displayName="@mantine/core/Chip",PA.Group=PT;var P_={root:"m_3eebeb36",label:"m_9e365f20"};let PN={orientation:"horizontal"},PM=(e,{color:t,variant:n,size:r})=>({root:{"--divider-color":t?Rw(t,e):void 0,"--divider-border-style":n,"--divider-size":Ru(r,"divider-size")}}),PI=Lt((e,t)=>{let n=RP("Divider",PN,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,vars:a,color:c,orientation:d,label:u,labelPosition:h,mod:p,attributes:f,...m}=n,g=RW({name:"Divider",classes:P_,props:n,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:f,vars:a,varsResolver:PM});return(0,Z.jsx)(R7,{ref:t,mod:[{orientation:d,"with-label":!!u},p],...g("root"),...m,role:"separator",children:u&&(0,Z.jsx)(R7,{component:"span",mod:{position:h},...g("label"),children:u})})});PI.classes=P_,PI.displayName="@mantine/core/Divider";var PO={root:"m_1b7284a3"};let PD=(e,{radius:t,shadow:n})=>({root:{"--paper-radius":void 0===t?void 0:Rp(t),"--paper-shadow":Rm(n)}}),PR=Ln((e,t)=>{let n=RP("Paper",null,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,withBorder:a,vars:c,radius:d,shadow:u,variant:h,mod:p,attributes:f,...m}=n,g=RW({name:"Paper",props:n,classes:PO,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:f,vars:c,varsResolver:PD});return(0,Z.jsx)(R7,{ref:t,mod:[{"data-with-border":a},p],...g("root"),variant:h,...m})});function PL(e){let t=(0,X.createContext)(null);return[({children:e,value:n})=>(0,Z.jsx)(t.Provider,{value:n,children:e}),()=>{let n=(0,X.useContext)(t);if(null===n)throw Error(e);return n}]}PR.classes=PO,PR.displayName="@mantine/core/Paper";let[PP,PB]=PL("Card component was not found in tree");var PH={root:"m_e615b15f",section:"m_599a2148"};let Pj=Ln((e,t)=>{let{classNames:n,className:r,style:o,styles:i,vars:s,withBorder:l,inheritPadding:a,mod:c,...d}=RP("CardSection",null,e),u=PB();return(0,Z.jsx)(R7,{ref:t,mod:[{"with-border":l,"inherit-padding":a},c],...u.getStyles("section",{className:r,style:o,styles:i,classNames:n}),...d})});Pj.classes=PH,Pj.displayName="@mantine/core/CardSection";let PF=(e,{padding:t})=>({root:{"--card-padding":Rh(t)}}),PU=Ln((e,t)=>{let n=RP("Card",null,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,vars:a,children:c,padding:d,attributes:u,...h}=n,p=RW({name:"Card",props:n,classes:PH,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:u,vars:a,varsResolver:PF}),f=X.Children.toArray(c),m=f.map((e,t)=>"object"==typeof e&&e&&"type"in e&&e.type===Pj?(0,X.cloneElement)(e,{"data-first-section":0===t||void 0,"data-last-section":t===f.length-1||void 0}):e);return(0,Z.jsx)(PP,{value:{getStyles:p},children:(0,Z.jsx)(PR,{ref:t,unstyled:l,...p("root"),...h,children:m})})});PU.classes=PH,PU.displayName="@mantine/core/Card",PU.Section=Pj;var Pz={root:"m_18320242","skeleton-fade":"m_299c329c"};let PV={visible:!0,animate:!0},P$=(e,{width:t,height:n,radius:r,circle:o})=>({root:{"--skeleton-height":Ra(n),"--skeleton-width":o?Ra(n):Ra(t),"--skeleton-radius":o?"1000px":void 0===r?void 0:Rp(r)}}),PG=Lt((e,t)=>{let n=RP("Skeleton",PV,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,vars:a,width:c,height:d,circle:u,visible:h,radius:p,animate:f,mod:m,attributes:g,...b}=n,y=RW({name:"Skeleton",classes:Pz,props:n,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:g,vars:a,varsResolver:P$});return(0,Z.jsx)(R7,{ref:t,...y("root"),mod:[{visible:h,animate:f},m],...b})});PG.classes=Pz,PG.displayName="@mantine/core/Skeleton";let Pq=(0,X.createContext)(null),PW=Pq.Provider;var PY={group:"m_11def92b",root:"m_f85678b6",image:"m_11f8ac07",placeholder:"m_104cd71f"};let PK=(e,{spacing:t})=>({group:{"--ag-spacing":Rh(t)}}),PZ=Lt((e,t)=>{let n=RP("AvatarGroup",null,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,vars:a,spacing:c,attributes:d,...u}=n,h=RW({name:"AvatarGroup",classes:PY,props:n,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:d,vars:a,varsResolver:PK,rootSelector:"group"});return(0,Z.jsx)(PW,{value:!0,children:(0,Z.jsx)(R7,{ref:t,...h("group"),...u})})});function PX(e){return(0,Z.jsx)("svg",{...e,"data-avatar-placeholder-icon":!0,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,Z.jsx)("path",{d:"M0.877014 7.49988C0.877014 3.84219 3.84216 0.877045 7.49985 0.877045C11.1575 0.877045 14.1227 3.84219 14.1227 7.49988C14.1227 11.1575 11.1575 14.1227 7.49985 14.1227C3.84216 14.1227 0.877014 11.1575 0.877014 7.49988ZM7.49985 1.82704C4.36683 1.82704 1.82701 4.36686 1.82701 7.49988C1.82701 8.97196 2.38774 10.3131 3.30727 11.3213C4.19074 9.94119 5.73818 9.02499 7.50023 9.02499C9.26206 9.02499 10.8093 9.94097 11.6929 11.3208C12.6121 10.3127 13.1727 8.97172 13.1727 7.49988C13.1727 4.36686 10.6328 1.82704 7.49985 1.82704ZM10.9818 11.9787C10.2839 10.7795 8.9857 9.97499 7.50023 9.97499C6.01458 9.97499 4.71624 10.7797 4.01845 11.9791C4.97952 12.7272 6.18765 13.1727 7.49985 13.1727C8.81227 13.1727 10.0206 12.727 10.9818 11.9787ZM5.14999 6.50487C5.14999 5.207 6.20212 4.15487 7.49999 4.15487C8.79786 4.15487 9.84999 5.207 9.84999 6.50487C9.84999 7.80274 8.79786 8.85487 7.49999 8.85487C6.20212 8.85487 5.14999 7.80274 5.14999 6.50487ZM7.49999 5.10487C6.72679 5.10487 6.09999 5.73167 6.09999 6.50487C6.09999 7.27807 6.72679 7.90487 7.49999 7.90487C8.27319 7.90487 8.89999 7.27807 8.89999 6.50487C8.89999 5.73167 8.27319 5.10487 7.49999 5.10487Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}PZ.classes=PY,PZ.displayName="@mantine/core/AvatarGroup";let PQ=["blue","cyan","grape","green","indigo","lime","orange","pink","red","teal","violet"],PJ=(e,{size:t,radius:n,variant:r,gradient:o,color:i,autoContrast:s,name:l,allowedInitialsColors:a})=>{let c="initials"===i&&"string"==typeof l?function(e,t=PQ){let n=Math.abs(function(e){let t=0;for(let n=0;n<e.length;n+=1)t=(t<<5)-t+e.charCodeAt(n)|0;return t}(e))%t.length;return t[n]}(l,a):i,d=e.variantColorResolver({color:c||"gray",theme:e,gradient:o,variant:r||"light",autoContrast:s});return{root:{"--avatar-size":Ru(t,"avatar-size"),"--avatar-radius":void 0===n?void 0:Rp(n),"--avatar-bg":c||r?d.background:void 0,"--avatar-color":c||r?d.color:void 0,"--avatar-bd":c||r?d.border:void 0}}},P0=Ln((e,t)=>{let n=RP("Avatar",null,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,vars:a,src:c,alt:d,radius:u,color:h,gradient:p,imageProps:f,children:m,autoContrast:g,mod:b,name:y,allowedInitialsColors:v,attributes:E,...k}=n,C={withinGroup:!!(0,X.useContext)(Pq)},[T,w]=(0,X.useState)(!c),x=RW({name:"Avatar",props:n,classes:PY,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:E,vars:a,varsResolver:PJ});return(0,X.useEffect)(()=>w(!c),[c]),(0,Z.jsx)(R7,{...x("root"),mod:[{"within-group":C.withinGroup},b],ref:t,...k,children:T||!c?(0,Z.jsx)("span",{...x("placeholder"),title:d,children:m||"string"==typeof y&&function(e,t=2){let n=e.split(" ");return 1===n.length?e.slice(0,t).toUpperCase():n.map(e=>e[0]).slice(0,t).join("").toUpperCase()}(y)||(0,Z.jsx)(PX,{})}):(0,Z.jsx)("img",{...f,...x("image"),src:c,alt:d,onError:e=>{w(!0),f?.onError?.(e)}})})});P0.classes=PY,P0.displayName="@mantine/core/Avatar",P0.Group=PZ;let[P1,P2]=PE({size:"sm"});function P4({classNames:e,styles:t,props:n,stylesCtx:r}){let o=RR();return{resolvedClassNames:RV({theme:o,classNames:e,props:n,stylesCtx:r||void 0}),resolvedStyles:RG({theme:o,styles:t,props:n,stylesCtx:r||void 0})}}let P5=(0,X.forwardRef)(({size:e="var(--cb-icon-size, 70%)",style:t,...n},r)=>(0,Z.jsx)("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...t,width:e,height:e},ref:r,...n,children:(0,Z.jsx)("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})}));P5.displayName="@mantine/core/CloseIcon";var P3={root:"m_86a44da5","root--subtle":"m_220c80f2"};let P8={variant:"subtle"},P6=(e,{size:t,radius:n,iconSize:r})=>({root:{"--cb-size":Ru(t,"cb-size"),"--cb-radius":void 0===n?void 0:Rp(n),"--cb-icon-size":Ra(r)}}),P9=Ln((e,t)=>{let n=RP("CloseButton",P8,e),{iconSize:r,children:o,vars:i,radius:s,className:l,classNames:a,style:c,styles:d,unstyled:u,"data-disabled":h,disabled:p,variant:f,icon:m,mod:g,attributes:b,__staticSelector:y,...v}=n,E=RW({name:y||"CloseButton",props:n,className:l,style:c,classes:P3,classNames:a,styles:d,unstyled:u,attributes:b,vars:i,varsResolver:P6});return(0,Z.jsxs)(Ly,{ref:t,...v,unstyled:u,variant:f,disabled:p,mod:[{disabled:p||h},g],...E("root",{variant:f,active:!p&&!h}),children:[m||(0,Z.jsx)(P5,{}),o]})});P9.classes=P3,P9.displayName="@mantine/core/CloseButton";let P7=Lt((e,t)=>{let n=RP("InputClearButton",null,e),{size:r,variant:o,vars:i,classNames:s,styles:l,...a}=n,c=P2(),{resolvedClassNames:d,resolvedStyles:u}=P4({classNames:s,styles:l,props:n});return(0,Z.jsx)(P9,{variant:o||"transparent",ref:t,size:r||c?.size||"sm",classNames:d,styles:u,__staticSelector:"InputClearButton",style:{pointerEvents:"all",background:"var(--input-bg)",...a.style},...a})});P7.displayName="@mantine/core/InputClearButton";let Be={xs:7,sm:8,md:10,lg:12,xl:15},[Bt,Bn]=PE({offsetBottom:!1,offsetTop:!1,describedBy:void 0,getStyles:null,inputId:void 0,labelId:void 0});var Br={wrapper:"m_6c018570",input:"m_8fb7ebe7",section:"m_82577fc2",placeholder:"m_88bacfd0",root:"m_46b77525",label:"m_8fdc1311",required:"m_78a94662",error:"m_8f816625",description:"m_fe47ce59"};let Bo=(e,{size:t})=>({description:{"--input-description-size":void 0===t?void 0:`calc(${Rf(t)} - ${Ra(2)})`}}),Bi=Lt((e,t)=>{let n=RP("InputDescription",null,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,vars:a,size:c,__staticSelector:d,__inheritStyles:u=!0,attributes:h,variant:p,...f}=RP("InputDescription",null,n),m=Bn(),g=RW({name:["InputWrapper",d],props:n,classes:Br,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:h,rootSelector:"description",vars:a,varsResolver:Bo}),b=u&&m?.getStyles||g;return(0,Z.jsx)(R7,{component:"p",ref:t,variant:p,size:c,...b("description",m?.getStyles?{className:o,style:i}:void 0),...f})});Bi.classes=Br,Bi.displayName="@mantine/core/InputDescription";let Bs=(e,{size:t})=>({error:{"--input-error-size":void 0===t?void 0:`calc(${Rf(t)} - ${Ra(2)})`}}),Bl=Lt((e,t)=>{let n=RP("InputError",null,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,vars:a,size:c,attributes:d,__staticSelector:u,__inheritStyles:h=!0,variant:p,...f}=n,m=RW({name:["InputWrapper",u],props:n,classes:Br,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:d,rootSelector:"error",vars:a,varsResolver:Bs}),g=Bn(),b=h&&g?.getStyles||m;return(0,Z.jsx)(R7,{component:"p",ref:t,variant:p,size:c,...b("error",g?.getStyles?{className:o,style:i}:void 0),...f})});Bl.classes=Br,Bl.displayName="@mantine/core/InputError";let Ba={labelElement:"label"},Bc=(e,{size:t})=>({label:{"--input-label-size":Rf(t),"--input-asterisk-color":void 0}}),Bd=Lt((e,t)=>{let n=RP("InputLabel",Ba,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,vars:a,labelElement:c,size:d,required:u,htmlFor:h,onMouseDown:p,children:f,__staticSelector:m,variant:g,mod:b,attributes:y,...v}=RP("InputLabel",Ba,n),E=RW({name:["InputWrapper",m],props:n,classes:Br,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:y,rootSelector:"label",vars:a,varsResolver:Bc}),k=Bn(),C=k?.getStyles||E;return(0,Z.jsxs)(R7,{...C("label",k?.getStyles?{className:o,style:i}:void 0),component:c,variant:g,size:d,ref:t,htmlFor:"label"===c?h:void 0,mod:[{required:u},b],onMouseDown:e=>{p?.(e),!e.defaultPrevented&&e.detail>1&&e.preventDefault()},...v,children:[f,u&&(0,Z.jsx)("span",{...C("required"),"aria-hidden":!0,children:" *"})]})});Bd.classes=Br,Bd.displayName="@mantine/core/InputLabel";let Bu=Lt((e,t)=>{let n=RP("InputPlaceholder",null,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,vars:a,__staticSelector:c,variant:d,error:u,mod:h,attributes:p,...f}=n,m=RW({name:["InputPlaceholder",c],props:n,classes:Br,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:p,rootSelector:"placeholder"});return(0,Z.jsx)(R7,{...m("placeholder"),mod:[{error:!!u},h],component:"span",variant:d,ref:t,...f})});Bu.classes=Br,Bu.displayName="@mantine/core/InputPlaceholder";let Bh={labelElement:"label",inputContainer:e=>e,inputWrapperOrder:["label","description","input","error"]},Bp=(e,{size:t})=>({label:{"--input-label-size":Rf(t),"--input-asterisk-color":void 0},error:{"--input-error-size":void 0===t?void 0:`calc(${Rf(t)} - ${Ra(2)})`},description:{"--input-description-size":void 0===t?void 0:`calc(${Rf(t)} - ${Ra(2)})`}}),Bf=Lt((e,t)=>{let n=RP("InputWrapper",Bh,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,vars:a,size:c,variant:d,__staticSelector:u,inputContainer:h,inputWrapperOrder:p,label:f,error:m,description:g,labelProps:b,descriptionProps:y,errorProps:v,labelElement:E,children:k,withAsterisk:C,id:T,required:w,__stylesApiProps:x,mod:S,attributes:A,..._}=n,N=RW({name:["InputWrapper",u],props:x||n,classes:Br,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:A,vars:a,varsResolver:Bp}),M={size:c,variant:d,__staticSelector:u},I=Pn(T),O=v?.id||`${I}-error`,D=y?.id||`${I}-description`,R=!!m&&"boolean"!=typeof m,L=!!g,P=`${R?O:""} ${L?D:""}`,B=P.trim().length>0?P.trim():void 0,H=b?.id||`${I}-label`,j=f&&(0,Z.jsx)(Bd,{labelElement:E,id:H,htmlFor:I,required:"boolean"==typeof C?C:w,...M,...b,children:f},"label"),F=L&&(0,Z.jsx)(Bi,{...y,...M,size:y?.size||M.size,id:y?.id||D,children:g},"description"),U=(0,Z.jsx)(X.Fragment,{children:h(k)},"input"),z=R&&(0,X.createElement)(Bl,{...v,...M,size:v?.size||M.size,key:"error",id:v?.id||O},m),V=p.map(e=>{switch(e){case"label":return j;case"input":return U;case"description":return F;case"error":return z;default:return null}});return(0,Z.jsx)(Bt,{value:{getStyles:N,describedBy:B,inputId:I,labelId:H,...function(e,{hasDescription:t,hasError:n}){let r=e.findIndex(e=>"input"===e),o=e.slice(0,r),i=e.slice(r+1),s=t&&o.includes("description")||n&&o.includes("error");return{offsetBottom:t&&i.includes("description")||n&&i.includes("error"),offsetTop:s}}(p,{hasDescription:L,hasError:R})},children:(0,Z.jsx)(R7,{ref:t,variant:d,size:c,mod:[{error:!!m},S],...N("root"),..._,children:V})})});Bf.classes=Br,Bf.displayName="@mantine/core/InputWrapper";let Bm={variant:"default",leftSectionPointerEvents:"none",rightSectionPointerEvents:"none",withAria:!0,withErrorStyles:!0,size:"sm"},Bg=(e,t,n)=>({wrapper:{"--input-margin-top":n.offsetTop?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-margin-bottom":n.offsetBottom?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-height":Ru(t.size,"input-height"),"--input-fz":Rf(t.size),"--input-radius":void 0===t.radius?void 0:Rp(t.radius),"--input-left-section-width":void 0!==t.leftSectionWidth?Ra(t.leftSectionWidth):void 0,"--input-right-section-width":void 0!==t.rightSectionWidth?Ra(t.rightSectionWidth):void 0,"--input-padding-y":t.multiline?Ru(t.size,"input-padding-y"):void 0,"--input-left-section-pointer-events":t.leftSectionPointerEvents,"--input-right-section-pointer-events":t.rightSectionPointerEvents}}),Bb=Ln((e,t)=>{let n=RP("Input",Bm,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,required:a,__staticSelector:c,__stylesApiProps:d,size:u,wrapperProps:h,error:p,disabled:f,leftSection:m,leftSectionProps:g,leftSectionWidth:b,rightSection:y,rightSectionProps:v,rightSectionWidth:E,rightSectionPointerEvents:k,leftSectionPointerEvents:C,variant:T,vars:w,pointer:x,multiline:S,radius:A,id:_,withAria:N,withErrorStyles:M,mod:I,inputSize:O,attributes:D,__clearSection:R,__clearable:L,__defaultRightSection:P,...B}=n,{styleProps:H,rest:j}=RJ(B),F=Bn(),U=RW({name:["Input",c],props:d||n,classes:Br,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:D,stylesCtx:{offsetBottom:F?.offsetBottom,offsetTop:F?.offsetTop},rootSelector:"wrapper",vars:w,varsResolver:Bg}),z=N?{required:a,disabled:f,"aria-invalid":!!p,"aria-describedby":F?.describedBy,id:F?.inputId||_}:{},V=function({__clearable:e,__clearSection:t,rightSection:n,__defaultRightSection:r,size:o="sm"}){let i=e&&t;return i&&(n||r)?(0,Z.jsxs)("div",{"data-combined-clear-section":!0,style:{display:"flex",gap:2,alignItems:"center",paddingInlineEnd:Be[o]},children:[i,n||r]}):null===n?null:n||i||r}({__clearable:L,__clearSection:R,rightSection:y,__defaultRightSection:P,size:u});return(0,Z.jsx)(P1,{value:{size:u||"sm"},children:(0,Z.jsxs)(R7,{...U("wrapper"),...H,...h,mod:[{error:!!p&&M,pointer:x,disabled:f,multiline:S,"data-with-right-section":!!V,"data-with-left-section":!!m},I],variant:T,size:u,children:[m&&(0,Z.jsx)("div",{...g,"data-position":"left",...U("section",{className:g?.className,style:g?.style}),children:m}),(0,Z.jsx)(R7,{component:"input",...j,...z,ref:t,required:a,mod:{disabled:f,error:!!p&&M},variant:T,__size:O,...U("input")}),V&&(0,Z.jsx)("div",{...v,"data-position":"right",...U("section",{className:v?.className,style:v?.style}),children:V})]})})});Bb.classes=Br,Bb.Wrapper=Bf,Bb.Label=Bd,Bb.Error=Bl,Bb.Description=Bi,Bb.Placeholder=Bu,Bb.ClearButton=P7,Bb.displayName="@mantine/core/Input";let By={__staticSelector:"InputBase",withAria:!0,size:"sm"},Bv=Ln((e,t)=>{let{inputProps:n,wrapperProps:r,...o}=function(e,t,n){let r=RP(e,t,n),{label:o,description:i,error:s,required:l,classNames:a,styles:c,className:d,unstyled:u,__staticSelector:h,__stylesApiProps:p,errorProps:f,labelProps:m,descriptionProps:g,wrapperProps:b,id:y,size:v,style:E,inputContainer:k,inputWrapperOrder:C,withAsterisk:T,variant:w,vars:x,mod:S,attributes:A,..._}=r,{styleProps:N,rest:M}=RJ(_),I={label:o,description:i,error:s,required:l,classNames:a,className:d,__staticSelector:h,__stylesApiProps:p||r,errorProps:f,labelProps:m,descriptionProps:g,unstyled:u,styles:c,size:v,style:E,inputContainer:k,inputWrapperOrder:C,withAsterisk:T,variant:w,id:y,mod:S,attributes:A,...b};return{...M,classNames:a,styles:c,unstyled:u,wrapperProps:{...I,...N},inputProps:{required:l,classNames:a,styles:c,unstyled:u,size:v,__staticSelector:h,__stylesApiProps:p||r,error:s,variant:w,id:y,attributes:A}}}("InputBase",By,e);return(0,Z.jsx)(Bb.Wrapper,{...r,children:(0,Z.jsx)(Bb,{...n,...o,ref:t})})});Bv.classes={...Bb.classes,...Bb.Wrapper.classes},Bv.displayName="@mantine/core/InputBase";let BE=Lt((e,t)=>{let n=RP("TextInput",null,e);return(0,Z.jsx)(Bv,{component:"input",ref:t,...n,__staticSelector:"TextInput"})});function Bk(e,t){let n=e;for(;(n=n.parentElement)&&!n.matches(t););return n}function BC({open:e,close:t,openDelay:n,closeDelay:r}){let o=(0,X.useRef)(-1),i=(0,X.useRef)(-1),s=()=>{window.clearTimeout(o.current),window.clearTimeout(i.current)};return(0,X.useEffect)(()=>s,[]),{openDropdown:()=>{s(),0===n||void 0===n?e():o.current=window.setTimeout(e,n)},closeDropdown:()=>{s(),0===r||void 0===r?t():i.current=window.setTimeout(t,r)}}}BE.classes=Bv.classes,BE.displayName="@mantine/core/TextInput";let BT=["mousedown","touchstart"];var Bw={root:"m_9814e45f"};let Bx={zIndex:Lj.modal},BS=(e,{gradient:t,color:n,backgroundOpacity:r,blur:o,radius:i,zIndex:s})=>({root:{"--overlay-bg":t||(void 0!==n||void 0!==r)&&RS(n||"#000",r??.6)||void 0,"--overlay-filter":o?`blur(${Ra(o)})`:void 0,"--overlay-radius":void 0===i?void 0:Rp(i),"--overlay-z-index":s?.toString()}}),BA=Ln((e,t)=>{let n=RP("Overlay",Bx,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,vars:a,fixed:c,center:d,children:u,radius:h,zIndex:p,gradient:f,blur:m,color:g,backgroundOpacity:b,mod:y,attributes:v,...E}=n,k=RW({name:"Overlay",props:n,classes:Bw,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:v,vars:a,varsResolver:BS});return(0,Z.jsx)(R7,{ref:t,...k("root"),mod:[{center:d,fixed:c},y],...E,children:u})});BA.classes=Bw,BA.displayName="@mantine/core/Overlay";let[B_,BN]=PL("Popover component was not found in the tree"),BM=()=>{},BI=/input|select|textarea|button|object/,BO="a, input, select, textarea, button, object, [tabindex]";function BD(e){let t=e.getAttribute("tabindex");return null===t&&(t=void 0),parseInt(t,10)}function BR(e){let t=e.nodeName.toLowerCase(),n=!Number.isNaN(BD(e));return(BI.test(t)&&!e.disabled||e instanceof HTMLAnchorElement&&e.href||n)&&function(e){if(e.getAttribute("aria-hidden")||e.getAttribute("hidden")||"hidden"===e.getAttribute("type"))return!1;let t=e;for(;t&&t!==document.body&&11!==t.nodeType;){if("none"===t.style.display)return!1;t=t.parentNode}return!0}(e)}function BL(e){let t=BD(e);return(Number.isNaN(t)||t>=0)&&BR(e)}function BP(e=!0){let t=(0,X.useRef)(null),n=e=>{let t=e.querySelector("[data-autofocus]");if(!t){let n=Array.from(e.querySelectorAll(BO));!(t=n.find(BL)||n.find(BR)||null)&&BR(e)&&(t=e)}t&&t.focus({preventScroll:!0})},r=(0,X.useCallback)(r=>{e&&null!==r&&t.current!==r&&(r?(setTimeout(()=>{r.getRootNode()&&n(r)}),t.current=r):t.current=null)},[e]);return(0,X.useEffect)(()=>{if(!e)return;t.current&&setTimeout(()=>n(t.current));let r=e=>{"Tab"===e.key&&t.current&&function(e,t){let n=Array.from(e.querySelectorAll(BO)).filter(BL);if(!n.length)return t.preventDefault();let r=n[t.shiftKey?0:n.length-1],o=e.getRootNode(),i=r===o.activeElement||e===o.activeElement,s=o.activeElement;if("INPUT"===s.tagName&&"radio"===s.getAttribute("type")&&(i=n.filter(e=>"radio"===e.getAttribute("type")&&e.getAttribute("name")===s.getAttribute("name")).includes(r)),!i)return;t.preventDefault();let l=n[t.shiftKey?n.length-1:0];l&&l.focus()}(t.current,e)};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[e]),r}var BB={root:"m_515a97f8"};let BH=Lt((e,t)=>{let n=RP("VisuallyHidden",null,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,vars:a,attributes:c,...d}=n,u=RW({name:"VisuallyHidden",classes:BB,props:n,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:c});return(0,Z.jsx)(R7,{component:"span",ref:t,...u("root"),...d})});function Bj({children:e,active:t=!0,refProp:n="ref",innerRef:r}){let o=LH(BP(t),r),i=Lz(e);return i?(0,X.cloneElement)(i,{[n]:o}):e}function BF(e){return(0,Z.jsx)(BH,{tabIndex:-1,"data-autofocus":!0,...e})}BH.classes=BB,BH.displayName="@mantine/core/VisuallyHidden",Bj.displayName="@mantine/core/FocusTrap",BF.displayName="@mantine/core/FocusTrapInitialFocus",Bj.InitialFocus=BF;var BU={dropdown:"m_38a85659",arrow:"m_a31dc6c1",overlay:"m_3d7bc908"};let Bz=Lt((e,t)=>{let n=RP("PopoverDropdown",null,e),{className:r,style:o,vars:i,children:s,onKeyDownCapture:l,variant:a,classNames:c,styles:d,...u}=n,h=BN(),p=function({opened:e,shouldReturnFocus:t=!0}){let n=(0,X.useRef)(null),r=()=>{n.current&&"focus"in n.current&&"function"==typeof n.current.focus&&n.current?.focus({preventScroll:!0})};return Lf(()=>{let o=-1,i=e=>{"Tab"===e.key&&window.clearTimeout(o)};return document.addEventListener("keydown",i),e?n.current=document.activeElement:t&&(o=window.setTimeout(r,10)),()=>{window.clearTimeout(o),document.removeEventListener("keydown",i)}},[e,t]),r}({opened:h.opened,shouldReturnFocus:h.returnFocus}),f=h.withRoles?{"aria-labelledby":h.getTargetId(),id:h.getDropdownId(),role:"dialog",tabIndex:-1}:{},m=LH(t,h.floating);return h.disabled?null:(0,Z.jsx)(L0,{...h.portalProps,withinPortal:h.withinPortal,children:(0,Z.jsx)(Lm,{mounted:h.opened,...h.transitionProps,transition:h.transitionProps?.transition||"fade",duration:h.transitionProps?.duration??150,keepMounted:h.keepMounted,exitDuration:"number"==typeof h.transitionProps?.exitDuration?h.transitionProps.exitDuration:h.transitionProps?.duration,children:e=>(0,Z.jsx)(Bj,{active:h.trapFocus&&h.opened,innerRef:m,children:(0,Z.jsxs)(R7,{...f,...u,variant:a,onKeyDownCapture:function(e,t={active:!0}){return"function"==typeof e&&t.active?n=>{"Escape"===n.key&&(e(n),t.onTrigger?.())}:t.onKeyDown||BM}(()=>{h.onClose?.(),h.onDismiss?.()},{active:h.closeOnEscape,onTrigger:p,onKeyDown:l}),"data-position":h.placement,"data-fixed":"fixed"===h.floatingStrategy||void 0,...h.getStyles("dropdown",{className:r,props:n,classNames:c,styles:d,style:[{...e,zIndex:h.zIndex,top:h.y??0,left:h.x??0,width:"target"===h.width?void 0:Ra(h.width),...h.referenceHidden?{display:"none"}:null},h.resolvedStyles.dropdown,d?.dropdown,o]}),children:[s,(0,Z.jsx)(LK,{ref:h.arrowRef,arrowX:h.arrowX,arrowY:h.arrowY,visible:h.withArrow,position:h.placement,arrowSize:h.arrowSize,arrowRadius:h.arrowRadius,arrowOffset:h.arrowOffset,arrowPosition:h.arrowPosition,...h.getStyles("arrow",{props:n,classNames:c,styles:d})})]})})})})});Bz.classes=BU,Bz.displayName="@mantine/core/PopoverDropdown";let BV={refProp:"ref",popupType:"dialog"},B$=Lt((e,t)=>{let{children:n,refProp:r,popupType:o,...i}=RP("PopoverTarget",BV,e),s=Lz(n);if(!s)throw Error("Popover.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");let l=BN(),a=LH(l.reference,LF(s),t),c=l.withRoles?{"aria-haspopup":o,"aria-expanded":l.opened,"aria-controls":l.getDropdownId(),id:l.getTargetId()}:{},d=s.props;return(0,X.cloneElement)(s,{...i,...c,...l.targetProps,className:(0,Rg.default)(l.targetProps.className,i.className,d.className),[r]:a,...!l.controlled?{onClick:()=>{l.onToggle(),d.onClick?.()}}:null})});B$.displayName="@mantine/core/PopoverTarget";let BG={position:"bottom",offset:8,positionDependencies:[],transitionProps:{transition:"fade",duration:150},middlewares:{flip:!0,shift:!0,inline:!1},arrowSize:7,arrowOffset:5,arrowRadius:0,arrowPosition:"side",closeOnClickOutside:!0,withinPortal:!0,closeOnEscape:!0,trapFocus:!1,withRoles:!0,returnFocus:!1,withOverlay:!1,hideDetached:!0,clickOutsideEvents:["mousedown","touchstart"],zIndex:Lj.popover,__staticSelector:"Popover",width:"max-content"},Bq=(e,{radius:t,shadow:n})=>({dropdown:{"--popover-radius":void 0===t?void 0:Rp(t),"--popover-shadow":Rm(n)}});function BW(e){var t,n;let r,o,i=RP("Popover",BG,e),{children:s,position:l,offset:a,onPositionChange:c,positionDependencies:d,opened:u,transitionProps:h,onExitTransitionEnd:p,onEnterTransitionEnd:f,width:m,middlewares:g,withArrow:b,arrowSize:y,arrowOffset:v,arrowRadius:E,arrowPosition:k,unstyled:C,classNames:T,styles:w,closeOnClickOutside:x,withinPortal:S,portalProps:A,closeOnEscape:_,clickOutsideEvents:N,trapFocus:M,onClose:I,onDismiss:O,onOpen:D,onChange:R,zIndex:L,radius:P,shadow:B,id:H,defaultOpened:j,__staticSelector:F,withRoles:U,disabled:z,returnFocus:V,variant:$,keepMounted:G,vars:q,floatingStrategy:W,withOverlay:Y,overlayProps:K,hideDetached:Q,attributes:J,preventPositionChangeWhenVisible:ee,...et}=i,en=RW({name:F,props:i,classes:BU,classNames:T,styles:w,unstyled:C,attributes:J,rootSelector:"dropdown",vars:q,varsResolver:Bq}),{resolvedStyles:er}=P4({classNames:T,styles:w,props:i}),[eo,ei]=(0,X.useState)(u??j??!1),es=(0,X.useRef)(l),el=(0,X.useRef)(null),[ea,ec]=(0,X.useState)(null),[ed,eu]=(0,X.useState)(null),{dir:eh}=LG(),ep=RF(),ef=Pn(H),em=function(e){var t;let n,r,o=RF(),[i,s]=Py({value:e.opened,defaultValue:e.defaultOpened,finalValue:!1,onChange:e.onChange}),l=(0,X.useRef)(i),a=xJ({strategy:e.strategy,placement:e.preventPositionChangeWhenVisible?e.positionRef.current:e.position,middleware:(t=()=>a,n=function(e){if(void 0===e)return{shift:!0,flip:!0};let t={...e};return void 0===e.shift&&(t.shift=!0),void 0===e.flip&&(t.flip=!0),t}(e.middlewares),r=[(0,xA.offset)(e.offset),(0,xA.hide)()],e.dropdownVisible&&"test"!==o&&e.preventPositionChangeWhenVisible&&(n.flip=!1),n.shift&&r.push((0,xA.shift)("boolean"==typeof n.shift?{limiter:(0,xA.limitShift)(),padding:5}:{limiter:(0,xA.limitShift)(),padding:5,...n.shift})),n.flip&&r.push("boolean"==typeof n.flip?(0,xA.flip)():(0,xA.flip)(n.flip)),n.inline&&r.push("boolean"==typeof n.inline?(0,xA.inline)():(0,xA.inline)(n.inline)),r.push((0,xA.arrow)({element:e.arrowRef,padding:e.arrowOffset})),(n.size||"target"===e.width)&&r.push((0,xA.size)({..."boolean"==typeof n.size?{}:n.size,apply({rects:r,availableWidth:o,availableHeight:i,...s}){let l=t(),a=l.refs.floating.current?.style??{};n.size&&("object"==typeof n.size&&n.size.apply?n.size.apply({rects:r,availableWidth:o,availableHeight:i,...s}):Object.assign(a,{maxWidth:`${o}px`,maxHeight:`${i}px`})),"target"===e.width&&Object.assign(a,{width:`${r.reference.width}px`})}})),r),whileElementsMounted:e.keepMounted?void 0:x_.autoUpdate});return(0,X.useEffect)(()=>{if(a.refs.reference.current&&a.refs.floating.current&&i)return(0,x_.autoUpdate)(a.refs.reference.current,a.refs.floating.current,a.update)},[i,a.update]),Lf(()=>{e.onPositionChange?.(a.placement),e.positionRef.current=a.placement},[a.placement,e.preventPositionChangeWhenVisible]),Lf(()=>{i!==l.current&&(i?e.onOpen?.():e.onClose?.()),l.current=i},[i,e.onClose,e.onOpen]),LV(()=>{let t=-1;return i&&(t=window.setTimeout(()=>e.setDropdownVisible(!0),4)),()=>{window.clearTimeout(t)}},[i,e.position]),{floating:a,controlled:"boolean"==typeof e.opened,opened:i,onClose:()=>{i&&!e.disabled&&s(!1)},onToggle:()=>{e.disabled||s(!i)}}}({middlewares:g,width:m,position:LZ(eh,l),offset:"number"==typeof a?a+(b?y/2:0):a,arrowRef:el,arrowOffset:v,onPositionChange:c,positionDependencies:d,opened:u,defaultOpened:j,onChange:R,onOpen:D,onClose:I,onDismiss:O,strategy:W,dropdownVisible:eo,setDropdownVisible:ei,positionRef:es,disabled:z,preventPositionChangeWhenVisible:ee,keepMounted:G});t=()=>{x&&(em.onClose(),O?.())},n=[ea,ed],r=(0,X.useRef)(null),o=N||BT,(0,X.useEffect)(()=>{let e=e=>{let{target:o}=e??{};if(Array.isArray(n)){let r=!document.body.contains(o)&&o?.tagName!=="HTML";n.every(t=>!!t&&!e.composedPath().includes(t))&&!r&&t(e)}else r.current&&!r.current.contains(o)&&t(e)};return o.forEach(t=>document.addEventListener(t,e)),()=>{o.forEach(t=>document.removeEventListener(t,e))}},[r,t,n]);let eg=(0,X.useCallback)(e=>{ec(e),em.floating.refs.setReference(e)},[em.floating.refs.setReference]),eb=(0,X.useCallback)(e=>{eu(e),em.floating.refs.setFloating(e)},[em.floating.refs.setFloating]),ey=(0,X.useCallback)(()=>{h?.onExited?.(),p?.(),ei(!1),ee||(es.current=l)},[h?.onExited,p,ee,l]),ev=(0,X.useCallback)(()=>{h?.onEntered?.(),f?.()},[h?.onEntered,f]);return(0,Z.jsxs)(B_,{value:{returnFocus:V,disabled:z,controlled:em.controlled,reference:eg,floating:eb,x:em.floating.x,y:em.floating.y,arrowX:em.floating?.middlewareData?.arrow?.x,arrowY:em.floating?.middlewareData?.arrow?.y,opened:em.opened,arrowRef:el,transitionProps:{...h,onExited:ey,onEntered:ev},width:m,withArrow:b,arrowSize:y,arrowOffset:v,arrowRadius:E,arrowPosition:k,placement:em.floating.placement,trapFocus:M,withinPortal:S,portalProps:A,zIndex:L,radius:P,shadow:B,closeOnEscape:_,onDismiss:O,onClose:em.onClose,onToggle:em.onToggle,getTargetId:()=>`${ef}-target`,getDropdownId:()=>`${ef}-dropdown`,withRoles:U,targetProps:et,__staticSelector:F,classNames:T,styles:w,unstyled:C,variant:$,keepMounted:G,getStyles:en,resolvedStyles:er,floatingStrategy:W,referenceHidden:!!Q&&"test"!==ep&&em.floating.middlewareData.hide?.referenceHidden},children:[s,Y&&(0,Z.jsx)(Lm,{transition:"fade",mounted:em.opened,duration:h?.duration||250,exitDuration:h?.exitDuration||250,children:e=>(0,Z.jsx)(L0,{withinPortal:S,children:(0,Z.jsx)(BA,{...K,...en("overlay",{className:K?.className,style:[e,K?.style]})})})})]})}BW.Target=B$,BW.Dropdown=Bz,BW.displayName="@mantine/core/Popover",BW.extend=e=>e;let[BY,BK]=PL("Menu component was not found in the tree");var BZ={dropdown:"m_dc9b7c9f",label:"m_9bfac126",divider:"m_efdf90cb",item:"m_99ac2aa1",itemLabel:"m_5476e0d3",itemSection:"m_8b75e504",chevron:"m_b85b0bed"};let BX=Lt((e,t)=>{let{classNames:n,className:r,style:o,styles:i,vars:s,...l}=RP("MenuDivider",null,e),a=BK();return(0,Z.jsx)(R7,{ref:t,...a.getStyles("divider",{className:r,style:o,styles:i,classNames:n}),...l})});function BQ(e,t){return n=>{e?.(n),t?.(n)}}BX.classes=BZ,BX.displayName="@mantine/core/MenuDivider";let BJ=Lt((e,t)=>{let{classNames:n,className:r,style:o,styles:i,vars:s,onMouseEnter:l,onMouseLeave:a,onKeyDown:c,children:d,...u}=RP("MenuDropdown",null,e),h=(0,X.useRef)(null),p=BK(),f=BQ(c,e=>{("ArrowUp"===e.key||"ArrowDown"===e.key)&&(e.preventDefault(),h.current?.querySelectorAll("[data-menu-item]:not(:disabled)")[0]?.focus())}),m=BQ(l,()=>("hover"===p.trigger||"click-hover"===p.trigger)&&p.openDropdown()),g=BQ(a,()=>("hover"===p.trigger||"click-hover"===p.trigger)&&p.closeDropdown());return(0,Z.jsxs)(BW.Dropdown,{...u,onMouseEnter:m,onMouseLeave:g,role:"menu","aria-orientation":"vertical",ref:LH(t,h),...p.getStyles("dropdown",{className:r,style:o,styles:i,classNames:n,withStaticClass:!1}),tabIndex:-1,"data-menu-dropdown":!0,onKeyDown:f,children:[p.withInitialFocusPlaceholder&&(0,Z.jsx)("div",{tabIndex:-1,"data-autofocus":!0,"data-mantine-stop-propagation":!0,style:{outline:0}}),d]})});function B0({parentSelector:e,siblingSelector:t,onKeyDown:n,loop:r=!0,activateOnFocus:o=!1,dir:i="rtl",orientation:s}){return l=>{n?.(l);let a=Array.from(Bk(l.currentTarget,e)?.querySelectorAll(t)||[]).filter(t=>{var n;return n=l.currentTarget,Bk(n,e)===Bk(t,e)}),c=a.findIndex(e=>l.currentTarget===e),d=function(e,t,n){for(let n=e+1;n<t.length;n+=1)if(!t[n].disabled)return n;if(n){for(let e=0;e<t.length;e+=1)if(!t[e].disabled)return e}return e}(c,a,r),u=function(e,t,n){for(let n=e-1;n>=0;n-=1)if(!t[n].disabled)return n;if(n){for(let e=t.length-1;e>-1;e-=1)if(!t[e].disabled)return e}return e}(c,a,r),h="rtl"===i?u:d,p="rtl"===i?d:u;switch(l.key){case"ArrowRight":"horizontal"===s&&(l.stopPropagation(),l.preventDefault(),a[h].focus(),o&&a[h].click());break;case"ArrowLeft":"horizontal"===s&&(l.stopPropagation(),l.preventDefault(),a[p].focus(),o&&a[p].click());break;case"ArrowUp":"vertical"===s&&(l.stopPropagation(),l.preventDefault(),a[u].focus(),o&&a[u].click());break;case"ArrowDown":"vertical"===s&&(l.stopPropagation(),l.preventDefault(),a[d].focus(),o&&a[d].click());break;case"Home":l.stopPropagation(),l.preventDefault(),a[0].disabled||a[0].focus();break;case"End":{l.stopPropagation(),l.preventDefault();let e=a.length-1;a[e].disabled||a[e].focus()}}}}BJ.classes=BZ,BJ.displayName="@mantine/core/MenuDropdown";let[B1,B2]=PE(),B4=Ln((e,t)=>{let{classNames:n,className:r,style:o,styles:i,vars:s,color:l,closeMenuOnClick:a,leftSection:c,rightSection:d,children:u,disabled:h,"data-disabled":p,...f}=RP("MenuItem",null,e),m=BK(),g=B2(),b=RR(),{dir:y}=LG(),v=(0,X.useRef)(null),E=BQ(f.onClick,()=>{!p&&("boolean"==typeof a?a&&m.closeDropdownImmediately():m.closeOnItemClick&&m.closeDropdownImmediately())}),k=l?b.variantColorResolver({color:l,theme:b,variant:"light"}):void 0,C=l?RT({color:l,theme:b}):null,T=BQ(f.onKeyDown,e=>{"ArrowLeft"===e.key&&g&&(g.close(),g.focusParentItem())});return(0,Z.jsxs)(Ly,{onMouseDown:e=>e.preventDefault(),...f,unstyled:m.unstyled,tabIndex:m.menuItemTabIndex,...m.getStyles("item",{className:r,style:o,styles:i,classNames:n}),ref:LH(v,t),role:"menuitem",disabled:h,"data-menu-item":!0,"data-disabled":h||p||void 0,"data-mantine-stop-propagation":!0,onClick:E,onKeyDown:B0({siblingSelector:"[data-menu-item]:not([data-disabled])",parentSelector:"[data-menu-dropdown]",activateOnFocus:!1,loop:m.loop,dir:y,orientation:"vertical",onKeyDown:T}),__vars:{"--menu-item-color":C?.isThemeColor&&C?.shade===void 0?`var(--mantine-color-${C.color}-6)`:k?.color,"--menu-item-hover":k?.hover},children:[c&&(0,Z.jsx)("div",{...m.getStyles("itemSection",{styles:i,classNames:n}),"data-position":"left",children:c}),u&&(0,Z.jsx)("div",{...m.getStyles("itemLabel",{styles:i,classNames:n}),children:u}),d&&(0,Z.jsx)("div",{...m.getStyles("itemSection",{styles:i,classNames:n}),"data-position":"right",children:d})]})});B4.classes=BZ,B4.displayName="@mantine/core/MenuItem";let B5=Lt((e,t)=>{let{classNames:n,className:r,style:o,styles:i,vars:s,...l}=RP("MenuLabel",null,e),a=BK();return(0,Z.jsx)(R7,{ref:t,...a.getStyles("label",{className:r,style:o,styles:i,classNames:n}),...l})});B5.classes=BZ,B5.displayName="@mantine/core/MenuLabel";let B3=Lt((e,t)=>{let{classNames:n,className:r,style:o,styles:i,vars:s,onMouseEnter:l,onMouseLeave:a,onKeyDown:c,children:d,...u}=RP("MenuSubDropdown",null,e),h=(0,X.useRef)(null),p=BK(),f=B2(),m=BQ(l,f?.open),g=BQ(a,f?.close);return(0,Z.jsx)(BW.Dropdown,{...u,onMouseEnter:m,onMouseLeave:g,role:"menu","aria-orientation":"vertical",ref:LH(t,h),...p.getStyles("dropdown",{className:r,style:o,styles:i,classNames:n,withStaticClass:!1}),tabIndex:-1,"data-menu-dropdown":!0,children:d})});function B8({style:e,size:t=16,...n}){return(0,Z.jsx)("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...e,width:Ra(t),height:Ra(t),display:"block"},...n,children:(0,Z.jsx)("path",{d:"M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}B3.classes=BZ,B3.displayName="@mantine/core/MenuSubDropdown",B8.displayName="@mantine/core/AccordionChevron";let B6=Ln((e,t)=>{let{classNames:n,className:r,style:o,styles:i,vars:s,color:l,leftSection:a,rightSection:c,children:d,disabled:u,"data-disabled":h,closeMenuOnClick:p,...f}=RP("MenuSubItem",null,e),m=BK(),g=B2(),b=RR(),{dir:y}=LG(),v=(0,X.useRef)(null),E=l?b.variantColorResolver({color:l,theme:b,variant:"light"}):void 0,k=l?RT({color:l,theme:b}):null,C=BQ(f.onKeyDown,e=>{"ArrowRight"===e.key&&(g?.open(),g?.focusFirstItem()),"ArrowLeft"===e.key&&g?.parentContext&&(g.parentContext.close(),g.parentContext.focusParentItem())}),T=BQ(f.onClick,()=>{!h&&p&&m.closeDropdownImmediately()}),w=BQ(f.onMouseEnter,g?.open),x=BQ(f.onMouseLeave,g?.close);return(0,Z.jsxs)(Ly,{onMouseDown:e=>e.preventDefault(),...f,unstyled:m.unstyled,tabIndex:m.menuItemTabIndex,...m.getStyles("item",{className:r,style:o,styles:i,classNames:n}),ref:LH(v,t),role:"menuitem",disabled:u,"data-menu-item":!0,"data-sub-menu-item":!0,"data-disabled":u||h||void 0,"data-mantine-stop-propagation":!0,onMouseEnter:w,onMouseLeave:x,onClick:T,onKeyDown:B0({siblingSelector:"[data-menu-item]:not([data-disabled])",parentSelector:"[data-menu-dropdown]",activateOnFocus:!1,loop:m.loop,dir:y,orientation:"vertical",onKeyDown:C}),__vars:{"--menu-item-color":k?.isThemeColor&&k?.shade===void 0?`var(--mantine-color-${k.color}-6)`:E?.color,"--menu-item-hover":E?.hover},children:[a&&(0,Z.jsx)("div",{...m.getStyles("itemSection",{styles:i,classNames:n}),"data-position":"left",children:a}),d&&(0,Z.jsx)("div",{...m.getStyles("itemLabel",{styles:i,classNames:n}),children:d}),(0,Z.jsx)("div",{...m.getStyles("itemSection",{styles:i,classNames:n}),"data-position":"right",children:c||(0,Z.jsx)(B8,{...m.getStyles("chevron"),size:14})})]})});function B9({children:e,refProp:t}){if(!LU(e))throw Error("Menu.Sub.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");return BK(),(0,Z.jsx)(BW.Target,{refProp:t,popupType:"menu",children:e})}B6.classes=BZ,B6.displayName="@mantine/core/MenuSubItem",B9.displayName="@mantine/core/MenuSubTarget";let B7={offset:0,position:"right-start",transitionProps:{duration:0},openDelay:0,middlewares:{shift:{crossAxis:!0}}};function He(e){let{children:t,closeDelay:n,openDelay:r,...o}=RP("MenuSub",B7,e),i=Pn(),[s,{open:l,close:a}]=function(e=!1,t={}){let[n,r]=(0,X.useState)(e),o=(0,X.useCallback)(()=>{r(e=>e||(t.onOpen?.(),!0))},[t.onOpen]),i=(0,X.useCallback)(()=>{r(e=>e?(t.onClose?.(),!1):e)},[t.onClose]),s=(0,X.useCallback)(()=>{n?i():o()},[i,o,n]);return[n,{open:o,close:i,toggle:s}]}(!1),c=B2(),{openDropdown:d,closeDropdown:u}=BC({open:l,close:a,closeDelay:n,openDelay:r});return(0,Z.jsx)(B1,{value:{opened:s,close:u,open:d,focusFirstItem:()=>window.setTimeout(()=>{document.getElementById(`${i}-dropdown`)?.querySelectorAll("[data-menu-item]:not([data-disabled])")[0]?.focus()},16),focusParentItem:()=>window.setTimeout(()=>{document.getElementById(`${i}-target`)?.focus()},16),parentContext:c},children:(0,Z.jsx)(BW,{opened:s,withinPortal:!1,withArrow:!1,id:i,...o,children:t})})}He.extend=e=>e,He.displayName="@mantine/core/MenuSub",He.Target=B9,He.Dropdown=B3,He.Item=B6;let Ht={refProp:"ref"},Hn=(0,X.forwardRef)((e,t)=>{let{children:n,refProp:r,...o}=RP("MenuTarget",Ht,e),i=Lz(n);if(!i)throw Error("Menu.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");let s=BK(),l=i.props,a=BQ(l.onClick,()=>{"click"===s.trigger?s.toggleDropdown():"click-hover"===s.trigger&&(s.setOpenedViaClick(!0),s.opened||s.openDropdown())}),c=BQ(l.onMouseEnter,()=>("hover"===s.trigger||"click-hover"===s.trigger)&&s.openDropdown()),d=BQ(l.onMouseLeave,()=>{"hover"===s.trigger?s.closeDropdown():"click-hover"!==s.trigger||s.openedViaClick||s.closeDropdown()});return(0,Z.jsx)(BW.Target,{refProp:r,popupType:"menu",ref:t,...o,children:(0,X.cloneElement)(i,{onClick:a,onMouseEnter:c,onMouseLeave:d,"data-expanded":!!s.opened||void 0})})});Hn.displayName="@mantine/core/MenuTarget";let Hr={trapFocus:!0,closeOnItemClick:!0,withInitialFocusPlaceholder:!0,clickOutsideEvents:["mousedown","touchstart","keydown"],loop:!0,trigger:"click",openDelay:0,closeDelay:100,menuItemTabIndex:-1};function Ho(e){let t=RP("Menu",Hr,e),{children:n,onOpen:r,onClose:o,opened:i,defaultOpened:s,trapFocus:l,onChange:a,closeOnItemClick:c,loop:d,closeOnEscape:u,trigger:h,openDelay:p,closeDelay:f,classNames:m,styles:g,unstyled:b,variant:y,vars:v,menuItemTabIndex:E,keepMounted:k,withInitialFocusPlaceholder:C,attributes:T,...w}=t,x=RW({name:"Menu",classes:BZ,props:t,classNames:m,styles:g,unstyled:b,attributes:T}),[S,A]=Py({value:i,defaultValue:s,finalValue:!1,onChange:a}),[_,N]=(0,X.useState)(!1),M=()=>{A(!1),N(!1),S&&o?.()},I=()=>{A(!0),S||r?.()},O=()=>{S?M():I()},{openDropdown:D,closeDropdown:R}=BC({open:I,close:M,closeDelay:f,openDelay:p}),{resolvedClassNames:L,resolvedStyles:P}=P4({classNames:m,styles:g,props:t});return(0,Z.jsx)(BY,{value:{getStyles:x,opened:S,toggleDropdown:O,getItemIndex:e=>e?Array.from(Bk(e,"[data-menu-dropdown]")?.querySelectorAll("[data-menu-item]")||[]).findIndex(t=>t===e):null,openedViaClick:_,setOpenedViaClick:N,closeOnItemClick:c,closeDropdown:"click"===h?M:R,openDropdown:"click"===h?I:D,closeDropdownImmediately:M,loop:d,trigger:h,unstyled:b,menuItemTabIndex:E,withInitialFocusPlaceholder:C},children:(0,Z.jsx)(BW,{returnFocus:!0,...w,opened:S,onChange:O,defaultOpened:s,trapFocus:!k&&l,closeOnEscape:u,__staticSelector:"Menu",classNames:L,styles:P,unstyled:b,variant:y,keepMounted:k,children:n})})}function Hi(e,t){return n=>{if("string"!=typeof n||0===n.trim().length)throw Error(t);return`${e}-${n}`}}function Hs({color:e,theme:t,autoContrast:n}){return("boolean"==typeof n?n:t.autoContrast)&&RT({color:e||t.primaryColor,theme:t}).isLight?"var(--mantine-color-black)":"var(--mantine-color-white)"}function Hl(e,t){return Hs({color:e.colors[e.primaryColor][RE(e,t)],theme:e,autoContrast:null})}Ho.extend=e=>e,Ho.withProps=e=>{let t=(0,X.forwardRef)((t,n)=>(0,Z.jsx)(Ho,{...e,...t,ref:n}));return t.extend=Ho.extend,t.displayName=`WithProps(${Ho.displayName})`,t},Ho.classes=BZ,Ho.displayName="@mantine/core/Menu",Ho.Item=B4,Ho.Label=B5,Ho.Dropdown=BJ,Ho.Target=Hn,Ho.Divider=BX,Ho.Sub=He;let[Ha,Hc]=PL("Tabs component was not found in the tree");var Hd={root:"m_89d60db1","list--default":"m_576c9d4",list:"m_89d33d6d",tab:"m_4ec4dce6",panel:"m_b0c91715",tabSection:"m_fc420b1f",tabLabel:"m_42bbd1ae","tab--default":"m_539e827b","list--outline":"m_6772fbd5","tab--outline":"m_b59ab47c","tab--pills":"m_c3381914"};let Hu=Lt((e,t)=>{let n=RP("TabsList",null,e),{children:r,className:o,grow:i,justify:s,classNames:l,styles:a,style:c,mod:d,...u}=n,h=Hc();return(0,Z.jsx)(R7,{...u,...h.getStyles("list",{className:o,style:c,classNames:l,styles:a,props:n,variant:h.variant}),ref:t,role:"tablist",variant:h.variant,mod:[{grow:i,orientation:h.orientation,placement:"vertical"===h.orientation&&h.placement,inverted:h.inverted},d],"aria-orientation":h.orientation,__vars:{"--tabs-justify":s},children:r})});Hu.classes=Hd,Hu.displayName="@mantine/core/TabsList";let Hh=Lt((e,t)=>{let n=RP("TabsPanel",null,e),{children:r,className:o,value:i,classNames:s,styles:l,style:a,mod:c,keepMounted:d,...u}=n,h=Hc(),p=h.value===i,f=h.keepMounted||d||p?r:null;return(0,Z.jsx)(R7,{...h.getStyles("panel",{className:o,classNames:s,styles:l,style:[a,p?void 0:{display:"none"}],props:n}),ref:t,mod:[{orientation:h.orientation},c],role:"tabpanel",id:h.getPanelId(i),"aria-labelledby":h.getTabId(i),...u,children:f})});Hh.classes=Hd,Hh.displayName="@mantine/core/TabsPanel";let Hp=Lt((e,t)=>{let n=RP("TabsTab",null,e),{className:r,children:o,rightSection:i,leftSection:s,value:l,onClick:a,onKeyDown:c,disabled:d,color:u,style:h,classNames:p,styles:f,vars:m,mod:g,tabIndex:b,...y}=n,v=RR(),{dir:E}=LG(),k=Hc(),C=l===k.value,T={classNames:p,styles:f,props:n};return(0,Z.jsxs)(Ly,{...k.getStyles("tab",{className:r,style:h,variant:k.variant,...T}),disabled:d,unstyled:k.unstyled,variant:k.variant,mod:[{active:C,disabled:d,orientation:k.orientation,inverted:k.inverted,placement:"vertical"===k.orientation&&k.placement},g],ref:t,role:"tab",id:k.getTabId(l),"aria-selected":C,tabIndex:void 0!==b?b:C||null===k.value?0:-1,"aria-controls":k.getPanelId(l),onClick:e=>{k.onChange(k.allowTabDeactivation&&l===k.value?null:l),a?.(e)},__vars:{"--tabs-color":u?Rw(u,v):void 0},onKeyDown:B0({siblingSelector:'[role="tab"]',parentSelector:'[role="tablist"]',activateOnFocus:k.activateTabWithKeyboard,loop:k.loop,orientation:k.orientation||"horizontal",dir:E,onKeyDown:c}),...y,children:[s&&(0,Z.jsx)("span",{...k.getStyles("tabSection",T),"data-position":"left",children:s}),o&&(0,Z.jsx)("span",{...k.getStyles("tabLabel",T),children:o}),i&&(0,Z.jsx)("span",{...k.getStyles("tabSection",T),"data-position":"right",children:i})]})});Hp.classes=Hd,Hp.displayName="@mantine/core/TabsTab";let Hf="Tabs.Tab or Tabs.Panel component was rendered with invalid value or without value",Hm={keepMounted:!0,orientation:"horizontal",loop:!0,activateTabWithKeyboard:!0,variant:"default",placement:"left"},Hg=(e,{radius:t,color:n,autoContrast:r})=>({root:{"--tabs-radius":Rp(t),"--tabs-color":Rw(n,e),"--tabs-text-color":("boolean"==typeof r?r:e.autoContrast)?Hs({color:n,theme:e,autoContrast:r}):void 0}}),Hb=Lt((e,t)=>{let n=RP("Tabs",Hm,e),{defaultValue:r,value:o,onChange:i,orientation:s,children:l,loop:a,id:c,activateTabWithKeyboard:d,allowTabDeactivation:u,variant:h,color:p,radius:f,inverted:m,placement:g,keepMounted:b,classNames:y,styles:v,unstyled:E,className:k,style:C,vars:T,autoContrast:w,mod:x,attributes:S,...A}=n,_=Pn(c),[N,M]=Py({value:o,defaultValue:r,finalValue:null,onChange:i}),I=RW({name:"Tabs",props:n,classes:Hd,className:k,style:C,classNames:y,styles:v,unstyled:E,attributes:S,vars:T,varsResolver:Hg});return(0,Z.jsx)(Ha,{value:{placement:g,value:N,orientation:s,id:_,loop:a,activateTabWithKeyboard:d,getTabId:Hi(`${_}-tab`,Hf),getPanelId:Hi(`${_}-panel`,Hf),onChange:M,allowTabDeactivation:u,variant:h,color:p,radius:f,inverted:m,keepMounted:b,unstyled:E,getStyles:I},children:(0,Z.jsx)(R7,{ref:t,id:_,variant:h,mod:[{orientation:s,inverted:"horizontal"===s&&m,placement:"vertical"===s&&g},x],...I("root"),...A,children:l})})});Hb.classes=Hd,Hb.displayName="@mantine/core/Tabs",Hb.Tab=Hp,Hb.Panel=Hh,Hb.List=Hu;var Hy={root:"m_6e45937b",loader:"m_e8eb006c",overlay:"m_df587f17"};let Hv={transitionProps:{transition:"fade",duration:0},overlayProps:{backgroundOpacity:.75},zIndex:Lj.overlay},HE=(e,{zIndex:t})=>({root:{"--lo-z-index":t?.toString()}}),Hk=Lt((e,t)=>{let n=RP("LoadingOverlay",Hv,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,vars:a,transitionProps:c,loaderProps:d,overlayProps:u,visible:h,zIndex:p,attributes:f,...m}=n,g=RR(),b=RW({name:"LoadingOverlay",classes:Hy,props:n,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:f,vars:a,varsResolver:HE}),y={...Hv.overlayProps,...u};return(0,Z.jsx)(Lm,{transition:"fade",...c,mounted:!!h,children:e=>(0,Z.jsxs)(R7,{...b("root",{style:e}),ref:t,...m,children:[(0,Z.jsx)(Ld,{...b("loader"),unstyled:l,...d}),(0,Z.jsx)(BA,{...y,...b("overlay"),darkHidden:!0,unstyled:l,color:u?.color||g.white}),(0,Z.jsx)(BA,{...y,...b("overlay"),lightHidden:!0,unstyled:l,color:u?.color||g.colors.dark[5]})]})})});Hk.classes=Hy,Hk.displayName="@mantine/core/LoadingOverlay";let HC={multiple:!1},HT=(0,X.forwardRef)((e,t)=>{let{onChange:n,children:r,multiple:o,accept:i,name:s,form:l,resetRef:a,disabled:c,capture:d,inputProps:u,...h}=RP("FileButton",HC,e),p=(0,X.useRef)(null);return LP(a,()=>{p.current&&(p.current.value="")}),(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("input",{style:{display:"none"},type:"file",accept:i,multiple:o,onChange:e=>{if(null===e.currentTarget.files)return n(o?[]:null);o?n(Array.from(e.currentTarget.files)):n(e.currentTarget.files[0]||null)},ref:LH(t,p),name:s,form:l,capture:d,...u}),r({onClick:()=>{c||p.current?.click()},...h})]})});HT.displayName="@mantine/core/FileButton";let Hw={valueComponent:({value:e})=>(0,Z.jsx)("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Array.isArray(e)?e.map(e=>e.name).join(", "):e?.name})},Hx=Lt((e,t)=>{let n=RP("FileInput",Hw,e),{unstyled:r,vars:o,onChange:i,value:s,defaultValue:l,multiple:a,accept:c,name:d,form:u,valueComponent:h,clearable:p,clearButtonProps:f,readOnly:m,capture:g,fileInputProps:b,rightSection:y,size:v,placeholder:E,component:k,resetRef:C,classNames:T,styles:w,attributes:x,...S}=n,A=(0,X.useRef)(null),{resolvedClassNames:_,resolvedStyles:N}=P4({classNames:T,styles:w,props:n}),[M,I]=Py({value:s,defaultValue:l,onChange:i,finalValue:a?[]:null}),O=Array.isArray(M)?0!==M.length:null!==M,D=y||(p&&O&&!m?(0,Z.jsx)(P9,{...f,variant:"subtle",onClick:()=>I(a?[]:null),size:v,unstyled:r}):null);return(0,X.useEffect)(()=>{(Array.isArray(M)&&0===M.length||null===M)&&A.current?.()},[M]),(0,Z.jsx)(HT,{onChange:I,multiple:a,accept:c,name:d,form:u,resetRef:LH(A,C),disabled:m,capture:g,inputProps:b,children:e=>(0,Z.jsx)(Bv,{component:k||"button",ref:t,rightSection:D,...e,...S,__staticSelector:"FileInput",multiline:!0,type:"button",pointer:!0,__stylesApiProps:n,unstyled:r,size:v,classNames:T,styles:w,attributes:x,children:O?(0,Z.jsx)(h,{value:M}):(0,Z.jsx)(Bb.Placeholder,{__staticSelector:"FileInput",classNames:_,styles:N,attributes:x,children:E})})})});Hx.classes=Bv.classes,Hx.displayName="@mantine/core/FileInput";var HS={root:"m_347db0ec","root--dot":"m_fbd81e3d",label:"m_5add502a",section:"m_91fdda9b"};let HA=(e,{radius:t,color:n,gradient:r,variant:o,size:i,autoContrast:s,circle:l})=>{let a=e.variantColorResolver({color:n||e.primaryColor,theme:e,gradient:r,variant:o||"filled",autoContrast:s});return{root:{"--badge-height":Ru(i,"badge-height"),"--badge-padding-x":Ru(i,"badge-padding-x"),"--badge-fz":Ru(i,"badge-fz"),"--badge-radius":l||void 0===t?void 0:Rp(t),"--badge-bg":n||o?a.background:void 0,"--badge-color":n||o?a.color:void 0,"--badge-bd":n||o?a.border:void 0,"--badge-dot-color":"dot"===o?Rw(n,e):void 0}}},H_=Ln((e,t)=>{let n=RP("Badge",null,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,vars:a,radius:c,color:d,gradient:u,leftSection:h,rightSection:p,children:f,variant:m,fullWidth:g,autoContrast:b,circle:y,mod:v,attributes:E,...k}=n,C=RW({name:"Badge",props:n,classes:HS,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:E,vars:a,varsResolver:HA});return(0,Z.jsxs)(R7,{variant:m,mod:[{block:g,circle:y,"with-right-section":!!p,"with-left-section":!!h},v],...C("root",{variant:m}),ref:t,...k,children:[h&&(0,Z.jsx)("span",{...C("section"),"data-position":"left",children:h}),(0,Z.jsx)("span",{...C("label"),children:f}),p&&(0,Z.jsx)("span",{...C("section"),"data-position":"right",children:p})]})});H_.classes=HS,H_.displayName="@mantine/core/Badge";let HN={gap:{type:"spacing",property:"gap"},rowGap:{type:"spacing",property:"rowGap"},columnGap:{type:"spacing",property:"columnGap"},align:{type:"identity",property:"alignItems"},justify:{type:"identity",property:"justifyContent"},wrap:{type:"identity",property:"flexWrap"},direction:{type:"identity",property:"flexDirection"}};var HM={root:"m_8bffd616"};let HI=Ln((e,t)=>{let n=RP("Flex",null,e),{classNames:r,className:o,style:i,styles:s,unstyled:l,vars:a,gap:c,rowGap:d,columnGap:u,align:h,justify:p,wrap:f,direction:m,attributes:g,...b}=n,y=RW({name:"Flex",classes:HM,props:n,className:o,style:i,classNames:r,styles:s,unstyled:l,attributes:g,vars:a}),v=RR(),E=R9(),k=R6({styleProps:{gap:c,rowGap:d,columnGap:u,align:h,justify:p,wrap:f,direction:m},theme:v,data:HN});return(0,Z.jsxs)(Z.Fragment,{children:[k.hasResponsiveStyles&&(0,Z.jsx)(RZ,{selector:`.${E}`,styles:k.styles,media:k.media}),(0,Z.jsx)(R7,{ref:t,...y("root",{className:E,style:Rb(k.inlineStyles)}),...b})]})});function HO(e){return"auto"===e||"dark"===e||"light"===e}function HD(){let e=RR(),t=Rj(),n=RY(e.breakpoints).reduce((t,n)=>{let r=e.breakpoints[n].includes("px"),o=function(e){let t="string"==typeof e&&e.includes("var(--mantine-scale)")?e.match(/^calc\((.*?)\)$/)?.[1].split("*")[0].trim():e;return"number"==typeof t?t:"string"==typeof t?t.includes("calc")||t.includes("var")?t:t.includes("px")?Number(t.replace("px","")):t.includes("rem")?16*Number(t.replace("rem","")):t.includes("em")?16*Number(t.replace("em","")):Number(t):NaN}(e.breakpoints[n]),i=r?`${o-.1}px`:Rc(o-.1),s=r?`${o}px`:Rc(o);return`${t}@media (max-width: ${i}) {.mantine-visible-from-${n} {display: none !important;}}@media (min-width: ${s}) {.mantine-hidden-from-${n} {display: none !important;}}`},"");return(0,Z.jsx)("style",{"data-mantine-styles":"classes",nonce:t?.(),dangerouslySetInnerHTML:{__html:n}})}function HR(e){return Object.entries(e).map(([e,t])=>`${e}: ${t};`).join("")}function HL(e,t){let n=t?[t]:[":root",":host"],r=HR(e.variables),o=r?`${n.join(", ")}{${r}}`:"",i=HR(e.dark),s=HR(e.light),l=e=>n.map(t=>":host"===t?`${t}([data-mantine-color-scheme="${e}"])`:`${t}[data-mantine-color-scheme="${e}"]`).join(", "),a=i?`${l("dark")}{${i}}`:"",c=s?`${l("light")}{${s}}`:"";return`${o}

${a}

${c}`}function HP({theme:e,color:t,colorScheme:n,name:r=t,withColorValues:o=!0}){if(!e.colors[t])return{};if("light"===n){let n=RE(e,"light"),i={[`--mantine-color-${r}-text`]:`var(--mantine-color-${r}-filled)`,[`--mantine-color-${r}-filled`]:`var(--mantine-color-${r}-${n})`,[`--mantine-color-${r}-filled-hover`]:`var(--mantine-color-${r}-${9===n?8:n+1})`,[`--mantine-color-${r}-light`]:RS(e.colors[t][n],.1),[`--mantine-color-${r}-light-hover`]:RS(e.colors[t][n],.12),[`--mantine-color-${r}-light-color`]:`var(--mantine-color-${r}-${n})`,[`--mantine-color-${r}-outline`]:`var(--mantine-color-${r}-${n})`,[`--mantine-color-${r}-outline-hover`]:RS(e.colors[t][n],.05)};return o?{[`--mantine-color-${r}-0`]:e.colors[t][0],[`--mantine-color-${r}-1`]:e.colors[t][1],[`--mantine-color-${r}-2`]:e.colors[t][2],[`--mantine-color-${r}-3`]:e.colors[t][3],[`--mantine-color-${r}-4`]:e.colors[t][4],[`--mantine-color-${r}-5`]:e.colors[t][5],[`--mantine-color-${r}-6`]:e.colors[t][6],[`--mantine-color-${r}-7`]:e.colors[t][7],[`--mantine-color-${r}-8`]:e.colors[t][8],[`--mantine-color-${r}-9`]:e.colors[t][9],...i}:i}let i=RE(e,"dark"),s={[`--mantine-color-${r}-text`]:`var(--mantine-color-${r}-4)`,[`--mantine-color-${r}-filled`]:`var(--mantine-color-${r}-${i})`,[`--mantine-color-${r}-filled-hover`]:`var(--mantine-color-${r}-${9===i?8:i+1})`,[`--mantine-color-${r}-light`]:RS(e.colors[t][Math.max(0,i-2)],.15),[`--mantine-color-${r}-light-hover`]:RS(e.colors[t][Math.max(0,i-2)],.2),[`--mantine-color-${r}-light-color`]:`var(--mantine-color-${r}-${Math.max(i-5,0)})`,[`--mantine-color-${r}-outline`]:`var(--mantine-color-${r}-${Math.max(i-4,0)})`,[`--mantine-color-${r}-outline-hover`]:RS(e.colors[t][Math.max(i-4,0)],.05)};return o?{[`--mantine-color-${r}-0`]:e.colors[t][0],[`--mantine-color-${r}-1`]:e.colors[t][1],[`--mantine-color-${r}-2`]:e.colors[t][2],[`--mantine-color-${r}-3`]:e.colors[t][3],[`--mantine-color-${r}-4`]:e.colors[t][4],[`--mantine-color-${r}-5`]:e.colors[t][5],[`--mantine-color-${r}-6`]:e.colors[t][6],[`--mantine-color-${r}-7`]:e.colors[t][7],[`--mantine-color-${r}-8`]:e.colors[t][8],[`--mantine-color-${r}-9`]:e.colors[t][9],...s}:s}function HB(e,t,n){RY(t).forEach(r=>Object.assign(e,{[`--mantine-${n}-${r}`]:t[r]}))}HI.classes=HM,HI.displayName="@mantine/core/Flex";let HH=e=>{let t=RE(e,"light"),n=e.defaultRadius in e.radius?e.radius[e.defaultRadius]:Ra(e.defaultRadius),r={variables:{"--mantine-z-index-app":"100","--mantine-z-index-modal":"200","--mantine-z-index-popover":"300","--mantine-z-index-overlay":"400","--mantine-z-index-max":"9999","--mantine-scale":e.scale.toString(),"--mantine-cursor-type":e.cursorType,"--mantine-webkit-font-smoothing":e.fontSmoothing?"antialiased":"unset","--mantine-moz-font-smoothing":e.fontSmoothing?"grayscale":"unset","--mantine-color-white":e.white,"--mantine-color-black":e.black,"--mantine-line-height":e.lineHeights.md,"--mantine-font-family":e.fontFamily,"--mantine-font-family-monospace":e.fontFamilyMonospace,"--mantine-font-family-headings":e.headings.fontFamily,"--mantine-heading-font-weight":e.headings.fontWeight,"--mantine-heading-text-wrap":e.headings.textWrap,"--mantine-radius-default":n,"--mantine-primary-color-filled":`var(--mantine-color-${e.primaryColor}-filled)`,"--mantine-primary-color-filled-hover":`var(--mantine-color-${e.primaryColor}-filled-hover)`,"--mantine-primary-color-light":`var(--mantine-color-${e.primaryColor}-light)`,"--mantine-primary-color-light-hover":`var(--mantine-color-${e.primaryColor}-light-hover)`,"--mantine-primary-color-light-color":`var(--mantine-color-${e.primaryColor}-light-color)`},light:{"--mantine-color-scheme":"light","--mantine-primary-color-contrast":Hl(e,"light"),"--mantine-color-bright":"var(--mantine-color-black)","--mantine-color-text":e.black,"--mantine-color-body":e.white,"--mantine-color-error":"var(--mantine-color-red-6)","--mantine-color-placeholder":"var(--mantine-color-gray-5)","--mantine-color-anchor":`var(--mantine-color-${e.primaryColor}-${t})`,"--mantine-color-default":"var(--mantine-color-white)","--mantine-color-default-hover":"var(--mantine-color-gray-0)","--mantine-color-default-color":"var(--mantine-color-black)","--mantine-color-default-border":"var(--mantine-color-gray-4)","--mantine-color-dimmed":"var(--mantine-color-gray-6)","--mantine-color-disabled":"var(--mantine-color-gray-2)","--mantine-color-disabled-color":"var(--mantine-color-gray-5)","--mantine-color-disabled-border":"var(--mantine-color-gray-3)"},dark:{"--mantine-color-scheme":"dark","--mantine-primary-color-contrast":Hl(e,"dark"),"--mantine-color-bright":"var(--mantine-color-white)","--mantine-color-text":"var(--mantine-color-dark-0)","--mantine-color-body":"var(--mantine-color-dark-7)","--mantine-color-error":"var(--mantine-color-red-8)","--mantine-color-placeholder":"var(--mantine-color-dark-3)","--mantine-color-anchor":`var(--mantine-color-${e.primaryColor}-4)`,"--mantine-color-default":"var(--mantine-color-dark-6)","--mantine-color-default-hover":"var(--mantine-color-dark-5)","--mantine-color-default-color":"var(--mantine-color-white)","--mantine-color-default-border":"var(--mantine-color-dark-4)","--mantine-color-dimmed":"var(--mantine-color-dark-2)","--mantine-color-disabled":"var(--mantine-color-dark-6)","--mantine-color-disabled-color":"var(--mantine-color-dark-3)","--mantine-color-disabled-border":"var(--mantine-color-dark-4)"}};HB(r.variables,e.breakpoints,"breakpoint"),HB(r.variables,e.spacing,"spacing"),HB(r.variables,e.fontSizes,"font-size"),HB(r.variables,e.lineHeights,"line-height"),HB(r.variables,e.shadows,"shadow"),HB(r.variables,e.radius,"radius"),e.colors[e.primaryColor].forEach((t,n)=>{r.variables[`--mantine-primary-color-${n}`]=`var(--mantine-color-${e.primaryColor}-${n})`}),RY(e.colors).forEach(t=>{let n=e.colors[t];if(n&&"object"==typeof n&&"mantine-virtual-color"in n){Object.assign(r.light,HP({theme:e,name:n.name,color:n.light,colorScheme:"light",withColorValues:!0})),Object.assign(r.dark,HP({theme:e,name:n.name,color:n.dark,colorScheme:"dark",withColorValues:!0}));return}n.forEach((e,n)=>{r.variables[`--mantine-color-${t}-${n}`]=e}),Object.assign(r.light,HP({theme:e,color:t,colorScheme:"light",withColorValues:!1})),Object.assign(r.dark,HP({theme:e,color:t,colorScheme:"dark",withColorValues:!1}))});let o=e.headings.sizes;return RY(o).forEach(t=>{r.variables[`--mantine-${t}-font-size`]=o[t].fontSize,r.variables[`--mantine-${t}-line-height`]=o[t].lineHeight,r.variables[`--mantine-${t}-font-weight`]=o[t].fontWeight||e.headings.fontWeight}),r},Hj=HH(R_);function HF({cssVariablesSelector:e,deduplicateCssVariables:t}){let n,r=RR(),o=Rj(),i=function({theme:e,generator:t}){let n=HH(e),r=t?.(e);return r?RM(n,r):n}({theme:r,generator:RH().cssVariablesResolver}),s=(void 0===e||":root"===e||":host"===e)&&t,l=HL(s?(n={variables:{},light:{},dark:{}},RY(i.variables).forEach(e=>{Hj.variables[e]!==i.variables[e]&&(n.variables[e]=i.variables[e])}),RY(i.light).forEach(e=>{Hj.light[e]!==i.light[e]&&(n.light[e]=i.light[e])}),RY(i.dark).forEach(e=>{Hj.dark[e]!==i.dark[e]&&(n.dark[e]=i.dark[e])}),n):i,e);return l?(0,Z.jsx)("style",{"data-mantine-styles":!0,nonce:o?.(),dangerouslySetInnerHTML:{__html:`${l}${s?"":HL({variables:{},dark:{"--mantine-color-scheme":"dark"},light:{"--mantine-color-scheme":"light"}},e)}`}}):null}function HU(e,t){let n="undefined"!=typeof window&&"matchMedia"in window&&window.matchMedia("(prefers-color-scheme: dark)")?.matches;t()?.setAttribute("data-mantine-color-scheme","auto"!==e?e:n?"dark":"light")}function Hz({theme:e,children:t,getStyleNonce:n,withStaticClasses:r=!0,withGlobalClasses:o=!0,deduplicateCssVariables:i=!0,withCssVariables:s=!0,cssVariablesSelector:l,classNamesPrefix:a="mantine",colorSchemeManager:c=function({key:e="mantine-color-scheme-value"}={}){let t;return{get:t=>{if("undefined"==typeof window)return t;try{let n=window.localStorage.getItem(e);return HO(n)?n:t}catch{return t}},set:t=>{try{window.localStorage.setItem(e,t)}catch(e){console.warn("[@mantine/core] Local storage color scheme manager was unable to save color scheme.",e)}},subscribe:n=>{t=t=>{t.storageArea===window.localStorage&&t.key===e&&HO(t.newValue)&&n(t.newValue)},window.addEventListener("storage",t)},unsubscribe:()=>{window.removeEventListener("storage",t)},clear:()=>{window.localStorage.removeItem(e)}}}(),defaultColorScheme:d="light",getRootElement:u=()=>document.documentElement,cssVariablesResolver:h,forceColorScheme:p,stylesTransform:f,env:m}){let{colorScheme:g,setColorScheme:b,clearColorScheme:y}=function({manager:e,defaultColorScheme:t,getRootElement:n,forceColorScheme:r}){let o=(0,X.useRef)(null),[i,s]=(0,X.useState)(()=>e.get(t)),l=r||i,a=(0,X.useCallback)(t=>{r||(HU(t,n),s(t),e.set(t))},[e.set,l,r]),c=(0,X.useCallback)(()=>{s(t),HU(t,n),e.clear()},[e.clear,t]);return(0,X.useEffect)(()=>(e.subscribe(a),e.unsubscribe),[e.subscribe,e.unsubscribe]),LV(()=>{HU(e.get(t),n)},[]),(0,X.useEffect)(()=>{if(r)return HU(r,n),()=>{};void 0===r&&HU(i,n),"undefined"!=typeof window&&"matchMedia"in window&&(o.current=window.matchMedia("(prefers-color-scheme: dark)"));let e=e=>{"auto"===i&&HU(e.matches?"dark":"light",n)};return o.current?.addEventListener("change",e),()=>o.current?.removeEventListener("change",e)},[i,r]),{colorScheme:l,setColorScheme:a,clearColorScheme:c}}({defaultColorScheme:d,forceColorScheme:p,manager:c,getRootElement:u});return!function({respectReducedMotion:e,getRootElement:t}){LV(()=>{e&&t()?.setAttribute("data-respect-reduced-motion","true")},[e])}({respectReducedMotion:e?.respectReducedMotion||!1,getRootElement:u}),(0,Z.jsx)(RB.Provider,{value:{colorScheme:g,setColorScheme:b,clearColorScheme:y,getRootElement:u,classNamesPrefix:a,getStyleNonce:n,cssVariablesResolver:h,cssVariablesSelector:l??":root",withStaticClasses:r,stylesTransform:f,env:m},children:(0,Z.jsxs)(RL,{theme:e,children:[s&&(0,Z.jsx)(HF,{cssVariablesSelector:l,deduplicateCssVariables:i}),o&&(0,Z.jsx)(HD,{}),t]})})}HF.displayName="@mantine/CssVariables",Hz.displayName="@mantine/core/MantineProvider";let HV=(e,t,n=!1)=>((function e(r,o="--bn"){for(let i in r){let s=i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),l=`${o}-${s}`;"object"!=typeof r[i]?("number"==typeof r[i]&&(r[i]=`${r[i]}px`),n?t.style.removeProperty(l):t.style.setProperty(l,r[i].toString())):e(r[i],l)}})(e),[]),H$={colors:{editor:{text:void 0,background:void 0},menu:{text:void 0,background:void 0},tooltip:{text:void 0,background:void 0},hovered:{text:void 0,background:void 0},selected:{text:void 0,background:void 0},disabled:{text:void 0,background:void 0},shadow:void 0,border:void 0,sideMenu:void 0,highlights:{gray:{text:void 0,background:void 0},brown:{text:void 0,background:void 0},red:{text:void 0,background:void 0},orange:{text:void 0,background:void 0},yellow:{text:void 0,background:void 0},green:{text:void 0,background:void 0},blue:{text:void 0,background:void 0},purple:{text:void 0,background:void 0},pink:{text:void 0,background:void 0}}},borderRadius:void 0,fontFamily:void 0},HG=e=>(0,Z.jsxs)(Pc,{gap:0,className:"bn-tooltip",children:[(0,Z.jsx)(Pp,{size:"sm",lineClamp:5,children:e.mainTooltip}),e.secondaryTooltip&&(0,Z.jsx)(Pp,{size:"xs",lineClamp:5,children:e.secondaryTooltip})]}),Hq=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,mainTooltip:o,secondaryTooltip:i,icon:s,isSelected:l,isDisabled:a,onClick:c,label:d,variant:u,...h}=e;l2(h,!1);let[p,f]=(0,X.useState)(!1),m=r?(0,Z.jsx)(LA,{"aria-label":d,className:n,onMouseDown:e=>{/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&e.currentTarget.focus()},onClick:e=>{f(!0),null==c||c(e)},onPointerLeave:()=>f(!1),"aria-pressed":l,"data-selected":l||void 0,"data-test":o?o.slice(0,1).toLowerCase()+o.replace(/\s+/g,"").slice(1):void 0,size:"compact"===u?"compact-xs":"xs",disabled:a||!1,ref:t,...h,children:r}):(0,Z.jsx)(LL,{className:n,"aria-label":d,onMouseDown:e=>{/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&e.currentTarget.focus()},onClick:e=>{f(!0),null==c||c(e)},onPointerLeave:()=>f(!1),"aria-pressed":l,"data-selected":l||void 0,"data-test":o?o.slice(0,1).toLowerCase()+o.replace(/\s+/g,"").slice(1):void 0,size:"compact"===u?20:30,disabled:a||!1,ref:t,...h,children:s});return o?(0,Z.jsx)(Pi,{disabled:p,withinPortal:!1,label:(0,Z.jsx)(HG,{mainTooltip:o,secondaryTooltip:i}),children:m}):m}),HW=(0,X.forwardRef)((e,t)=>{let{className:n,text:r,icon:o,isSelected:i,mainTooltip:s,secondaryTooltip:l,onClick:a,onMouseEnter:c,...d}=e;l2(d,!1);let[u,h]=(0,X.useState)(!1),p=(0,Z.jsxs)(PA,{className:n,checked:!0===i,wrapperProps:{onMouseEnter:c,onMouseLeave:()=>h(!1),onClick:e=>{h(!0),null==a||a(e)}},variant:"light",icon:null,ref:t,children:[(0,Z.jsx)("span",{children:o}),(0,Z.jsx)("span",{children:r})]});return!s||u?p:(0,Z.jsx)(Pi,{refProp:"rootRef",withinPortal:!1,label:(0,Z.jsx)(HG,{mainTooltip:s,secondaryTooltip:l}),children:p})}),HY=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,...o}=e;return l2(o),(0,Z.jsx)(Pb,{className:n,ref:t,children:r})}),HK=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,headerText:o,selected:i,onFocus:s,onBlur:l,tabIndex:a,...c}=e;return l2(c,!1),(0,Z.jsxs)(PU,{className:mF(n,i?"selected":""),onFocus:s,onBlur:l,tabIndex:a,ref:t,children:[o&&(0,Z.jsx)(Pp,{className:"bn-header-text",children:o}),r]})}),HZ=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,...o}=e;return l2(o,!1),(0,Z.jsx)(PU.Section,{className:n,ref:t,children:r})}),HX=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,...o}=e;return l2(o,!1),(0,Z.jsx)(PI,{className:n,label:(0,Z.jsx)(Pp,{children:r}),ref:t})}),HQ=(0,X.forwardRef)((e,t)=>{let{authorInfo:n,timeString:r,edited:o,...i}=e,s=If();return l2(i,!1),"loading"===n?(0,Z.jsxs)(Pb,{children:[(0,Z.jsx)(PG,{height:24,width:24}),(0,Z.jsx)("div",{children:(0,Z.jsx)(PG,{height:12,width:100})})]}):(0,Z.jsxs)(Pb,{children:[(0,Z.jsx)(P0,{src:n.avatarUrl,alt:n.username,radius:"xl",size:"sm",color:"initials"}),(0,Z.jsxs)(Pp,{fz:"sm",fw:"bold",children:[n.username,(0,Z.jsxs)(Pp,{fz:"xs",c:"dimmed",span:!0,ml:"xs",children:[r," ",o&&`(${s.comments.edited})`]})]})]})}),HJ=(0,X.forwardRef)((e,t)=>{var n;let{className:r,showActions:o,authorInfo:i,timeString:s,edited:l,actions:a,emojiPickerOpen:c,children:d,...u}=e,{hovered:h,ref:p}=function(){let[e,t]=(0,X.useState)(!1),n=(0,X.useRef)(null),r=(0,X.useCallback)(()=>{t(!0)},[]),o=(0,X.useCallback)(()=>{t(!1)},[]);return{ref:(0,X.useCallback)(e=>{n.current&&(n.current.removeEventListener("mouseenter",r),n.current.removeEventListener("mouseleave",o)),e&&(e.addEventListener("mouseenter",r),e.addEventListener("mouseleave",o)),n.current=e},[r,o]),hovered:e}}(),f=(n=[t,p],e=>{n.forEach(t=>{"function"==typeof t?t(e):null!=t&&(t.current=e)})});return l2(u,!1),(0,Z.jsxs)(Pb,{pos:"relative",ref:f,className:r,children:[a&&(!0===o||void 0===o||"hover"===o&&h||c)?(0,Z.jsx)(Pb,{style:{position:"absolute",right:0,top:0,zIndex:10},children:a}):null,(0,Z.jsx)(HQ,{...e}),d]})}),H0=(0,X.forwardRef)((e,t)=>{let{className:n,autoFocus:r,onFocus:o,onBlur:i,editor:s,editable:l,...a}=e;l2(a,!1);let c=Id();return(0,Z.jsx)(jN,{autoFocus:r,className:n,editor:e.editor,sideMenu:!1,slashMenu:!1,tableHandles:!1,filePanel:!1,formattingToolbar:!1,editable:l,theme:null==c?void 0:c.colorSchemePreference,ref:t,onFocus:o,onBlur:i,children:(0,Z.jsx)(OV,{formattingToolbar:H1})})}),H1=()=>{let e=OU([]).filter(e=>"nestBlockButton"!==e.key&&"unnestBlockButton"!==e.key);return(0,Z.jsx)(Oz,{blockTypeSelectItems:[],children:e})},H2=(0,X.forwardRef)((e,t)=>{let{className:n,name:r,label:o,variant:i,icon:s,value:l,autoFocus:a,placeholder:c,disabled:d,onKeyDown:u,onChange:h,onSubmit:p,autoComplete:f,rightSection:m,...g}=e;return l2(g),(0,Z.jsx)(BE,{size:"xs",className:mF(n||"","large"===i?"bn-mt-input-large":""),ref:t,name:r,label:o,leftSection:s,value:l,autoFocus:a,"data-autofocus":a?"true":void 0,rightSection:m,placeholder:c,disabled:d,onKeyDown:u,onChange:h,onSubmit:p,autoComplete:f})}),H4=(0,X.createContext)(void 0),H5=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,icon:o,checked:i,subTrigger:s,onClick:l,...a}=e;return l2(a,!1),s?(0,Z.jsx)(Ho.Sub.Item,{className:n,ref:t,leftSection:o,rightSection:i?(0,Z.jsx)(Pv,{size:10}):!1===i?(0,Z.jsx)("div",{className:"bn-tick-space"}):null,onClick:l,...a,children:r}):(0,Z.jsx)(Ho.Item,{className:n,ref:t,leftSection:o,rightSection:i?(0,Z.jsx)(Pv,{size:10}):!1===i?(0,Z.jsx)("div",{className:"bn-tick-space"}):null,onClick:l,...a,children:r})}),H3=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,sub:o,...i}=e;l2(i);let s=(0,X.useContext)(H4);return o?(0,Z.jsx)(Ho.Sub.Dropdown,{className:n,ref:t,onMouseOver:null==s?void 0:s.onMenuMouseOver,onMouseLeave:null==s?void 0:s.onMenuMouseLeave,children:r}):(0,Z.jsx)(Ho.Dropdown,{className:n,ref:t,onMouseOver:null==s?void 0:s.onMenuMouseOver,onMouseLeave:null==s?void 0:s.onMenuMouseLeave,children:r})}),H8=(0,X.forwardRef)((e,t)=>{let{className:n,...r}=e;return l2(r),(0,Z.jsx)(Ho.Divider,{className:n,ref:t})}),H6=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,...o}=e;return l2(o),(0,Z.jsx)(Ho.Label,{className:n,ref:t,children:r})}),H9=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,icon:o,onClick:i,onDragEnd:s,onDragStart:l,draggable:a,label:c,...d}=e;return l2(d,!1),o?(0,Z.jsx)(LL,{size:24,className:n,ref:t,onClick:i,onDragEnd:s,onDragStart:l,draggable:a,"aria-label":c,...d,children:o}):(0,Z.jsx)(LA,{className:n,ref:t,onClick:i,onDragEnd:s,onDragStart:l,draggable:a,"aria-label":c,...d,children:r})}),H7=(0,X.forwardRef)((e,t)=>{let{className:n,tabs:r,defaultOpenTab:o,openTab:i,setOpenTab:s,loading:l,...a}=e;return l2(a),(0,Z.jsx)(Pb,{className:n,ref:t,children:(0,Z.jsxs)(Hb,{value:i,defaultValue:o,onChange:s,children:[l&&(0,Z.jsx)(Hk,{visible:l}),(0,Z.jsx)(Hb.List,{children:r.map(e=>(0,Z.jsx)(Hb.Tab,{"data-test":`${e.name.toLowerCase()}-tab`,value:e.name,children:e.name},e.name))}),r.map(e=>(0,Z.jsx)(Hb.Panel,{value:e.name,children:e.tabPanel},e.name))]})})}),je=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,onClick:o,label:i,...s}=e;return l2(s),(0,Z.jsx)(LA,{size:"xs","aria-label":i,className:n,ref:t,onClick:o,...s,children:r})}),jt=(0,X.forwardRef)((e,t)=>{let{className:n,accept:r,value:o,placeholder:i,onChange:s,...l}=e;return l2(l),(0,Z.jsx)(Hx,{size:"xs",className:n,ref:t,accept:r,value:o,placeholder:i,onChange:s,...l})}),jn=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,...o}=e;return l2(o),(0,Z.jsx)("div",{className:n,ref:t,children:r})}),jr=(0,X.forwardRef)((e,t)=>{let{className:n,value:r,placeholder:o,onKeyDown:i,onChange:s,...l}=e;return l2(l),(0,Z.jsx)(BE,{size:"xs","data-test":"embed-input",className:n,ref:t,value:r,placeholder:o,onKeyDown:i,onChange:s})}),jo=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,variant:o,...i}=e;return l2(i),(0,Z.jsx)(Bz,{className:n,ref:t,children:r})}),ji=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,...o}=e;return l2(o,!1),(0,Z.jsx)(Pb,{align:"center",gap:0,className:n,ref:t,...o,children:r})}),js=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,icon:o,onClick:i,onDragEnd:s,onDragStart:l,draggable:a,label:c,...d}=e;return l2(d,!1),o?(0,Z.jsx)(LL,{size:24,className:n,ref:t,onClick:i,onDragEnd:s,onDragStart:l,draggable:a,"aria-label":c,...d,children:o}):(0,Z.jsx)(LA,{className:n,ref:t,onClick:i,onDragEnd:s,onDragStart:l,draggable:a,"aria-label":c,...d,children:r})}),jl=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,id:o,...i}=e;return l2(i),(0,Z.jsx)(Pc,{gap:0,className:n,ref:t,id:o,role:"listbox",children:r})}),ja=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,...o}=e;return l2(o),(0,Z.jsx)(Pb,{className:n,ref:t,children:(0,Z.jsx)(Pb,{className:"bn-mt-suggestion-menu-item-title",children:r})})}),jc=(0,X.forwardRef)((e,t)=>{let{className:n,isSelected:r,onClick:o,item:i,id:s,...l}=e;l2(l);let a=(0,X.useRef)(null);return(0,X.useEffect)(()=>{if(!a.current||!r)return;let e=Ri(a.current,a.current.closest(".bn-suggestion-menu, #ai-suggestion-menu"));"top"===e?a.current.scrollIntoView(!0):"bottom"===e&&a.current.scrollIntoView(!1)},[r]),(0,Z.jsxs)(Pb,{gap:0,className:n,ref:LB(t,a),id:s,role:"option",onMouseDown:e=>e.preventDefault(),onClick:o,"aria-selected":r||void 0,children:[i.icon&&(0,Z.jsx)(Pb,{className:"bn-mt-suggestion-menu-item-section","data-position":"left",children:i.icon}),(0,Z.jsxs)(Pc,{gap:0,className:"bn-mt-suggestion-menu-item-body",children:[(0,Z.jsx)(Pp,{className:"bn-mt-suggestion-menu-item-title",children:i.title}),(0,Z.jsx)(Pp,{className:"bn-mt-suggestion-menu-item-subtitle",children:i.subtext})]}),i.badge&&(0,Z.jsx)(Pb,{"data-position":"right",className:"bn-mt-suggestion-menu-item-section",children:(0,Z.jsx)(H_,{size:"xs",children:i.badge})})]})}),jd=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,...o}=e;return l2(o),(0,Z.jsx)(Pb,{className:n,ref:t,children:r})}),ju=(0,X.forwardRef)((e,t)=>{let{className:n,...r}=e;return l2(r),(0,Z.jsx)(Ld,{className:n,type:"dots",size:16,ref:t})}),jh=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,id:o,columns:i,...s}=e;return l2(s),(0,Z.jsx)("div",{className:n,style:{gridTemplateColumns:`repeat(${i}, 1fr)`},ref:t,id:o,role:"grid",children:r})}),jp=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,columns:o,...i}=e;return l2(i),(0,Z.jsx)(Pb,{className:n,style:{gridColumn:`1 / ${o+1}`},ref:t,children:(0,Z.jsx)(Pb,{className:"bn-mt-suggestion-menu-item-title",children:r})})}),jf=(0,X.forwardRef)((e,t)=>{let{className:n,isSelected:r,onClick:o,item:i,id:s,...l}=e;l2(l);let a=(0,X.useRef)(null);return(0,X.useEffect)(()=>{if(!a.current||!r)return;let e=Ri(a.current,a.current.closest(".bn-grid-suggestion-menu"));"top"===e?a.current.scrollIntoView(!0):"bottom"===e&&a.current.scrollIntoView(!1)},[r]),(0,Z.jsx)("div",{className:n,ref:LB(t,a),id:s,role:"option",onClick:o,"aria-selected":r||void 0,children:i.icon})}),jm=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,columns:o,...i}=e;return l2(i),(0,Z.jsx)(Ld,{className:n,style:{gridColumn:`1 / ${o+1}`},type:"dots",ref:t})}),jg=(0,X.forwardRef)((e,t)=>{let{children:n,className:r,onMouseDown:o,onClick:i,...s}=e;return l2(s,!1),(0,Z.jsx)(LA,{className:r,ref:t,onMouseDown:o,onClick:i,...s,children:n})}),jb=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,draggable:o,onDragStart:i,onDragEnd:s,style:l,label:a,...c}=e;return l2(c,!1),(0,Z.jsx)(LA,{className:n,ref:t,"aria-label":a,draggable:o,onDragStart:i,onDragEnd:s,style:l,...c,children:r})}),jy=(0,X.forwardRef)((e,t)=>{let{className:n,children:r,onMouseEnter:o,onMouseLeave:i,variant:s,...l}=e;l2(l);let{ref:a,focused:c}=function({onBlur:e,onFocus:t}={}){let[n,r]=(0,X.useState)(!1),o=(0,X.useRef)(!1),i=(0,X.useRef)(null),s=(0,X.useCallback)(e=>{r(e),o.current=e},[]),l=(0,X.useCallback)(e=>{o.current||(s(!0),t?.(e))},[t]),a=(0,X.useCallback)(t=>{o.current&&!(t.currentTarget instanceof HTMLElement&&t.relatedTarget instanceof HTMLElement&&t.currentTarget.contains(t.relatedTarget))&&(s(!1),e?.(t))},[e]),c=(0,X.useCallback)(e=>{e&&(i.current&&(i.current.removeEventListener("focusin",l),i.current.removeEventListener("focusout",a)),e.addEventListener("focusin",l),e.addEventListener("focusout",a),i.current=e)},[l,a]);return(0,X.useEffect)(()=>()=>{i.current&&(i.current.removeEventListener("focusin",l),i.current.removeEventListener("focusout",a))},[]),{ref:c,focused:n}}(),d=LB(t,a,BP(c));return(0,Z.jsx)(HI,{className:n,ref:d,role:"toolbar",onMouseEnter:o,onMouseLeave:i,gap:"action-toolbar"===s?2:void 0,children:r})});var jv={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},jE=X.default.createContext&&X.default.createContext(jv),jk=["attr","size","title"];function jC(){return(jC=Object.assign.bind()).apply(this,arguments)}function jT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function jw(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jT(Object(n),!0).forEach(function(t){var r,o,i;r=e,o=t,i=n[t],(o=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(o))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jT(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function jx(e){var t=t=>{var n,{attr:r,size:o,title:i}=e,s=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,jk),l=o||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),X.default.createElement("svg",jC({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,s,{className:n,style:jw(jw({color:e.color||t.color},t.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&X.default.createElement("title",null,i),e.children)};return void 0!==jE?X.default.createElement(jE.Consumer,null,e=>t(e)):t(jv)}function jS(e){var t;return(t={attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"},child:[]}]},e=>X.default.createElement(jx,jC({attr:jw({},t.attr)},e),function e(t){return t&&t.map((t,n)=>X.default.createElement(t.tag,jw({key:n},t.attr),e(t.child)))}(t.child)))(e)}let jA=(0,X.forwardRef)((e,t)=>{let{className:n,items:r,isDisabled:o,...i}=e;l2(i);let s=r.filter(e=>e.isSelected)[0];return s?(0,Z.jsxs)(Ho,{withinPortal:!1,transitionProps:{exitDuration:0},disabled:o,middlewares:{flip:!0,shift:!0,inline:!1,size:!0},children:[(0,Z.jsx)(Ho.Target,{children:(0,Z.jsx)(LA,{onMouseDown:e=>{/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&e.currentTarget.focus()},leftSection:s.icon,rightSection:(0,Z.jsx)(jS,{}),size:"xs",variant:"subtle",disabled:o,children:s.text})}),(0,Z.jsx)(Ho.Dropdown,{className:n,ref:t,children:r.map(e=>(0,Z.jsx)(Ho.Item,{onClick:e.onClick,leftSection:e.icon,rightSection:e.isSelected?(0,Z.jsx)(Pv,{size:10,className:"bn-tick-icon"}):(0,Z.jsx)("div",{className:"bn-tick-space"}),disabled:e.isDisabled,children:e.text},e.text))})]}):null}),j_={FormattingToolbar:{Root:jy,Button:Hq,Select:jA},FilePanel:{Root:H7,Button:je,FileInput:jt,TabPanel:jn,TextInput:jr},GridSuggestionMenu:{Root:jh,Item:jf,EmptyItem:jp,Loader:jm},LinkToolbar:{Root:jy,Button:Hq,Select:jA},SideMenu:{Root:ji,Button:js},SuggestionMenu:{Root:jl,Item:jc,EmptyItem:ja,Label:jd,Loader:ju},TableHandle:{Root:jb,ExtendButton:jg},Generic:{Badge:{Root:HW,Group:HY},Form:{Root:e=>(0,Z.jsx)("div",{children:e.children}),TextInput:H2},Menu:{Root:e=>{let{children:t,onOpenChange:n,position:r,sub:o,...i}=e;return l2(i),o?(0,Z.jsx)(Ho.Sub,{transitionProps:{duration:250,exitDelay:250},withinPortal:!1,middlewares:{flip:!0,shift:!0,inline:!1,size:!0},onChange:n,position:r,children:t}):(0,Z.jsx)(Ho,{withinPortal:!1,middlewares:{flip:!0,shift:!0,inline:!1,size:!0},onChange:n,position:r,children:t})},Trigger:e=>{let{children:t,sub:n,...r}=e;return l2(r),n?(0,Z.jsx)(Ho.Sub.Target,{children:t}):(0,Z.jsx)(Ho.Target,{children:t})},Dropdown:H3,Divider:H8,Label:H6,Item:H5,Button:H9},Popover:{Root:e=>{let{open:t,onOpenChange:n,position:r,children:o,...i}=e;return l2(i),(0,Z.jsx)(BW,{middlewares:{size:{padding:20}},withinPortal:!1,opened:t,onChange:n,position:r,zIndex:1e4,children:o})},Trigger:e=>{let{children:t,...n}=e;return l2(n),(0,Z.jsx)(B$,{children:t})},Content:jo},Toolbar:{Root:jy,Button:Hq,Select:jA}},Comments:{Comment:HJ,Editor:H0,Card:HK,CardSection:HZ,ExpandSectionsPrompt:HX}},jN=e=>{let{className:t,theme:n,...r}=e,o=Id(),i=DT(),s=(null==o?void 0:o.colorSchemePreference)||i,l=(0,X.useCallback)(e=>{if(e&&(HV(H$,e,!0),"object"==typeof n)){if("light"in n&&"dark"in n)return void HV(n["dark"===s?"dark":"light"],e);return void HV(n,e)}},[s,n]),a=(0,X.useContext)(RB),c="string"==typeof n?n:"no-preference"!==s?s:"light",d=(0,Z.jsx)(Iu.Provider,{value:j_,children:(0,Z.jsx)(DN,{"data-mantine-color-scheme":c,className:mF("bn-mantine",t||""),theme:"object"==typeof n?void 0:n,...r,ref:l})});return a?d:(0,Z.jsx)(Hz,{withCssVariables:!1,getRootElement:()=>{},children:d})};function jM({initialContent:e,onChange:t,editable:n=!0}){let[r,o]=(0,X.useState)(!1),i=DQ({initialContent:e?JSON.parse(e):void 0});return(0,X.useEffect)(()=>{if(i&&n){let e=i.onChange(()=>{t(JSON.stringify(i.document))});return()=>e()}},[i,t,n]),(0,Z.jsx)(Hz,{defaultColorScheme:"light",children:(0,Z.jsx)("div",{className:"min-h-[500px] w-full bg-white rounded-lg py-4",children:(0,Z.jsx)(jN,{editor:i,editable:n,theme:"light",className:"min-h-[400px]"})})})}var jI=e.i(19455),jO=e.i(80376),jD=e.i(72436),jR=e.i(27069),jL=e.i(91967),jP=e.i(99795),jB=e.i(51053),jH=e.i(11035),jj=e.i(83373),jF=e.i(41576),jU=e.i(13649),jz=e.i(64923),jV=e.i(55713),j$=["PageUp","PageDown"],jG=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],jq={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},jW="Slider",[jY,jK,jZ]=(0,jV.createCollection)(jW),[jX,jQ]=(0,jB.createContextScope)(jW,[jZ]),[jJ,j0]=jX(jW),j1=X.forwardRef((e,t)=>{let{name:n,min:r=0,max:o=100,step:i=1,orientation:s="horizontal",disabled:l=!1,minStepsBetweenThumbs:a=0,defaultValue:c=[r],value:d,onValueChange:u=()=>{},onValueCommit:h=()=>{},inverted:p=!1,form:f,...m}=e,g=X.useRef(new Set),b=X.useRef(0),y="horizontal"===s,[v=[],E]=(0,jH.useControllableState)({prop:d,defaultProp:c,onChange:e=>{let t=[...g.current];t[b.current]?.focus(),u(e)}}),k=X.useRef(v);function C(e,t,{commit:n}={commit:!1}){let s,l=(String(i).split(".")[1]||"").length,c=Math.round((Math.round((e-r)/i)*i+r)*(s=Math.pow(10,l)))/s,d=(0,jR.clamp)(c,[r,o]);E((e=[])=>{let r=function(e=[],t,n){let r=[...e];return r[n]=t,r.sort((e,t)=>e-t)}(e,d,t);if(!function(e,t){if(t>0)return Math.min(...e.slice(0,-1).map((t,n)=>e[n+1]-t))>=t;return!0}(r,a*i))return e;{b.current=r.indexOf(d);let t=String(r)!==String(e);return t&&n&&h(r),t?r:e}})}return(0,Z.jsx)(jJ,{scope:e.__scopeSlider,name:n,disabled:l,min:r,max:o,valueIndexToChangeRef:b,thumbs:g.current,values:v,orientation:s,form:f,children:(0,Z.jsx)(jY.Provider,{scope:e.__scopeSlider,children:(0,Z.jsx)(jY.Slot,{scope:e.__scopeSlider,children:(0,Z.jsx)(y?j5:j3,{"aria-disabled":l,"data-disabled":l?"":void 0,...m,ref:t,onPointerDown:(0,jL.composeEventHandlers)(m.onPointerDown,()=>{l||(k.current=v)}),min:r,max:o,inverted:p,onSlideStart:l?void 0:function(e){let t=function(e,t){if(1===e.length)return 0;let n=e.map(e=>Math.abs(e-t)),r=Math.min(...n);return n.indexOf(r)}(v,e);C(e,t)},onSlideMove:l?void 0:function(e){C(e,b.current)},onSlideEnd:l?void 0:function(){let e=k.current[b.current];v[b.current]!==e&&h(v)},onHomeKeyDown:()=>!l&&C(r,0,{commit:!0}),onEndKeyDown:()=>!l&&C(o,v.length-1,{commit:!0}),onStepKeyDown:({event:e,direction:t})=>{if(!l){let n=j$.includes(e.key)||e.shiftKey&&jG.includes(e.key),r=b.current;C(v[r]+i*(n?10:1)*t,r,{commit:!0})}}})})})})});j1.displayName=jW;var[j2,j4]=jX(jW,{startEdge:"left",endEdge:"right",size:"width",direction:1}),j5=X.forwardRef((e,t)=>{let{min:n,max:r,dir:o,inverted:i,onSlideStart:s,onSlideMove:l,onSlideEnd:a,onStepKeyDown:c,...d}=e,[u,h]=X.useState(null),p=(0,jP.useComposedRefs)(t,e=>h(e)),f=X.useRef(void 0),m=(0,jj.useDirection)(o),g="ltr"===m,b=g&&!i||!g&&i;function y(e){let t=f.current||u.getBoundingClientRect(),o=Fs([0,t.width],b?[n,r]:[r,n]);return f.current=t,o(e-t.left)}return(0,Z.jsx)(j2,{scope:e.__scopeSlider,startEdge:b?"left":"right",endEdge:b?"right":"left",direction:b?1:-1,size:"width",children:(0,Z.jsx)(j8,{dir:m,"data-orientation":"horizontal",...d,ref:p,style:{...d.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:e=>{let t=y(e.clientX);s?.(t)},onSlideMove:e=>{let t=y(e.clientX);l?.(t)},onSlideEnd:()=>{f.current=void 0,a?.()},onStepKeyDown:e=>{let t=jq[b?"from-left":"from-right"].includes(e.key);c?.({event:e,direction:t?-1:1})}})})}),j3=X.forwardRef((e,t)=>{let{min:n,max:r,inverted:o,onSlideStart:i,onSlideMove:s,onSlideEnd:l,onStepKeyDown:a,...c}=e,d=X.useRef(null),u=(0,jP.useComposedRefs)(t,d),h=X.useRef(void 0),p=!o;function f(e){let t=h.current||d.current.getBoundingClientRect(),o=Fs([0,t.height],p?[r,n]:[n,r]);return h.current=t,o(e-t.top)}return(0,Z.jsx)(j2,{scope:e.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1,children:(0,Z.jsx)(j8,{"data-orientation":"vertical",...c,ref:u,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:e=>{let t=f(e.clientY);i?.(t)},onSlideMove:e=>{let t=f(e.clientY);s?.(t)},onSlideEnd:()=>{h.current=void 0,l?.()},onStepKeyDown:e=>{let t=jq[p?"from-bottom":"from-top"].includes(e.key);a?.({event:e,direction:t?-1:1})}})})}),j8=X.forwardRef((e,t)=>{let{__scopeSlider:n,onSlideStart:r,onSlideMove:o,onSlideEnd:i,onHomeKeyDown:s,onEndKeyDown:l,onStepKeyDown:a,...c}=e,d=j0(jW,n);return(0,Z.jsx)(jz.Primitive.span,{...c,ref:t,onKeyDown:(0,jL.composeEventHandlers)(e.onKeyDown,e=>{"Home"===e.key?(s(e),e.preventDefault()):"End"===e.key?(l(e),e.preventDefault()):j$.concat(jG).includes(e.key)&&(a(e),e.preventDefault())}),onPointerDown:(0,jL.composeEventHandlers)(e.onPointerDown,e=>{let t=e.target;t.setPointerCapture(e.pointerId),e.preventDefault(),d.thumbs.has(t)?t.focus():r(e)}),onPointerMove:(0,jL.composeEventHandlers)(e.onPointerMove,e=>{e.target.hasPointerCapture(e.pointerId)&&o(e)}),onPointerUp:(0,jL.composeEventHandlers)(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),i(e))})})}),j6="SliderTrack",j9=X.forwardRef((e,t)=>{let{__scopeSlider:n,...r}=e,o=j0(j6,n);return(0,Z.jsx)(jz.Primitive.span,{"data-disabled":o.disabled?"":void 0,"data-orientation":o.orientation,...r,ref:t})});j9.displayName=j6;var j7="SliderRange",Fe=X.forwardRef((e,t)=>{let{__scopeSlider:n,...r}=e,o=j0(j7,n),i=j4(j7,n),s=X.useRef(null),l=(0,jP.useComposedRefs)(t,s),a=o.values.length,c=o.values.map(e=>Fi(e,o.min,o.max)),d=a>1?Math.min(...c):0,u=100-Math.max(...c);return(0,Z.jsx)(jz.Primitive.span,{"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,...r,ref:l,style:{...e.style,[i.startEdge]:d+"%",[i.endEdge]:u+"%"}})});Fe.displayName=j7;var Ft="SliderThumb",Fn=X.forwardRef((e,t)=>{let n=jK(e.__scopeSlider),[r,o]=X.useState(null),i=(0,jP.useComposedRefs)(t,e=>o(e)),s=X.useMemo(()=>r?n().findIndex(e=>e.ref.current===r):-1,[n,r]);return(0,Z.jsx)(Fr,{...e,ref:i,index:s})}),Fr=X.forwardRef((e,t)=>{var n,r,o,i,s;let l,a,{__scopeSlider:c,index:d,name:u,...h}=e,p=j0(Ft,c),f=j4(Ft,c),[m,g]=X.useState(null),b=(0,jP.useComposedRefs)(t,e=>g(e)),y=!m||p.form||!!m.closest("form"),v=(0,jU.useSize)(m),E=p.values[d],k=void 0===E?0:Fi(E,p.min,p.max),C=(n=d,(r=p.values.length)>2?`Value ${n+1} of ${r}`:2===r?["Minimum","Maximum"][n]:void 0),T=v?.[f.size],w=T?(o=T,i=k,s=f.direction,a=Fs([0,50],[0,l=o/2]),(l-a(i)*s)*s):0;return X.useEffect(()=>{if(m)return p.thumbs.add(m),()=>{p.thumbs.delete(m)}},[m,p.thumbs]),(0,Z.jsxs)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[f.startEdge]:`calc(${k}% + ${w}px)`},children:[(0,Z.jsx)(jY.ItemSlot,{scope:e.__scopeSlider,children:(0,Z.jsx)(jz.Primitive.span,{role:"slider","aria-label":e["aria-label"]||C,"aria-valuemin":p.min,"aria-valuenow":E,"aria-valuemax":p.max,"aria-orientation":p.orientation,"data-orientation":p.orientation,"data-disabled":p.disabled?"":void 0,tabIndex:p.disabled?void 0:0,...h,ref:b,style:void 0===E?{display:"none"}:e.style,onFocus:(0,jL.composeEventHandlers)(e.onFocus,()=>{p.valueIndexToChangeRef.current=d})})}),y&&(0,Z.jsx)(Fo,{name:u??(p.name?p.name+(p.values.length>1?"[]":""):void 0),form:p.form,value:E},d)]})});Fn.displayName=Ft;var Fo=X.forwardRef(({__scopeSlider:e,value:t,...n},r)=>{let o=X.useRef(null),i=(0,jP.useComposedRefs)(o,r),s=(0,jF.usePrevious)(t);return X.useEffect(()=>{let e=o.current;if(!e)return;let n=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value").set;if(s!==t&&n){let r=new Event("input",{bubbles:!0});n.call(e,t),e.dispatchEvent(r)}},[s,t]),(0,Z.jsx)(jz.Primitive.input,{style:{display:"none"},...n,ref:i,defaultValue:t})});function Fi(e,t,n){return(0,jR.clamp)(100/(n-t)*(e-t),[0,100])}function Fs(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}Fo.displayName="RadioBubbleInput";var Fl=e.i(75157);function Fa({className:e,defaultValue:t,value:n,min:r=0,max:o=100,...i}){let s=X.useMemo(()=>Array.isArray(n)?n:Array.isArray(t)?t:[r,o],[n,t,r,o]);return(0,Z.jsxs)(j1,{"data-slot":"slider",defaultValue:t,value:n,min:r,max:o,className:(0,Fl.cn)("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...i,children:[(0,Z.jsx)(j9,{"data-slot":"slider-track",className:(0,Fl.cn)("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:(0,Z.jsx)(Fe,{"data-slot":"slider-range",className:(0,Fl.cn)("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:s.length},(e,t)=>(0,Z.jsx)(Fn,{"data-slot":"slider-thumb",className:"border-primary ring-ring/50 block size-4 shrink-0 rounded-full border bg-white shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},t))]})}var Fc=e.i(67489),Fd=e.i(10204);function Fu(){let e=(0,Q.useSearchParams)().get("id"),[t,n]=(0,X.useState)(null),[r,o]=(0,X.useState)([]),[i,s]=(0,X.useState)(!0),[l,a]=(0,X.useState)(!1),[c,d]=(0,X.useState)(!1),u=(0,X.useCallback)(async()=>{if(e)try{let t=await (0,J.invoke)("get_diary_entry",{id:e});n(t);let r=await (0,J.invoke)("get_diary_sub_pages",{parentId:e});o(r);let i=new Date(t.entry_date),s=new Date("2026-01-03");i>s&&d(!0)}catch(e){console.error("Failed to fetch diary entry:",e)}finally{s(!1)}},[e]);(0,X.useEffect)(()=>{e&&u()},[e,u]);let h=async e=>{if(!t||c)return;let r={...t,...e};try{a(!0),await (0,J.invoke)("update_diary_entry",{id:r.diary_entry_id,title:r.title,contentJson:r.content_json,wordCount:r.word_count,moodLabel:r.mood_label,moodRating:r.mood_rating,energyLevel:r.energy_level,stressLevel:r.stress_level,importanceLevel:r.importance_level}),n({...r,updated_at:Math.floor(Date.now()/1e3)})}catch(e){console.error("Save failed:",e)}finally{setTimeout(()=>a(!1),500)}},p=async e=>{if(!t||c)return;let n=0;try{JSON.parse(e).forEach(e=>{e.content&&Array.isArray(e.content)&&e.content.forEach(e=>{e.text&&(n+=e.text.trim().split(/\s+/).length)})})}catch(e){}await h({content_json:e,word_count:n})},f=async()=>{if(t)try{await (0,J.invoke)("create_diary_entry",{input:{title:"Untitled Sub-page",entry_date:t.entry_date,content_json:"[]",parent_page_id:t.diary_entry_id}}),u()}catch(e){console.error("Failed to create sub-page:",e)}};return i?(0,Z.jsx)("div",{className:"p-20 text-center animate-pulse",children:"Initializing System Stream..."}):t?(0,Z.jsxs)("div",{className:"flex flex-col h-screen bg-white font-geist",children:[(0,Z.jsxs)("header",{className:"h-14 border-b flex items-center justify-between px-6 shrink-0 transition-colors bg-zinc-50/30",children:[(0,Z.jsxs)("div",{className:"flex items-center gap-3 text-sm text-zinc-400 overflow-hidden",children:[(0,Z.jsxs)(ep.default,{href:"/diary",className:"hover:text-primary flex items-center gap-1.5 shrink-0 transition-colors uppercase font-black text-[10px] tracking-widest",children:[(0,Z.jsx)(et,{className:"h-4 w-4"}),"Archive"]}),(0,Z.jsx)(ei.ChevronRight,{className:"h-3 w-3 shrink-0 opacity-40"}),(0,Z.jsx)("span",{className:"truncate font-black text-zinc-900 uppercase text-[10px] tracking-widest",children:t.title||"Untethered Fragment"})]}),(0,Z.jsxs)("div",{className:"flex items-center gap-4",children:[l&&(0,Z.jsx)("span",{className:"text-[10px] uppercase font-black text-primary animate-pulse tracking-widest bg-primary/5 px-2 py-1 rounded",children:"Syncing..."}),c&&(0,Z.jsxs)("div",{className:"flex items-center gap-1.5 px-3 py-1 bg-zinc-900 text-white rounded-full text-[10px] font-black tracking-widest uppercase shadow-lg shadow-black/20",children:[(0,Z.jsx)(el.Lock,{className:"h-3 w-3"}),"Locked System"]}),(0,Z.jsxs)(jO.Sheet,{children:[(0,Z.jsx)(jO.SheetTrigger,{asChild:!0,children:(0,Z.jsx)(jI.Button,{variant:"ghost",size:"icon",className:"h-10 w-10 hover:bg-zinc-100 rounded-xl",children:(0,Z.jsx)(en,{className:"h-5 w-5 text-zinc-400"})})}),(0,Z.jsxs)(jO.SheetContent,{className:"sm:max-w-md p-8 overflow-y-auto",children:[(0,Z.jsxs)(jO.SheetHeader,{className:"mb-10 text-left",children:[(0,Z.jsxs)(jO.SheetTitle,{className:"text-3xl font-black uppercase tracking-tighter text-zinc-900 leading-none",children:["Identity ",(0,Z.jsx)("br",{})," ",(0,Z.jsx)("span",{className:"text-zinc-400",children:"Metadata"})]}),(0,Z.jsx)(jO.SheetDescription,{className:"font-medium text-zinc-500",children:"Deep system audit and configuration labels."})]}),(0,Z.jsxs)("div",{className:"space-y-10",children:[(0,Z.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Z.jsxs)("div",{className:"p-4 bg-zinc-50 rounded-2xl border border-zinc-100",children:[(0,Z.jsx)("p",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-400 mb-1",children:"Created"}),(0,Z.jsx)("p",{className:"text-sm font-bold",children:new Date(1e3*t.created_at).toLocaleDateString()})]}),(0,Z.jsxs)("div",{className:"p-4 bg-zinc-50 rounded-2xl border border-zinc-100",children:[(0,Z.jsx)("p",{className:"text-[10px] font-black uppercase tracking-widest text-zinc-400 mb-1",children:"Words"}),(0,Z.jsx)("p",{className:"text-sm font-bold",children:t.word_count})]})]}),(0,Z.jsx)(jD.Separator,{className:"bg-zinc-100"}),(0,Z.jsxs)("div",{className:"space-y-6",children:[(0,Z.jsxs)("div",{className:"space-y-2",children:[(0,Z.jsx)(Fd.Label,{className:"text-[10px] font-black uppercase tracking-widest text-zinc-400",children:"Atmosphere Label"}),(0,Z.jsxs)(Fc.Select,{disabled:c,value:t.mood_label||"Stable",onValueChange:e=>h({mood_label:e}),children:[(0,Z.jsx)(Fc.SelectTrigger,{className:"h-12 bg-zinc-50 border-zinc-100 rounded-xl font-bold uppercase text-[10px] tracking-widest",children:(0,Z.jsx)(Fc.SelectValue,{})}),(0,Z.jsxs)(Fc.SelectContent,{className:"bg-zinc-900 text-white border-zinc-800",children:[(0,Z.jsx)(Fc.SelectItem,{value:"Stable",className:"font-bold uppercase text-[10px] tracking-widest",children:"Stable"}),(0,Z.jsx)(Fc.SelectItem,{value:"Focused",className:"font-bold uppercase text-[10px] tracking-widest",children:"Focused"}),(0,Z.jsx)(Fc.SelectItem,{value:"Tired",className:"font-bold uppercase text-[10px] tracking-widest",children:"Tired"}),(0,Z.jsx)(Fc.SelectItem,{value:"Energetic",className:"font-bold uppercase text-[10px] tracking-widest",children:"Energetic"}),(0,Z.jsx)(Fc.SelectItem,{value:"Reflective",className:"font-bold uppercase text-[10px] tracking-widest",children:"Reflective"})]})]})]}),(0,Z.jsxs)("div",{className:"space-y-3",children:[(0,Z.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Z.jsx)(Fd.Label,{className:"text-[10px] font-black uppercase tracking-widest text-zinc-400",children:"Vibe Intensity"}),(0,Z.jsxs)("span",{className:"text-[10px] font-black text-primary uppercase",children:[t.mood_rating||0,"/5"]})]}),(0,Z.jsx)(Fa,{disabled:c,value:[t.mood_rating||0],max:5,step:1,onValueChange:e=>h({mood_rating:e[0]})})]})]}),(0,Z.jsxs)("div",{className:"space-y-6",children:[(0,Z.jsxs)("div",{className:"space-y-3",children:[(0,Z.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Z.jsx)(Fd.Label,{className:"text-[10px] font-black uppercase tracking-widest text-zinc-400",children:"Energy Level"}),(0,Z.jsxs)("span",{className:"text-[10px] font-black text-orange-500 uppercase",children:[t.energy_level||0,"/5"]})]}),(0,Z.jsx)(Fa,{disabled:c,value:[t.energy_level||0],max:5,step:1,onValueChange:e=>h({energy_level:e[0]})})]}),(0,Z.jsxs)("div",{className:"space-y-3",children:[(0,Z.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Z.jsx)(Fd.Label,{className:"text-[10px] font-black uppercase tracking-widest text-zinc-400",children:"System Stress"}),(0,Z.jsxs)("span",{className:"text-[10px] font-black text-red-500 uppercase",children:[t.stress_level||0,"/5"]})]}),(0,Z.jsx)(Fa,{disabled:c,value:[t.stress_level||0],max:5,step:1,onValueChange:e=>h({stress_level:e[0]})})]})]}),(0,Z.jsxs)("div",{className:"space-y-4",children:[(0,Z.jsx)(Fd.Label,{className:"text-[10px] font-black uppercase tracking-widest text-zinc-400",children:"Record Priority"}),(0,Z.jsx)("div",{className:"grid grid-cols-3 gap-2",children:[{val:0,label:"Normal",color:"bg-zinc-100 text-zinc-600"},{val:1,label:"High",color:"bg-orange-100 text-orange-700"},{val:2,label:"Critical",color:"bg-red-100 text-red-700"}].map(e=>(0,Z.jsx)(jI.Button,{variant:"ghost",disabled:c,className:(0,Fl.cn)("h-10 text-[9px] font-black uppercase tracking-widest rounded-xl transition-all",t.importance_level===e.val?e.color:"bg-zinc-50 text-zinc-400 hover:bg-zinc-100"),onClick:()=>h({importance_level:e.val}),children:e.label},e.val))})]}),(0,Z.jsxs)("div",{className:"p-4 bg-zinc-900 rounded-2xl border border-zinc-800 space-y-2",children:[(0,Z.jsxs)("div",{className:"flex items-center gap-2 text-primary",children:[(0,Z.jsx)(ea.History,{className:"h-3 w-3"}),(0,Z.jsx)("span",{className:"text-[9px] font-black uppercase tracking-widest",children:"Audit Trail Active"})]}),(0,Z.jsxs)("p",{className:"text-[10px] text-zinc-500 leading-relaxed italic",children:['"Metadata integrity is critical for long-term pattern recognition. Labels updated at'," ",new Date(1e3*t.updated_at).toLocaleTimeString(),'."']})]})]})]})]}),(0,Z.jsx)(jI.Button,{variant:"ghost",size:"icon",className:"h-10 w-10 hover:bg-zinc-100 rounded-xl text-zinc-400",children:(0,Z.jsx)(es,{className:"h-5 w-5"})})]})]}),(0,Z.jsx)("main",{className:"flex-1 overflow-y-auto overflow-x-hidden selection:bg-primary/10 bg-white",children:(0,Z.jsxs)("div",{className:"max-w-4xl mx-auto py-24 px-16 space-y-16",children:[(0,Z.jsxs)("div",{className:"space-y-6",children:[(0,Z.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Z.jsx)("div",{className:"px-3 py-1 bg-zinc-100 rounded-full text-[10px] font-black uppercase text-zinc-400 tracking-widest",children:t.entry_date}),(0,Z.jsx)("div",{className:"h-px bg-zinc-100 flex-1"}),(0,Z.jsxs)("div",{className:"text-[10px] font-black text-zinc-300 uppercase tracking-widest",children:["Record ID: ",t.diary_entry_id.split("-")[0]]})]}),(0,Z.jsx)("input",{className:"w-full text-7xl font-black tracking-tighter outline-none bg-transparent placeholder:text-zinc-100 text-zinc-900 leading-[0.9] uppercase",placeholder:"Entry Point Title",defaultValue:t.title||"",disabled:c,onBlur:e=>{c||h({title:e.target.value})}})]}),(0,Z.jsxs)("div",{className:"flex gap-4 border-b border-zinc-50 pb-10",children:[(0,Z.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-zinc-50 rounded-2xl border border-zinc-100",children:[(0,Z.jsx)(ec.Smile,{className:"h-4 w-4 text-primary"}),(0,Z.jsx)("span",{className:"text-xs font-bold uppercase tracking-widest text-zinc-500",children:t.mood_label||"Stable"})]}),(0,Z.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-zinc-50 rounded-2xl border border-zinc-100",children:[(0,Z.jsx)(ed.Zap,{className:"h-4 w-4 text-orange-500"}),(0,Z.jsxs)("span",{className:"text-xs font-bold uppercase tracking-widest text-zinc-500",children:["E: ",t.energy_level||0]})]}),(0,Z.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-zinc-50 rounded-2xl border border-zinc-100",children:[(0,Z.jsx)(eu.Brain,{className:"h-4 w-4 text-red-500"}),(0,Z.jsxs)("span",{className:"text-xs font-bold uppercase tracking-widest text-zinc-500",children:["S: ",t.stress_level||0]})]}),(0,Z.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 bg-zinc-50 rounded-2xl border border-zinc-100",children:[(0,Z.jsx)(eh,{className:(0,Fl.cn)("h-4 w-4",2===t.importance_level?"text-red-500":1===t.importance_level?"text-orange-500":"text-zinc-400")}),(0,Z.jsx)("span",{className:"text-xs font-bold uppercase tracking-widest text-zinc-500",children:"Priority"})]})]}),(0,Z.jsx)("div",{className:"-mx-16 min-h-[500px]",children:(0,Z.jsx)(jM,{initialContent:t.content_json,onChange:p,editable:!c})}),(0,Z.jsxs)("div",{className:"pt-20 border-t border-zinc-100 space-y-8",children:[(0,Z.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Z.jsxs)("div",{children:[(0,Z.jsx)("h3",{className:"text-sm font-black uppercase tracking-[0.2em] text-zinc-400",children:"Nested Chronicles"}),(0,Z.jsx)("p",{className:"text-xs font-medium text-zinc-500 mt-1",children:"Deep linking related sub-pages for this entry."})]}),(0,Z.jsxs)(jI.Button,{variant:"outline",size:"sm",onClick:f,className:"h-10 px-6 text-[10px] font-black uppercase tracking-widest rounded-xl border-zinc-200 hover:bg-zinc-50 gap-2",disabled:c,children:[(0,Z.jsx)(er.Plus,{className:"h-4 w-4"}),"Add Nested Page"]})]}),(0,Z.jsx)("div",{className:"grid gap-3",children:0===r.length?(0,Z.jsxs)("div",{className:"flex flex-col items-center gap-4 py-12 bg-zinc-50 border border-dashed border-zinc-200 rounded-3xl opacity-40",children:[(0,Z.jsx)(eo,{className:"h-8 w-8 text-zinc-300"}),(0,Z.jsxs)("div",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-zinc-400 italic text-center",children:["No hierarchy established ",(0,Z.jsx)("br",{})," for this entry point."]})]}):r.map(e=>(0,Z.jsxs)(ep.default,{href:`/diary/editor?id=${e.diary_entry_id}`,className:"flex items-center gap-6 p-6 rounded-[1.5rem] border border-zinc-100 hover:border-primary/20 hover:bg-primary/5 group transition-all",children:[(0,Z.jsx)("div",{className:"h-10 w-10 rounded-xl bg-white border border-zinc-200 flex items-center justify-center shadow-sm group-hover:border-primary/20 transition-colors",children:(0,Z.jsx)(eo,{className:"h-5 w-5 text-zinc-400 group-hover:text-primary transition-colors"})}),(0,Z.jsxs)("div",{className:"flex-1",children:[(0,Z.jsx)("span",{className:"text-lg font-black tracking-tight text-zinc-900 uppercase group-hover:text-primary transition-colors",children:e.title||"Untitled Sub-page"}),(0,Z.jsxs)("p",{className:"text-[10px] font-black uppercase text-zinc-400 tracking-widest mt-1",children:["Captured at"," ",new Date(1e3*e.created_at).toLocaleTimeString()]})]}),(0,Z.jsx)(ei.ChevronRight,{className:"h-6 w-6 text-zinc-200 group-hover:text-primary transition-all group-hover:translate-x-1"})]},e.diary_entry_id))})]})]})})]}):(0,Z.jsx)("div",{className:"p-20 text-center text-destructive font-bold",children:"404: IDENTITY NOT FOUND"})}function Fh(){return(0,Z.jsx)(X.Suspense,{fallback:(0,Z.jsx)("div",{className:"p-20 text-center animate-pulse font-black text-zinc-300 uppercase tracking-widest",children:"Warping to stream..."}),children:(0,Z.jsx)(Fu,{})})}e.s(["default",()=>Fh],28615)}]);